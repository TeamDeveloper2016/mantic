<?xml version="1.0" encoding="ISO-8859-1" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html
  xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:fn="http://java.sun.com/jsp/jstl/functions"
	xmlns:p="http://primefaces.org/ui"
	xmlns:pe="http://primefaces.org/ui/extensions">
	<f:view contentType="text/html">
		<h:head>
			<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
			<meta http-equiv="X-UA-Compatible" content="IE=EDGE; IE=10; IE=9;"/>
			<link rel="shortcut icon" type="image/ico" href="#{kajoolUtilAplicacion.defaultResourceImg}/sistema/favicon.ico.jsf?ln=janal"/>
			<h:outputScript library="janal" name="#{kajoolUtilAplicacion.libraryJs}"/>
			<h:outputText escape="false" value="#{kajoolUtilAplicacion.defaultScripts}"/>							
			<h:outputScript library="sentinel" name="js/jquery.sentinel.layout-1.0.1.js"/>			
      <h:outputText escape="false" value="#{kajoolUtilAplicacion.defaultCss}"/>
 			<ui:insert name="librerias"/>      			
		</h:head>
		<h:body class="ui-widget-content">	
			<p:ajaxExceptionHandler type="java.lang.RuntimeException" update="janalGlobalException" onexception="PF('exceptionGlobalDialog').show();" />
			<p:ajaxExceptionHandler type="javax.faces.application.ViewExpiredException" update="janalGlobalException" onexception="PF('exceptionGlobalDialog').show();" />
			<p:layout fullPage="true">
        <p:layoutUnit position="north" styleClass="janal-header-page" style="border:0; width: 100%" gutter="0">
				<ui:include src="/WEB-INF/plantillas/secciones/titulo.xhtml" />
				</p:layoutUnit>
        <p:layoutUnit id="principal" position="center" size="100%" style="border:0;" styleClass="sticky-wrapper" gutter="0">
          <div id="layout-portlets-cover" class="janal-content-center">
            <h:form id="datos" prependId="false">						
              <p:growl id="mensaje" showSummary="false" showDetail="true" sticky="true" widgetVar="mensajes" autoUpdate="true" escape="false" life="15000"/>
              <p:panel styleClass="sticky-body" toggleable="true" style="border:0px;">
                <p:focus context="principal"/>																																		
                <ui:insert name="contenido"/>																	
              </p:panel>						
              <p:spacer id="temporal" width="1px" height="1px"/>
              <p:blockUI block="principal" widgetVar="bloqueo" trigger="#{empty componenteBloqueo? 'temporal': componenteBloqueo}">
                ¡  Espere por favor !<br/><br/><br/>
                <i class="fa fa-spinner fa-spin fa-2x"></i>
              </p:blockUI>							
            </h:form>
          </div>
				</p:layoutUnit>
			</p:layout>
			<h:form prependId="false">
				<pe:remoteCommand name="executeGlobalException" actionListener="#{janalBackingPage[janalEventPage]}" process="@all" onstart="return janal.bloquear();" oncomplete="janal.desbloquear();">
					<pe:methodSignature parameters="java.lang.Boolean"/>  
					<pe:methodParam name="isViewException"/>  
				</pe:remoteCommand>	
				<p:dialog id="janalGlobalException" header="Ocurrió una excepción: '#{pfExceptionHandler.type}' !" widgetVar="exceptionGlobalDialog" width="1300px" height="500px" closeOnEscape="true" closable="true" onShow="janal.bloquear();#{empty janalBackingPage? '': pfExceptionHandler.type eq 'javax.faces.application.ViewExpiredException'? 'executeGlobalException(true);': 'executeGlobalException(false);'}" onHide="janal.desbloquear();">
					<div class="janal-wid-100-txt janal-column-center janal-font-bold">
						<p:outputLabel value="FAVOR DE NOTIFICAR DE ESTE ERROR AL EQUIPO DE DESARROLLO DE ESTE SISTEMA !" styleClass="recalculo janal-field-error"/>
					</div>
					<strong>Message: </strong>#{pfExceptionHandler.message} <br/><br/>
					<strong>StackTrace: </strong><h:outputText value="#{pfExceptionHandler.formattedStackTrace}" escape="false" /><br/>
					<hr class="ui-widget-content"/>
					<div class="janal-line-button">						  
						<p:commandButton type="button" icon="fa-refresh" onclick="document.location.href= document.location.href;" value="Recargar pagina!" rendered="#{pfExceptionHandler.type eq 'javax.faces.application.ViewExpiredException'}" />
					</div>	
				</p:dialog>							
			</h:form>	
		</h:body>
	</f:view>
</html>
