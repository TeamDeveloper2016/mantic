<?xml version='1.0' encoding="ISO-8859-1" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition
	xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui"
  xmlns:pe="http://primefaces.org/ui/extensions"
	template="/WEB-INF/plantillas/ingreso.xhtml">
	<ui:define name="librerias">
		<h:outputStylesheet library="janal" name="css/jquery.realperson.css"/>
		<h:outputScript library="janal" name="js/jquery.plugin.min.js"/>
		<h:outputScript library="janal" name="js/jquery.realperson.min.js"/>
		<script type="text/javascript">
			Janal.Control.errors = 2;
			Janal.Control.fields = {
				rfc: {validaciones: 'requerido', mascara: 'libre'},
				folio: {validaciones: 'requerido', mascara: 'libre'},
				codigo: {validaciones: 'requerido', mascara: 'libre'}
			};
			//<![CDATA[
			function start() {
        PF('statusDialog').show();
      };
 
      function stop() {
        PF('statusDialog').hide();
      };
			
			$(document).ready(function() {
				$('#codigo').realperson({length: 5, regenerate: 'Clic para cambiar', includeNumbers: true, chars: $.realperson.alphanumeric});
			});
      
      function showOpcion(opcion) {
        $('div.opciones').hide();
        $('#janal-opcion-'+ opcion).show();
      }
      
      function recalcular() {
        if($('div.janal-contenedor-icons').hasClass('janal-wid-70')) {
          $('div.janal-contenedor-icons').removeClass('janal-wid-70');
          $('div.janal-contenedor-icons').addClass('janal-wid-97');
          $('div.janal-contenedor-menu').removeClass('janal-wid-30');
          $('div.janal-contenedor-menu').addClass('janal-wid-3');
        } // if
        else {
          $('div.janal-contenedor-icons').removeClass('janal-wid-97');
          $('div.janal-contenedor-icons').addClass('janal-wid-70');
          $('div.janal-contenedor-menu').removeClass('janal-wid-3');
          $('div.janal-contenedor-menu').addClass('janal-wid-30');
        } // else  
      }
			//]]>
		</script> 
		<style type="text/css">
			input[type="text"], input[type="password"] { text-align: center !important; }
      .p-p-1 {padding: 0.25rem !important;}
      .p-p-2 {padding: 0.3rem !important;}
      .container {width: 100%; display: flex; flex-direction: row; flex-wrap: wrap; justify-content: center; align-items: center;}
      .galeria  {width: 570px; margin-right: 3%;}
      .galeria .galeria-header {margin: 0 0 0.2rem 0; text-align: left;}
      .galeria .galeria-list {border: 0px; padding-right: 0px;}
      .galeria .galeria-description {margin: 0 0 0.1rem -1.2rem; font-size: 0.8rem; padding-left: 0px !important; font-weight: normal !important;}
      .galeria .galeria-marca {font-size: 1.5rem; margin: 0 0 0.5rem 0; color: blue; font-weight: bold;}
      .galeria .galeria-nombre {font-size: 1.2rem; margin: 0 0 0.5rem 0; color: black; font-weight: bold;}
      .galeria .galeria-list-item .galeria-actions {font-size: 0.9rem; font-weight: 100; margin-bottom: 0.1rem; align-self: flex-end; text-align: right;}
      .galeria .galeria-list-item .galeria-item-search {width: 320px; text-align: center;}
      .galeria .galeria-list-item .galeria-item-search img {width: 300px; height:250px; margin-right: 2rem;}      
      .galeria .galeria-list-item {display: -ms-flexbox;display: flex;-ms-flex-align: center;align-items: center;padding: 0.5rem; text-align: left;}
      .galeria .galeria-list-item .galeria-list-detail {flex: 1 1 0;-ms-flex: 1 1 0;align-self: baseline;}  
      
      .ui-tree.ui-tree-horizontal .ui-treenode-connector-table {width: 2px !important;}
      .ui-tree .ui-icon {position: absolute; top: 44px;}
      .ui-treenode-content {position: relative; width: 90px !important; height: 90px !important;}
      .janal-tree-content {width: 250px !important;height: 36px !important;color: white;text-align: center;padding-top: 10px;}
      .janal-nodo-acciones {position: absolute; right: 0;}
      .janal-nodo-descripcion {white-space: normal !important;position: absolute;top: 40%;left: 20px;}
      .janal-nivel-nodo {font-size: smaller;font-weight: bold;position: absolute;top: 3px;right: 6px !important;}  
      .janal-nodo-nivel {font-size: smaller;font-weight: bold;position: absolute;bottom: 0;right: 0;width: 100%;text-align: right;height: 15px;}
      .janal-tree-content{width: 300px !important;}
      .janal-nodo-title {font-size: smaller;position: absolute;top: 5px;left: 5px !important;border: 0px;} 
      .janal-nivel-1 { background: #6f4CBA !important; color: white;}
      .janal-nivel-2 { background: #35AC19 !important; color: white;}
      .janal-nivel-3 { background: #CC0000 !important; color: white;}
      .janal-nivel-4 { background: #00BFFF !important; color: white;}
      .janal-nivel-5 { background: #2417B2 !important; color: white;}
      .janal-nivel-6 { background: #1767B2 !important; color: white;}
      .janal-nivel-7 { background: #17B279 !important; color: white;}
      .janal-nivel-8 { background: #B28617 !important; color: white;}
      .janal-nivel-9 { background: #B25517 !important; color: white;}
      .janal-nivel-10 { background: #BA4C84 !important; color: white;}
      .janal-nivel-11 { background: #AACC84 !important; color: white;}
      .janal-nivel-12 { background: #CC4C08 !important; color: white;}
      .janal-nivel-13 { background: #604B14 !important; color: white;}
      .janal-nivel-14 { background: #00BB14 !important; color: white;}
      .janal-nivel-15 { background: #FF01A4 !important; color: white;}

      .jana-flex-container {display: flex; flex-direction: row; flex-wrap: nowrap; justify-content: normal; align-items: normal; align-content: normal; height:100vh;}
      .jana-flex-items:nth-child(1) {display: block;  flex-grow: 0; flex-shrink: 1; flex-basis: auto; align-self: auto; order: 0;width: 20%;}
      .jana-flex-items:nth-child(2) {display: block; flex-grow: 0; flex-shrink: 1; flex-basis: auto; align-self: auto; order: 0;width: 100%;}      
      .menu-flex-container {display: flex; flex-direction: column; flex-wrap: nowrap; justify-content: normal; align-items: center; align-content: center; height: 100%;}
      .menu-flex-items {display: block; flex-grow: 0; flex-shrink: 1; flex-basis: auto; align-self: auto; order: 0; width: 80%; text-align: center; box-shadow: rgba(0, 0, 0, 0.24) 0px 3px 8px; margin-bottom: 15px; height: 50px; padding-top: 15px;}
    </style>
	</ui:define>
	<ui:define name="contenido">  	
    <p:menubar styleClass="janal-wid-100-txt">
      <p:menuitem value="Categorías" icon="fa fa-picture-o" process="@this" actionListener="#{kajoolAccesoIndice.doOpcion(0)}" oncomplete="showOpcion(0)"/>
      <p:menuitem value="Marcas" icon="fa fa-dashcube" process="@this" actionListener="#{kajoolAccesoIndice.doOpcion(1)}" oncomplete="showOpcion(1)"/>
      <p:menuitem value="Facturación" icon="fa fa-qrcode" process="@this" actionListener="#{kajoolAccesoIndice.doOpcion(2)}" oncomplete="showOpcion(2)"/>
      <f:facet name="options">
        <p:inputText id="buscar" value="#{kajoolAccesoIndice.attrs.codigo}" size="#{util.isMobile? 10: 25}" style="margin-right:10px" placeholder="Buscar"/>
        <p:commandButton title="Buscar producto" actionListener="#{kajoolAccesoIndice.doSearchItem()}" process="@this buscar" update="tabla" icon="fa fa-search" onstart="showOpcion(3); return true;"/>
        <p:commandButton title="Ingresar" action="/acceso?faces-redirect=true" icon="fa fa-user"/>
      </f:facet> 
    </p:menubar>
      <div id="janal-opcion-0" class="opciones janal-display-none">
    		<pe:remoteCommand name="categoria" process="@this" actionListener="#{kajoolAccesoIndice.doUpdateCategorias}" onstart="return janal.bloquear();" oncomplete="janal.desbloquear();">  
   	 		  <pe:methodSignature parameters="java.lang.String"/>  
			    <pe:methodParam name="descripcion"/>  
        </pe:remoteCommand>
        <p:panelGrid layout="grid" columns="2" styleClass="janal-wid-100" columnClasses="janal-wid-30 janal-contenedor-menu, janal-wid-70 janal-column-center janal-contenedor-icons">
          <p:panel header="Categorias" toggleable="true" toggleSpeed="500" closeSpeed="500" toggleOrientation="horizontal" styleClass="janal-wid-100" style="height:100vh;">
            <p:ajax event="toggle" update="productos" onstart="recalcular(); return true;"/>
            <div class="menu-flex-container">
              <ui:repeat var="row" value="#{kajoolAccesoIndice.menu}" varStatus="index"> 
                <div class="menu-flex-items" style="cursor: pointer;" onclick="categoria('#{row.nombre}');">
                  <i class="fa fa-2x #{row.icon} janal-color-orange"></i>&nbps;
                  <span>#{row.categoria}</span>
                </div>
              </ui:repeat>  
            </div>            
          </p:panel>
          <pe:fluidGrid id="productos" value="#{kajoolAccesoIndice.productos}" var="row" fitWidth="true" hasImages="true" styleClass="janal-column-center">
            <pe:fluidGridItem>
              <div class="container">
                <div class="galeria">
                  <div class="galeria-header p-p-2">
                    <span class="galeria-marca">#{row.producto.marca}</span><br/>
                    <span class="galeria-nombre">#{row.producto.nombre}</span>
                    <div style="float: right; margin-top: -33px;">
                      <p:graphicImage url="#{kajoolAccesoIndice.brand}#{row.producto.logo}" width="200px" height="60px"/>
                    </div>  
                  </div>  
                  <div class="galeria-list-item p-p-1">
                    <div class="galeria-item-search">
                      <a id="view#{row.producto.idProducto}" data-magnify="gallery" href="#{kajoolAccesoIndice.path}#{row.producto.archivo}" data-caption="#{row.producto.nombre}" data-group="icon-image" class="icon">
                        <p:graphicImage url="#{kajoolAccesoIndice.path}#{row.producto.archivo}" style="cursor:zoom-in;"/>
                      </a>  
                    </div> 
                    <div class="galeria-list-detail">
                      <span class="janal-color-orange" style="font-size: 1.1rem; font-weight: bold;">ESPECIFICACIONES:</span><br/>
                      <p:dataList var="item" value="#{row.caracteristicas}" styleClass="galeria-list" itemStyleClass="galeria-description" emptyMessage="#{Constantes.NO_EXISTEN_REGISTROS}">
                        #{kajoolAccesoIndice.doLetraCapital(item)}
                      </p:dataList>
                    </div>  
                  </div>
                  <div class="galeria-actions">
                    <p:dataTable var="row" value="#{row.articulos}" paginator="false" rowKey="#{row.idProductoDetalle}" emptyMessage="#{Constantes.NO_EXISTEN_REGISTROS}" styleClass="filas" rowIndexVar="index" rowStyleClass="#{kajoolAccesoIndice.toColorPartida(row)}">
                      <p:column headerText="Código" styleClass="janal-wid-20">
                        <p:outputLabel value="#{row.codigo}"/>
                      </p:column>   
                      <p:column headerText="Descripción" styleClass="janal-column-left">
                        <p:outputLabel value="#{row.descripcion}"/>
                      </p:column>   
                      <p:column headerText="Medida" styleClass="janal-wid-12 janal-column-center">
                        <p:outputLabel value="#{row.medida}"/>
                      </p:column>   
                      <p:column headerText="$ Precio" styleClass="janal-wid-12 janal-column-right">
                        <h:outputText value="#{row.precio}"/>
                      </p:column>   
                      <p:column headerText="Cliente" styleClass="janal-wid-12 janal-column-right" rendered="#{kajoolAccesoIndice.attrs.particular}">
                        <h:outputText value="#{row.cliente}"/>
                      </p:column>
                    </p:dataTable>	
                    <br/>
                  </div>  
                </div>  
              </div>
            </pe:fluidGridItem>  
          </pe:fluidGrid>    
        </p:panelGrid>
      </div>        
      <div id="janal-opcion-1" class="opciones janal-display-none">
    		<pe:remoteCommand name="procesar" process="@this" actionListener="#{kajoolAccesoIndice.doUpdateMarcas}" onstart="return janal.bloquear();" oncomplete="janal.desbloquear();">  
   	 		  <pe:methodSignature parameters="java.lang.String"/>  
			    <pe:methodParam name="descripcion"/>  
        </pe:remoteCommand>  
        <p:dataGrid value="#{kajoolAccesoIndice.marcas}" var="row" columns="4" rows="1" paginator="true" layout="grid" paginatorPosition="top" paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}" styleClass="janal-wid-100-txt">
          <p:panelGrid layout="grid" columns="1" style="margin: 10px 0px" styleClass="janal-wid-100 janal-column-center">
            <p:commandLink process="@this" style="cursor: pointer;" onclick="procesar('#{row.descripcion}')">
              <p:graphicImage url="#{kajoolAccesoIndice.brand}#{row.original}" style="cursor: pointer; display: #{empty row.original? 'none': ''}" width="200px" height="70px"/> 
              <br/>
              <h:outputText value="#{row.descripcion}" styleClass="janal-color-black janal-font-bold"/>            
            </p:commandLink>
          </p:panelGrid>
        </p:dataGrid>  
        <center style="margin: 30px">
          <pe:fluidGrid id="tabla" value="#{kajoolAccesoIndice.productos}" var="row" fitWidth="true" hasImages="true">
            <pe:fluidGridItem>
              <div class="container">
                <div class="galeria">
                  <div class="galeria-header p-p-2">
                    <span class="galeria-marca">#{row.producto.marca}</span><br/>
                    <span class="galeria-nombre">#{row.producto.nombre}</span>
                    <div style="float: right; margin-top: -33px;">
                      <p:graphicImage url="#{kajoolAccesoIndice.brand}#{row.producto.logo}" width="200px" height="60px"/>
                    </div>  
                  </div>  
                  <div class="galeria-list-item p-p-1">
                    <div class="galeria-item-search">
                      <a id="view#{row.producto.idProducto}" data-magnify="gallery" href="#{kajoolAccesoIndice.path}#{row.producto.archivo}" data-caption="#{row.producto.nombre}" data-group="icon-image" class="icon">
                        <p:graphicImage url="#{kajoolAccesoIndice.path}#{row.producto.archivo}" style="cursor:zoom-in;"/>
                      </a>  
                    </div> 
                    <div class="galeria-list-detail">
                      <span class="janal-color-orange" style="font-size: 1.1rem; font-weight: bold;">ESPECIFICACIONES:</span><br/>
                      <p:dataList var="item" value="#{row.caracteristicas}" styleClass="galeria-list" itemStyleClass="galeria-description" emptyMessage="#{Constantes.NO_EXISTEN_REGISTROS}">
                        #{kajoolAccesoIndice.doLetraCapital(item)}
                      </p:dataList>
                    </div>  
                  </div>
                  <div class="galeria-actions">
                    <p:dataTable var="row" value="#{row.articulos}" paginator="false" rowKey="#{row.idProductoDetalle}" emptyMessage="#{Constantes.NO_EXISTEN_REGISTROS}" styleClass="filas" rowIndexVar="index" rowStyleClass="#{kajoolAccesoIndice.toColorPartida(row)}">
                      <p:column headerText="Código" styleClass="janal-wid-20">
                        <p:outputLabel value="#{row.codigo}"/>
                      </p:column>   
                      <p:column headerText="Descripción" styleClass="janal-column-left">
                        <p:outputLabel value="#{row.descripcion}"/>
                      </p:column>   
                      <p:column headerText="Medida" styleClass="janal-wid-12 janal-column-center">
                        <p:outputLabel value="#{row.medida}"/>
                      </p:column>   
                      <p:column headerText="$ Precio" styleClass="janal-wid-12 janal-column-right">
                        <h:outputText value="#{row.precio}"/>
                      </p:column>   
                      <p:column headerText="Cliente" styleClass="janal-wid-12 janal-column-right" rendered="#{kajoolAccesoIndice.attrs.particular}">
                        <h:outputText value="#{row.cliente}"/>
                      </p:column>
                    </p:dataTable>	
                    <br/>
                  </div>  
                </div>  
              </div>
            </pe:fluidGridItem>  
          </pe:fluidGrid>        
        </center>
      </div>
      <div id="janal-opcion-2" class="opciones">
        <center style="margin: 30px">
          <p:spacer id="temporal" width="1"/>
          <div id="login-box" class="janal-only-out-lines Container80 MaxWid500 Fnone MarAuto BordRad10">
            <div class="Container100">
              <div class="janal-content-center">
                <div class="Container100 TexAlCenter Animated05 BoxSizeBorder TabBtn left TabBtnActiveLeft" role="1">
                  <div class="Container80 Fnone MarAuto"><i class="fa fa-cloud-download"></i>  Facturación</div>
                </div>
                <div class="Container50 TexAlCenter Animated05 BoxSizeBorder TabBtn right" role="2" style="display:none;">
                  <div id="download" class="Container80 Fnone MarAuto"><i class="fa fa-files-o"></i>  Descargar</div>
                </div>
                <div id="tab_1" class="Container90 Fnone MarAuto TexAlCenter TabContent">										
                  <p:panelGrid layout="grid" columns="1" id="gridCuenta">
                    <p:spacer height="1"/>
                    <p:outputLabel for="rfc" value="RFC:" styleClass="Fs16"/>
                    <p:inputText placeholder="ej. ADRC760130L95" id="rfc" tabindex="1" value="#{kajoolAccesoIndice.attrs.rfc}" styleClass="items Container80 Fnone MarAuto Fs18"/>
                    <p:outputLabel for="folio" value="No. ticket:" styleClass="Fs16"/>
                    <p:inputText placeholder="ej. 2019000123" id="folio" tabindex="2" value="#{kajoolAccesoIndice.attrs.folio}" styleClass="items Container80 Fnone MarAuto Fs18"/>
                    <p:outputLabel for="codigo" value="Código:" styleClass="Fs16" style="display: none;"/>
                    <p:inputText placeholder="Dijite código" id="codigo" tabindex="3" value="#{kajoolAccesoIndice.attrs.codigo}" styleClass="items Container80 Fnone MarAuto Fs18"/>
                    <p:commandButton id="aceptar" tabindex="3" value="Recuperar" onstart="$('#encode').val($('#codigo').realperson('getHash')); return janal.execute();" oncomplete="$('#codigo').realperson({length: 5, regenerate: 'Clic para cambiar', includeNumbers: true, chars: $.realperson.alphanumeric});" actionListener="#{kajoolAccesoIndice.doRecoverTicket}" process="@this @(.items)" update="codigo @(.refresh)"/>					
                    <p:spacer height="1"/>
                  </p:panelGrid>
                  <p:inputText id="encode" value="#{kajoolAccesoIndice.attrs.encode}" styleClass="items" style="display: none;"/>
                </div>
                <div id="tab_2" class="Container90 Fnone MarAuto TexAlCenter TabContent DispNone">
                  <p:panelGrid layout="grid" columns="1" styleClass="refresh">
                    <p:spacer width="10%"/>
                    <p:commandLink title="Click para descargar el documento" rendered="#{kajoolAccesoIndice.existsPdf}" ajax="false" onclick="PrimeFaces.monitorDownload(start, stop);" process="@this tab_2">
                      <p:fileDownload value="#{kajoolAccesoIndice.pdfFileDownload}"/>
                      <i class="fa fa-file-pdf-o Fs30 janal-color-orange"></i><br/>
                      <p:outputLabel value="#{kajoolAccesoIndice.attrs.pdfFile.nombre}"/>
                    </p:commandLink>
                    <p:spacer width="5%"/>
                    <p:commandLink title="Click para descargar el documento" rendered="#{kajoolAccesoIndice.existsXml}" ajax="false" onclick="PrimeFaces.monitorDownload(start, stop);" process="@this tab_2">
                      <p:fileDownload value="#{kajoolAccesoIndice.xmlFileDownload}"/>
                      <i class="fa fa-file-code-o Fs30 janal-color-orange"></i><br/>
                      <p:outputLabel value="#{kajoolAccesoIndice.attrs.xmlFile.nombre}"/>
                    </p:commandLink>
                  </p:panelGrid>					
                </div>	
              </div>          
            </div>
          </div>
        </center>        
      </div>  
      <div id="janal-opcion-3" class="opciones">
        <center style="margin: 30px">
          <pe:fluidGrid id="catalogo" value="#{kajoolAccesoIndice.productos}" var="row" fitWidth="true" hasImages="true">
            <pe:fluidGridItem>
              <div class="container">
                <div class="galeria">
                  <div class="galeria-header p-p-2">
                    <span class="galeria-marca">#{row.producto.marca}</span><br/>
                    <span class="galeria-nombre">#{row.producto.nombre}</span>
                    <div style="float: right; margin-top: -33px;">
                      <p:graphicImage url="#{kajoolAccesoIndice.brand}#{row.producto.logo}" width="200px" height="60px"/>
                    </div>  
                  </div>  
                  <div class="galeria-list-item p-p-1">
                    <div class="galeria-item-search">
                      <a id="view#{row.producto.idProducto}" data-magnify="gallery" href="#{kajoolAccesoIndice.path}#{row.producto.archivo}" data-caption="#{row.producto.nombre}" data-group="icon-image" class="icon">
                        <p:graphicImage url="#{kajoolAccesoIndice.path}#{row.producto.archivo}" style="cursor:zoom-in;"/>
                      </a>  
                    </div> 
                    <div class="galeria-list-detail">
                      <span class="janal-color-orange" style="font-size: 1.1rem; font-weight: bold;">ESPECIFICACIONES:</span><br/>
                      <p:dataList var="item" value="#{row.caracteristicas}" styleClass="galeria-list" itemStyleClass="galeria-description" emptyMessage="#{Constantes.NO_EXISTEN_REGISTROS}">
                        #{kajoolAccesoIndice.doLetraCapital(item)}
                      </p:dataList>
                    </div>  
                  </div>
                  <div class="galeria-actions">
                    <p:dataTable var="row" value="#{row.articulos}" paginator="false" rowKey="#{row.idProductoDetalle}" emptyMessage="#{Constantes.NO_EXISTEN_REGISTROS}" styleClass="filas" rowIndexVar="index" rowStyleClass="#{kajoolAccesoIndice.toColorPartida(row)}">
                      <p:column headerText="Código" styleClass="janal-wid-20">
                        <p:outputLabel value="#{row.codigo}"/>
                      </p:column>   
                      <p:column headerText="Descripción" styleClass="janal-column-left">
                        <p:outputLabel value="#{row.descripcion}"/>
                      </p:column>   
                      <p:column headerText="Medida" styleClass="janal-wid-12 janal-column-center">
                        <p:outputLabel value="#{row.medida}"/>
                      </p:column>   
                      <p:column headerText="$ Precio" styleClass="janal-wid-12 janal-column-right">
                        <h:outputText value="#{row.precio}"/>
                      </p:column>   
                      <p:column headerText="Cliente" styleClass="janal-wid-12 janal-column-right" rendered="#{kajoolAccesoIndice.attrs.particular}">
                        <h:outputText value="#{row.cliente}"/>
                      </p:column>
                    </p:dataTable>	
                    <br/>
                  </div>  
                </div>  
              </div>
            </pe:fluidGridItem>  
          </pe:fluidGrid>              
        </center>
      </div>  
		<p:dialog modal="true" widgetVar="statusDialog" header="Descargando documento ..." draggable="false" closable="false" resizable="false">
			<p:graphicImage library="janal" name="/img/sistema/ajaxloadingbar.gif" />
		</p:dialog>		
	</ui:define>
	<ui:param name="componenteBloqueo" value="aceptar"/>
</ui:composition>
