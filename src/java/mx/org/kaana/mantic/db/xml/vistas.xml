<?xml version="1.0" encoding="ISO-8859-1"?>
<!--
		Relación de consultas para las vistas de MANTIC
-->
<process>
	<dml> 
		<unit id="VistaTransferenciasMultiplesDto">
      <select id="lazy">
        select 
          tc_mantic_transferencias_multiples.id_transferencia_multiple as id_key,
          tc_mantic_transferencias_multiples.id_transferencia_multiple,
				  tc_mantic_transferencias_multiples.consecutivo,
          tc_mantic_transferencias_multiples.id_almacen,
          origen.nombre as nombre_origen,
          origen.clave as clave_origen,
          tc_mantic_transferencias_multiples.id_solicito,
          concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) as solicito,
          tc_mantic_transferencias_multiples.id_usuario,
          tc_mantic_transferencias_multiples.registro,
          tc_mantic_transferencias_multiples.observaciones,
          tc_mantic_transferencias_multiples.id_transferencia_multiple_estatus estatus,
          tc_mantic_transferencias_multiples_estatus.nombre nombre_estatus,
          tc_mantic_transferencias_multiples_estatus.estatus_asociados,
          count(distinct(tc_mantic_transferencias_multiples_detalles.id_almacen)) as almacenes,
          count(distinct(tc_mantic_transferencias_multiples_detalles.id_transferencia_multiple_detalle)) as articulos
        from
          tc_mantic_transferencias_multiples
        inner join
          tc_mantic_transferencias_multiples_estatus on tc_mantic_transferencias_multiples.id_transferencia_multiple_estatus = tc_mantic_transferencias_multiples_estatus.id_transferencia_multiple_estatus
        inner join
          tc_mantic_transferencias_multiples_detalles on tc_mantic_transferencias_multiples.id_transferencia_multiple = tc_mantic_transferencias_multiples_detalles.id_transferencia_multiple
        inner join 
					tc_mantic_empresas on tc_mantic_transferencias_multiples.id_empresa = tc_mantic_empresas.id_empresa
        left join 
          tc_mantic_personas on tc_mantic_transferencias_multiples.id_solicito = tc_mantic_personas.id_persona
        inner join 
        	tc_mantic_almacenes origen on tc_mantic_transferencias_multiples.id_almacen = origen.id_almacen
				where 
          tc_mantic_empresas.id_empresa in ({idEmpresa}) 
				  and {condicion}	
        group by
          tc_mantic_transferencias_multiples.id_transferencia_multiple        
        {sortOrder}
      </select>  
			<select id="movimientos">
				select
					tc_mantic_transferencias_multiples_bitacora.id_transferencia_multiple_bitacora as id_key,
					tc_mantic_transferencias_multiples.consecutivo,
				  0 as importe,
				  tc_mantic_transferencias_multiples_bitacora.id_transporto,
					tc_mantic_transferencias_multiples_bitacora.justificacion,
					concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) as nombre,
				  tc_mantic_transferencias_multiples_estatus.nombre as estatus,
					tc_mantic_transferencias_multiples_bitacora.registro
				from 
					tc_mantic_transferencias_multiples_bitacora
				inner join
					tc_mantic_transferencias_multiples on tc_mantic_transferencias_multiples_bitacora.id_transferencia_multiple= tc_mantic_transferencias_multiples.id_transferencia_multiple
				inner join
					tc_mantic_transferencias_multiples_estatus on tc_mantic_transferencias_multiples_bitacora.id_transferencia_multiple_estatus= tc_mantic_transferencias_multiples_estatus.id_transferencia_multiple_estatus
				inner join
					tc_janal_usuarios on tc_mantic_transferencias_multiples_bitacora.id_usuario= tc_janal_usuarios.id_usuario
				inner join
					tc_mantic_personas on tc_janal_usuarios.id_persona= tc_mantic_personas.id_persona
				where
					tc_mantic_transferencias_multiples_bitacora.id_transferencia_multiple= {idTransferenciaMultiple}
				order by
					tc_mantic_transferencias_multiples_bitacora.registro desc				
			</select>		    
      <select id="detalle">
        select      
				  tc_mantic_transferencias_multiples_detalles.id_transferencia_multiple_detalle as id_comodin,
				  tc_mantic_transferencias_multiples_detalles.id_transferencia_multiple as id_orden_detalle,
          tc_mantic_transferencias_multiples_detalles.codigo as propio,
          tc_mantic_transferencias_multiples_detalles.*,
          ifnull(tc_mantic_transferencias_multiples_detalles.cantidad, 0) as solicitados,
          tc_mantic_transferencias_multiples_detalles.cantidad as cuantos,
          tc_mantic_transferencias_multiples_detalles.cantidad as inicial,
				  tc_mantic_articulos.precio as valor
        from      
          tc_mantic_transferencias_multiples_detalles
        inner join
          tc_mantic_articulos on tc_mantic_transferencias_multiples_detalles.id_articulo= tc_mantic_articulos.id_articulo
        where      
          tc_mantic_transferencias_multiples_detalles.id_transferencia_multiple= {idTransferenciaMultiple}
				order by
				  tc_mantic_transferencias_multiples_detalles.caja, 
          tc_mantic_transferencias_multiples_detalles.codigo
      </select>
    </unit>  
		<unit id="VistaProductosDto">
      <select id="hijos">
        select      
          tc_mantic_productos_categorias.id_producto_categoria as id_key,
          tc_mantic_productos_categorias.nombre
        from
          tc_mantic_productos_categorias
        where
          tc_mantic_productos_categorias.padre= '{categoria}|'
        order by
          tc_mantic_productos_categorias.orden
      </select>
      <select id="categorias">
        select      
          tc_mantic_productos_categorias.id_producto_categoria as id_key,
          tc_mantic_productos_categorias.nombre as categoria,
          tc_mantic_productos_categorias.padre,
          concat(tc_mantic_productos_categorias.padre, tc_mantic_productos_categorias.nombre) as nombre,
          ifnull(tc_mantic_productos_categorias.icon, 'fa-language') as icon,
          tc_mantic_productos_categorias.ultimo,
          ifnull(tc_mantic_productos_categorias_archivos.nombre, 'sin-foto.png') as imagen
        from      
          tc_mantic_productos_categorias
        left join
          tc_mantic_productos_categorias_archivos on tc_mantic_productos_categorias.id_producto_categoria_archivo= tc_mantic_productos_categorias_archivos.id_producto_categoria_archivo
        where
          tc_mantic_productos_categorias.nivel= {nivel}
          and (tc_mantic_productos_categorias.padre like '{padre}%' or '{padre}'= 'null')
        group by
          concat(tc_mantic_productos_categorias.padre, tc_mantic_productos_categorias.nombre)
        order by
          concat(tc_mantic_productos_categorias.padre, tc_mantic_productos_categorias.nombre)
      </select>  
      <select id="producto">
        select      
          tc_mantic_productos.*,
          tc_mantic_productos_marcas.nombre as marca,
          tc_mantic_productos_marcas_archivos.nombre as logo,
          concat(tc_mantic_productos_categorias.padre, tc_mantic_productos_categorias.nombre) as categoria
        from      
          tc_mantic_productos
        inner join  
          tc_mantic_productos_marcas on tc_mantic_productos.id_producto_marca= tc_mantic_productos_marcas.id_producto_marca
        left join  
          tc_mantic_productos_marcas_archivos on tc_mantic_productos_marcas.id_producto_marca_archivo= tc_mantic_productos_marcas_archivos.id_producto_marca_archivo
        inner join  
          tc_mantic_productos_categorias on tc_mantic_productos.id_producto_categoria= tc_mantic_productos_categorias.id_producto_categoria
        where 
          tc_mantic_productos.id_producto= {idProducto}
      </select>  
      <select id="productos">
        select 
          tc_mantic_productos.id_producto as id_key,
          tc_mantic_productos.id_producto,
          replace(concat(tc_mantic_productos_categorias.padre, tc_mantic_productos_categorias.nombre), '|', ' » ') as categoria,
          tc_mantic_productos_marcas.nombre as marca,
          concat('{url}', tc_mantic_productos.id_empresa, '/marcas/', ifnull(tc_mantic_productos_marcas_archivos.nombre, '')) as logo,
          tc_mantic_productos.nombre,
          tc_mantic_productos.id_activo,
          concat('{url}', tc_mantic_productos.id_empresa, '/', ifnull(tc_mantic_imagenes.archivo, 'sin-foto.png')) as archivo,
          '{razonSocial}' as razon_social,
          {idCliente} as id_cliente,
          '{tipoVenta}' as cliente,
          tc_mantic_productos.registro
        from
          tc_mantic_productos
				inner join 
          tc_mantic_productos_categorias on tc_mantic_productos.id_producto_categoria= tc_mantic_productos_categorias.id_producto_categoria
				inner join 
					tc_mantic_productos_marcas on tc_mantic_productos.id_producto_marca= tc_mantic_productos_marcas.id_producto_marca
        left join  
          tc_mantic_productos_marcas_archivos on tc_mantic_productos_marcas.id_producto_marca_archivo= tc_mantic_productos_marcas_archivos.id_producto_marca_archivo
        left join
          tc_mantic_imagenes on tc_mantic_productos.id_imagen= tc_mantic_imagenes.id_imagen     
        where
          tc_mantic_productos.id_empresa in ({idEmpresa})
					and concat(tc_mantic_productos_categorias.padre, tc_mantic_productos_categorias.nombre) like '{categoria}%'
        order by
          concat(tc_mantic_productos_categorias.padre, tc_mantic_productos_categorias.nombre),
          tc_mantic_productos.orden         
      </select>
      <select id="porCodigo">
        select      
					distinct(tc_mantic_clientes.id_cliente) as id_key,
					tc_mantic_tipos_ventas.nombre,
          tc_mantic_clientes.*
        from      
          tc_mantic_clientes
        inner join
          tc_mantic_tipos_ventas on tc_mantic_clientes.id_tipo_venta= tc_mantic_tipos_ventas.id_tipo_venta
        where 
          tc_mantic_clientes.id_empresa in ({sucursales})
          and upper(tc_mantic_clientes.clave) regexp '.*{codigo}.*'
				order by
				  tc_mantic_clientes.clave
      </select>
      <select id="porNombre">
        select      
					distinct(tc_mantic_clientes.id_cliente) as id_key,
					tc_mantic_tipos_ventas.nombre,
          tc_mantic_clientes.*
        from      
          tc_mantic_clientes
        inner join
          tc_mantic_tipos_ventas on tc_mantic_clientes.id_tipo_venta= tc_mantic_tipos_ventas.id_tipo_venta
        where 
          tc_mantic_clientes.id_empresa in ({sucursales})
          and (
				    upper(tc_mantic_clientes.razon_social) regexp '.*{codigo}.*'
				    or
				    upper(tc_mantic_clientes.rfc) regexp '.*{codigo}.*'
				  )
				order by
				  tc_mantic_clientes.clave
      </select>
      <select id="codigos">
        select      
          tc_mantic_articulos_codigos.id_articulo_codigo as id_key,
          tc_mantic_articulos_codigos.id_articulo,
          tc_mantic_articulos_codigos.codigo,
          tc_mantic_articulos.menudeo,
          tc_mantic_articulos.medio_mayoreo,
          tc_mantic_articulos.mayoreo,
          if(tc_mantic_articulos_codigos.id_principal= 1, 'SI', 'NO') as principal
        from      
          tc_mantic_articulos_codigos
        inner join
          tc_mantic_articulos on tc_mantic_articulos_codigos.id_articulo= tc_mantic_articulos.id_articulo
        where      
          tc_mantic_articulos_codigos.id_articulo = {idArticulo}
          and tc_mantic_articulos_codigos.id_proveedor is null
        order by
          tc_mantic_articulos_codigos.id_principal,
          tc_mantic_articulos_codigos.codigo
      </select>
			<select id="lazy">  
        select 
          tc_mantic_productos.id_producto as id_key,
          count(tc_mantic_productos_detalles.id_producto) as articulos,
				  tc_mantic_productos.id_producto,
				  tc_mantic_productos.id_empresa,
				  tc_mantic_productos.id_producto_categoria,
				  tc_mantic_productos.nombre,
				  tc_mantic_productos.id_imagen,
				  tc_mantic_productos.orden,
				  tc_mantic_productos.id_activo,
				  tc_mantic_productos.observaciones,
				  tc_mantic_productos.registro,
          tc_mantic_productos_marcas.nombre as marca,
          tc_mantic_productos_categorias.nombre as referencia,
          concat(tc_mantic_productos_categorias.padre, tc_mantic_productos_categorias.nombre) as categoria
        from
          tc_mantic_productos
				inner join 
          tc_mantic_productos_categorias on tc_mantic_productos.id_producto_categoria= tc_mantic_productos_categorias.id_producto_categoria
				inner join 
					tc_mantic_empresas on tc_mantic_productos.id_empresa= tc_mantic_empresas.id_empresa
				inner join 
					tc_mantic_productos_marcas on tc_mantic_productos.id_producto_marca= tc_mantic_productos_marcas.id_producto_marca
				left join 
					tc_mantic_productos_detalles on tc_mantic_productos.id_producto= tc_mantic_productos_detalles.id_producto
        where
          tc_mantic_productos.id_empresa in ({idEmpresa})
					and {condicion}
        group by
          concat(tc_mantic_productos_categorias.padre, tc_mantic_productos_categorias.nombre),
          tc_mantic_productos_marcas.nombre,
          tc_mantic_productos.nombre
        {sortOrder}           
      </select>
			<select id="ordenar">
        select 
          tc_mantic_productos.id_producto as id_key,
          count(tc_mantic_productos_detalles.id_producto) as articulos,
				  tc_mantic_productos.id_producto,
				  tc_mantic_productos.id_empresa,
				  tc_mantic_productos.id_producto_categoria,
				  tc_mantic_productos.nombre,
				  tc_mantic_productos.id_imagen,
				  tc_mantic_productos.orden,
				  tc_mantic_productos.id_activo,
				  tc_mantic_productos.observaciones,
				  tc_mantic_productos.registro,
          tc_mantic_productos_marcas.nombre as marca,
          concat(tc_mantic_productos_categorias.padre, tc_mantic_productos_categorias.nombre) as categoria,
          concat(tc_mantic_productos.id_empresa, '/', ifnull(tc_mantic_imagenes.archivo, 'sin-foto.png')) as archivo
        from
          tc_mantic_productos
				inner join 
					tc_mantic_empresas on tc_mantic_productos.id_empresa= tc_mantic_empresas.id_empresa
				inner join 
          tc_mantic_productos_categorias on tc_mantic_productos.id_producto_categoria= tc_mantic_productos_categorias.id_producto_categoria
				inner join 
					tc_mantic_productos_marcas on tc_mantic_productos.id_producto_marca= tc_mantic_productos_marcas.id_producto_marca
				left join 
					tc_mantic_productos_detalles on tc_mantic_productos.id_producto= tc_mantic_productos_detalles.id_producto
        left join
          tc_mantic_imagenes on tc_mantic_productos.id_imagen= tc_mantic_imagenes.id_imagen     
        where
          tc_mantic_productos.id_empresa in ({idEmpresa})
					and concat(tc_mantic_productos_categorias.padre, tc_mantic_productos_categorias.nombre)= '{categoria}'
        group by
          concat(tc_mantic_productos_categorias.padre, tc_mantic_productos_categorias.nombre),
          tc_mantic_productos_marcas.nombre,
          tc_mantic_productos.nombre
        {sortOrder}           
      </select>
			<select id="galeria">
        select 
          tc_mantic_productos.id_producto as id_key,
          concat(tc_mantic_productos_categorias.padre, tc_mantic_productos_categorias.nombre) as categoria
        from
          tc_mantic_productos
				inner join 
          tc_mantic_productos_categorias on tc_mantic_productos.id_producto_categoria= tc_mantic_productos_categorias.id_producto_categoria
				inner join 
					tc_mantic_empresas on tc_mantic_productos.id_empresa= tc_mantic_empresas.id_empresa
				inner join 
					tc_mantic_productos_marcas on tc_mantic_productos.id_producto_marca= tc_mantic_productos_marcas.id_producto_marca
        where
          tc_mantic_productos.id_empresa in ({idEmpresa})
					and concat(tc_mantic_productos_categorias.padre, tc_mantic_productos_categorias.nombre) like '{categoria}%'
          and tc_mantic_productos.id_activo= 1
        group by
          concat(tc_mantic_productos_categorias.padre, tc_mantic_productos_categorias.nombre),
          tc_mantic_productos_marcas.nombre,
          tc_mantic_productos.nombre
        {sortOrder}           
      </select>
			<select id="marca">
        select 
          tc_mantic_productos.id_producto as id_key,
          concat(tc_mantic_productos_categorias.padre, tc_mantic_productos_categorias.nombre) as categoria,
          tc_mantic_productos_marcas.nombre as marca
        from
          tc_mantic_productos
				inner join 
          tc_mantic_productos_categorias on tc_mantic_productos.id_producto_categoria= tc_mantic_productos_categorias.id_producto_categoria
				inner join 
					tc_mantic_empresas on tc_mantic_productos.id_empresa= tc_mantic_empresas.id_empresa
				inner join 
					tc_mantic_productos_marcas on tc_mantic_productos.id_producto_marca= tc_mantic_productos_marcas.id_producto_marca
        where
          tc_mantic_productos.id_empresa in ({idEmpresa})
					and tc_mantic_productos_marcas.nombre= '{marca}'
          and tc_mantic_productos.id_activo= 1
        group by
          concat(tc_mantic_productos_categorias.padre, tc_mantic_productos_categorias.nombre),
          tc_mantic_productos_marcas.nombre,
          tc_mantic_productos.nombre
        {sortOrder}           
      </select>
      <select id="marcas">
        select 
          tc_mantic_productos.id_producto_marca as id_key,
          tc_mantic_productos_categorias.nombre as categoria,
          tc_mantic_productos_categorias.padre,
          concat(tc_mantic_productos_categorias.padre, tc_mantic_productos_categorias.nombre) as nombre,
          tc_mantic_productos_marcas.nombre as marca,
          count(*) as total,
          ifnull(tc_mantic_productos_marcas_archivos.nombre, 'sin-foto.png') as archivo
        from
          tc_mantic_productos
				inner join 
          tc_mantic_productos_categorias on tc_mantic_productos.id_producto_categoria= tc_mantic_productos_categorias.id_producto_categoria
				inner join 
					tc_mantic_productos_marcas on tc_mantic_productos.id_producto_marca= tc_mantic_productos_marcas.id_producto_marca
        left join
          tc_mantic_productos_marcas_archivos on tc_mantic_productos_marcas.id_producto_marca_archivo= tc_mantic_productos_marcas_archivos.id_producto_marca_archivo
        where
          tc_mantic_productos.id_activo= 1
          and concat(tc_mantic_productos_categorias.padre, tc_mantic_productos_categorias.nombre) like '{categoria}%'
        group by
          tc_mantic_productos_marcas.nombre    
        order by
          count(*) desc
      </select>
      <select id="divisiones">
        select
          tc_mantic_productos_categorias.id_producto_categoria as id_key,
          tc_mantic_productos_categorias.nivel,
          tc_mantic_productos_categorias.nombre as categoria,
          tc_mantic_productos_categorias.padre,
          concat(tc_mantic_productos_categorias.padre, tc_mantic_productos_categorias.nombre) as nombre,
          (select count(*) as total from tc_mantic_productos inner join tc_mantic_productos_categorias as tt_mantic_productos_categorias on tt_mantic_productos_categorias.id_producto_categoria= tc_mantic_productos.id_producto_categoria where tc_mantic_productos.id_activo= 1 and tt_mantic_productos_categorias.padre like concat('{categoria}', tc_mantic_productos_categorias.nombre, '%') limit 0, 1) as total,
          ifnull(tc_mantic_productos_categorias_archivos.nombre, 'sin-foto.png') as archivo
        from
          tc_mantic_productos_categorias
        left join
          tc_mantic_productos_categorias_archivos on tc_mantic_productos_categorias.id_producto_categoria_archivo= tc_mantic_productos_categorias_archivos.id_producto_categoria_archivo
        where
          tc_mantic_productos_categorias.nivel= 3
          and tc_mantic_productos_categorias.padre like '{categoria}%'
        group by
          tc_mantic_productos_categorias.nombre
        order by 
          total desc        
      </select>
			<select id="codigo">
        select 
          tc_mantic_productos.id_producto as id_key,
          concat(tc_mantic_productos_categorias.padre, tc_mantic_productos_categorias.nombre) as categoria,
          tc_mantic_productos_marcas.nombre as marca
        from
          tc_mantic_productos
				inner join 
          tc_mantic_productos_categorias on tc_mantic_productos.id_producto_categoria= tc_mantic_productos_categorias.id_producto_categoria
				inner join 
					tc_mantic_empresas on tc_mantic_productos.id_empresa= tc_mantic_empresas.id_empresa
				inner join 
					tc_mantic_productos_marcas on tc_mantic_productos.id_producto_marca= tc_mantic_productos_marcas.id_producto_marca
        where
          tc_mantic_productos.id_empresa in ({idEmpresa})
          and (upper(tc_mantic_productos.nombre) regexp '.*{codigo}.*' or upper(tc_mantic_productos_marcas.nombre) regexp '.*{codigo}.*')
          and tc_mantic_productos.id_activo= 1
        group by
          concat(tc_mantic_productos_categorias.padre, tc_mantic_productos_categorias.nombre),
          tc_mantic_productos_marcas.nombre,
          tc_mantic_productos.nombre
        {sortOrder}           
      </select>
      <select id="articulos">
        select
         tc_mantic_productos_detalles.id_producto_detalle as id_key,
         tc_mantic_productos_detalles.*,
         (select tc_mantic_articulos_codigos.codigo from tc_mantic_articulos_codigos where tc_mantic_articulos_codigos.id_articulo= tc_mantic_articulos.id_articulo and tc_mantic_articulos_codigos.id_principal= 1 limit 0, 1) as propio,
         (select tc_mantic_articulos_codigos.codigo from tc_mantic_articulos_codigos where tc_mantic_articulos_codigos.id_articulo= tc_mantic_articulos.id_articulo and tc_mantic_articulos_codigos.id_principal= 2 and tc_mantic_articulos_codigos.id_proveedor is null limit 0, 1) as codigo, 
         tc_mantic_articulos.nombre,
         tc_mantic_articulos.menudeo,
         tc_mantic_articulos.medio_mayoreo,
         tc_mantic_articulos.mayoreo,
         ifnull(tc_mantic_imagenes.id_imagen, -1) as id_imagen,
         concat(tc_mantic_articulos.id_empresa, '/', ifnull(tc_mantic_imagenes.archivo, 'sin-foto.png')) as archivo,
         false as principal
        from
          tc_mantic_productos_detalles
        inner join 
          tc_mantic_articulos on tc_mantic_productos_detalles.id_articulo= tc_mantic_articulos.id_articulo
        left join
          tc_mantic_imagenes on tc_mantic_articulos.id_imagen= tc_mantic_imagenes.id_imagen     
        where
          tc_mantic_productos_detalles.id_producto= {idProducto}
        order by
          tc_mantic_productos_detalles.orden        
      </select>
    </unit>    
		<unit id="VistaGaleriaDto">
			<select id="porNombre">
				select 
				  tc_mantic_articulos.id_articulo as id_key,
				  tc_mantic_articulos.id_articulo,
				  (select tc_mantic_articulos_codigos.codigo from tc_mantic_articulos_codigos where tc_mantic_articulos_codigos.id_articulo= tc_mantic_articulos.id_articulo and tc_mantic_articulos_codigos.id_principal= 1 and (upper(tc_mantic_articulos.nombre) regexp '.*{codigo}.*') limit 0, 1) as propio,
				  tc_mantic_articulos.fabricante,
				  tc_mantic_articulos.nombre,
				  tc_mantic_articulos.descripcion,
				  tc_mantic_articulos.precio,
				  tc_mantic_articulos.precio as original,
				  tc_mantic_articulos.menudeo,
				  tc_mantic_articulos.medio_mayoreo,
				  tc_mantic_articulos.mayoreo,
				  tc_mantic_articulos.sat,
				  tc_mantic_articulos.iva,
				  tc_mantic_unidades_medidas.nombre unidad_medida,
          floor(rand()*(10-5+1))+4 as rating,
				  ifnull(tc_mantic_imagenes.archivo, 'sin-foto.png') as archivo
				from 
					tc_mantic_articulos
				inner join
					tc_mantic_articulos_codigos on tc_mantic_articulos.id_articulo = tc_mantic_articulos_codigos.id_articulo and tc_mantic_articulos_codigos.id_principal= 1
				inner join 
					tc_mantic_empresas on tc_mantic_articulos.id_empresa = tc_mantic_empresas.id_empresa
				inner join
					tr_mantic_empaque_unidad_medida on tc_mantic_articulos.id_empaque_unidad_medida = tr_mantic_empaque_unidad_medida.id_empaque_unidad_medida
				inner join 
					tc_mantic_empaques on tr_mantic_empaque_unidad_medida.id_empaque = tc_mantic_empaques.id_empaque
				inner join 
					tc_mantic_unidades_medidas on tr_mantic_empaque_unidad_medida.id_unidad_medida = tc_mantic_unidades_medidas.id_unidad_medida
				left join
				  tc_mantic_imagenes on tc_mantic_articulos.id_imagen= tc_mantic_imagenes.id_imagen
				where 
					tc_mantic_empresas.id_empresa in (1, 2)
				  and tc_mantic_articulos.id_articulo_tipo= 1
				  and tc_mantic_articulos.id_vigente= 1
				  and (upper(tc_mantic_articulos.nombre) regexp '.*{codigo}.*')
          and {condicion}
				{sortOrder}				
			</select>			
			<select id="porCodigo">
				select 
				  tc_mantic_articulos_codigos.id_articulo_codigo as id_key,
				  tc_mantic_articulos.id_articulo,
				  (select tc_mantic_articulos_codigos.codigo from tc_mantic_articulos_codigos where tc_mantic_articulos_codigos.id_articulo= tc_mantic_articulos.id_articulo and tc_mantic_articulos_codigos.id_principal= 1 limit 0, 1) as propio,
				  tc_mantic_articulos.fabricante,
				  tc_mantic_articulos.nombre,
				  tc_mantic_articulos.descripcion,
				  tc_mantic_articulos.precio,
				  tc_mantic_articulos.precio as original,
				  tc_mantic_articulos.menudeo,
				  tc_mantic_articulos.medio_mayoreo,
				  tc_mantic_articulos.mayoreo,
					tc_mantic_articulos.sat,
				  tc_mantic_articulos.iva,
				  tc_mantic_unidades_medidas.nombre unidad_medida,
          floor(rand()*(10-5+1))+4 as rating,
				  ifnull(tc_mantic_imagenes.archivo, 'sin-foto.png') as archivo
				from 
					tc_mantic_articulos
				inner join
					tc_mantic_articulos_codigos on tc_mantic_articulos.id_articulo = tc_mantic_articulos_codigos.id_articulo
				inner join 
					tc_mantic_empresas on tc_mantic_articulos.id_empresa = tc_mantic_empresas.id_empresa								
				inner join
					tr_mantic_empaque_unidad_medida on tc_mantic_articulos.id_empaque_unidad_medida = tr_mantic_empaque_unidad_medida.id_empaque_unidad_medida
				inner join 
					tc_mantic_empaques on tr_mantic_empaque_unidad_medida.id_empaque = tc_mantic_empaques.id_empaque
				inner join 
					tc_mantic_unidades_medidas on tr_mantic_empaque_unidad_medida.id_unidad_medida = tc_mantic_unidades_medidas.id_unidad_medida
				left join
				  tc_mantic_imagenes on tc_mantic_articulos.id_imagen= tc_mantic_imagenes.id_imagen
				where 
					tc_mantic_empresas.id_empresa in (1, 2)
				  and tc_mantic_articulos.id_articulo_tipo= 1
				  and tc_mantic_articulos.id_vigente= 1
				  and upper(tc_mantic_articulos_codigos.codigo) like '{codigo}%'
          and {condicion}
        {sortOrder}				
			</select>
			<select id="porCodigoIgual">
				select 
				  tc_mantic_articulos_codigos.id_articulo_codigo as id_key,
				  tc_mantic_articulos.id_articulo,
				  (select tc_mantic_articulos_codigos.codigo from tc_mantic_articulos_codigos where tc_mantic_articulos_codigos.id_articulo= tc_mantic_articulos.id_articulo and tc_mantic_articulos_codigos.id_principal= 1 limit 0, 1) as propio,
				  tc_mantic_articulos.fabricante,
				  tc_mantic_articulos.nombre,
				  tc_mantic_articulos.descripcion,
				  tc_mantic_articulos.precio,
				  tc_mantic_articulos.precio as original,
				  tc_mantic_articulos.menudeo,
				  tc_mantic_articulos.medio_mayoreo,					
				  tc_mantic_articulos.mayoreo,
					tc_mantic_articulos.sat,
				  tc_mantic_articulos.iva,
				  tc_mantic_unidades_medidas.nombre unidad_medida,
          floor(rand()*(10-5+1))+4 as rating,
				  ifnull(tc_mantic_imagenes.archivo, 'sin-foto.png') as archivo
				from 
					tc_mantic_articulos
				inner join
					tc_mantic_articulos_codigos on tc_mantic_articulos.id_articulo= tc_mantic_articulos_codigos.id_articulo
				inner join 
					tc_mantic_empresas on tc_mantic_articulos.id_empresa = tc_mantic_empresas.id_empresa								
				inner join
					tr_mantic_empaque_unidad_medida on tc_mantic_articulos.id_empaque_unidad_medida = tr_mantic_empaque_unidad_medida.id_empaque_unidad_medida
				inner join 
					tc_mantic_empaques on tr_mantic_empaque_unidad_medida.id_empaque = tc_mantic_empaques.id_empaque
				inner join 
					tc_mantic_unidades_medidas on tr_mantic_empaque_unidad_medida.id_unidad_medida = tc_mantic_unidades_medidas.id_unidad_medida
				left join
				  tc_mantic_imagenes on tc_mantic_articulos.id_imagen= tc_mantic_imagenes.id_imagen
				where 
					tc_mantic_empresas.id_empresa in (1,2)
				  and tc_mantic_articulos.id_articulo_tipo= 1
				  and tc_mantic_articulos.id_vigente= 1
				  and upper(tc_mantic_articulos_codigos.codigo)= '{codigo}'
          and {condicion}
        {sortOrder}
			</select>		
    </unit>  
		<unit id="VistaRefaccionesDto">
      <select id="lazy">
        select 
          tc_mantic_refacciones.id_refaccion as id_key,
				  tc_mantic_empresas.nombre as nombre_empresa,  
					tc_mantic_proveedores.razon_social,
          tc_mantic_refacciones.*
        from
          tc_mantic_refacciones
				inner join 
					tc_mantic_empresas on tc_mantic_refacciones.id_empresa= tc_mantic_empresas.id_empresa
				inner join 
					tc_mantic_proveedores on tc_mantic_refacciones.id_proveedor= tc_mantic_proveedores.id_proveedor
        where
          tc_mantic_refacciones.id_empresa in ({idEmpresa})
					and {condicion}
        {sortOrder}        
      </select>
    </unit>   
		<unit id="VistaServiciosDto">
      <select id="lazy">
        select 
          tc_mantic_encargos.id_encargo as id_key,
				  tc_mantic_empresas.nombre as nombre_empresa,  
          tc_mantic_encargos.*
        from
          tc_mantic_encargos
				inner join 
					tc_mantic_empresas on tc_mantic_encargos.id_empresa= tc_mantic_empresas.id_empresa
        where
          tc_mantic_encargos.id_empresa in ({idEmpresa})
					and {condicion}
        {sortOrder}        
      </select>
    </unit>   
		<unit id="VistaCuentasPorCobrarDto">
      <select id="lazy">
				select
					tc_mantic_clientes_deudas.id_cliente_deuda as id_key,
					tc_mantic_clientes_deudas.id_cliente,
					tc_mantic_clientes.razon_social,
					if(tc_mantic_clientes.saldo&lt; tc_mantic_clientes.limite_credito or tc_mantic_clientes.limite_credito= 0,  'ACTIVO', 'DETENIDO') as estatus,
					sum(tc_mantic_clientes_deudas.importe) as deuda,
					(sum(tc_mantic_clientes_deudas.importe)- sum(tc_mantic_clientes_deudas.saldo)) as pagado,
					sum(if((datediff(tc_mantic_clientes_deudas.limite, now())* -1)&lt;= 0, tc_mantic_clientes_deudas.saldo, 0)) as saldo,
					sum(if((datediff(tc_mantic_clientes_deudas.limite, now())* -1)&gt; 0,  tc_mantic_clientes_deudas.saldo, 0)) as vencido,
					tc_mantic_clientes.limite_credito,
					tc_mantic_clientes.saldo as saldo_global,
					max(datediff(tc_mantic_clientes_deudas.limite, now())* -1) as dias
				from
					tc_mantic_clientes_deudas
				inner join
					tc_mantic_ventas on tc_mantic_clientes_deudas.id_venta= tc_mantic_ventas.id_venta
				inner join 
					tc_mantic_clientes on tc_mantic_clientes_deudas.id_cliente = tc_mantic_clientes.id_cliente
				where
				  tc_mantic_ventas.id_empresa in ({idEmpresa})
				  and tc_mantic_clientes_deudas.id_cliente_estatus in (1,2)
					and {condicion}
				group by
					tc_mantic_clientes_deudas.id_cliente
        {sortOrder}        
      </select>  
      <select id="porCodigo">
        select      
					distinct(tc_mantic_clientes.id_cliente) as id_key,
          tc_mantic_clientes.*
        from      
          tc_mantic_clientes
        inner join
          tc_mantic_clientes_deudas on tc_mantic_clientes.id_cliente= tc_mantic_clientes_deudas.id_cliente
        where 
          tc_mantic_clientes.id_empresa in ({sucursales})
          and upper(tc_mantic_clientes.clave) regexp '.*{codigo}.*'
				order by
				  tc_mantic_clientes.clave
      </select>
      <select id="porNombre">
        select      
					distinct(tc_mantic_clientes.id_cliente) as id_key,
          tc_mantic_clientes.*
        from      
          tc_mantic_clientes
        inner join
          tc_mantic_clientes_deudas on tc_mantic_clientes.id_cliente= tc_mantic_clientes_deudas.id_cliente
        where 
          tc_mantic_clientes.id_empresa in ({sucursales})
          and (
				    upper(tc_mantic_clientes.razon_social) regexp '.*{codigo}.*'
				    or
				    upper(tc_mantic_clientes.rfc) regexp '.*{codigo}.*'
				  )
				order by
				  tc_mantic_clientes.clave
      </select>
    </unit>  
		<unit id="VistaPedidosDto">
			<select id="row">
				select
					tc_mantic_pedidos.id_pedido as id_key,
					tc_mantic_pedidos.id_pedido,
					tc_mantic_pedidos.id_usuario,
					tc_mantic_pedidos.consecutivo,
					tc_mantic_pedidos.total,
					tc_mantic_pedidos.id_pedido_estatus,
					tc_mantic_pedidos_detalles.id_pedido_detalle,
					tc_mantic_pedidos_detalles.id_articulo,
					tc_mantic_pedidos_detalles.codigo,
					tc_mantic_pedidos_detalles.nombre,
					tc_mantic_pedidos_detalles.cantidad,
					tc_mantic_pedidos_detalles.precio,
					tc_mantic_pedidos_detalles.importe,
					tc_mantic_pedidos_detalles.registro
				from
					tc_mantic_pedidos
				left join
					tc_mantic_pedidos_detalles on tc_mantic_pedidos.id_pedido= tc_mantic_pedidos_detalles.id_pedido
				where
					tc_mantic_pedidos.id_usuario= {idUsuario}
				  and (tc_mantic_pedidos.id_pedido_estatus= 1 or tc_mantic_pedidos.id_pedido_estatus= 4 or tc_mantic_pedidos.id_pedido_estatus= 2)
				order by
					tc_mantic_pedidos_detalles.id_pedido_detalle
			</select>	
			<select id="pedido">
				select
					tc_mantic_pedidos.id_pedido as id_key,
					tc_mantic_pedidos.id_usuario,
					tc_mantic_pedidos.consecutivo,
					tc_mantic_pedidos.total,
					tc_mantic_pedidos.id_pedido_estatus,
					tc_mantic_pedidos_detalles.cantidad as original,
					tc_mantic_pedidos_detalles.*
				from
					tc_mantic_pedidos
				left join
					tc_mantic_pedidos_detalles on tc_mantic_pedidos.id_pedido= tc_mantic_pedidos_detalles.id_pedido
				where
					tc_mantic_pedidos.id_pedido= {idPedido}
				order by
					tc_mantic_pedidos_detalles.id_pedido_detalle
			</select>	
			<select id="pedidos">
				select
					tc_mantic_pedidos.id_pedido as id_key,
					tc_mantic_pedidos.id_usuario,
					tc_mantic_pedidos.consecutivo,
					count(*) as articulos,
					tc_mantic_pedidos.total,
					tc_mantic_pedidos.id_pedido_estatus,
					tc_mantic_pedidos_estatus.nombre,
					tc_mantic_pedidos.registro
				from
					tc_mantic_pedidos
				left join
					tc_mantic_pedidos_detalles on tc_mantic_pedidos.id_pedido= tc_mantic_pedidos_detalles.id_pedido
				inner join
					tc_mantic_pedidos_estatus on tc_mantic_pedidos.id_pedido_estatus= tc_mantic_pedidos_estatus.id_pedido_estatus
				where
					tc_mantic_pedidos.id_usuario= {idUsuario}
				group by
					tc_mantic_pedidos.id_empresa,
					tc_mantic_pedidos.id_usuario,
					tc_mantic_pedidos.consecutivo
				order by
					tc_mantic_pedidos.id_pedido
			</select>	
			<select id="pedidosCondicion">
				select
					tc_mantic_pedidos.id_pedido as id_key,
					tc_mantic_pedidos.*,
					tc_mantic_pedidos_estatus.nombre
				from
					tc_mantic_pedidos				
				inner join
					tc_mantic_pedidos_estatus on tc_mantic_pedidos.id_pedido_estatus= tc_mantic_pedidos_estatus.id_pedido_estatus
				where
					tc_mantic_pedidos.id_usuario= {idUsuario}
				and 
					{condicion}
				group by
					tc_mantic_pedidos.id_empresa,
					tc_mantic_pedidos.id_usuario,
					tc_mantic_pedidos.consecutivo
				order by
					tc_mantic_pedidos.id_pedido
			</select>	
			<select id="articulos">
				select
					count(*) as articulos
				from
					tc_mantic_pedidos
				left join
					tc_mantic_pedidos_detalles on tc_mantic_pedidos.id_pedido= tc_mantic_pedidos_detalles.id_pedido
				where
					tc_mantic_pedidos.id_pedido= {idPedido}				
			</select>
		</unit>
		<unit id="VistaSincronizarDto">
			<select id="lazy">
				select
          tc_mantic_ventas.id_venta as id_key,
				  'VENTA' as documento,
				  tc_mantic_ventas.id_empresa,
				  tc_mantic_empresas.clave as empresa,  
				  tc_mantic_empresas.nombre as nombre_empresa,  
          tc_mantic_ventas.consecutivo,
				  tc_mantic_ventas.id_usuario,
					concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) as usuario,
				  tc_mantic_ventas.id_sincronizado,
				  tc_mantic_ventas.registro
        from
          tc_mantic_ventas
				inner join 
					tc_mantic_empresas on tc_mantic_ventas.id_empresa= tc_mantic_empresas.id_empresa
				inner join
					tc_janal_usuarios on tc_mantic_ventas.id_usuario= tc_janal_usuarios.id_usuario
				inner join
					tc_mantic_personas on tc_janal_usuarios.id_persona= tc_mantic_personas.id_persona
				where 
          tc_mantic_ventas.id_empresa in ({idEmpresa}) 
          and tc_mantic_ventas.id_sincronizado= 1
				  and {condicion}	
        {sortOrder}
			</select>
		</unit>			
    <unit id="VistaConfrontasDto">
			<select id="confronta">
				select
					tc_mantic_transferencias_detalles.id_transferencia_detalle as id_key,
				  tc_mantic_transferencias.id_empresa,
				  tc_mantic_transferencias.consecutivo,
					tc_mantic_transferencias_detalles.codigo,
					tc_mantic_transferencias_detalles.codigo as propio,
					tc_mantic_transferencias_detalles.nombre,
					tc_mantic_transferencias_detalles.cantidad,
				  tc_mantic_transferencias_detalles.cantidad as solicitar,
					tc_mantic_transferencias_detalles.cantidades,
					tc_mantic_transferencias_detalles.cantidades as unidades,
				  tc_mantic_transferencias.id_transferencia,
					tc_mantic_transferencias_detalles.id_articulo,
				  'janal-color-blue' as color,
				  0 as porcentaje
				from
					tc_mantic_transferencias
				inner join
					tc_mantic_transferencias_detalles on tc_mantic_transferencias.id_transferencia= tc_mantic_transferencias_detalles.id_transferencia
				where  
  				tc_mantic_transferencias.id_transferencia= {idTransferencia}
				  and {condicion}
				{sortOrder}
			</select>			
		  <select id="consulta">
				select
					tc_mantic_confrontas_detalles.id_confronta_detalle as id_key,
					tc_mantic_confrontas.consecutivo,
					tc_mantic_transferencias.consecutivo as transferencia,
					tc_mantic_confrontas_detalles.codigo,
					tc_mantic_confrontas_detalles.codigo as propio,
					tc_mantic_confrontas_detalles.nombre,
					tc_mantic_confrontas_detalles.cantidad,
					tc_mantic_confrontas_detalles.cantidades,
				  if(tc_mantic_confrontas_detalles.id_transferencia_detalle is null, '*', '') as nuevo,
  				tc_mantic_confrontas_detalles.declarados,
  				tc_mantic_confrontas_detalles.diferencia,
				  tc_mantic_transferencias_estatus.nombre as estatus,
				  tc_mantic_transferencias_estatus.id_transferencia_estatus,
				  tc_mantic_confrontas.id_confronta,
				  tc_mantic_confrontas.id_transferencia,
				  'janal-color-blue' as color,
				  0 as porcentaje,
					tc_mantic_confrontas_detalles.id_articulo,
					tc_mantic_transferencias.registro,
					tc_mantic_transferencias.observaciones
				from
					tc_mantic_confrontas
				inner join 
				  tc_mantic_transferencias on tc_mantic_confrontas.id_transferencia= tc_mantic_transferencias.id_transferencia
				inner join
					tc_mantic_confrontas_detalles on tc_mantic_confrontas.id_confronta= tc_mantic_confrontas_detalles.id_confronta
				inner join
				  tc_mantic_transferencias_estatus on tc_mantic_transferencias.id_transferencia_estatus= tc_mantic_transferencias_estatus.id_transferencia_estatus
				left join
				  tc_mantic_transferencias_detalles on tc_mantic_confrontas_detalles.id_transferencia_detalle= tc_mantic_transferencias_detalles.id_transferencia_detalle
				where  
					tc_mantic_confrontas.id_transferencia= {idTransferencia}	
				  {condicion}
				{sortOrder}
			</select>	
		  <select id="autorizar">
				select
					tc_mantic_confrontas_detalles.id_confronta_detalle as id_key,
					tc_mantic_confrontas_detalles.id_confronta_detalle as id_comodin,
					tc_mantic_confrontas.consecutivo as origen,
					tc_mantic_transferencias.consecutivo as transferencia,
					tc_mantic_confrontas_detalles.codigo,
					tc_mantic_confrontas_detalles.codigo as propio,
					tc_mantic_confrontas_detalles.nombre,
					tc_mantic_confrontas_detalles.cantidad,
					tc_mantic_confrontas_detalles.cantidades as inicial,
				  ifnull(tc_mantic_transferencias_detalles.cantidad, 0) as solicitados,
				  if(tc_mantic_confrontas_detalles.id_transferencia_detalle is null, '*', '') as observacion,
  				tc_mantic_confrontas_detalles.diferencia as cuantos,
				  tc_mantic_transferencias_estatus.nombre as estatus,
				  tc_mantic_transferencias_estatus.id_transferencia_estatus,
				  tc_mantic_confrontas.id_confronta as id_proveedor,
				  tc_mantic_confrontas.id_transferencia as id_orden_detalle,
					tc_mantic_confrontas_detalles.id_articulo,
				  0 as id_aplicar,
					tc_mantic_confrontas_detalles.cantidad as descuentos,
				  ifnull(tc_mantic_inventarios.stock, 0) as stock,
          tc_mantic_confrontas_detalles.perdidos as excedentes,
          tc_mantic_confrontas_detalles.observaciones as sat
				from
					tc_mantic_confrontas
				inner join 
				  tc_mantic_transferencias on tc_mantic_confrontas.id_transferencia= tc_mantic_transferencias.id_transferencia
				inner join
					tc_mantic_confrontas_detalles on tc_mantic_confrontas.id_confronta= tc_mantic_confrontas_detalles.id_confronta
				inner join
				  tc_mantic_transferencias_estatus on tc_mantic_transferencias.id_transferencia_estatus= tc_mantic_transferencias_estatus.id_transferencia_estatus
				left join
				  tc_mantic_transferencias_detalles on tc_mantic_confrontas_detalles.id_transferencia_detalle= tc_mantic_transferencias_detalles.id_transferencia_detalle
				left join
				  tc_mantic_inventarios on tc_mantic_transferencias.id_almacen= tc_mantic_inventarios.id_almacen and tc_mantic_inventarios.id_articulo= tc_mantic_transferencias_detalles.id_articulo
	      left join
          tc_mantic_inventarios as tt_mantic_inventarios on tc_mantic_transferencias.id_destino= tt_mantic_inventarios.id_almacen and tt_mantic_inventarios.id_articulo= tc_mantic_transferencias_detalles.id_articulo     
			  where  
					tc_mantic_confrontas.id_transferencia= {idTransferencia}	
				  and tc_mantic_confrontas_detalles.diferencia!= 0
        group by
          tc_mantic_confrontas_detalles.id_confronta_detalle
				order by 
				  tc_mantic_confrontas.consecutivo, 
          tc_mantic_transferencias_detalles.nombre
			</select>						
			<select id="errores">
        select
					sum(tc_mantic_errores.total) as total
				from (    				
					select
					  count(*) as total
					from
					  tc_mantic_transferencias_detalles
					where      
					  tc_mantic_transferencias_detalles.id_transferencia= {idTransferencia}
					  and tc_mantic_transferencias_detalles.cantidades&lt;&gt; 0
				union
					select 
						count(*) as total
					from
						tc_mantic_confrontas
					inner join
						tc_mantic_confrontas_detalles on tc_mantic_confrontas.id_confronta= tc_mantic_confrontas_detalles.id_confronta 
					where
						tc_mantic_confrontas.id_transferencia= {idTransferencia}
						and tc_mantic_confrontas_detalles.id_transferencia_detalle is null
				) as tc_mantic_errores
			</select>
      <select id="siguiente">
        select
					max(tc_mantic_confrontas.orden)+ 1 as siguiente
				from 
					tc_mantic_confrontas
				inner join
				  tc_mantic_transferencias on tc_mantic_confrontas.id_transferencia= tc_mantic_transferencias.id_transferencia
				where
				  tc_mantic_confrontas.ejercicio= {ejercicio} 
				  and tc_mantic_transferencias.id_empresa= {idEmpresa}		
				  and tc_mantic_confrontas.orden {operador} 900000		
			</select>		
      <select id="perdidos">
				select
         tc_mantic_confrontas_detalles.id_confronta_detalle as id_key,
         tc_mantic_confrontas.consecutivo,
         tc_mantic_confrontas.registro,
         concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) as autorizo,
         tc_mantic_confrontas_detalles.codigo,
         tc_mantic_confrontas_detalles.nombre,
         tc_mantic_confrontas_detalles.cantidad,
         tc_mantic_confrontas_detalles.cantidades,
         tc_mantic_confrontas_detalles.declarados,
         tc_mantic_confrontas_detalles.diferencia,
         tc_mantic_confrontas_detalles.perdidos,
         tc_mantic_confrontas_detalles.observaciones,
         sum(tc_mantic_confrontas_detalles.perdidos) as articulos
        from
          tc_mantic_confrontas
        inner join
          tc_mantic_confrontas_detalles on tc_mantic_confrontas.id_confronta= tc_mantic_confrontas_detalles.id_confronta
				inner join
					tc_janal_usuarios on tc_mantic_confrontas.id_usuario= tc_janal_usuarios.id_usuario
				inner join
					tc_mantic_personas on tc_janal_usuarios.id_persona= tc_mantic_personas.id_persona
        where
          tc_mantic_confrontas.id_confronta= {idConfronta}
          and tc_mantic_confrontas_detalles.perdidos&gt; 0
        group by  
          tc_mantic_confrontas_detalles.id_confronta_detalle
        order by
          tc_mantic_confrontas_detalles.perdidos desc
      </select>  
      <select id="lazy">
				select
					tc_mantic_transferencias.id_transferencia as id_key,
					ifnull(tc_mantic_confrontas.id_confronta, -1) as id_confronta,
					tc_mantic_transferencias.id_transferencia,
					ifnull(tc_mantic_confrontas.consecutivo, '') as consecutivo,
					tc_mantic_transferencias.consecutivo as transferencia,
					tc_mantic_transferencias.id_almacen,
					tc_mantic_transferencias.id_destino,
					origen.nombre  nombre_origen,
					origen.clave clave_origen,
					destino.nombre nombre_destino,
					destino.clave clave_destino,
					tc_mantic_transferencias.id_solicito,
					concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) as solicito,
					ifnull(tc_mantic_confrontas.id_usuario, tc_mantic_transferencias.id_usuario) as id_usuario,
					ifnull(tc_mantic_confrontas.registro, tc_mantic_transferencias.registro) as registro,
					ifnull(tc_mantic_confrontas.observaciones, '') as observaciones,
					tc_mantic_transferencias.id_transferencia_estatus estatus,
					tc_mantic_transferencias_estatus.nombre nombre_estatus,
					tc_mantic_transferencias_tipos.id_transferencia_tipo,
					tc_mantic_transferencias_tipos.nombre as tipo,
					sum(ifnull(tc_mantic_confrontas_detalles.perdidos, 0)) as perdidos       
				from
					tc_mantic_transferencias         
				left join
					tc_mantic_confrontas on tc_mantic_confrontas.id_transferencia= tc_mantic_transferencias.id_transferencia         
				left join
					tc_mantic_confrontas_detalles on tc_mantic_confrontas.id_confronta= tc_mantic_confrontas_detalles.id_confronta         
				inner join
					tc_mantic_transferencias_estatus on tc_mantic_transferencias.id_transferencia_estatus = tc_mantic_transferencias_estatus.id_transferencia_estatus         
				inner join
					tc_mantic_empresas on tc_mantic_transferencias.id_empresa = tc_mantic_empresas.id_empresa         
				left join
					tc_mantic_personas on tc_mantic_transferencias.id_solicito = tc_mantic_personas.id_persona         
				inner join
					tc_mantic_almacenes origen on tc_mantic_transferencias.id_almacen = origen.id_almacen         
				inner join
					tc_mantic_almacenes destino on tc_mantic_transferencias.id_destino = destino.id_almacen         
				inner join
					tc_mantic_transferencias_tipos on tc_mantic_transferencias.id_transferencia_tipo = tc_mantic_transferencias_tipos.id_transferencia_tipo     
				where
					({condicion})
			  group by
			    tc_mantic_transferencias.id_transferencia 		
				{sortOrder}				
      </select>   
      <select id="detalle">
        select      
				  tc_mantic_transferencias.consecutivo,
				  tc_mantic_confrontas_detalles.id_confronta_detalle as id_key,
				  tc_mantic_confrontas_detalles.id_confronta_detalle as id_comodin,
				  tc_mantic_confrontas_detalles.id_transferencia_detalle as id_orden_detalle,
				  tc_mantic_confrontas_detalles.codigo as propio,
          tc_mantic_confrontas_detalles.*,
          tc_mantic_confrontas_detalles.cantidad as cuantos,
          tc_mantic_confrontas_detalles.cantidad as inicial,
 					ifnull(tc_mantic_transferencias_detalles.cantidad, 0) as solicitados, 
				  tc_mantic_articulos.precio as valor,
				  tc_mantic_confrontas_detalles.caja as bulto
        from      
          tc_mantic_confrontas_detalles
        inner join
				  tc_mantic_confrontas on tc_mantic_confrontas_detalles.id_confronta= tc_mantic_confrontas.id_confronta
        inner join
				  tc_mantic_transferencias on tc_mantic_confrontas.id_transferencia= tc_mantic_transferencias.id_transferencia
        inner join
          tc_mantic_articulos on tc_mantic_confrontas_detalles.id_articulo= tc_mantic_articulos.id_articulo
				left join
				  tc_mantic_transferencias_detalles on tc_mantic_confrontas_detalles.id_transferencia_detalle= tc_mantic_transferencias_detalles.id_transferencia_detalle
        where      
          tc_mantic_confrontas_detalles.id_confronta= {idConfronta}
				  and (
				    (tc_mantic_transferencias.id_transferencia_estatus!= 6)
				    or
				    (tc_mantic_transferencias.id_transferencia_estatus= 6 and tc_mantic_confrontas_detalles.diferencia!= 0)
				  )
				order by
				  tc_mantic_confrontas_detalles.caja, tc_mantic_confrontas_detalles.nombre
      </select>
			<select id="origen">
        select      
				  tc_mantic_transferencias_detalles.id_articulo as id_key,
				  tc_mantic_transferencias_detalles.codigo,
          tc_mantic_transferencias_detalles.nombre,
          ' ' as fecha,
          ' ' as stock
        from      
          tc_mantic_transferencias
        inner join
				  tc_mantic_transferencias_detalles on tc_mantic_transferencias.id_transferencia= tc_mantic_transferencias_detalles.id_transferencia
        inner join
          tc_mantic_articulos on tc_mantic_transferencias_detalles.id_articulo= tc_mantic_articulos.id_articulo
        inner join
				  tc_mantic_inventarios on tc_mantic_transferencias.id_almacen= tc_mantic_inventarios.id_almacen and tc_mantic_transferencias_detalles.id_articulo= tc_mantic_inventarios.id_articulo
        inner join
        (select
						max(tc_mantic_inventarios.id_inventario) as id_inventario
					from
						tc_mantic_inventarios         
					where
						id_automatico= 1
					group by
						id_almacen, id_articulo  
				) as tc_mantic_maximos on tc_mantic_inventarios.id_inventario= tc_mantic_maximos.id_inventario				  
        where      
          tc_mantic_transferencias.id_transferencia= {idTransferencia}
        order by
				  tc_mantic_transferencias_detalles.nombre				
			</select>
			<select id="destino">
        select      
				  tc_mantic_confrontas_detalles.id_articulo as id_key,
				  tc_mantic_confrontas_detalles.codigo,
          tc_mantic_confrontas_detalles.nombre,
          ' ' as fecha,
          ' ' as stock
        from      
          tc_mantic_confrontas_detalles
        inner join
          tc_mantic_articulos on tc_mantic_confrontas_detalles.id_articulo= tc_mantic_articulos.id_articulo
        inner join
				  tc_mantic_confrontas on tc_mantic_confrontas_detalles.id_confronta= tc_mantic_confrontas.id_confronta
        inner join
				  tc_mantic_transferencias on tc_mantic_confrontas.id_transferencia= tc_mantic_transferencias.id_transferencia
        inner join
				  tc_mantic_inventarios on tc_mantic_transferencias.id_destino= tc_mantic_inventarios.id_almacen and tc_mantic_confrontas_detalles.id_articulo= tc_mantic_inventarios.id_articulo
        inner join
        (select
						max(tc_mantic_inventarios.id_inventario) as id_inventario
					from
						tc_mantic_inventarios         
					where
						id_automatico= 1
					group by
						id_almacen, id_articulo  
				) as tc_mantic_maximos on tc_mantic_inventarios.id_inventario= tc_mantic_maximos.id_inventario				  
        where      
          tc_mantic_confrontas.id_confronta= {idConfronta}				
        order by
				  tc_mantic_confrontas_detalles.nombre
			</select>
      <select id="diferencia">
        select      
				  tc_mantic_transferencias.consecutivo,
          1 as sin_iva, 
					1 as tipo_de_cambio, 
					tc_mantic_articulos.nombre, 
					tc_mantic_transferencias_detalles.codigo, 
					tc_mantic_transferencias_detalles.codigo as propio, 
				  tc_mantic_articulos.sat,
					0 as costo, 
					0 as valor, 
					tc_mantic_transferencias_detalles.id_transferencia as id_orden_compra, 
					0 as cantidad, 
					0 as cuantos, 
					0 as inicial, 
					tc_mantic_transferencias_detalles.cantidades as solicitados, 
					tc_mantic_transferencias_detalles.id_transferencia_detalle as id_orden_detalle, 
					tc_mantic_transferencias_detalles.id_articulo, 
					-1 as id_proveedor, 
					false as ultimo, 
					false as solicitado, 
					0 as stock,
				  0 as id_aplicar,
				  tc_mantic_transferencias_detalles.caja,
				  tc_mantic_transferencias_detalles.caja as bulto
        from      
          tc_mantic_transferencias
        inner join      
          tc_mantic_transferencias_detalles on tc_mantic_transferencias.id_transferencia= tc_mantic_transferencias_detalles.id_transferencia
        inner join
          tc_mantic_articulos on tc_mantic_transferencias_detalles.id_articulo= tc_mantic_articulos.id_articulo
        where      
          tc_mantic_transferencias.id_transferencia= {idTransferencia}
				order by
				  tc_mantic_transferencias_detalles.caja, tc_mantic_transferencias_detalles.nombre	
			</select>
		</unit>
		<unit id="VistaInventariosDto">
			<select id="lazy">
				select
					tc_mantic_inventarios.id_inventario as id_key,
					tc_mantic_inventarios.*,
					concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) as persona
				from 
					tc_mantic_inventarios
				inner join
					tc_janal_usuarios on tc_mantic_inventarios.id_usuario= tc_janal_usuarios.id_usuario          
				inner join
					tc_mantic_personas on tc_janal_usuarios.id_persona= tc_mantic_personas.id_persona
				where
					id_almacen= {idAlmacen}
					and id_articulo= {idArticulo}
				{sortOrder}
			</select>	
      <select id="conteos">
				select
					tc_mantic_inventarios.id_inventario as id_key,
					tc_mantic_articulos.nombre as articulo,
					tc_mantic_almacenes.nombre as almacen,
					tc_mantic_inventarios.*,
					concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) as persona
			  from
					tc_mantic_inventarios
				inner join
					tc_janal_usuarios on tc_mantic_inventarios.id_usuario= tc_janal_usuarios.id_usuario          
				inner join
					tc_mantic_personas on tc_janal_usuarios.id_persona= tc_mantic_personas.id_persona
				inner join
					tc_mantic_articulos on tc_mantic_inventarios.id_articulo= tc_mantic_articulos.id_articulo
				inner join
					tc_mantic_almacenes on tc_mantic_inventarios.id_almacen= tc_mantic_almacenes.id_almacen
				inner join (
					select
						max(tc_mantic_inventarios.id_inventario) as id_inventario
					from
						tc_mantic_inventarios         
					where
						id_automatico= 2
					group by
						id_almacen, id_articulo
				) as tc_mantic_maximos on tc_mantic_inventarios.id_inventario= tc_mantic_maximos.id_inventario
        where
          (tc_mantic_almacenes.id_almacen= {idAlmacen} or {idAlmacen}= -1)
				{sortOrder}
      </select>
		</unit>	
		<unit id="VistaCargasMasivasDto">
			<select id="lazy">
				select
					tc_mantic_masivas_detalles.id_masiva_detalle as id_key,
					tc_mantic_masivas_archivos.nombre as archivo,
					tc_mantic_masivas_archivos.tuplas,
					tc_mantic_masivas_detalles.codigo,
					tc_mantic_masivas_detalles.observaciones,
					tc_mantic_masivas_detalles.registro
				from 
					tc_mantic_masivas_archivos
				inner join
					tc_mantic_masivas_detalles on tc_mantic_masivas_archivos.id_masiva_archivo= tc_mantic_masivas_detalles.id_masiva_archivo
				where
					tc_mantic_masivas_archivos.id_masiva_archivo= {idMasivaArchivo}
				{sortOrder}
			</select>
			<select id="movimientos">
				select
					tc_mantic_masivas_bitacora.id_masiva_bitacora as id_key,
					tc_mantic_masivas_archivos.nombre as archivo,
					tc_mantic_masivas_archivos.tuplas,
					tc_mantic_masivas_bitacora.procesados,
					tc_mantic_masivas_bitacora.justificacion,
					concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) as nombre,
				  tc_mantic_masivas_estatus.nombre as estatus,
					tc_mantic_masivas_bitacora.registro
				from 
					tc_mantic_masivas_archivos
				inner join
					tc_mantic_masivas_bitacora on tc_mantic_masivas_archivos.id_masiva_archivo= tc_mantic_masivas_bitacora.id_masiva_archivo
				inner join
					tc_mantic_masivas_estatus on tc_mantic_masivas_bitacora.id_masiva_estatus= tc_mantic_masivas_estatus.id_masiva_estatus
				inner join
					tc_janal_usuarios on tc_mantic_masivas_bitacora.id_usuario= tc_janal_usuarios.id_usuario
				inner join
					tc_mantic_personas on tc_janal_usuarios.id_persona= tc_mantic_personas.id_persona
				where
					tc_mantic_masivas_bitacora.id_masiva_archivo= {idMasivaArchivo}
				{sortOrder}
			</select>	
			<select id="articulo">
				select
					tc_mantic_articulos.id_articulo as id_key,
					tc_mantic_articulos.*
				from
					tc_mantic_articulos
				inner join  
					 tc_mantic_articulos_codigos on tc_mantic_articulos_codigos.id_articulo= tc_mantic_articulos.id_articulo
				where  
					 upper(tc_mantic_articulos_codigos.codigo)= '{codigo}'	
				   and tc_mantic_articulos.id_articulo_tipo= {idArticuloTipo}
			</select>		
			<select id="codigo">
				select
					tc_mantic_articulos.id_articulo as id_key,
					tc_mantic_articulos.*
				from
					tc_mantic_articulos
				inner join  
					tc_mantic_articulos_codigos on tc_mantic_articulos_codigos.id_articulo= tc_mantic_articulos.id_articulo
				where  
					upper(tc_mantic_articulos_codigos.codigo)= '{codigo}'	
				  and tc_mantic_articulos_codigos.id_principal= 1
					and tc_mantic_articulos_codigos.id_proveedor is null
			</select>		
			<select id="encontrado">
				select
					tc_mantic_articulos_codigos.id_articulo as id_key,
					tc_mantic_articulos_codigos.*
				from
					tc_mantic_articulos
				inner join  
					 tc_mantic_articulos_codigos on tc_mantic_articulos_codigos.id_articulo= tc_mantic_articulos.id_articulo
				where  
					 tc_mantic_articulos_codigos.id_articulo= {idArticulo}	
				   and upper(tc_mantic_articulos_codigos.codigo)= '{codigo}'
			</select>		
			<select id="auxiliar">
				select
					tc_mantic_articulos_codigos.id_articulo_codigo,
				  tc_mantic_articulos.nombre
				from
					tc_mantic_articulos
				inner join  
					 tc_mantic_articulos_codigos on tc_mantic_articulos_codigos.id_articulo= tc_mantic_articulos.id_articulo 
				where  
					upper(tc_mantic_articulos_codigos.codigo)= '{codigo}'	
				  and tc_mantic_articulos_codigos.id_proveedor is null
			</select>		
			<select id="principal">
				select
					count(*) as total
				from
					tc_mantic_articulos
				inner join  
					tc_mantic_articulos_codigos on tc_mantic_articulos_codigos.id_articulo= tc_mantic_articulos.id_articulo
				where  
					tc_mantic_articulos_codigos.id_articulo= {idArticulo}
				  and tc_mantic_articulos.id_articulo_tipo= {idArticuloTipo}
				  and tc_mantic_articulos_codigos.id_principal= 1
				group by
				  tc_mantic_articulos.id_articulo_tipo,
				  tc_mantic_articulos_codigos.id_articulo
			</select>		
			<select id="identico">
				select
					tc_mantic_articulos.id_articulo as id_key,
					tc_mantic_articulos.*
				from
					tc_mantic_articulos
				where  
				  id_empaque_unidad_medida = {idEmpaqueUnidadMedida}
          and id_empresa = {idEmpresa} 
          and nombre = '{nombre}'
			</select>		
			<select id="egresos">
				select
					tc_mantic_egresos.id_egreso as id_key,
					tc_mantic_egresos.*
				from
					tc_mantic_egresos				
				where  
					tc_mantic_egresos.descripcion= upper('{descripcion}')
			</select>		
			<select id="cliente">
				select
					tc_mantic_clientes.id_cliente as id_key,
					tc_mantic_clientes.*
				from
					tc_mantic_clientes
				where  
					 upper(tc_mantic_clientes.rfc)= '{rfc}'				
			</select>		
			<select id="proveedor">
				select
					tc_mantic_proveedores.id_proveedor as id_key,
					tc_mantic_proveedores.*
				from
					tc_mantic_proveedores
				where  
					upper(tc_mantic_proveedores.rfc)= upper('{rfc}')
          or upper(tc_mantic_proveedores.clave)= upper('{clave}')
			</select>		
			<select id="trabajo">
				select
					tc_mantic_trabajos.id_trabajo as id_key,
					tc_mantic_trabajos.*
				from
					tc_mantic_trabajos
				where  
					 upper(tc_mantic_trabajos.codigo)= '{codigo}'				
			</select>		
			<select id="usoCfdi">
        select
					tc_mantic_usos_cfdi.id_uso_cfdi
				from
					tc_mantic_usos_cfdi
				where  
					 upper(tc_mantic_usos_cfdi.clave)= '{clave}'					
			</select>
			<select id="auxiliar">
				select
					tc_mantic_articulos_codigos.id_articulo_codigo,
				  tc_mantic_articulos.nombre
				from
					tc_mantic_articulos
				inner join  
					 tc_mantic_articulos_codigos on tc_mantic_articulos_codigos.id_articulo= tc_mantic_articulos.id_articulo 
				where  
					upper(tc_mantic_articulos_codigos.codigo)= '{codigo}'	
				  and tc_mantic_articulos_codigos.id_proveedor is null
			</select>		
			<select id="contactoc">
       select
					tr_mantic_cliente_tipo_contacto.id_cliente_tipo_contacto as id_key,
					tr_mantic_cliente_tipo_contacto.*
				from
					tc_mantic_tipos_contactos
				inner join
				  tr_mantic_cliente_tipo_contacto on tc_mantic_tipos_contactos.id_tipo_contacto= tr_mantic_cliente_tipo_contacto.id_tipo_contacto
				where  
				  tr_mantic_cliente_tipo_contacto.id_cliente= {idCliente}
				  and tc_mantic_tipos_contactos.id_tipo_contacto in ({idTipoContacto})
			</select>
			<select id="contactop">
       select
					tr_mantic_proveedor_tipo_contacto.id_proveedor_tipo_contacto as id_key,
					tr_mantic_proveedor_tipo_contacto.*
				from
					tc_mantic_tipos_contactos
				inner join
				  tr_mantic_proveedor_tipo_contacto on tc_mantic_tipos_contactos.id_tipo_contacto= tr_mantic_proveedor_tipo_contacto.id_tipo_contacto
				where  
				  tr_mantic_proveedor_tipo_contacto.id_proveedor= {idProveedor}
				  and tc_mantic_tipos_contactos.id_tipo_contacto= {idTipoContacto}
			</select>
			<select id="empaque">
				select
					tr_mantic_empaque_unidad_medida.id_empaque_unidad_medida
				from
					tr_mantic_empaque_unidad_medida
				inner join  
					 tc_mantic_unidades_medidas on tr_mantic_empaque_unidad_medida.id_unidad_medida= tc_mantic_unidades_medidas.id_unidad_medida
				where  
					 upper(tc_mantic_unidades_medidas.nombre)= '{codigo}'	
			</select>
			<select id="importados">
        select
					tc_mantic_masivas_archivos.id_masiva_archivo as id_key,
					tc_mantic_empresas.nombre as empresa,
					tc_mantic_masivas_archivos.id_masiva_archivo,
					tc_mantic_tipos_masivos.nombre as categoria,
			  	tc_mantic_masivas_archivos.id_tipo_archivo,
					tc_mantic_tipos_archivos.nombre as formato,
					tc_mantic_masivas_archivos.nombre,
					tc_mantic_masivas_archivos.alias,
					tc_mantic_masivas_archivos.ruta,
					tc_mantic_masivas_archivos.tuplas,
					concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) as usuario,
					tc_mantic_masivas_archivos.observaciones,
				  tc_mantic_masivas_estatus.nombre as estatus,
					tc_mantic_masivas_archivos.id_principal,
					tc_mantic_masivas_archivos.registro
				from
					tc_mantic_masivas_archivos
				inner join
					tc_mantic_empresas on tc_mantic_masivas_archivos.id_empresa= tc_mantic_empresas.id_empresa				
				inner join
					tc_mantic_masivas_estatus on tc_mantic_masivas_archivos.id_masiva_estatus= tc_mantic_masivas_estatus.id_masiva_estatus
				inner join
					tc_mantic_tipos_masivos on tc_mantic_masivas_archivos.id_tipo_masivo= tc_mantic_tipos_masivos.id_tipo_masivo				
				inner join
					tc_mantic_tipos_archivos on tc_mantic_masivas_archivos.id_tipo_archivo= tc_mantic_tipos_archivos.id_tipo_archivo
				inner join
					tc_janal_usuarios on tc_mantic_masivas_archivos.id_usuario= tc_janal_usuarios.id_usuario          
				inner join
					tc_mantic_personas on tc_janal_usuarios.id_persona= tc_mantic_personas.id_persona
				where
			    tc_mantic_masivas_archivos.id_empresa in ({sucursales})
					and tc_mantic_tipos_masivos.id_tipo_masivo= {idTipoMasivo}
				order by
					tc_mantic_masivas_archivos.registro desc
			</select>
		</unit>		
		<unit id="VistaServiciosDetallesDto">
			<select id="orden">
        select      				  
          tc_mantic_servicios_detalles.id_servicio_detalle as id_key,
          tc_mantic_servicios_detalles.id_articulo,
          tc_mantic_servicios_detalles.codigo,
          tc_mantic_servicios_detalles.propio,
          tc_mantic_servicios_detalles.concepto as nombre,
          tc_mantic_servicios_detalles.cantidad,
          tc_mantic_servicios_detalles.precio,
          tc_mantic_servicios_detalles.costo,
          tc_mantic_servicios_detalles.descuento,
          tc_mantic_servicios_detalles.descuentos,
          tc_mantic_servicios_detalles.iva,
          tc_mantic_servicios_detalles.impuestos,
          tc_mantic_servicios_detalles.sub_total,
          tc_mantic_servicios_detalles.importe as total,
          tc_mantic_servicios_detalles.sat,
          tc_mantic_servicios_detalles.registro,
          1 as factor
        from      
          tc_mantic_servicios_detalles				
        where      
          tc_mantic_servicios_detalles.id_servicio= {idServicio}
          and tc_mantic_servicios_detalles.id_articulo_tipo= {idArticuloTipo}
				order by
				  tc_mantic_servicios_detalles.registro
      </select>  
			<select id="detalle">
        select      				  
          tc_mantic_servicios_detalles.id_servicio_detalle as id_key,
          tc_mantic_servicios_detalles.id_servicio_detalle,
          tc_mantic_servicios_detalles.id_servicio,
          tc_mantic_servicios_detalles.id_articulo,          
          tc_mantic_servicios_detalles.codigo,
          tc_mantic_servicios_detalles.propio,
          tc_mantic_servicios_detalles.concepto as nombre,
          tc_mantic_servicios_detalles.cantidad,
          tc_mantic_servicios_detalles.cantidad as cuantos,
          tc_mantic_servicios_detalles.cantidad as inicial,
          tc_mantic_servicios_detalles.precio as costo,
          tc_mantic_servicios_detalles.descuento,
          tc_mantic_servicios_detalles.iva,
          tc_mantic_servicios_detalles.impuestos,
          tc_mantic_servicios_detalles.sub_total,
          tc_mantic_servicios_detalles.importe,
          tc_mantic_servicios_detalles.id_articulo_tipo as id_comodin,
          tc_mantic_servicios_detalles.id_usuario,
          tc_mantic_servicios_detalles.id_valido as id_automatico,
          tc_mantic_servicios_detalles.sat,
          tc_mantic_servicios_detalles.registro
        from      
          tc_mantic_servicios_detalles				
        where      
          tc_mantic_servicios_detalles.id_servicio = {idServicio}
				order by
				  tc_mantic_servicios_detalles.registro
      </select>
			<select id="articulosDetalle">
         select      				  
          tc_mantic_servicios_detalles.id_servicio_detalle AS id_key,
          tc_mantic_servicios_detalles.id_servicio_detalle,
          tc_mantic_servicios_detalles.id_servicio,
          tc_mantic_servicios_detalles.id_articulo,
          tc_mantic_servicios_detalles.codigo,
          tc_mantic_servicios_detalles.concepto,
          tc_mantic_servicios_detalles.cantidad,
          tc_mantic_servicios_detalles.costo,
          tc_mantic_servicios_detalles.descuento,
          tc_mantic_servicios_detalles.iva,
          tc_mantic_servicios_detalles.impuestos,
          tc_mantic_servicios_detalles.sub_total,
          tc_mantic_servicios_detalles.importe,
          tc_mantic_servicios_detalles.id_usuario,
          tc_mantic_servicios_detalles.registro,
          tc_mantic_servicios_detalles.concepto as nombre,
          tc_mantic_servicios_detalles.cantidad as cuantos,
          tc_mantic_servicios_detalles.cantidad as inicial,
          tc_mantic_articulos.precio,
          tc_mantic_articulos.sat,
          tc_mantic_unidades_medidas.nombre unidad_medida,
          (select tc_mantic_articulos_codigos.codigo from tc_mantic_articulos_codigos where tc_mantic_articulos_codigos.id_articulo= tc_mantic_articulos.id_articulo and tc_mantic_articulos_codigos.id_principal= 1 limit 0, 1) as propio,
          tc_mantic_articulos.stock
        from      
          tc_mantic_servicios_detalles		
        inner join
					tc_mantic_articulos on tc_mantic_servicios_detalles.id_articulo = tc_mantic_articulos.id_articulo			
        inner join
					tr_mantic_empaque_unidad_medida on tc_mantic_articulos.id_empaque_unidad_medida = tr_mantic_empaque_unidad_medida.id_empaque_unidad_medida
				inner join 
					tc_mantic_empaques on tr_mantic_empaque_unidad_medida.id_empaque = tc_mantic_empaques.id_empaque
				inner join 
					tc_mantic_unidades_medidas on tr_mantic_empaque_unidad_medida.id_unidad_medida = tc_mantic_unidades_medidas.id_unidad_medida
        where      
          tc_mantic_servicios_detalles.id_servicio = {idServicio}
				order by
				  tc_mantic_servicios_detalles.registro
      </select>
		</unit>
		<unit id="VistaConsultasDto">
			<select id="maximo">
        select
					tc_mantic_ventas.id_venta as id_key,
					tc_mantic_ventas.id_venta,
					tc_mantic_ventas.id_empresa,  
				  tc_mantic_empresas.clave as empresa,  
				  tc_mantic_empresas.nombre as nombre_empresa,  
					tc_mantic_ventas.consecutivo,  
					tc_mantic_ventas.ticket,
          ifnull(tc_mantic_ventas.cotizacion, '') as cotizacion,  
					tc_mantic_clientes.id_cliente,  
					tc_mantic_ventas.id_manual,
					tc_mantic_clientes.razon_social as cliente,
					tc_mantic_clientes.limite_credito,
					tc_mantic_ventas.total,
					tc_mantic_ventas.sub_total,
					tc_mantic_ventas.impuestos,
					tc_mantic_ventas.total as precio_total,
				  tc_mantic_ventas_estatus.nombre as estatus,
					tc_mantic_ventas.id_venta_estatus,
				  tc_mantic_ventas.id_factura,
					tc_mantic_ventas.registro,
					tc_mantic_ventas.registro as hora,
					tc_mantic_ventas_estatus.estatus_asociados, 					
					tc_mantic_personas.cuenta,
					concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) as nombre,
					tc_mantic_clientes.id_credito,
					tc_mantic_clientes_deudas.saldo,
					tc_mantic_clientes_deudas.limite,
          ifnull(tc_mantic_garantias.consecutivo, '') as garantia,
          tc_mantic_garantias.total as devuelto,
          tc_mantic_garantias.registro as fecha
				from 
					tc_mantic_ventas
        inner join (
          select
            max(tc_mantic_ventas.id_venta) as id_venta
          from
            tc_mantic_ventas
          where
            tc_mantic_ventas.id_empresa in ({idEmpresa})
				    and {condicion}         
        ) as tt_mantic_ventas on tc_mantic_ventas.id_venta= tt_mantic_ventas.id_venta 
				inner join 
					tc_mantic_ventas_detalles on tc_mantic_ventas.id_venta= tc_mantic_ventas_detalles.id_venta
				inner join 
					tc_mantic_clientes on tc_mantic_ventas.id_cliente= tc_mantic_clientes.id_cliente
				left join 
				  tc_mantic_clientes_deudas on tc_mantic_ventas.id_venta= tc_mantic_clientes_deudas.id_venta
				inner join 
					tc_mantic_empresas on tc_mantic_ventas.id_empresa= tc_mantic_empresas.id_empresa
				inner join 
					tc_mantic_ventas_estatus on tc_mantic_ventas.id_venta_estatus=tc_mantic_ventas_estatus.id_venta_estatus
				inner join 
				  tc_janal_usuarios on tc_mantic_ventas.id_usuario = tc_janal_usuarios.id_usuario
				inner join				
					tc_mantic_personas on tc_mantic_personas.id_persona = tc_janal_usuarios.id_persona				
				left join
				  tc_mantic_garantias on tc_mantic_ventas.id_venta= tc_mantic_garantias.id_venta
				where
					tc_mantic_ventas.id_empresa in ({idEmpresa})
				  and {condicion}
				group by 
					tc_mantic_ventas.id_venta
      </select>  
			<select id="faltantes">
				select 
          * 
        from
					(select
						tc_mantic_articulos.id_articulo as id_key,
						tc_mantic_articulos.id_articulo,
				    -1 as id_orden_detalle,
						tc_mantic_articulos_codigos.codigo as propio,
						tc_mantic_articulos.nombre,
						(select tc_mantic_articulos_codigos.codigo from tc_mantic_articulos_codigos where tc_mantic_articulos_codigos.id_articulo= tc_mantic_articulos.id_articulo and tc_mantic_articulos_codigos.id_proveedor= {idProveedor} limit 0, 1) as codigo,
						tc_mantic_articulos.iva,
						tc_mantic_articulos.precio as costo,
						tc_mantic_articulos.precio,
						'   ' as consecutivo,
						0 as id_orden_estatus,
						'   ' as estatus, 
						0 as solicitado,
						0 as llegaron,
						tc_mantic_almacenes_articulos.maximo- tc_mantic_almacenes_articulos.stock as cantidad,
						tc_mantic_almacenes_articulos.stock,
						tc_mantic_almacenes_articulos.minimo,
						tc_mantic_almacenes_articulos.maximo,
            tc_mantic_inventarios.registro
					from
						tc_mantic_articulos
					inner join
						tc_mantic_almacenes_articulos on tc_mantic_articulos.id_articulo= tc_mantic_almacenes_articulos.id_articulo
					inner join
						tc_mantic_almacenes on tc_mantic_almacenes_articulos.id_almacen= tc_mantic_almacenes.id_almacen
					inner join 
						tc_mantic_inventarios on tc_mantic_articulos.id_articulo= tc_mantic_inventarios.id_articulo and tc_mantic_inventarios.id_almacen= {idAlmacen}
					inner join
						tc_mantic_articulos_codigos on tc_mantic_articulos.id_articulo= tc_mantic_articulos_codigos.id_articulo
					where 
						tc_mantic_almacenes.id_empresa in ({sucursales})
						and tc_mantic_almacenes.id_almacen= {idAlmacen}
				    and tc_mantic_articulos.id_descontinuado= 2
				    and tc_mantic_articulos.id_vigente= 1
						and tc_mantic_inventarios.id_automatico= 2
						and tc_mantic_almacenes_articulos.stock &lt;= tc_mantic_almacenes_articulos.minimo
						and tc_mantic_articulos_codigos.id_principal= 1
            and (tc_mantic_articulos.nombre regexp '.*{codigoFaltante}.*' or upper(tc_mantic_articulos_codigos.codigo) regexp '.*{codigoFaltante}.*')										
						and tc_mantic_articulos.id_articulo not in 
				    (select 
               tc_mantic_ordenes_detalles.id_articulo 
             from 
               tc_mantic_ordenes_detalles 
				     inner join 
               tc_mantic_ordenes_compras on tc_mantic_ordenes_detalles.id_orden_compra= tc_mantic_ordenes_compras.id_orden_compra and tc_mantic_ordenes_compras.id_orden_estatus in (3,4,5,7))
				union					
					select
						 id_key,
						 id_articulo,
						 id_orden_detalle,
						 propio,
						 nombre,
						 codigo,
						 iva,
						 costo,
						 precio,
						 consecutivo,
						 id_orden_estatus,
						 estatus,
						 solicitado,
						 llegaron,
						 cantidad,
						 stock,
						 minimo,
						 maximo,
             registro     
					from (
						select
							tc_mantic_articulos.id_articulo as id_key,
							tc_mantic_articulos.id_articulo,
							tc_mantic_ordenes_detalles.id_orden_detalle,
							tc_mantic_articulos_codigos.codigo as propio,
							tc_mantic_articulos.nombre,
							(select tc_mantic_articulos_codigos.codigo from tc_mantic_articulos_codigos where tc_mantic_articulos_codigos.id_articulo= tc_mantic_articulos.id_articulo and tc_mantic_articulos_codigos.id_proveedor= {idProveedor} limit 0, 1) as codigo,
							tc_mantic_articulos.iva,
							tc_mantic_articulos.precio as costo,
							tc_mantic_articulos.precio,
							ifnull(tc_mantic_ordenes_compras.consecutivo, '   ') as consecutivo,
							ifnull(tc_mantic_ordenes_compras.id_orden_estatus, 0) as id_orden_estatus,
							ifnull(tc_mantic_ordenes_estatus.nombre, '   ') as estatus, 
							ifnull(tc_mantic_ordenes_detalles.cantidad, 0) as solicitado,
							ifnull(tc_mantic_ordenes_detalles.cantidad- tc_mantic_ordenes_detalles.cantidades, 0) as llegaron,
							tc_mantic_almacenes_articulos.maximo- tc_mantic_almacenes_articulos.stock as cantidad,
							tc_mantic_almacenes_articulos.stock,
							tc_mantic_almacenes_articulos.minimo,
							tc_mantic_almacenes_articulos.maximo,
              tc_mantic_inventarios.registro
						from
							tc_mantic_articulos
						inner join
							tc_mantic_almacenes_articulos on tc_mantic_articulos.id_articulo= tc_mantic_almacenes_articulos.id_articulo
						inner join
							tc_mantic_almacenes on tc_mantic_almacenes_articulos.id_almacen= tc_mantic_almacenes.id_almacen
						inner join 
							tc_mantic_inventarios on tc_mantic_articulos.id_articulo= tc_mantic_inventarios.id_articulo and tc_mantic_inventarios.id_almacen= {idAlmacen}
						inner join
							tc_mantic_articulos_codigos on tc_mantic_articulos.id_articulo= tc_mantic_articulos_codigos.id_articulo
						left join	
							tc_mantic_ordenes_detalles on tc_mantic_articulos.id_articulo= tc_mantic_ordenes_detalles.id_articulo
						left join 
							tc_mantic_ordenes_compras on tc_mantic_ordenes_detalles.id_orden_compra= tc_mantic_ordenes_compras.id_orden_compra
						left join
							tc_mantic_ordenes_estatus on tc_mantic_ordenes_estatus.id_orden_estatus= tc_mantic_ordenes_compras.id_orden_estatus
						where 
							tc_mantic_almacenes.id_empresa in ({sucursales})
							and tc_mantic_almacenes.id_almacen= {idAlmacen}
  				    and tc_mantic_articulos.id_descontinuado= 2
   				    and tc_mantic_articulos.id_vigente= 1
							and tc_mantic_inventarios.id_automatico= 2
							and tc_mantic_almacenes_articulos.stock &lt;= tc_mantic_almacenes_articulos.minimo
							and tc_mantic_articulos_codigos.id_principal= 1
              and (tc_mantic_articulos.nombre regexp '.*{codigoFaltante}.*' or upper(tc_mantic_articulos_codigos.codigo) regexp '.*{codigoFaltante}.*')										
							and (tc_mantic_ordenes_compras.id_orden_estatus in (3,4,5,7) or tc_mantic_ordenes_compras.id_orden_estatus is null)
						order by
							tc_mantic_articulos.nombre, tc_mantic_ordenes_detalles.registro desc
					) as faltantes
					inner join (
						select 
							max(tc_mantic_ordenes_detalles.id_orden_detalle) as id_maximo_detalle,
							tc_mantic_ordenes_detalles.id_articulo as id_maximo_articulo
						from 
							tc_mantic_ordenes_detalles 
						inner join
							tc_mantic_ordenes_compras on tc_mantic_ordenes_detalles.id_orden_compra= tc_mantic_ordenes_compras.id_orden_compra   
						 where
							 (tc_mantic_ordenes_compras.id_orden_estatus in (3,4,5,7) or tc_mantic_ordenes_compras.id_orden_estatus is null)
						group by
							tc_mantic_ordenes_detalles.id_articulo  
						order by  
							tc_mantic_ordenes_detalles.id_articulo      
					) as ultimo on faltantes.id_orden_detalle= ultimo.id_maximo_detalle and faltantes.id_articulo= ultimo.id_maximo_articulo
        union all
        select      
          tc_mantic_articulos.id_articulo as id_key,
          tc_mantic_articulos.id_articulo,
          -1 as id_orden_detalle,
          tc_mantic_articulos_codigos.codigo as propio,
          tc_mantic_articulos.nombre,
          tc_mantic_articulos_codigos.codigo,
          tc_mantic_articulos.iva,
  				tc_mantic_articulos.precio as costo,
					tc_mantic_articulos.precio,
          ' ' as consecutivo,
          0 as id_orden_estatus,
          ' ' as estatus,
					0 as solicitado,
					0 as llegaron,
					tc_mantic_almacenes_articulos.maximo- tc_mantic_almacenes_articulos.stock as cantidad,
					tc_mantic_almacenes_articulos.stock,
					tc_mantic_almacenes_articulos.minimo,
					tc_mantic_almacenes_articulos.maximo,
          tc_mantic_faltantes.registro
        from      
          tc_mantic_faltantes
				inner join 
					tc_mantic_empresas on tc_mantic_faltantes.id_empresa = tc_mantic_empresas.id_empresa
        inner join
          tc_mantic_articulos on tc_mantic_faltantes.id_articulo= tc_mantic_articulos.id_articulo
        inner join
					tc_janal_usuarios on tc_mantic_faltantes.id_usuario= tc_janal_usuarios.id_usuario          
				inner join
					tc_mantic_personas on tc_janal_usuarios.id_persona= tc_mantic_personas.id_persona
				inner join
				  tc_mantic_almacenes_articulos	on tc_mantic_articulos.id_articulo= tc_mantic_almacenes_articulos.id_articulo
        left join
          tc_mantic_articulos_codigos on tc_mantic_faltantes.id_articulo= tc_mantic_articulos_codigos.id_articulo and tc_mantic_articulos_codigos.id_principal= 1
				where 
				  tc_mantic_faltantes.id_empresa in ({sucursales})
				  and tc_mantic_almacenes_articulos.id_almacen= {idAlmacen}
          and tc_mantic_faltantes.id_vigente= 1
				  and tc_mantic_articulos.id_descontinuado= 2
				  and tc_mantic_articulos.id_vigente= 1
          and (tc_mantic_articulos.nombre regexp '.*{codigoFaltante}.*' or upper(tc_mantic_articulos_codigos.codigo) regexp '.*{codigoFaltante}.*')				
				) as tt_mantic_compras
        where
          {condicion}
				group by
				  tt_mantic_compras.id_articulo
				{sortOrder}
			</select>			
			<select id="articulo">
				select 
				  tc_mantic_articulos.id_articulo as id_key,
				  tc_mantic_ventas.ticket,
					concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) as vendedor,
				  tc_mantic_articulos.id_vigente,
				  tc_mantic_articulos.nombre,
				  tc_mantic_articulos.precio,
				  tc_mantic_ventas_detalles.precio as precios,
				  tc_mantic_ventas_detalles.costo,
				  tc_mantic_ventas_detalles.iva,
				  tc_mantic_ventas_detalles.cantidad,
				  tc_mantic_ventas_detalles.importe,
				  tc_mantic_articulos.menudeo,
				  tc_mantic_articulos.medio_mayoreo,
				  tc_mantic_articulos.mayoreo,
					(select tc_mantic_articulos_codigos.codigo from tc_mantic_articulos_codigos where tc_mantic_articulos_codigos.id_articulo= tc_mantic_articulos.id_articulo and tc_mantic_articulos_codigos.id_principal= 1 limit 0, 1) as propio,
				  if(tc_mantic_articulos.id_facturama is null, -1, tc_mantic_articulos.id_facturama) id_facturama,
				  tc_mantic_ventas.registro
				from 
					tc_mantic_articulos
				inner join
					tc_mantic_articulos_codigos on tc_mantic_articulos.id_articulo = tc_mantic_articulos_codigos.id_articulo and tc_mantic_articulos_codigos.id_principal= 1
				inner join 
					tc_mantic_empresas on tc_mantic_articulos.id_empresa = tc_mantic_empresas.id_empresa
				inner join
					tr_mantic_empaque_unidad_medida on tc_mantic_articulos.id_empaque_unidad_medida = tr_mantic_empaque_unidad_medida.id_empaque_unidad_medida
				inner join 
					tc_mantic_empaques on tr_mantic_empaque_unidad_medida.id_empaque = tc_mantic_empaques.id_empaque
				inner join 
					tc_mantic_unidades_medidas on tr_mantic_empaque_unidad_medida.id_unidad_medida = tc_mantic_unidades_medidas.id_unidad_medida
				inner join
					tc_mantic_ventas_detalles on tc_mantic_articulos.id_articulo = tc_mantic_ventas_detalles.id_articulo
				inner join
					tc_mantic_ventas on tc_mantic_ventas_detalles.id_venta = tc_mantic_ventas.id_venta
				inner join 
					tc_janal_usuarios on tc_mantic_ventas.id_usuario= tc_janal_usuarios.id_usuario
				inner join				
					tc_mantic_personas on tc_mantic_personas.id_persona= tc_janal_usuarios.id_persona
				where 
					tc_mantic_ventas.id_empresa in ({idEmpresa})
					and tc_mantic_ventas.ticket is not null
					and tc_mantic_ventas.id_venta_estatus in (3, 4, 6, 15)
				  and {condicion}					
				group by 
					tc_mantic_articulos.id_vigente,
				  tc_mantic_articulos.nombre,          
				  tc_mantic_articulos.menudeo,          
				  tc_mantic_articulos.medio_mayoreo,          
				  tc_mantic_articulos.mayoreo,          
				  tc_mantic_articulos.iva,          
				  tc_mantic_articulos.desperdicio          
				{sortOrder}
			</select>
			<select id="disponible">
        select
          tc_mantic_cierres_cajas.id_cierre_caja as id_key,
          tc_mantic_tipos_medios_pagos.nombre as medio_pago,
          tc_mantic_cierres_cajas.disponible,
          tc_mantic_cierres_cajas.acumulado,
          tc_mantic_cierres_cajas.saldo,
          tc_mantic_cierres_cajas.saldo as total,
          tc_mantic_cierres_cajas.importe,
          tc_mantic_cierres_cajas.dia,
          tc_mantic_cierres_cajas.registro
        from 
          tc_mantic_cierres_cajas
        inner join
          tc_mantic_tipos_medios_pagos on tc_mantic_cierres_cajas.id_tipo_medio_pago= tc_mantic_tipos_medios_pagos.id_tipo_medio_pago
        inner join
          (select
             max(id_cierre) as id_cierre
           from
             tc_mantic_cierres_cajas
           where
             tc_mantic_cierres_cajas.id_caja= {idCaja}
            ) tc_mantic_maximo on tc_mantic_cierres_cajas.id_cierre= tc_mantic_maximo.id_cierre
        where
         tc_mantic_cierres_cajas.id_caja= {idCaja}
      </select>  
			<select id="conteos">
				select
					tc_mantic_inventarios.id_inventario as id_key,
				  tc_mantic_empresas.nombre as nombre_empresa,  
					tc_mantic_almacenes.id_almacen,
					tc_mantic_articulos.id_articulo,
					tc_mantic_articulos_codigos.codigo,
					tc_mantic_articulos.nombre,
					tc_mantic_almacenes.nombre as almacen,
					tc_mantic_inventarios.inicial,
					tc_mantic_inventarios.entradas,
					tc_mantic_inventarios.salidas,
					tc_mantic_inventarios.stock as conteo,
					tc_mantic_almacenes_articulos.stock,
					tc_mantic_inventarios.registro,
					tc_mantic_almacenes_articulos.minimo,
					tc_mantic_almacenes_articulos.maximo,
					if(tc_mantic_conteo_previo.fecha_previa= null, '-', date_format(tc_mantic_conteo_previo.fecha_previa, '%d/%m/%Y')) as fecha_previa,
					ifnull(tc_mantic_conteo_previo.conteo_previo, '0') as conteo_previo
				from
					tc_mantic_inventarios
				inner join     
				 (select
						max(tc_mantic_inventarios.id_inventario) as id_inventario
					from
						tc_mantic_inventarios         
					where
						id_automatico= 2
					group by
						id_almacen, id_articulo  
					) as tc_mantic_maximos  on tc_mantic_inventarios.id_inventario= tc_mantic_maximos.id_inventario
				inner join
					tc_mantic_articulos on tc_mantic_inventarios.id_articulo= tc_mantic_articulos.id_articulo
				inner join
					tc_mantic_articulos_codigos on tc_mantic_articulos.id_articulo= tc_mantic_articulos_codigos.id_articulo and tc_mantic_articulos_codigos.id_principal= 1
				inner join 
					tc_mantic_almacenes on tc_mantic_inventarios.id_almacen= tc_mantic_almacenes.id_almacen
				inner join 
					tc_mantic_almacenes_articulos on tc_mantic_inventarios.id_almacen= tc_mantic_almacenes_articulos.id_almacen and tc_mantic_inventarios.id_articulo= tc_mantic_almacenes_articulos.id_articulo
				left join 
				 (
					select
						tc_mantic_inventarios.id_inventario,
						tc_mantic_inventarios.id_almacen,
						tc_mantic_inventarios.id_articulo,
						tc_mantic_inventarios.registro as fecha_previa,
						tc_mantic_inventarios.stock as conteo_previo
					from
						tc_mantic_inventarios         
					where
						tc_mantic_inventarios.id_automatico= 2
				 ) as tc_mantic_conteo_previo on tc_mantic_inventarios.id_inventario!= tc_mantic_conteo_previo.id_inventario and tc_mantic_inventarios.id_almacen= tc_mantic_conteo_previo.id_almacen and tc_mantic_inventarios.id_articulo= tc_mantic_conteo_previo.id_articulo
				inner join 
					tc_mantic_empresas on tc_mantic_almacenes.id_empresa= tc_mantic_empresas.id_empresa
				where
				  tc_mantic_almacenes.id_empresa in ({idEmpresa})
				  and {condicion}
				{sortOrder}
			</select>
			<select id="proveedor">
				select
					tc_mantic_articulos.id_articulo as id_key,
					max(tc_mantic_notas_entradas.consecutivo) as consecutivo,
					tc_mantic_empresas.nombre as nombre_empresa,  
					tc_mantic_proveedores.razon_social,
					tc_mantic_articulos_codigos.codigo,
					tc_mantic_articulos.nombre,
          tc_mantic_articulos.precio as costo_compra,
          (tc_mantic_articulos.menudeo- (tc_mantic_articulos.precio* 1.16))* 100/ (tc_mantic_articulos.precio* 1.16) as pmenudeo,
          tc_mantic_articulos.menudeo,
          (tc_mantic_articulos.medio_mayoreo- (tc_mantic_articulos.precio* 1.16))* 100/ (tc_mantic_articulos.precio* 1.16) as pmedio_mayoreo,
          tc_mantic_articulos.medio_mayoreo,
          (tc_mantic_articulos.mayoreo- (tc_mantic_articulos.precio* 1.16))* 100/ (tc_mantic_articulos.precio* 1.16) as pmayoreo,
          tc_mantic_articulos.mayoreo,
					tc_mantic_notas_entradas.registro
				from 
					tc_mantic_articulos
				inner join
					tc_mantic_articulos_codigos on tc_mantic_articulos.id_articulo= tc_mantic_articulos_codigos.id_articulo and tc_mantic_articulos_codigos.id_principal= 1
				inner join 
					tc_mantic_empresas on tc_mantic_articulos.id_empresa= tc_mantic_empresas.id_empresa
				left join
					tc_mantic_notas_detalles on tc_mantic_articulos.id_articulo= tc_mantic_notas_detalles.id_articulo
				left join
					tc_mantic_notas_entradas on tc_mantic_notas_detalles.id_nota_entrada= tc_mantic_notas_entradas.id_nota_entrada
				left join
					tc_mantic_proveedores on tc_mantic_notas_entradas.id_proveedor= tc_mantic_proveedores.id_proveedor
				where
				  tc_mantic_articulos.id_empresa in ({idEmpresa})
					and tc_mantic_notas_entradas.id_nota_estatus in (3, 5)
				  and {condicion}
        group by 
          tc_mantic_articulos.id_articulo
				{sortOrder}
			</select>
			<select id="totalVendedores">
				select 
					tc_mantic_empresas.id_empresa as id_key,
					tc_mantic_empresas.nombre as nombre_empresa,  
					count(distinct(tc_mantic_ventas.id_usuario)) as vendedores,
				  sum(tc_mantic_ventas.total) as ventas,
				  sum(tc_mantic_ventas.utilidad) as utilidad
				from
					tc_mantic_ventas
				inner join 
					tc_mantic_empresas on tc_mantic_ventas.id_empresa= tc_mantic_empresas.id_empresa
				where
					tc_mantic_ventas.id_empresa in ({idEmpresa})
					and tc_mantic_ventas.id_tipo_documento= 2
					and tc_mantic_ventas.id_venta_estatus in (3, 6, 15)
					and date_format(tc_mantic_ventas.registro, '%Y%m%d')&gt;= '{fechaInicio}' 
					and date_format(tc_mantic_ventas.registro, '%Y%m%d')&lt;= '{fechaTermino}' 
				group by
					tc_mantic_empresas.id_empresa
				order by
					tc_mantic_empresas.nombre
			</select>
			<select id="ventasVendedor">
				select 
					tc_mantic_ventas.id_venta as id_key,
					tc_mantic_empresas.nombre as nombre_empresa,  
					concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) as vendedor,
					count(tc_mantic_ventas.id_venta) as ventas,
					sum(tc_mantic_ventas.total) as total,
					sum(tc_mantic_ventas.utilidad) as utilidad,
					count(tc_mantic_garantias.id_garantia) as devoluciones,
					sum(ifnull(tc_mantic_garantias.total, 0)) as garantias,
					(sum(tc_mantic_ventas.total)* 100)/ {pventas} as pventas,
					(sum(tc_mantic_ventas.utilidad)* 100)/ {putilidad} as putilidad,
				  '{inicio}' as inicio,
				  '{termino}' as termino
				from
					tc_mantic_ventas
				inner join 
					tc_janal_usuarios on tc_mantic_ventas.id_usuario= tc_janal_usuarios.id_usuario
				inner join				
					tc_mantic_personas on tc_mantic_personas.id_persona= tc_janal_usuarios.id_persona
				inner join 
					tc_mantic_empresas on tc_mantic_ventas.id_empresa= tc_mantic_empresas.id_empresa
				left join
					tc_mantic_garantias on tc_mantic_ventas.id_venta= tc_mantic_garantias.id_venta
				where
					tc_mantic_ventas.id_empresa in ({idEmpresa})
					and date_format(tc_mantic_ventas.registro, '%Y%m%d')&gt;= '{fechaInicio}' 
					and date_format(tc_mantic_ventas.registro, '%Y%m%d')&lt;= '{fechaTermino}' 
					and {condicion}
				group by
					tc_mantic_empresas.nombre,
					tc_mantic_ventas.id_usuario  
				{sortOrder}
			</select>
			<select id="general">
        select
					tc_mantic_ventas.id_venta as id_key,
					tc_mantic_ventas.id_venta,
					tc_mantic_ventas.id_empresa,  
				  tc_mantic_empresas.clave as empresa,  
				  tc_mantic_empresas.nombre as nombre_empresa,  
					tc_mantic_ventas.consecutivo,  
					tc_mantic_ventas.ticket,
          ifnull(tc_mantic_ventas.cotizacion, '') as cotizacion,  
					tc_mantic_clientes.id_cliente,  
					tc_mantic_ventas.id_manual,
					tc_mantic_clientes.razon_social as cliente,
					tc_mantic_clientes.limite_credito,
					tc_mantic_ventas.total,
					tc_mantic_ventas.sub_total,
					tc_mantic_ventas.impuestos,
					tc_mantic_ventas.total as precio_total,
				  tc_mantic_ventas_estatus.nombre as estatus,
					tc_mantic_ventas.id_venta_estatus,
				  tc_mantic_ventas.id_factura,
					tc_mantic_ventas.registro,
					tc_mantic_ventas.registro as hora,
					tc_mantic_ventas_estatus.estatus_asociados, 					
					tc_mantic_personas.cuenta,
					concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) as nombre,
					tc_mantic_clientes.id_credito,
					tc_mantic_clientes_deudas.saldo,
					tc_mantic_clientes_deudas.limite,
          ifnull(tc_mantic_garantias.consecutivo, '') as garantia,
          tc_mantic_garantias.total as devuelto,
          tc_mantic_garantias.registro as fecha
				from 
					tc_mantic_ventas
				inner join 
					tc_mantic_ventas_detalles on tc_mantic_ventas.id_venta= tc_mantic_ventas_detalles.id_venta
				left join 
					tr_mantic_articulo_proveedor on tc_mantic_ventas_detalles.id_articulo= tr_mantic_articulo_proveedor.id_articulo
				left join
					tc_mantic_proveedores on tr_mantic_articulo_proveedor.id_proveedor= tc_mantic_proveedores.id_proveedor											
				left join 
					tc_mantic_clientes on tc_mantic_ventas.id_cliente= tc_mantic_clientes.id_cliente
				inner join 
				  tc_mantic_clientes_deudas on tc_mantic_ventas.id_venta= tc_mantic_clientes_deudas.id_venta
				inner join 
					tc_mantic_empresas on tc_mantic_ventas.id_empresa= tc_mantic_empresas.id_empresa
				inner join 
					tc_mantic_ventas_estatus on tc_mantic_ventas.id_venta_estatus=tc_mantic_ventas_estatus.id_venta_estatus
	 	  	inner join
    			tc_mantic_tipos_documentos on tc_mantic_tipos_documentos.id_tipo_documento= tc_mantic_ventas_estatus.id_tipo_documento
				inner join 
				  tc_janal_usuarios on tc_mantic_ventas.id_usuario = tc_janal_usuarios.id_usuario
				inner join				
					tc_mantic_personas on tc_mantic_personas.id_persona = tc_janal_usuarios.id_persona				
				left join
				  tc_mantic_garantias on tc_mantic_ventas.id_venta= tc_mantic_garantias.id_venta
				where
					tc_mantic_ventas.id_empresa in ({idEmpresa})
				  and {condicion}
				group by 
					tc_mantic_ventas.id_venta
				{sortOrder}
			</select>
			<select id="lazy">
        select
					tc_mantic_ventas.id_venta as id_key,
					tc_mantic_ventas.id_venta,
					tc_mantic_ventas.id_empresa,  
				  tc_mantic_empresas.clave as empresa,  
				  tc_mantic_empresas.nombre as nombre_empresa,  
					tc_mantic_ventas.consecutivo,  
					tc_mantic_ventas.ticket,
          ifnull(tc_mantic_ventas.cotizacion, '') as cotizacion,  
					tc_mantic_clientes.id_cliente,  
					tc_mantic_ventas.id_manual,
					tc_mantic_clientes.razon_social as cliente,
					tc_mantic_clientes.limite_credito,
					tc_mantic_ventas.total,
					tc_mantic_ventas.sub_total,
					tc_mantic_ventas.impuestos,
					tc_mantic_ventas.total as precio_total,
				  tc_mantic_ventas_estatus.nombre as estatus,
					tc_mantic_ventas.id_venta_estatus,
				  tc_mantic_ventas.id_factura,
					tc_mantic_ventas.registro,
					tc_mantic_ventas.registro as hora,
					tc_mantic_ventas_estatus.estatus_asociados, 					
					tc_mantic_personas.cuenta,
					concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) as nombre,
					tc_mantic_clientes.id_credito,
					tc_mantic_clientes_deudas.saldo,
					tc_mantic_clientes_deudas.limite,
          ifnull(tc_mantic_garantias.consecutivo, '') as garantia,
          tc_mantic_garantias.total as devuelto,
          tc_mantic_garantias.registro as fecha
				from 
					tc_mantic_ventas
				inner join 
					tc_mantic_ventas_detalles on tc_mantic_ventas.id_venta= tc_mantic_ventas_detalles.id_venta
				inner join 
					tc_mantic_clientes on tc_mantic_ventas.id_cliente= tc_mantic_clientes.id_cliente
				left join 
				  tc_mantic_clientes_deudas on tc_mantic_ventas.id_venta= tc_mantic_clientes_deudas.id_venta
				inner join 
					tc_mantic_empresas on tc_mantic_ventas.id_empresa= tc_mantic_empresas.id_empresa
				inner join 
					tc_mantic_ventas_estatus on tc_mantic_ventas.id_venta_estatus=tc_mantic_ventas_estatus.id_venta_estatus
				inner join 
				  tc_janal_usuarios on tc_mantic_ventas.id_usuario = tc_janal_usuarios.id_usuario
				inner join				
					tc_mantic_personas on tc_mantic_personas.id_persona = tc_janal_usuarios.id_persona				
				left join
				  tc_mantic_garantias on tc_mantic_ventas.id_venta= tc_mantic_garantias.id_venta
				where
					tc_mantic_ventas.id_empresa in ({idEmpresa})
				  and {condicion}
				group by 
					tc_mantic_ventas.id_venta
				{sortOrder}
			</select>
			<select id="ventas">
        select
          convert(concat(tt_mantic_general.id_empresa, tt_mantic_general.id_caja, tt_mantic_general.id_tipo_medio_pago), signed) as id_key,
          tt_mantic_general.empresa,
          tt_mantic_general.nombre_empresa,
          tt_mantic_general.id_caja,
          tc_mantic_cajas.clave as caja,
          tt_mantic_general.tipo_medio_pago,
          sum(tt_mantic_general.total+ tt_mantic_general.deduccion) importe,
          count(*) total     
        from (
          select
            tc_mantic_ventas.id_venta,
            tc_mantic_empresas.id_empresa,
            tc_mantic_empresas.clave as empresa,
            tc_mantic_empresas.nombre as nombre_empresa,
            tc_mantic_cierres_cajas.id_caja,
            tr_mantic_venta_medio_pago.importe,
            tc_mantic_ventas.total,
            ifnull(tc_mantic_garantias.total* -1, 0) as deduccion,
            tc_mantic_tipos_medios_pagos.id_tipo_medio_pago,
            tc_mantic_tipos_medios_pagos.nombre as tipo_medio_pago,          
            tc_mantic_ventas.registro
          from
            tc_mantic_ventas    
          inner join (
            select
              tc_mantic_ventas.id_venta
           from
             tc_mantic_ventas   
           where
             tc_mantic_ventas.id_empresa in ({idEmpresa})
             and {condicion}           
          ) as tt_mantic_ventas on tc_mantic_ventas.id_venta= tt_mantic_ventas.id_venta 
          inner join
            tc_mantic_empresas on tc_mantic_ventas.id_empresa= tc_mantic_empresas.id_empresa          
          inner join
            tr_mantic_venta_medio_pago on tc_mantic_ventas.id_venta = tr_mantic_venta_medio_pago.id_venta          
          inner join
            tc_mantic_tipos_medios_pagos on tr_mantic_venta_medio_pago.id_tipo_medio_pago = tc_mantic_tipos_medios_pagos.id_tipo_medio_pago          
          inner join
            tc_mantic_cierres_cajas on tr_mantic_venta_medio_pago.id_cierre= tc_mantic_cierres_cajas.id_cierre          
          left join
            tc_mantic_garantias on tc_mantic_ventas.id_venta= tc_mantic_garantias.id_venta
          where
            tc_mantic_ventas.id_empresa in ({idEmpresa})
            and {apartado}           
          group by
            tc_mantic_ventas.id_venta,
            tc_mantic_empresas.id_empresa,
            tc_mantic_cierres_cajas.id_caja,
            tc_mantic_tipos_medios_pagos.id_tipo_medio_pago) as tt_mantic_general     
       inner join
         tc_mantic_cajas on tt_mantic_general.id_caja = tc_mantic_cajas.id_caja          
       group by
         tt_mantic_general.empresa,
         tt_mantic_general.id_caja,
         tt_mantic_general.tipo_medio_pago     
       order by
         tt_mantic_general.empresa,
         tt_mantic_general.importe desc
      </select>  
			<select id="credito">
				select				
				  convert(concat(recalculo.id_empresa, recalculo.id_caja, recalculo.id_tipo_medio_pago), signed) as id_key,			
					recalculo.*,
					if(id_tipo_medio_pago=1, (total - if(deduccion is null, 0, deduccion)), importe) total_deducciones
				from(
				select 
					deducciones.*,	
					(select if(importe is null, 0, importe) importe from tr_mantic_venta_medio_pago where id_venta=deducciones.id_venta and id_tipo_medio_pago != 1) deduccion
				from (
				select							
					tc_mantic_ventas.id_venta,
					tc_mantic_empresas.id_empresa,
					tc_mantic_empresas.clave as empresa,
					tc_mantic_empresas.nombre as nombre_empresa,
					tc_mantic_cajas.id_caja,            
					tc_mantic_cajas.clave caja,					
					tr_mantic_venta_medio_pago.importe,
					tr_mantic_venta_medio_pago.importe as total,	
				  tc_mantic_ventas.registro as fecha,
					tc_mantic_tipos_medios_pagos.id_tipo_medio_pago,
					tc_mantic_tipos_medios_pagos.nombre as tipo_medio_pago,
					tc_mantic_clientes.razon_social,
          ifnull(tc_mantic_garantias.consecutivo, '') as garantia,
          tc_mantic_garantias.total as devuelto,
          tc_mantic_garantias.registro as cuando        
				from
					tc_mantic_ventas    
				inner join (
          select
            tc_mantic_ventas.id_venta
          from
            tc_mantic_ventas
          where
            tc_mantic_ventas.id_empresa in ({idEmpresa})
            and {condicion}     
        ) tt_mantic_ventas on tc_mantic_ventas.id_venta= tt_mantic_ventas.id_venta
				inner join
					tc_mantic_almacenes on tc_mantic_ventas.id_almacen= tc_mantic_almacenes.id_almacen     
				inner join
					tc_mantic_empresas on tc_mantic_ventas.id_empresa= tc_mantic_empresas.id_empresa     
				inner join
					tc_mantic_ventas_estatus on tc_mantic_ventas.id_venta_estatus=tc_mantic_ventas_estatus.id_venta_estatus     
				inner join
					tc_mantic_tipos_documentos on tc_mantic_tipos_documentos.id_tipo_documento= tc_mantic_ventas_estatus.id_tipo_documento     	       
				inner join
					tr_mantic_venta_medio_pago on tc_mantic_ventas.id_venta = tr_mantic_venta_medio_pago.id_venta     
				inner join
					tc_mantic_tipos_medios_pagos on tr_mantic_venta_medio_pago.id_tipo_medio_pago = tc_mantic_tipos_medios_pagos.id_tipo_medio_pago     
        inner join
          tc_mantic_clientes on tc_mantic_ventas.id_cliente= tc_mantic_clientes.id_cliente
        inner join
          tc_mantic_cierres_cajas on tr_mantic_venta_medio_pago.id_cierre = tc_mantic_cierres_cajas.id_cierre and tc_mantic_ventas.id_venta= tr_mantic_venta_medio_pago.id_venta     
        inner join
          tc_mantic_cajas on tc_mantic_cierres_cajas.id_caja = tc_mantic_cajas.id_caja     
				left join
				  tc_mantic_garantias on tc_mantic_ventas.id_venta= tc_mantic_garantias.id_venta
				where
					tc_mantic_ventas.id_empresa in ({idEmpresa})
				  and {apartado}     
				group by				
					tc_mantic_ventas.id_venta,
					tc_mantic_empresas.id_empresa,
					tc_mantic_cajas.id_caja,					
					tr_mantic_venta_medio_pago.importe,
					tc_mantic_tipos_medios_pagos.id_tipo_medio_pago) as deducciones
				) as recalculo
			</select>				
			<select id="apartado">
				select				
				  convert(concat(recalculo.id_empresa, recalculo.id_caja, recalculo.id_tipo_medio_pago), signed) as id_key,			
					recalculo.*,
					if(id_tipo_medio_pago=1, (total - if(deduccion is null, 0, deduccion)), importe) total_deducciones
				from(
				select 
					deducciones.*,	
					(select if(importe is null, 0, importe) importe from tr_mantic_venta_medio_pago where id_venta=deducciones.id_venta and id_tipo_medio_pago != 1) deduccion
				from (
				select							
					tc_mantic_ventas.id_venta,
					tc_mantic_empresas.id_empresa,
					tc_mantic_empresas.clave as empresa,
					tc_mantic_empresas.nombre as nombre_empresa,
					tc_mantic_cajas.id_caja,            
					tc_mantic_cajas.clave caja,					
					tr_mantic_venta_medio_pago.importe,
					tc_mantic_ventas.total,	
				  tc_mantic_ventas.registro as fecha,
					tc_mantic_tipos_medios_pagos.id_tipo_medio_pago,
					tc_mantic_tipos_medios_pagos.nombre as tipo_medio_pago,
					tc_mantic_clientes.razon_social
				from
					tc_mantic_ventas    
				inner join (
          select
            tc_mantic_ventas.id_venta
          from
            tc_mantic_ventas
          where
            tc_mantic_ventas.id_empresa in ({idEmpresa})
            and {condicion}     
        ) tt_mantic_ventas on tc_mantic_ventas.id_venta= tt_mantic_ventas.id_venta
				inner join
					tc_mantic_almacenes on tc_mantic_ventas.id_almacen= tc_mantic_almacenes.id_almacen     
				inner join
					tc_mantic_empresas on tc_mantic_ventas.id_empresa= tc_mantic_empresas.id_empresa     
				inner join
					tc_mantic_ventas_estatus on tc_mantic_ventas.id_venta_estatus=tc_mantic_ventas_estatus.id_venta_estatus     
				inner join
					tc_mantic_tipos_documentos on tc_mantic_tipos_documentos.id_tipo_documento= tc_mantic_ventas_estatus.id_tipo_documento     	       
				inner join
					tr_mantic_venta_medio_pago on tc_mantic_ventas.id_venta = tr_mantic_venta_medio_pago.id_venta     
				inner join
					tc_mantic_tipos_medios_pagos on tr_mantic_venta_medio_pago.id_tipo_medio_pago = tc_mantic_tipos_medios_pagos.id_tipo_medio_pago     
        inner join
          tc_mantic_clientes on tc_mantic_ventas.id_cliente= tc_mantic_clientes.id_cliente
        inner join
          tc_mantic_cierres_cajas on tr_mantic_venta_medio_pago.id_cierre = tc_mantic_cierres_cajas.id_cierre and tc_mantic_ventas.id_venta= tr_mantic_venta_medio_pago.id_venta     
        inner join
          tc_mantic_cajas on tc_mantic_cierres_cajas.id_caja = tc_mantic_cajas.id_caja     
				where
					tc_mantic_ventas.id_empresa in ({idEmpresa})
				  and {apartado}     
				group by				
					tc_mantic_ventas.id_venta,
					tc_mantic_empresas.id_empresa,
					tc_mantic_empresas.clave,
					tc_mantic_empresas.nombre,
					tc_mantic_cajas.id_caja,					
					tc_mantic_cajas.clave,					
					tr_mantic_venta_medio_pago.importe,
					tc_mantic_ventas.total,
					tc_mantic_tipos_medios_pagos.id_tipo_medio_pago,
					tc_mantic_tipos_medios_pagos.nombre) as deducciones
				) as recalculo
			</select>				
			<select id="diariasTotales">
select
  sum(tt_mantic_general.total+ tt_mantic_general.deduccion) as total
from (
  select
    tc_mantic_empresas.id_empresa,
    tc_mantic_ventas.id_venta,
    tc_mantic_cierres_cajas.id_caja,
    tc_mantic_tipos_medios_pagos.id_tipo_medio_pago,
    tc_mantic_ventas.total,
    ifnull(tc_mantic_garantias.total* -1, 0) as deduccion
  from
    tc_mantic_ventas    
  inner join (
    select
      tc_mantic_ventas.id_venta
   from
     tc_mantic_ventas   
   where
     tc_mantic_ventas.id_empresa in ({idEmpresa})
     and {condicion}           
  ) as tt_mantic_ventas on tc_mantic_ventas.id_venta= tt_mantic_ventas.id_venta 
  inner join
    tc_mantic_empresas on tc_mantic_ventas.id_empresa= tc_mantic_empresas.id_empresa          
  inner join
    tr_mantic_venta_medio_pago on tc_mantic_ventas.id_venta = tr_mantic_venta_medio_pago.id_venta          
  inner join
    tc_mantic_tipos_medios_pagos on tr_mantic_venta_medio_pago.id_tipo_medio_pago = tc_mantic_tipos_medios_pagos.id_tipo_medio_pago          
  inner join
    tc_mantic_cierres_cajas on tr_mantic_venta_medio_pago.id_cierre= tc_mantic_cierres_cajas.id_cierre          
  left join
    tc_mantic_garantias on tc_mantic_ventas.id_venta= tc_mantic_garantias.id_venta
  where
    tc_mantic_ventas.id_empresa in ({idEmpresa})
    and {apartado}           
  group by
    tc_mantic_empresas.id_empresa,
    tt_mantic_ventas.id_venta,
    tc_mantic_cierres_cajas.id_caja,
    tc_mantic_tipos_medios_pagos.id_tipo_medio_pago
) as tt_mantic_general     
			</select>
			<select id="horas">
				select
					if((convert(concat(hora, empresa), signed integer)) is null, tc_janal_horas.id_hora, (convert(concat(hora, empresa), signed integer))) as id_key,
					empresa,
					nombre_empresa,
					(select count(*) from tc_mantic_ventas where tc_mantic_ventas.id_venta_estatus in ({idVentaEstatus}) and (date_format(tc_mantic_ventas.registro, '%Y%m%d')= principal.fecha) and (date_format(tc_mantic_ventas.registro,'%H')= principal.hora) and tc_mantic_ventas.id_empresa= principal.id_empresa) as total_ventas,
					caja,
					(select if(sum(total) is null, 0,  sum(total)) from tc_mantic_ventas where tc_mantic_ventas.id_venta_estatus in ({idVentaEstatus}) and (date_format(tc_mantic_ventas.registro, '%Y%m%d')= principal.fecha) and (date_format(tc_mantic_ventas.registro,'%H')= principal.hora) and tc_mantic_ventas.id_empresa= principal.id_empresa) as total,
					if(str_to_date(fecha,'%Y%m%d') is null , str_to_date('{fechaInicio}','%Y%m%d'), str_to_date(fecha,'%Y%m%d')) as fecha,
					tc_janal_horas.descripcion                 
				from        
					(select
						tc_mantic_empresas.clave as empresa,
						tc_mantic_empresas.nombre as nombre_empresa,
						tc_mantic_cajas.clave caja,
						tc_mantic_ventas.id_empresa,
						cast(date_format(tc_mantic_ventas.registro,'%Y%m%d') as char) as fecha,
						cast(date_format(tc_mantic_ventas.registro,'%H') as char) as hora                 
					from
						tc_mantic_ventas        
          inner join (
            select
              tc_mantic_ventas.id_venta
            from
              tc_mantic_ventas
            where
              tc_mantic_ventas.id_empresa in ({idEmpresa})
              and tc_mantic_ventas.id_venta_estatus in ({idVentaEstatus})       
              and (date_format(tc_mantic_ventas.registro, '%Y%m%d')&gt;= '{fechaInicio}')       
              and (date_format(tc_mantic_ventas.registro, '%Y%m%d')&lt;= '{fechaFin}')            
          ) tt_mantic_ventas on tc_mantic_ventas.id_venta= tt_mantic_ventas.id_venta
					inner join
						tc_mantic_almacenes on tc_mantic_ventas.id_almacen= tc_mantic_almacenes.id_almacen           
					inner join
						tc_mantic_empresas on tc_mantic_ventas.id_empresa= tc_mantic_empresas.id_empresa           
					inner join
						tc_mantic_ventas_estatus on tc_mantic_ventas.id_venta_estatus=tc_mantic_ventas_estatus.id_venta_estatus           
					inner join
						tc_mantic_tipos_documentos on tc_mantic_tipos_documentos.id_tipo_documento= tc_mantic_ventas_estatus.id_tipo_documento                           
					inner join
						tr_mantic_venta_medio_pago on tc_mantic_ventas.id_venta = tr_mantic_venta_medio_pago.id_venta           
					inner join
						tc_mantic_tipos_medios_pagos on tr_mantic_venta_medio_pago.id_tipo_medio_pago = tc_mantic_tipos_medios_pagos.id_tipo_medio_pago           
				  inner join
					  tc_mantic_cierres_cajas on tr_mantic_venta_medio_pago.id_cierre = tc_mantic_cierres_cajas.id_cierre and tc_mantic_ventas.id_venta= tr_mantic_venta_medio_pago.id_venta     
  				inner join
					  tc_mantic_cajas on tc_mantic_cierres_cajas.id_caja = tc_mantic_cajas.id_caja     
					where
						tc_mantic_ventas.id_empresa in ({idEmpresa})             
            and tc_mantic_tipos_documentos.id_tipo_documento= {idTipoDocumento}       
					  and	{apartado}
					group by
						tc_mantic_ventas.id_empresa,
						tc_mantic_empresas.clave,
						tc_mantic_empresas.nombre,
						tc_mantic_ventas.id_empresa,
						tc_mantic_cajas.clave,
						date_format(tc_mantic_ventas.registro,'%Y%m%d'),
						date_format(tc_mantic_ventas.registro,'%h')
					) as principal
				right join 
					tc_janal_horas on principal.hora = tc_janal_horas.descripcion
				where
					tc_janal_horas.id_hora&gt; 6 and tc_janal_horas.id_hora&lt; 22
				order by
					tc_janal_horas.descripcion
			</select>
			<select id="horasTotales">
				select if(sum(total) is null, 0, sum(total)) total from (
				select
            convert(concat(cast(hora as char), cast(empresa as char)),signed integer) as id_key,            
					empresa,
					nombre_empresa,
            (select count(*) from 
				      tc_mantic_ventas where tc_mantic_ventas.id_venta_estatus in ({idVentaEstatus}) 
              and (date_format(tc_mantic_ventas.registro, '%Y%m%d')= principal.fecha)                             
							and date_format(tc_mantic_ventas.registro,'%h')= principal.hora and tc_mantic_ventas.id_empresa= principal.id_empresa) total_ventas,
					caja,
            (select 
				       sum(total) 
				     from 
				       tc_mantic_ventas 
				     where 
				      tc_mantic_ventas.id_venta_estatus in ({idVentaEstatus}) 
              and (date_format(tc_mantic_ventas.registro, '%Y%m%d')= principal.fecha)
							and date_format(tc_mantic_ventas.registro,'%h')= principal.hora and tc_mantic_ventas.id_empresa= principal.id_empresa) as total,            
              str_to_date(fecha,'%Y%m%d') as fecha,
              hora        
				from        
					(select
						tc_mantic_empresas.clave as empresa,
						tc_mantic_empresas.nombre as nombre_empresa,                						
						tc_mantic_cajas.clave caja,
						tc_mantic_ventas.id_empresa,
						date_format(tc_mantic_ventas.registro, '%Y%m%d') fecha,
						date_format(tc_mantic_ventas.registro, '%h') hora           
					from
						tc_mantic_ventas   
          inner join (
            select
              tc_mantic_ventas.id_venta
            from
              tc_mantic_ventas
            where
              tc_mantic_ventas.id_empresa in ({idEmpresa})
              and tc_mantic_ventas.id_venta_estatus in ({idVentaEstatus})       
              and (date_format(tc_mantic_ventas.registro, '%Y%m%d')&gt;= '{fechaInicio}')       
              and (date_format(tc_mantic_ventas.registro, '%Y%m%d')&lt;= '{fechaFin}')            
          ) tt_mantic_ventas on tc_mantic_ventas.id_venta= tt_mantic_ventas.id_venta
					inner join
						tc_mantic_almacenes on tc_mantic_ventas.id_almacen= tc_mantic_almacenes.id_almacen           
					inner join
						tc_mantic_empresas on tc_mantic_ventas.id_empresa= tc_mantic_empresas.id_empresa           
					inner join
						tc_mantic_ventas_estatus on tc_mantic_ventas.id_venta_estatus=tc_mantic_ventas_estatus.id_venta_estatus           
					inner join
						tc_mantic_tipos_documentos on tc_mantic_tipos_documentos.id_tipo_documento= tc_mantic_ventas_estatus.id_tipo_documento                           
					inner join
						tr_mantic_venta_medio_pago on tc_mantic_ventas.id_venta = tr_mantic_venta_medio_pago.id_venta           
					inner join
						tc_mantic_tipos_medios_pagos on tr_mantic_venta_medio_pago.id_tipo_medio_pago = tc_mantic_tipos_medios_pagos.id_tipo_medio_pago           
				  inner join
					  tc_mantic_cierres_cajas on tr_mantic_venta_medio_pago.id_cierre = tc_mantic_cierres_cajas.id_cierre and tc_mantic_ventas.id_venta= tr_mantic_venta_medio_pago.id_venta     
  				inner join
					  tc_mantic_cajas on tc_mantic_cierres_cajas.id_caja = tc_mantic_cajas.id_caja     
					where
						tc_mantic_ventas.id_empresa in ({idEmpresa})             
            and tc_mantic_tipos_documentos.id_tipo_documento= {idTipoDocumento}       
					  and {apartado}
					group by
						tc_mantic_ventas.id_empresa,
						tc_mantic_empresas.clave,
						tc_mantic_empresas.nombre,
						tc_mantic_ventas.id_empresa,
						tc_mantic_cajas.clave,
						date_format(tc_mantic_ventas.registro, '%Y%m%d'),
						date_format(tc_mantic_ventas.registro, '%h')) principal
				order by
					hora) totales
			</select>
			<select id="vendedor">
				select
					tc_mantic_ventas.id_usuario as id_key,					
					concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) as nombre					
				from
					tc_mantic_ventas
				inner join 
					tc_mantic_ventas_estatus on tc_mantic_ventas.id_venta_estatus=tc_mantic_ventas_estatus.id_venta_estatus
				inner join
					tc_mantic_tipos_documentos on tc_mantic_tipos_documentos.id_tipo_documento= tc_mantic_ventas_estatus.id_tipo_documento
				inner join
					tc_mantic_empresas on tc_mantic_ventas.id_empresa= tc_mantic_empresas.id_empresa
				inner join 
					tc_janal_usuarios on tc_mantic_ventas.id_usuario = tc_janal_usuarios.id_usuario
				inner join				
					tc_mantic_personas on tc_mantic_personas.id_persona = tc_janal_usuarios.id_persona
				where
					tc_mantic_empresas.id_empresa in ({condicionVendedor})
				  and tc_mantic_ventas.id_usuario> 1
				group by 
					tc_mantic_ventas.id_usuario,					
					concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno)
			</select>
			<select id="detalle">
				select
					tc_mantic_ventas_detalles.id_venta_detalle as id_key,
          tc_mantic_ventas_detalles.*,
          tc_mantic_ventas_detalles.cantidad as cuantos,
          tc_mantic_ventas_detalles.cantidad as inicial,
					(select tc_mantic_articulos_codigos.codigo from tc_mantic_articulos_codigos where tc_mantic_articulos_codigos.id_articulo= tc_mantic_articulos.id_articulo and tc_mantic_articulos_codigos.id_principal= 1 limit 0, 1) as propio,
					tc_mantic_articulos.stock
				from 
					tc_mantic_ventas_detalles 
				inner join
					tc_mantic_articulos on tc_mantic_ventas_detalles.id_articulo = tc_mantic_articulos.id_articulo				
				where  
					id_venta = {idVenta}				
			</select>
		</unit>
		<unit id="VistaHistorialIvaDto">
			<select id="importe">
				select 
					tc_mantic_historial_iva.id_historial_iva as id_key,
					tc_mantic_historial_iva.*,
					concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) as usuario
				from 
					tc_mantic_historial_iva
				inner join 
					tc_janal_usuarios on tc_mantic_historial_iva.id_usuario = tc_janal_usuarios.id_usuario
				inner join				
					tc_mantic_personas on tc_mantic_personas.id_persona = tc_janal_usuarios.id_persona		
				where 
					importe like '%{importe}%'
				{sortOrder}
			</select>			
		</unit>	
		<unit id="VistaCierresCajasDto">
      <select id="consultar">
        select      
          tc_mantic_cajas.id_caja as id_key,
				  tc_mantic_empresas.clave as empresa,  
				  tc_mantic_empresas.nombre as nombre_empresa,  
          tc_mantic_cajas.*,
          if(tc_mantic_cajas.id_activa= 1, 'SI', 'NO') as activa
        from      
          tc_mantic_cajas
				inner join 
				  tc_mantic_empresas on tc_mantic_cajas.id_empresa= tc_mantic_empresas.id_empresa
        where      
          tc_mantic_cajas.id_empresa in ({idEmpresa}) 
				  and {condicion}
        {sortOrder}
      </select>
			<select id="creditos">
				select
					tc_mantic_ventas.id_venta as id_key,
					tc_mantic_clientes.id_cliente,  
					tc_mantic_clientes.razon_social as cliente,
					tc_mantic_ventas.ticket,
					tc_mantic_ventas.total,
					tc_mantic_ventas.id_venta_estatus,
					tc_mantic_ventas.registro,
					tc_mantic_personas.cuenta,
					concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) as vendedor
				from 
					tc_mantic_ventas
				inner join 
					tc_mantic_clientes on tc_mantic_ventas.id_cliente= tc_mantic_clientes.id_cliente
				inner join 
					tc_mantic_empresas on tc_mantic_ventas.id_empresa= tc_mantic_empresas.id_empresa
				inner join 
					tc_mantic_ventas_estatus on tc_mantic_ventas.id_venta_estatus=tc_mantic_ventas_estatus.id_venta_estatus
				inner join 
					tc_janal_usuarios on tc_mantic_ventas.id_usuario = tc_janal_usuarios.id_usuario
				inner join				
					tc_mantic_personas on tc_mantic_personas.id_persona = tc_janal_usuarios.id_persona		
				inner join 
					tr_mantic_venta_medio_pago on tc_mantic_ventas.id_venta = tr_mantic_venta_medio_pago.id_venta
				where
					tc_mantic_ventas.id_empresa in ({idEmpresa})
					and tr_mantic_venta_medio_pago.id_cierre= {idCierre}
					and tc_mantic_ventas.id_venta_estatus= 4
					and date_format(tc_mantic_ventas.registro, '%Y%m%d%H%i%S')&gt;= '{vigenciaInicio}'
					and date_format(tc_mantic_ventas.registro, '%Y%m%d%H%i%S')&lt;= '{vigenciaFin}'
				group by
					tc_mantic_ventas.id_venta,
					tc_mantic_clientes.id_cliente,  
					tc_mantic_clientes.razon_social,
					tc_mantic_ventas.ticket,
					tc_mantic_ventas.total,
					tc_mantic_ventas.id_venta_estatus,
					tc_mantic_ventas.registro,
					tc_mantic_personas.cuenta,			
					concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno)
				order by
					tc_mantic_ventas.registro
			</select>
      <select id="unica">
        select      
          tc_mantic_cajas.id_caja as id_key,
          tc_mantic_cajas.*
        from 
          tc_mantic_cajas
        where 
          tc_mantic_cajas.id_empresa= {idEmpresa}
          and tc_mantic_cajas.id_caja not in (
        select      
          distinct(tc_mantic_cierres_cajas.id_caja) as id_caja
        from      
          tc_mantic_cierres 
        inner join
          tc_mantic_cierres_cajas on tc_mantic_cierres.id_cierre= tc_mantic_cierres_cajas.id_cierre
        inner join 
          tc_mantic_cajas on tc_mantic_cierres_cajas.id_caja= tc_mantic_cajas.id_caja
        where
          tc_mantic_cajas.id_empresa= {idEmpresa}
			  )
			</select>
			<select id="abiertas">
        select
					tc_mantic_ventas.id_venta as id_key,
					tc_mantic_ventas.id_empresa,  
				  tc_mantic_empresas.clave as empresa,  
				  tc_mantic_empresas.nombre as nombre_empresa,  
					tc_mantic_ventas.dia,  
					tc_mantic_ventas.consecutivo,  
					tc_mantic_ventas.total,
				  tc_mantic_ventas_estatus.nombre as estatus,
					tc_mantic_ventas.id_venta_estatus,
					tc_mantic_ventas.registro,
					tc_mantic_personas.cuenta,
					concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) as nombre
				from 
					tc_mantic_ventas
				inner join 
					tc_mantic_empresas on tc_mantic_ventas.id_empresa= tc_mantic_empresas.id_empresa
				inner join 
					tc_mantic_ventas_estatus on tc_mantic_ventas.id_venta_estatus=tc_mantic_ventas_estatus.id_venta_estatus
				inner join 
				  tc_janal_usuarios on tc_mantic_ventas.id_usuario = tc_janal_usuarios.id_usuario
				inner join				
					tc_mantic_personas on tc_mantic_personas.id_persona = tc_janal_usuarios.id_persona
				where
				  tc_mantic_ventas.id_empresa= {idEmpresa}
				  and tc_mantic_ventas.id_venta_estatus in (1, 2)
        order by
          tc_mantic_ventas.consecutivo
			</select>
			<select id="global">
				select
					tc_mantic_cierres.id_cierre as id_key,
					tc_mantic_empresas.id_empresa,
					tc_mantic_empresas.clave as empresa,
				  tc_mantic_empresas.nombre as nombre_empresa,  
					tc_mantic_cajas.clave as caja,
					tc_mantic_cajas.id_caja,
					tc_mantic_cajas.limite,
				  tc_mantic_cierres_alertas.mensaje,
					tc_mantic_cierres_cajas.id_tipo_medio_pago,
					tc_mantic_cierres_cajas.id_cierre_caja,
				  tc_mantic_cierres_cajas.disponible,
				  tc_mantic_cierres_cajas.acumulado,
				  tc_mantic_cierres_cajas.saldo,
				  tc_mantic_cierres_cajas.dia,
				  tc_mantic_cierres_cajas.importe,
				  tc_mantic_cierres_alertas.importe as efectivo,
				  tc_mantic_cierres_alertas.registro
				from
					tc_mantic_cierres
				inner join
					tc_mantic_cierres_cajas on tc_mantic_cierres.id_cierre= tc_mantic_cierres_cajas.id_cierre
				inner join 
					tc_mantic_cierres_alertas on tc_mantic_cierres.id_cierre= tc_mantic_cierres_alertas.id_cierre
				inner join
					tc_mantic_cajas on tc_mantic_cierres_cajas.id_caja= tc_mantic_cajas.id_caja
				inner join
					tc_mantic_empresas on tc_mantic_cajas.id_empresa= tc_mantic_empresas.id_empresa
				where
				  tc_mantic_empresas.id_empresa in ({sucursales})
				  and tc_mantic_cierres_alertas.id_notifica= 1
				  and tc_mantic_cierres_cajas.id_tipo_medio_pago= 1
				order by
				  tc_mantic_cierres_cajas.registro				
			</select>			
			<select id="depurar">
        select
					tc_mantic_cierres.*
				from
				  tc_mantic_cierres
				inner join
					tc_mantic_cierres_cajas on tc_mantic_cierres.id_cierre= tc_mantic_cierres_cajas.id_cierre
				where 
				  tc_mantic_cierres_cajas.id_caja={idCaja}				
			</select>	
			<select id="abonos">
				select
					count(tc_mantic_cierres_cajas.id_caja) as total
				from
				  tc_mantic_cierres_cajas
				inner join  
					tc_mantic_cierres_retiros on tc_mantic_cierres_cajas.id_cierre_caja= tc_mantic_cierres_retiros.id_cierre_caja
				where 
				  tc_mantic_cierres_cajas.id_caja= {idCaja}
			</select>	
			<select id="movimientos">
        select
					tc_mantic_cierres_bitacora.id_cierre_bitacora as id_key,
					tc_mantic_cajas.clave as consecutivo,
					sum(tc_mantic_cierres_cajas.acumulado) as importe,
					tc_mantic_cierres_bitacora.justificacion,
					concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) as nombre,
				  tc_mantic_cierres_estatus.nombre as estatus,
					tc_mantic_cierres_bitacora.registro
				from 
					tc_mantic_cierres_bitacora
				inner join
					tc_mantic_cierres_estatus on tc_mantic_cierres_bitacora.id_cierre_estatus= tc_mantic_cierres_estatus.id_cierre_estatus
				inner join
					tc_janal_usuarios on tc_mantic_cierres_bitacora.id_usuario= tc_janal_usuarios.id_usuario
				inner join
					tc_mantic_personas on tc_janal_usuarios.id_persona= tc_mantic_personas.id_persona
				inner join
					tc_mantic_cierres_cajas on tc_mantic_cierres_bitacora.id_cierre= tc_mantic_cierres_cajas.id_cierre
				inner join
					tc_mantic_cajas on tc_mantic_cierres_cajas.id_caja= tc_mantic_cajas.id_caja
				where
					tc_mantic_cierres_bitacora.id_cierre= {idCierre}				
				order by
					tc_mantic_cierres_bitacora.registro desc
			</select>
			<select id="lazy">
				select
				  tc_mantic_cierres_cajas.id_cierre_caja as id_key,
					tc_mantic_cierres.id_cierre,
					tc_mantic_empresas.id_empresa,
					tc_mantic_empresas.clave as empresa,
				  tc_mantic_empresas.nombre as nombre_empresa,
					tc_mantic_cajas.clave as caja,
					tc_mantic_cajas.limite,
					if(tc_mantic_cierres.id_diferencias= 1, 'SI', 'NO') as diferencias,
					concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) as usuario,
					tc_mantic_cierres_estatus.nombre as estatus,
					sum(tc_mantic_cierres_cajas.disponible) as disponible,
					sum(tc_mantic_cierres_cajas.acumulado) as acumulado,
					sum(tc_mantic_cierres_cajas.saldo) as saldo,
					sum(tc_mantic_cierres_cajas.saldo) as efectivo,
					sum(tc_mantic_cierres_cajas.importe) as capturado,
					tc_mantic_cierres.observaciones,
					tc_mantic_cierres.registro,
					tc_mantic_cierres.id_cierre_estatus,
					tc_mantic_cajas.id_caja,tc_mantic_cierres.orden,
          tc_mantic_cierres.registro as inicio,
          tc_mantic_cierres.termino     
				from
					tc_mantic_cierres
				inner join
					tc_janal_usuarios on tc_mantic_cierres.id_usuario= tc_janal_usuarios.id_usuario
				inner join
					tc_mantic_personas on tc_janal_usuarios.id_persona= tc_mantic_personas.id_persona
				inner join
					tc_mantic_cierres_cajas on tc_mantic_cierres.id_cierre= tc_mantic_cierres_cajas.id_cierre
				inner join
					tc_mantic_cajas on tc_mantic_cierres_cajas.id_caja= tc_mantic_cajas.id_caja
				inner join
					tc_mantic_empresas on tc_mantic_cajas.id_empresa= tc_mantic_empresas.id_empresa
				inner join
					tc_mantic_cierres_estatus on tc_mantic_cierres.id_cierre_estatus= tc_mantic_cierres_estatus.id_cierre_estatus
				where
					tc_mantic_cajas.id_empresa in ({idEmpresa})
					and {condicion}
				group by
					tc_mantic_cierres.id_cierre,
					tc_mantic_empresas.id_empresa,
					tc_mantic_empresas.clave,
					tc_mantic_cajas.clave,
					if(tc_mantic_cierres.id_diferencias= 1, 'SI', 'NO'),
					concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno),
					tc_mantic_cierres_estatus.nombre,
					tc_mantic_cierres.observaciones,
					tc_mantic_cierres.registro,
					tc_mantic_cierres.id_cierre_estatus,
					tc_mantic_cajas.id_caja
				{sortOrder}
			</select>
			<select id="retiros">
				select
					tc_mantic_cierres_retiros.id_cierre_retiro as id_key,
					tc_mantic_cierres.id_cierre,
					tc_mantic_cierres.id_cierre_estatus,
					tc_mantic_empresas.id_empresa,
					tc_mantic_empresas.clave as empresa,
					tc_mantic_cajas.clave as caja,
					tc_mantic_cierres_retiros.consecutivo,
					tc_mantic_cierres_retiros.id_abono,
				  if(tc_mantic_cierres_retiros.id_abono= 1, 'ABONO', 'RETIRO') as tipo,
					concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) as usuario,
				  (select concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) from tc_mantic_personas where tc_mantic_personas.id_persona= tc_mantic_cierres_retiros.id_autorizo) as autorizo,
					tc_mantic_tipos_medios_pagos.nombre as medio,
				  tc_mantic_cierres_retiros.concepto,
					tc_mantic_cierres_retiros.importe,
					tc_mantic_cierres_retiros.observaciones,
					tc_mantic_cierres_retiros.registro,
					tc_mantic_cajas.id_caja,
					tc_mantic_tipos_medios_pagos.id_tipo_medio_pago,
					tc_mantic_tipos_medios_pagos.nombre as moneda,
					tc_mantic_cierres_cajas.id_cierre_caja,
				  tc_mantic_cierres_retiros.id_terminado,
				  tc_mantic_cierres_retiros.id_cierre_retiro
				from
					tc_mantic_cierres
				inner join
					tc_mantic_cierres_cajas on tc_mantic_cierres.id_cierre= tc_mantic_cierres_cajas.id_cierre
				inner join
					tc_mantic_cajas on tc_mantic_cierres_cajas.id_caja= tc_mantic_cajas.id_caja
				inner join
					tc_mantic_empresas on tc_mantic_cajas.id_empresa= tc_mantic_empresas.id_empresa
				inner join
					tc_mantic_cierres_retiros on tc_mantic_cierres_cajas.id_cierre_caja= tc_mantic_cierres_retiros.id_cierre_caja
				inner join
					tc_mantic_tipos_medios_pagos on tc_mantic_cierres_retiros.id_tipo_medio_pago= tc_mantic_tipos_medios_pagos.id_tipo_medio_pago
				inner join
					tc_janal_usuarios on tc_mantic_cierres_retiros.id_usuario= tc_janal_usuarios.id_usuario
				inner join
					tc_mantic_personas on tc_janal_usuarios.id_persona= tc_mantic_personas.id_persona
				where
				  tc_mantic_cierres.id_cierre= {idCierre}
				group by
					tc_mantic_cierres.id_cierre,
					tc_mantic_cierres.id_cierre_estatus,
					tc_mantic_empresas.id_empresa,
					tc_mantic_empresas.clave,
					tc_mantic_cajas.clave,
					tc_mantic_cierres_retiros.consecutivo,
					concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno),
					tc_mantic_tipos_medios_pagos.nombre,
					tc_mantic_cierres_retiros.importe,
					tc_mantic_cierres_retiros.observaciones,
					tc_mantic_cierres_retiros.registro,
					tc_mantic_cajas.id_caja,
					tc_mantic_tipos_medios_pagos.id_tipo_medio_pago,
					tc_mantic_tipos_medios_pagos.nombre,
					tc_mantic_cierres_cajas.id_cierre_caja
				{sortOrder}
			</select>
			<select id="consulta">
				select
					tc_mantic_cierres_retiros.id_cierre_retiro as id_key,
					tc_mantic_cierres.id_cierre,
					tc_mantic_cierres.id_cierre_estatus,
					tc_mantic_empresas.id_empresa,
					tc_mantic_empresas.clave as empresa,
					tc_mantic_cajas.clave as caja,
					tc_mantic_cierres_retiros.consecutivo,
					tc_mantic_cierres_retiros.id_abono,
				  if(tc_mantic_cierres_retiros.id_abono= 1, 'ABONO', 'RETIRO') as tipo,
					concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) as usuario,
				  (select concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) from tc_mantic_personas where tc_mantic_personas.id_persona= tc_mantic_cierres_retiros.id_autorizo) as autorizo,
					tc_mantic_tipos_medios_pagos.nombre as medio,
				  tc_mantic_cierres_retiros.concepto,
					tc_mantic_cierres_retiros.importe,
					tc_mantic_cierres_retiros.observaciones,
					tc_mantic_cierres_retiros.registro,
					tc_mantic_cajas.id_caja,
					tc_mantic_tipos_medios_pagos.id_tipo_medio_pago,
					tc_mantic_tipos_medios_pagos.nombre as moneda,
					tc_mantic_cierres_cajas.id_cierre_caja,
				  tc_mantic_cierres_retiros.id_terminado,
				  tc_mantic_cierres_retiros.id_cierre_retiro
				from
					tc_mantic_cierres
				inner join
					tc_mantic_cierres_cajas on tc_mantic_cierres.id_cierre= tc_mantic_cierres_cajas.id_cierre
				inner join
					tc_mantic_cajas on tc_mantic_cierres_cajas.id_caja= tc_mantic_cajas.id_caja
				inner join
					tc_mantic_empresas on tc_mantic_cajas.id_empresa= tc_mantic_empresas.id_empresa
				inner join
					tc_mantic_cierres_retiros on tc_mantic_cierres_cajas.id_cierre_caja= tc_mantic_cierres_retiros.id_cierre_caja
				inner join
					tc_mantic_tipos_medios_pagos on tc_mantic_cierres_retiros.id_tipo_medio_pago= tc_mantic_tipos_medios_pagos.id_tipo_medio_pago
				inner join
					tc_janal_usuarios on tc_mantic_cierres_retiros.id_usuario= tc_janal_usuarios.id_usuario
				inner join
					tc_mantic_personas on tc_janal_usuarios.id_persona= tc_mantic_personas.id_persona
				where
					tc_mantic_cajas.id_empresa in ({idEmpresa})
					and {condicion}
				group by
					tc_mantic_cierres.id_cierre,
					tc_mantic_cierres.id_cierre_estatus,
					tc_mantic_empresas.id_empresa,
					tc_mantic_empresas.clave,
					tc_mantic_cajas.clave,
					tc_mantic_cierres_retiros.consecutivo,
					concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno),
					tc_mantic_tipos_medios_pagos.nombre,
					tc_mantic_cierres_retiros.importe,
					tc_mantic_cierres_retiros.observaciones,
					tc_mantic_cierres_retiros.registro,
					tc_mantic_cajas.id_caja,
					tc_mantic_tipos_medios_pagos.id_tipo_medio_pago,
					tc_mantic_tipos_medios_pagos.nombre,
					tc_mantic_cierres_cajas.id_cierre_caja
				{sortOrder}
			</select>
			<select id="usuarios">
				select
					tc_mantic_cierres_retiros.id_usuario as id_key,
					concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) as nombre
				from
					tc_mantic_cierres
				inner join
					tc_mantic_cierres_cajas on tc_mantic_cierres.id_cierre= tc_mantic_cierres_cajas.id_cierre
				inner join
					tc_mantic_cierres_retiros on tc_mantic_cierres_cajas.id_cierre_caja= tc_mantic_cierres_retiros.id_cierre_caja
				inner join
					tc_mantic_cajas on tc_mantic_cierres_cajas.id_caja= tc_mantic_cajas.id_caja
				inner join
					tc_janal_usuarios on tc_mantic_cierres_retiros.id_usuario= tc_janal_usuarios.id_usuario
				inner join
					tc_mantic_personas on tc_janal_usuarios.id_persona= tc_mantic_personas.id_persona
				where
					tc_mantic_cajas.id_empresa in ({idEmpresa})
					and tc_mantic_cajas.id_caja= {idCaja}
				group by
					tc_mantic_cierres_retiros.id_usuario,
					concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) 
				order by
				  concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) 
			</select>
			<select id="caja">
				select
					tc_mantic_cierres.id_cierre as id_key,
					tc_mantic_cierres.id_cierre_estatus,
					tc_mantic_empresas.id_empresa,
					tc_mantic_empresas.clave as empresa,
					tc_mantic_cajas.clave as caja,
					tc_mantic_cajas.id_caja,
					tc_mantic_cierres_cajas.id_tipo_medio_pago,
					tc_mantic_cierres_cajas.id_cierre_caja,
				  tc_mantic_cierres_cajas.disponible,
				  tc_mantic_cierres_cajas.acumulado,
				  tc_mantic_cierres_cajas.saldo,
				  tc_mantic_cierres_cajas.dia,
				  tc_mantic_cierres_cajas.importe
				from
					tc_mantic_cierres
				inner join
					tc_mantic_cierres_cajas on tc_mantic_cierres.id_cierre= tc_mantic_cierres_cajas.id_cierre
				inner join
					tc_mantic_cajas on tc_mantic_cierres_cajas.id_caja= tc_mantic_cajas.id_caja
				inner join
					tc_mantic_empresas on tc_mantic_cajas.id_empresa= tc_mantic_empresas.id_empresa
				where
				  tc_mantic_cierres.id_cierre= {idCierre}
				  and tc_mantic_cierres_cajas.id_tipo_medio_pago= 1
				  and tc_mantic_cierres.id_cierre_estatus in (1, 2)
				order by
				  tc_mantic_cierres.registro desc
			</select>
			<select id="cierre">
				select
					tc_mantic_cierres.id_cierre as id_key,
					tc_mantic_empresas.id_empresa,
					tc_mantic_empresas.clave as empresa,
					tc_mantic_cajas.clave as caja,
					tc_mantic_cajas.id_caja,
					tc_mantic_cierres_cajas.id_tipo_medio_pago,
					tc_mantic_cierres_cajas.id_cierre_caja,
				  tc_mantic_cierres_cajas.disponible,
				  tc_mantic_cierres_cajas.acumulado,
				  tc_mantic_cierres_cajas.saldo,
				  tc_mantic_cierres_cajas.dia,
				  tc_mantic_cierres_cajas.importe
				from
					tc_mantic_cierres
				inner join
					tc_mantic_cierres_cajas on tc_mantic_cierres.id_cierre= tc_mantic_cierres_cajas.id_cierre
				inner join
					tc_mantic_cajas on tc_mantic_cierres_cajas.id_caja= tc_mantic_cajas.id_caja
				inner join
					tc_mantic_empresas on tc_mantic_cajas.id_empresa= tc_mantic_empresas.id_empresa
				where
				  tc_mantic_empresas.id_empresa= {idEmpresa}
				  and tc_mantic_cajas.id_caja= {idCaja}
				  and tc_mantic_cierres_cajas.id_tipo_medio_pago= 1
			    and tc_mantic_cierres.id_cierre_estatus in (1, 2)
				order by
				  tc_mantic_cierres.registro desc				
			</select>
			<select id="cierreVigente">
				select
					tc_mantic_cierres.id_cierre as id_key,
					tc_mantic_cierres.id_cierre,
					tc_mantic_empresas.id_empresa,
					tc_mantic_empresas.clave as empresa,
					tc_mantic_cajas.clave as caja,
					tc_mantic_cajas.id_caja,
					tc_mantic_cierres_cajas.id_tipo_medio_pago,
					tc_mantic_cierres_cajas.id_cierre_caja,
				  tc_mantic_cierres_cajas.disponible,
				  tc_mantic_cierres_cajas.acumulado,
				  tc_mantic_cierres_cajas.saldo,
				  tc_mantic_cierres_cajas.dia,
				  tc_mantic_cierres_cajas.importe
				from
					tc_mantic_cierres
				inner join
					tc_mantic_cierres_cajas on tc_mantic_cierres.id_cierre= tc_mantic_cierres_cajas.id_cierre
				inner join
					tc_mantic_cajas on tc_mantic_cierres_cajas.id_caja= tc_mantic_cajas.id_caja
				inner join
					tc_mantic_empresas on tc_mantic_cajas.id_empresa= tc_mantic_empresas.id_empresa
				where
				  tc_mantic_empresas.id_empresa= {idEmpresa}
				  and tc_mantic_cajas.id_caja= {idCaja}
					and id_cierre_estatus in ({estatusAbierto})				  
				order by
				  tc_mantic_cierres_cajas.registro				
			</select>
			<select id="alerta">
				select
					tc_mantic_cierres_alertas.id_cierre_alerta as id_key,
					tc_mantic_empresas.id_empresa,
					tc_mantic_empresas.clave as empresa,
					tc_mantic_cajas.clave as caja,
					tc_mantic_cajas.id_caja,
				  tc_mantic_cierres_alertas.mensaje,
					tc_mantic_cierres_cajas.id_tipo_medio_pago,
					tc_mantic_cierres_cajas.id_cierre_caja,
				  tc_mantic_cierres_cajas.disponible,
				  tc_mantic_cierres_cajas.acumulado,
				  tc_mantic_cierres_cajas.saldo,
				  tc_mantic_cierres_cajas.dia,
				  tc_mantic_cierres_cajas.importe
				from
					tc_mantic_cierres
				inner join
					tc_mantic_cierres_cajas on tc_mantic_cierres.id_cierre= tc_mantic_cierres_cajas.id_cierre
				inner join 
					tc_mantic_cierres_alertas on tc_mantic_cierres.id_cierre= tc_mantic_cierres_alertas.id_cierre
				inner join
					tc_mantic_cajas on tc_mantic_cierres_cajas.id_caja= tc_mantic_cajas.id_caja
				inner join
					tc_mantic_empresas on tc_mantic_cajas.id_empresa= tc_mantic_empresas.id_empresa
				where
				  tc_mantic_empresas.id_empresa= {idEmpresa}
				  and tc_mantic_cajas.id_caja= {idCaja}
				  and tc_mantic_cierres_alertas.id_notifica= 1
				order by
				  tc_mantic_cierres_cajas.registro				
			</select>
      <select id="ambos">
        select      
          sum(if(tc_mantic_cierres_retiros.id_abono= 1, tc_mantic_cierres_retiros.importe, 0)) as abonos,
          sum(if(tc_mantic_cierres_retiros.id_abono= 2, tc_mantic_cierres_retiros.importe, 0)) as retiros
        from      
          tc_mantic_cierres
				inner join
				  tc_mantic_cierres_cajas on tc_mantic_cierres.id_cierre= tc_mantic_cierres_cajas.id_cierre
				inner join
				  tc_mantic_cierres_retiros on tc_mantic_cierres_cajas.id_cierre_caja= tc_mantic_cierres_retiros.id_cierre_caja
        where      
          tc_mantic_cierres.id_cierre = {idCierre}
      </select>
			<select id="importes">
				select
				  tc_mantic_cierres_cajas.id_cierre_caja as id_key,
					tc_mantic_cajas.clave as caja,
					tc_mantic_empresas.clave as empresa,
					tc_mantic_tipos_medios_pagos.nombre as medio_pago,
					tc_mantic_cierres_cajas.*
				from
					tc_mantic_cierres
				inner join
					tc_mantic_cierres_cajas on tc_mantic_cierres.id_cierre= tc_mantic_cierres_cajas.id_cierre
				inner join
					tc_mantic_cajas on tc_mantic_cierres_cajas.id_caja= tc_mantic_cajas.id_caja
				inner join
					tc_mantic_empresas on tc_mantic_cajas.id_empresa= tc_mantic_empresas.id_empresa
				inner join
					tc_mantic_tipos_medios_pagos on tc_mantic_cierres_cajas.id_tipo_medio_pago= tc_mantic_tipos_medios_pagos.id_tipo_medio_pago
				where
				  tc_mantic_cajas.id_caja= {idCaja}
				  and tc_mantic_cierres.id_cierre= {idCierre}
				order by
				  tc_mantic_tipos_medios_pagos.orden				
			</select>
			<select id="fondo">
				select
				  tc_mantic_cierres_cajas.id_cierre_caja as id_key,
					tc_mantic_cajas.clave as caja,
					tc_mantic_empresas.clave as empresa,
					tc_mantic_tipos_medios_pagos.nombre as medio_pago,
					tc_mantic_cierres_cajas.*
				from
					tc_mantic_cierres
				inner join
					tc_mantic_cierres_cajas on tc_mantic_cierres.id_cierre= tc_mantic_cierres_cajas.id_cierre
				inner join
					tc_mantic_cajas on tc_mantic_cierres_cajas.id_caja= tc_mantic_cajas.id_caja
				inner join
					tc_mantic_empresas on tc_mantic_cajas.id_empresa= tc_mantic_empresas.id_empresa
				inner join
					tc_mantic_tipos_medios_pagos on tc_mantic_cierres_cajas.id_tipo_medio_pago= tc_mantic_tipos_medios_pagos.id_tipo_medio_pago
				where
				  tc_mantic_cajas.id_caja= {idCaja}
				  and tc_mantic_cierres.id_cierre= {idCierre}
				  and tc_mantic_cierres_cajas.id_tipo_medio_pago= 1
				order by
				  tc_mantic_tipos_medios_pagos.orden				
			</select>
			<select id="denominacion">
				select 
				  tc_mantic_cierres_monedas.*,
				  tc_mantic_monedas.nombre, 
				  tc_mantic_monedas.denominacion
  			from 
				  tc_mantic_cierres_monedas 
				inner join 
				  tc_mantic_monedas on tc_mantic_cierres_monedas.id_moneda= tc_mantic_monedas.id_moneda 
				where 
				  tc_mantic_cierres_monedas.id_cierre= {idCierre}
				  and tc_mantic_cierres_monedas.id_efectivo= {idEfectivo}
				order by 
				  tc_mantic_monedas.orden
			</select>
      <select id="cierrePosterior">
        select distinct 
          tc_mantic_cierres.id_cierre as id_key,tc_mantic_cierres.* 
        from 
          tc_mantic_cierres_cajas 
        inner join 
          tc_mantic_cierres on tc_mantic_cierres_cajas.id_cierre = tc_mantic_cierres.id_cierre 
        where 
          tc_mantic_cierres_cajas.id_caja = {idCaja} and tc_mantic_cierres.orden &gt; {orden} 
        order by 
          tc_mantic_cierres.orden asc
      </select>
		</unit>
		<unit id="VistaCreditosNotasDto">
			<select id="saldoFavorCreditos">
				select      
          tc_mantic_creditos_notas.id_credito_nota as id_key,
					tc_mantic_creditos_notas.id_empresa,
					tc_mantic_notas_entradas.consecutivo,
					tc_mantic_notas_entradas.factura,
					tc_mantic_creditos_notas.importe,				  
					tc_mantic_creditos_notas.saldo,
					concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) as persona,					
					tc_mantic_creditos_notas.registro,					
					tc_mantic_empresas.nombre,
          tc_mantic_empresas.clave,
					tc_mantic_proveedores.razon_social proveedor,
					tc_mantic_almacenes.nombre almacen,
          tc_mantic_almacenes.id_almacen,
					tc_mantic_proveedores.id_proveedor,
				  tc_mantic_notas_entradas.id_nota_tipo,
				  tc_mantic_notas_tipos.nombre as directa
        from
					tc_mantic_creditos_notas
				inner join
					tc_mantic_notas_entradas on tc_mantic_creditos_notas.id_nota_entrada= tc_mantic_notas_entradas.id_nota_entrada				
				inner join 
					tc_mantic_proveedores on tc_mantic_notas_entradas.id_proveedor = tc_mantic_proveedores.id_proveedor
				inner join 
					tc_mantic_almacenes on tc_mantic_notas_entradas.id_almacen = tc_mantic_almacenes.id_almacen
				inner join 
					tc_mantic_empresas on tc_mantic_creditos_notas.id_empresa = tc_mantic_empresas.id_empresa
				inner join
					tc_janal_usuarios on tc_mantic_creditos_notas.id_usuario= tc_janal_usuarios.id_usuario
				inner join
					tc_mantic_personas on tc_janal_usuarios.id_persona= tc_mantic_personas.id_persona				
				inner join
					tc_mantic_notas_tipos on tc_mantic_notas_entradas.id_nota_tipo= tc_mantic_notas_tipos.id_nota_tipo
        where 
          tc_mantic_creditos_notas.saldo &lt; 0
				  and tc_mantic_proveedores.id_proveedor= {idProveedor}
				  and tc_mantic_creditos_notas.id_credito_estatus in ({idCreditoEstatus})
				order by 
					tc_mantic_creditos_notas.registro desc
			</select>
			<select id="meses">
        select
          tc_janal_meses.id_mes as id_key,
          tc_janal_meses.nombre
        from
          tc_janal_meses 
        where
          tc_janal_meses.id_mes in (
        select      
          distinct(tc_mantic_creditos_archivos.mes)
        from      
          tc_mantic_creditos_archivos
				where
				  tc_mantic_creditos_archivos.ejercicio= {ejercicio}
				)
 				order by
				  tc_janal_meses.id_mes				  
			</select>	
			<select id="facturas">
        select
					tc_mantic_creditos_notas.id_credito_nota as id_key,
					tc_mantic_creditos_archivos.ejercicio,
					tc_mantic_creditos_archivos.mes,
				  tc_janal_meses.nombre,
					tc_mantic_creditos_notas.id_credito_nota,
          tc_mantic_creditos_notas.id_empresa,
					tc_mantic_creditos_notas.consecutivo,
					tc_mantic_empresas.clave as empresa,
				  tc_mantic_tipos_creditos_notas.id_tipo_credito_nota,
				  tc_mantic_tipos_creditos_notas.nombre as tipo,
					tc_mantic_creditos_notas.importe,
					tc_mantic_creditos_notas.registro     
        from
          tc_mantic_creditos_archivos
				inner join
					tc_janal_meses on tc_mantic_creditos_archivos.mes= tc_janal_meses.id_mes          
        inner join
          tc_mantic_creditos_notas on tc_mantic_creditos_archivos.id_credito_nota= tc_mantic_creditos_notas.id_credito_nota
        inner join
          tc_mantic_tipos_creditos_notas on tc_mantic_creditos_notas.id_tipo_credito_nota=tc_mantic_tipos_creditos_notas.id_tipo_credito_nota      
        inner join
          tc_mantic_empresas on tc_mantic_creditos_notas.id_empresa= tc_mantic_empresas.id_empresa         
        where
					tc_mantic_creditos_notas.id_empresa in ({idEmpresa})
					and tc_mantic_creditos_archivos.id_principal= 1
					and {condicion}
				group by
					tc_mantic_creditos_notas.id_credito_nota,
					tc_mantic_creditos_archivos.ejercicio,
					tc_mantic_creditos_archivos.mes,
				  tc_janal_meses.nombre,
					tc_mantic_creditos_notas.id_credito_nota,
          tc_mantic_creditos_notas.id_empresa,
					tc_mantic_creditos_notas.consecutivo,
					tc_mantic_empresas.clave,
				  tc_mantic_tipos_creditos_notas.id_tipo_credito_nota,
				  tc_mantic_tipos_creditos_notas.nombre,
					tc_mantic_creditos_notas.importe,
					tc_mantic_creditos_notas.registro     
				{sortOrder}				
			</select>
			<select id="exportar">
        select
					tc_mantic_creditos_archivos.alias as nombre
        from
          tc_mantic_creditos_archivos
				inner join
					tc_janal_meses on tc_mantic_creditos_archivos.mes= tc_janal_meses.id_mes          
        inner join
          tc_mantic_creditos_notas on tc_mantic_creditos_archivos.id_credito_nota= tc_mantic_creditos_notas.id_credito_nota
        inner join
          tc_mantic_tipos_creditos_notas on tc_mantic_creditos_notas.id_tipo_credito_nota=tc_mantic_tipos_creditos_notas.id_tipo_credito_nota      
        inner join
          tc_mantic_empresas on tc_mantic_creditos_notas.id_empresa= tc_mantic_empresas.id_empresa         
        where
					tc_mantic_creditos_notas.id_empresa in ({idEmpresa})
					and tc_mantic_creditos_archivos.id_principal= 1
					and {condicion}
			</select>
			<select id="total">
				select
					sum(importe) as total
				from (
					select
						tc_mantic_creditos_notas.importe
					from
						tc_mantic_creditos_notas
					inner join
						tc_mantic_notas_entradas on tc_mantic_creditos_notas.id_nota_entrada= tc_mantic_notas_entradas.id_nota_entrada and tc_mantic_creditos_notas.id_tipo_credito_nota= 2
					where
						tc_mantic_creditos_notas.id_empresa in ({sucursales})
						and tc_mantic_creditos_notas.id_nota_entrada= {idNotaEntrada}
					union
					select
						tc_mantic_creditos_notas.importe
					from
						tc_mantic_creditos_notas
					inner join
						tc_mantic_devoluciones on tc_mantic_creditos_notas.id_devolucion= tc_mantic_devoluciones.id_devolucion and tc_mantic_creditos_notas.id_tipo_credito_nota= 1
					where
						tc_mantic_devoluciones.id_empresa in ({sucursales})
						and tc_mantic_devoluciones.id_nota_entrada= {idNotaEntrada}
				) as tc_matic_importes
			</select>
			<select id="parcial">
				select
					sum(tc_mantic_creditos_notas.importe) as total
				from
					tc_mantic_creditos_notas
				inner join
					tc_mantic_devoluciones on tc_mantic_creditos_notas.id_devolucion= tc_mantic_devoluciones.id_devolucion and tc_mantic_creditos_notas.id_tipo_credito_nota= 1
				where
					tc_mantic_devoluciones.id_empresa in ({sucursales})
					and tc_mantic_devoluciones.id_devolucion= {idDevolucion}				
			</select>
			<select id="movimientos">
				select
					tc_mantic_creditos_bitacora.id_credito_bitacora as id_key,
					tc_mantic_creditos_bitacora.consecutivo,
					tc_mantic_creditos_bitacora.importe,
					tc_mantic_creditos_bitacora.justificacion,
					concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) as nombre,
				  tc_mantic_creditos_estatus.nombre as estatus,
					tc_mantic_creditos_bitacora.registro
				from 
					tc_mantic_creditos_bitacora
				inner join
					tc_mantic_creditos_estatus on tc_mantic_creditos_bitacora.id_credito_estatus= tc_mantic_creditos_estatus.id_credito_estatus
				inner join
					tc_janal_usuarios on tc_mantic_creditos_bitacora.id_usuario= tc_janal_usuarios.id_usuario
				inner join
					tc_mantic_personas on tc_janal_usuarios.id_persona= tc_mantic_personas.id_persona
				where
					tc_mantic_creditos_bitacora.id_credito_nota= {idCreditoNota}
				order by
					tc_mantic_creditos_bitacora.registro desc				
			</select>	
			<select id="lazy">
        select
					tc_mantic_creditos_notas.id_credito_nota as id_key,
					tc_mantic_creditos_notas.id_credito_nota,
					tc_mantic_creditos_notas.id_devolucion,
					tc_mantic_devoluciones.consecutivo as devolucion,
				  tc_mantic_notas_entradas.id_nota_entrada,
					tc_mantic_notas_entradas.consecutivo as nota_entrada,
          tc_mantic_notas_entradas.id_almacen,
          tc_mantic_notas_entradas.id_empresa,
				  tc_mantic_proveedores.id_proveedor,
					tc_mantic_proveedores.razon_social as proveedor,
					tc_mantic_creditos_notas.consecutivo,
					tc_mantic_empresas.clave as empresa,
				  tc_mantic_empresas.nombre as nombre_empresa,
					tc_mantic_creditos_notas.folio,
					tc_mantic_creditos_notas.importe,
		  		tc_mantic_creditos_estatus.nombre as estatus,
					tc_mantic_creditos_estatus.id_credito_estatus,
				  tc_mantic_creditos_estatus.estatus_asociados,
				  tc_mantic_tipos_creditos_notas.id_tipo_credito_nota,
				  tc_mantic_tipos_creditos_notas.nombre,
					tc_mantic_creditos_notas.registro
        from
          tc_mantic_creditos_notas         
        inner join
          tc_mantic_tipos_creditos_notas on tc_mantic_creditos_notas.id_tipo_credito_nota=tc_mantic_tipos_creditos_notas.id_tipo_credito_nota      
        inner join
          tc_mantic_creditos_estatus on tc_mantic_creditos_notas.id_credito_estatus=tc_mantic_creditos_estatus.id_credito_estatus      
        inner join
          tc_mantic_empresas on tc_mantic_creditos_notas.id_empresa= tc_mantic_empresas.id_empresa         
        left join
          tc_mantic_devoluciones on tc_mantic_creditos_notas.id_devolucion= tc_mantic_devoluciones.id_devolucion
        left join
          tc_mantic_notas_entradas on tc_mantic_creditos_notas.id_nota_entrada= tc_mantic_notas_entradas.id_nota_entrada
        left join
          tc_mantic_proveedores on tc_mantic_creditos_notas.id_proveedor= tc_mantic_proveedores.id_proveedor
        where
					tc_mantic_creditos_notas.id_empresa in ({idEmpresa})
					and {condicion}
				{sortOrder}
			</select> 
			<select id="devoluciones">
				select
				  tc_mantic_devoluciones.id_devolucion as id_key,
				  tc_mantic_devoluciones.id_devolucion,
				  tc_mantic_devoluciones.consecutivo,
					tc_mantic_proveedores.id_proveedor,
					tc_mantic_proveedores.clave,
					tc_mantic_proveedores.razon_social,
				  tc_mantic_devoluciones.total,
					tc_mantic_devoluciones.id_devolucion_estatus,
				  tc_mantic_devoluciones_estatus.nombre as estatus,
				  tc_mantic_devoluciones.registro,
				  tc_mantic_notas_entradas.id_nota_entrada
				from
				  tc_mantic_devoluciones
				inner join 
					tc_mantic_empresas on tc_mantic_devoluciones.id_empresa = tc_mantic_empresas.id_empresa
				inner join 
					tc_mantic_notas_entradas on tc_mantic_devoluciones.id_nota_entrada= tc_mantic_notas_entradas.id_nota_entrada
				inner join 
					tc_mantic_proveedores on tc_mantic_notas_entradas.id_proveedor= tc_mantic_proveedores.id_proveedor
				inner join 
					tc_mantic_devoluciones_estatus on tc_mantic_devoluciones.id_devolucion_estatus=tc_mantic_devoluciones_estatus.id_devolucion_estatus
				where
				  tc_mantic_empresas.id_empresa in ({sucursales})
				  and tc_mantic_devoluciones.id_devolucion_estatus in (3, 4)
				  and (tc_mantic_devoluciones.id_devolucion= {idDevolucion} or {idDevolucion} is null)
				order by
				  tc_mantic_devoluciones.registro						
			</select>
			<select id="notas">
				select
				  tc_mantic_notas_entradas.id_nota_entrada as id_key,
				  tc_mantic_notas_entradas.consecutivo,
					tc_mantic_proveedores.id_proveedor,
					tc_mantic_proveedores.clave,
					tc_mantic_proveedores.razon_social,
				  tc_mantic_notas_entradas.total,
					tc_mantic_notas_entradas.id_nota_estatus,
				  tc_mantic_notas_estatus.nombre as estatus,
				  tc_mantic_notas_entradas.registro
				from
				  tc_mantic_notas_entradas
				inner join 
					tc_mantic_empresas on tc_mantic_notas_entradas.id_empresa = tc_mantic_empresas.id_empresa
				inner join 
					tc_mantic_proveedores on tc_mantic_notas_entradas.id_proveedor= tc_mantic_proveedores.id_proveedor
				inner join 
					tc_mantic_notas_estatus on tc_mantic_notas_entradas.id_nota_estatus=tc_mantic_notas_estatus.id_nota_estatus
				where
				  tc_mantic_empresas.id_empresa in ({sucursales})
				  and tc_mantic_notas_entradas.id_nota_estatus in (3, 5, 6)
				  and (tc_mantic_notas_entradas.id_nota_entrada= {idNotaEntrada} or {idNotaEntrada} is null)
				order by
				  tc_mantic_notas_entradas.registro						
			</select>
			<select id="importados">
				select
					tc_mantic_creditos_archivos.id_credito_archivo as id_key,
					tc_mantic_creditos_archivos.id_credito_nota,
					tc_mantic_creditos_archivos.id_tipo_archivo,
					tc_mantic_tipos_archivos.nombre as tipo,
					tc_mantic_creditos_archivos.nombre,
					tc_mantic_creditos_archivos.alias,
					tc_mantic_creditos_archivos.ruta,
					tc_mantic_creditos_archivos.id_principal,
					concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) as usuario,
					tc_mantic_creditos_archivos.observaciones,
					tc_mantic_creditos_archivos.registro
				from
					tc_mantic_creditos_archivos
				inner join
					tc_mantic_tipos_archivos on tc_mantic_creditos_archivos.id_tipo_archivo= tc_mantic_tipos_archivos.id_tipo_archivo
				inner join
					tc_janal_usuarios on tc_mantic_creditos_archivos.id_usuario= tc_janal_usuarios.id_usuario          
				inner join
					tc_mantic_personas on tc_janal_usuarios.id_persona= tc_mantic_personas.id_persona
				where
					tc_mantic_creditos_archivos.id_credito_nota= {idCreditoNota}
				order by
					tc_mantic_creditos_archivos.id_tipo_archivo, tc_mantic_creditos_archivos.registro desc				
			</select>
			<select id="proveedores">
        select      
					tc_mantic_proveedores.id_proveedor as id_key,
          tc_mantic_proveedores.*,
          tc_mantic_tipos_monedas.nombre as moneda,
          tc_mantic_tipos_monedas.siglas,
          tc_mantic_tipos_monedas.simbolo,
          tc_mantic_tipos_proveedores.nombre as tipo_proveedor,
          tc_mantic_tipos_proveedores.dias,
          tc_mantic_tipos_dias.nombre as tipo_dia
        from      
          tc_mantic_proveedores
        inner join 
          tc_mantic_tipos_monedas on tc_mantic_proveedores.id_tipo_moneda= tc_mantic_tipos_monedas.id_tipo_moneda
        inner join 
          tc_mantic_tipos_proveedores on tc_mantic_proveedores.id_tipo_proveedor= tc_mantic_tipos_proveedores.id_tipo_proveedor
        inner join 
          tc_mantic_tipos_dias on tc_mantic_proveedores.id_tipo_dia= tc_mantic_tipos_dias.id_tipo_dia
        where 
          tc_mantic_proveedores.id_empresa in ({sucursales})
				  and tc_mantic_proveedores.id_proveedor= {idProveedor}
				order by
				  tc_mantic_proveedores.clave
			</select>
		</unit>
		<unit id="VistaVentasDto">
			<select id="autorizar">
        select
					tc_mantic_ventas.id_venta as id_key,
					tc_mantic_ventas.id_venta,
					tc_mantic_ventas.id_empresa,
					tc_mantic_empresas.nombre as empresa,
					tc_mantic_clientes.id_cliente,
					tc_mantic_clientes.razon_social as cliente,
					tc_mantic_ventas.consecutivo,
					tc_mantic_ventas.ticket,
					tc_mantic_ventas.total,
					concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) as vendedor,
					tc_mantic_tipos_ventas.nombre as precio,
					tc_mantic_ventas.id_acepta,
					tt_mantic_personas.cuenta as autorizo,
					tc_mantic_ventas.registro
        from
           tc_mantic_ventas           
        inner join
          tc_mantic_empresas on tc_mantic_ventas.id_empresa= tc_mantic_empresas.id_empresa     
        inner join
          tc_janal_usuarios on tc_mantic_ventas.id_usuario = tc_janal_usuarios.id_usuario     
        inner join
          tc_mantic_personas on tc_mantic_personas.id_persona = tc_janal_usuarios.id_persona        
        inner join
          tc_mantic_clientes on tc_mantic_ventas.id_cliente= tc_mantic_clientes.id_cliente     
        inner join
          tc_mantic_tipos_ventas on tc_mantic_clientes.id_tipo_venta= tc_mantic_tipos_ventas.id_tipo_venta     
        left join
          tc_janal_usuarios as tt_janal_usuarios on tc_mantic_ventas.id_acepta= tt_janal_usuarios.id_usuario
        left join
          tc_mantic_personas as tt_mantic_personas on tt_mantic_personas.id_persona = tt_janal_usuarios.id_persona        
        where
          tc_mantic_ventas.id_empresa in ({idEmpresa})
          and (tc_mantic_ventas.ticket is null or tc_mantic_ventas.id_acepta is not null)
          and tc_mantic_clientes.id_tipo_venta!= 1
          and {condicion}
        group by
          tc_mantic_ventas.id_venta
        {sortOrder}
      </select>  
			<select id="pagosVenta">
				select 					
					tc_mantic_tipos_medios_pagos.id_tipo_medio_pago as id_key,
					tc_mantic_tipos_medios_pagos.id_tipo_medio_pago,
					tc_mantic_ventas.id_venta,
					tc_mantic_tipos_medios_pagos.nombre 
				from 
					tc_mantic_ventas
				inner join 
					tr_mantic_venta_medio_pago on tc_mantic_ventas.id_venta = tr_mantic_venta_medio_pago.id_venta
				inner join 
					tc_mantic_tipos_medios_pagos on tr_mantic_venta_medio_pago.id_tipo_medio_pago = tc_mantic_tipos_medios_pagos.id_tipo_medio_pago
				where 
					tc_mantic_ventas.id_venta= {idVenta}
				group by					
					tc_mantic_tipos_medios_pagos.id_tipo_medio_pago,
					tc_mantic_ventas.id_venta,
					tc_mantic_tipos_medios_pagos.nombre
			</select>
			<select id="devoluciones">
 				select 
					tc_mantic_garantias_detalles.id_garantia_detalle as id_key,
					tc_mantic_garantias.consecutivo,
					tc_mantic_ventas_detalles.codigo,
					tc_mantic_ventas_detalles.nombre,
					tc_mantic_garantias_detalles.cantidad,
					tc_mantic_garantias_detalles.importe,
					tc_mantic_garantias_detalles.id_reparacion,
					tc_janal_booleanos.descripcion,
			  	tc_mantic_garantias_detalles.registro
				from 
					tc_mantic_garantias
				inner join 
				  tc_mantic_garantias_detalles on tc_mantic_garantias.id_garantia= tc_mantic_garantias_detalles.id_garantia
				inner join 
				  tc_mantic_ventas_detalles on tc_mantic_garantias_detalles.id_venta_detalle= tc_mantic_ventas_detalles.id_venta_detalle
				inner join
				  tc_janal_booleanos on tc_mantic_garantias_detalles.id_reparacion= tc_janal_booleanos.id_booleano
				where 
					tc_mantic_garantias.id_venta= {idVenta}
					and tc_mantic_garantias.id_garantia_estatus in (3,4,6)
					and tc_mantic_garantias_detalles.cantidad> 0				
			  order by
				  tc_mantic_garantias.consecutivo, tc_mantic_ventas_detalles.codigo
			</select>
			<select id="tipoMedioPago">
				select 
					tr_mantic_venta_medio_pago.id_venta, group_concat(tc_mantic_tipos_medios_pagos.nombre order by tc_mantic_tipos_medios_pagos.nombre asc separator ', ') as medios
				from 
					tc_mantic_ventas
				inner join  
					tr_mantic_venta_medio_pago on tc_mantic_ventas.id_venta= tr_mantic_venta_medio_pago.id_venta
				inner join
					tc_mantic_tipos_medios_pagos on tr_mantic_venta_medio_pago.id_tipo_medio_pago= tc_mantic_tipos_medios_pagos.id_tipo_medio_pago
				where
					tc_mantic_ventas.id_venta= {idVenta}
				group by 
					tr_mantic_venta_medio_pago.id_venta				
			</select>
			<select id="tickets">
				select
					tc_mantic_ventas.id_venta as id_key,
					tc_mantic_ventas.id_venta,
					tc_mantic_ventas.id_venta_estatus,
					tc_mantic_ventas.ticket as consecutivo,
					tc_mantic_empresas.id_empresa,  
					tc_mantic_empresas.clave as empresa,  
					tc_mantic_empresas.nombre as nombre_empresa,  
					tc_mantic_ventas.id_factura,
					tc_mantic_ventas.id_facturar,
					tc_mantic_facturas.folio,
					tc_mantic_clientes.id_cliente,  
					tc_mantic_clientes.razon_social as cliente,
				  concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) as vendedor,
					tc_mantic_ventas.total as importe,
					tc_mantic_ventas.total,
					tc_mantic_ventas.registro
				from
					tc_mantic_ventas
				inner join
					tc_mantic_ventas_detalles on tc_mantic_ventas.id_venta= tc_mantic_ventas_detalles.id_venta
				inner join 
					tc_mantic_clientes on tc_mantic_ventas.id_cliente= tc_mantic_clientes.id_cliente
				inner join 
					tc_mantic_empresas on tc_mantic_ventas.id_empresa= tc_mantic_empresas.id_empresa  
				inner join
					tc_janal_usuarios on tc_mantic_ventas.id_usuario= tc_janal_usuarios.id_usuario
				inner join
					tc_mantic_personas on tc_janal_usuarios.id_persona= tc_mantic_personas.id_persona				
				left join
					tc_mantic_facturas on tc_mantic_ventas.id_factura= tc_mantic_facturas.id_factura
				where
					tc_mantic_ventas.id_empresa in ({idEmpresa})
			    and tc_mantic_ventas.id_venta_estatus in ({estatusTickets})
					and {condicion}
				group by
					tc_mantic_ventas.id_venta
				{sortOrder}
			</select>	
			<select id="movimientos">
				select
					tc_mantic_ventas_bitacora.id_venta_bitacora as id_key,
					tc_mantic_ventas_bitacora.consecutivo,
					tc_mantic_ventas_bitacora.importe,
					tc_mantic_ventas_bitacora.justificacion,
					concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) as nombre,
				  tc_mantic_ventas_estatus.nombre as estatus,
					tc_mantic_ventas_bitacora.registro
				from 
					tc_mantic_ventas_bitacora
				inner join
					tc_mantic_ventas_estatus on tc_mantic_ventas_bitacora.id_venta_estatus= tc_mantic_ventas_estatus.id_venta_estatus
				inner join
					tc_janal_usuarios on tc_mantic_ventas_bitacora.id_usuario= tc_janal_usuarios.id_usuario
				inner join
					tc_mantic_personas on tc_janal_usuarios.id_persona= tc_mantic_personas.id_persona
				where
					tc_mantic_ventas_bitacora.id_venta= {idVenta}
				order by
					tc_mantic_ventas_bitacora.registro desc				
			</select>	
			<select id="lazy">
				select
					tc_mantic_ventas.id_venta as id_key,
					tc_mantic_ventas.id_venta,
					tc_mantic_ventas.id_empresa,  
				  tc_mantic_empresas.clave as empresa,  
				  tc_mantic_empresas.nombre as nombre_empresa,  
					tc_mantic_ventas.consecutivo,  													
					tc_mantic_ventas.ticket,  
					tc_mantic_ventas.id_manual,
					tc_mantic_almacenes.clave,
					tc_mantic_almacenes.nombre as almacen,
					tc_mantic_ventas.total,
					tc_mantic_ventas.sub_total,
					tc_mantic_ventas.impuestos as iva,
					tc_mantic_ventas.total as precio_total,
					tc_mantic_ventas.id_venta_estatus,
					tc_mantic_ventas_estatus.nombre as estatus,
					tc_mantic_ventas_estatus.estatus_asociados, 
					if(tc_mantic_ventas_estatus.id_venta_estatus in (1,2), 'VENTA', tc_mantic_ventas_estatus.nombre) tipo,	
					tc_mantic_ventas.registro,
					tc_mantic_ventas.vigencia,
					tc_mantic_personas.cuenta,
					concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) as nombre,
					tc_mantic_clientes.id_cliente,  
					tc_mantic_clientes.id_credito,
					tc_mantic_clientes.razon_social as cliente,
					tc_mantic_clientes.limite_credito,					
					(select saldo from tc_mantic_clientes_deudas where tc_mantic_clientes_deudas.id_venta= tc_mantic_ventas.id_venta group by tc_mantic_clientes_deudas.id_venta) saldo,
					(select limite from tc_mantic_clientes_deudas where tc_mantic_clientes_deudas.id_venta= tc_mantic_ventas.id_venta group by tc_mantic_clientes_deudas.id_venta) limite,
					tc_mantic_facturas.id_factura,
					tc_mantic_facturas.id_facturama,
					tc_mantic_facturas.sello_sat,
					tc_mantic_facturas.timbrado,
					tc_mantic_facturas.intentos,
					tc_mantic_facturas.cancelada,
				  tc_mantic_facturas.folio as factura,
					if(tc_mantic_facturas.folio is null, 0, 1) folio,
					if(tc_mantic_facturas.id_facturama is null, 0, 1) facturado,
					if(tc_mantic_facturas.id_factura_estatus is null, 1, tc_mantic_facturas.id_factura_estatus) id_factura_estatus,
					tc_mantic_ventas.id_tipo_documento
				from 
					tc_mantic_ventas						
				left join 
					tc_mantic_ventas_detalles on tc_mantic_ventas.id_venta = tc_mantic_ventas_detalles.id_venta
				inner join 
					tc_mantic_empresas on tc_mantic_ventas.id_empresa= tc_mantic_empresas.id_empresa
				inner join 
					tc_mantic_ventas_estatus on tc_mantic_ventas.id_venta_estatus=tc_mantic_ventas_estatus.id_venta_estatus
				inner join 
					tc_mantic_almacenes on tc_mantic_ventas.id_almacen= tc_mantic_almacenes.id_almacen
				inner join 
				  tc_janal_usuarios on tc_mantic_ventas.id_usuario = tc_janal_usuarios.id_usuario
				inner join				
					tc_mantic_personas on tc_mantic_personas.id_persona = tc_janal_usuarios.id_persona			
				inner join 
					tc_mantic_clientes on tc_mantic_ventas.id_cliente= tc_mantic_clientes.id_cliente
				left join 
					tc_mantic_facturas on tc_mantic_ventas.id_factura = tc_mantic_facturas.id_factura				
				where
					tc_mantic_ventas.id_empresa in ({idEmpresa})
					and {condicion}
				group by 
					tc_mantic_ventas.id_venta
				{sortOrder}
			</select>
			<select id="bloqueadas">
				select
					tc_mantic_ventas.id_venta as id_key,
					tc_mantic_ventas.id_venta,
					tc_mantic_ventas.id_empresa,  
				  tc_mantic_empresas.clave as empresa,  
				  tc_mantic_empresas.nombre as nombre_empresa,  
					tc_mantic_ventas.consecutivo,  													
					tc_mantic_ventas.ticket,  
					tc_mantic_ventas.id_manual,
					tc_mantic_almacenes.clave,
					tc_mantic_almacenes.nombre as almacen,
					tc_mantic_ventas.total,
					tc_mantic_ventas.sub_total,
					tc_mantic_ventas.impuestos as iva,
					tc_mantic_ventas.total as precio_total,
					tc_mantic_ventas.id_venta_estatus,
					tc_mantic_ventas_estatus.nombre as estatus,
					tc_mantic_ventas_estatus.estatus_asociados, 
					if(tc_mantic_ventas_estatus.id_venta_estatus in (1,2), 'VENTA', tc_mantic_ventas_estatus.nombre) tipo,	
					tc_mantic_ventas.registro,
					tc_mantic_ventas.vigencia,
					tc_mantic_personas.cuenta,
					concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) as nombre,
					tc_mantic_clientes.id_cliente,  
					tc_mantic_clientes.id_credito,
					tc_mantic_clientes.razon_social as cliente,
					tc_mantic_clientes.limite_credito,					
					(select saldo from tc_mantic_clientes_deudas where tc_mantic_clientes_deudas.id_venta= tc_mantic_ventas.id_venta) saldo,
					(select limite from tc_mantic_clientes_deudas where tc_mantic_clientes_deudas.id_venta= tc_mantic_ventas.id_venta) limite,
					tc_mantic_facturas.id_factura,
					tc_mantic_facturas.id_facturama,
					tc_mantic_facturas.sello_sat,
					tc_mantic_facturas.timbrado,
					tc_mantic_facturas.intentos,
					tc_mantic_facturas.cancelada,
				  tc_mantic_facturas.folio as factura,
					if(tc_mantic_facturas.folio is null, 0, 1) folio,
					if(tc_mantic_facturas.id_facturama is null, 0, 1) facturado,
					if(tc_mantic_facturas.id_factura_estatus is null, 1, tc_mantic_facturas.id_factura_estatus) id_factura_estatus,
					tc_mantic_ventas.id_tipo_documento
				from 
					tc_mantic_ventas						
				left join 
					tc_mantic_ventas_detalles on tc_mantic_ventas.id_venta = tc_mantic_ventas_detalles.id_venta
				inner join 
					tc_mantic_empresas on tc_mantic_ventas.id_empresa= tc_mantic_empresas.id_empresa
				inner join 
					tc_mantic_ventas_estatus on tc_mantic_ventas.id_venta_estatus=tc_mantic_ventas_estatus.id_venta_estatus
				inner join 
					tc_mantic_almacenes on tc_mantic_ventas.id_almacen= tc_mantic_almacenes.id_almacen
				inner join 
				  tc_janal_usuarios on tc_mantic_ventas.id_usuario = tc_janal_usuarios.id_usuario
				inner join				
					tc_mantic_personas on tc_mantic_personas.id_persona = tc_janal_usuarios.id_persona			
				inner join 
					tc_mantic_clientes on tc_mantic_ventas.id_cliente= tc_mantic_clientes.id_cliente
				left join 
					tc_mantic_facturas on tc_mantic_ventas.id_factura = tc_mantic_facturas.id_factura				
				where
					tc_mantic_ventas.id_empresa in ({idEmpresa})
					and date_format(tc_mantic_ventas.registro, '%Y%m%d')= date_format(SYSDATE(), '%Y%m%d')
          and tc_mantic_ventas.candado= 1
          and tc_mantic_ventas.id_venta_estatus in ({estatus})
          and tc_mantic_ventas.id_venta!= {idVenta}
				group by 
					tc_mantic_ventas.id_venta
				{sortOrder}
			</select>
			<select id="fechasTicketsAbiertos">
        select
					tc_mantic_ventas.id_venta as id_key,					
					tc_mantic_ventas.id_empresa,  					
					tc_mantic_ventas.registro					
				from 
					tc_mantic_ventas																	
				where
					tc_mantic_ventas.id_empresa in ({idEmpresa}) {condicion}
				order by
					tc_mantic_ventas.registro					
			</select>
			<select id="lazyApartados">
        select
					tc_mantic_ventas.id_venta as id_key,
					tc_mantic_ventas.id_venta,
					tc_mantic_ventas.id_empresa,  
				  tc_mantic_empresas.clave as empresa,  
				  tc_mantic_empresas.nombre as nombre_empresa,  
					tc_mantic_ventas.consecutivo,  
					tc_mantic_ventas.ticket,  
					tc_mantic_clientes.id_cliente,  
					tc_mantic_ventas.id_manual,
					tc_mantic_clientes.razon_social as cliente,
					tc_mantic_clientes.limite_credito,
					tc_mantic_almacenes.clave,
					tc_mantic_almacenes.nombre as almacen,
					tc_mantic_apartados.saldo as total,
					tc_mantic_apartados.saldo as precio_total,
				  tc_mantic_ventas_estatus.nombre as estatus,
					tc_mantic_ventas.id_venta_estatus,
					if(tc_mantic_ventas_estatus.id_venta_estatus in (1,2), 'VENTA', tc_mantic_ventas_estatus.nombre) tipo,	
					tc_mantic_ventas.registro,
					tc_mantic_apartados.vencimiento as vigencia,
					tc_mantic_ventas_estatus.estatus_asociados, 					
					tc_mantic_personas.cuenta,
					concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) as nombre,
					tc_mantic_clientes.id_credito,
          (select saldo from tc_mantic_clientes_deudas where tc_mantic_clientes_deudas.id_venta= tc_mantic_ventas.id_venta) saldo,
          (select limite from tc_mantic_clientes_deudas where tc_mantic_clientes_deudas.id_venta= tc_mantic_ventas.id_venta) limite
				from 
					tc_mantic_ventas
				inner join 
					tc_mantic_apartados on tc_mantic_ventas.id_venta = tc_mantic_apartados.id_venta
				inner join 
					tc_mantic_clientes on tc_mantic_ventas.id_cliente= tc_mantic_clientes.id_cliente
				inner join 
					tc_mantic_almacenes on tc_mantic_ventas.id_almacen= tc_mantic_almacenes.id_almacen
				inner join 
					tc_mantic_empresas on tc_mantic_ventas.id_empresa= tc_mantic_empresas.id_empresa
				inner join 
					tc_mantic_ventas_estatus on tc_mantic_ventas.id_venta_estatus=tc_mantic_ventas_estatus.id_venta_estatus
				inner join 
				  tc_janal_usuarios on tc_mantic_ventas.id_usuario = tc_janal_usuarios.id_usuario
				inner join				
					tc_mantic_personas on tc_mantic_personas.id_persona = tc_janal_usuarios.id_persona				
				where
					tc_mantic_ventas.id_empresa in ({idEmpresa})
					and {condicion}
				{sortOrder}
			</select>	
			<select id="lazyVenta">
        select
					tc_mantic_ventas.id_venta as id_key,
					tc_mantic_ventas.id_empresa,  
				  tc_mantic_empresas.clave as empresa,  
				  tc_mantic_empresas.nombre as nombre_empresa,  
					tc_mantic_ventas.consecutivo,  
					tc_mantic_clientes.id_cliente,  
					tc_mantic_clientes.razon_social as cliente,
					tc_mantic_clientes.limite_credito,
					tc_mantic_almacenes.clave,
					tc_mantic_almacenes.nombre as almacen,
					tc_mantic_ventas.total,
					tc_mantic_ventas.total as precio_total,
				  tc_mantic_ventas_estatus.nombre as estatus,
					tc_mantic_ventas.id_venta_estatus,					
					tc_mantic_ventas.registro,
					tc_mantic_ventas_estatus.estatus_asociados, 					
					tc_mantic_personas.cuenta,
					concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) as nombre,
					tc_mantic_clientes.id_credito
				from 
					tc_mantic_ventas
				inner join 
					tc_mantic_clientes on tc_mantic_ventas.id_cliente= tc_mantic_clientes.id_cliente
				inner join 
					tc_mantic_almacenes on tc_mantic_ventas.id_almacen= tc_mantic_almacenes.id_almacen
				inner join 
					tc_mantic_empresas on tc_mantic_ventas.id_empresa= tc_mantic_empresas.id_empresa
				inner join 
					tc_mantic_ventas_estatus on tc_mantic_ventas.id_venta_estatus=tc_mantic_ventas_estatus.id_venta_estatus
				inner join 
				  tc_janal_usuarios on tc_mantic_ventas.id_usuario = tc_janal_usuarios.id_usuario
				inner join				
					tc_mantic_personas on tc_mantic_personas.id_persona = tc_janal_usuarios.id_persona
				where
					tc_mantic_ventas.id_venta= {idVenta}					
			</select>
			<select id="cotizacion">
				select * from (
					select
						tc_mantic_ventas.id_venta as id_key,
						tc_mantic_ventas.id_venta,
						tc_mantic_ventas.id_empresa,  
						tc_mantic_empresas.clave as empresa,  
						tc_mantic_empresas.nombre as nombre_empresa,  
						tc_mantic_ventas.orden,
            ifnull(tc_mantic_ventas.ticket, '') as ticket,
						tc_mantic_ventas.cotizacion consecutivo,
						tc_mantic_clientes.id_cliente,  
						tc_mantic_clientes.razon_social as cliente,
						tc_mantic_clientes.limite_credito,
						tc_mantic_almacenes.clave,
						tc_mantic_almacenes.nombre as almacen,
						tc_mantic_ventas.total,
						tc_mantic_ventas.total as precio_total,
						tc_mantic_ventas_estatus.nombre as estatus,
						tc_mantic_ventas.id_venta_estatus,
						tc_mantic_ventas.registro,
						tc_mantic_ventas_estatus.estatus_asociados, 					
						tc_mantic_personas.cuenta,
						concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) as nombre,
						tc_mantic_clientes.id_credito,
						(select saldo from tc_mantic_clientes_deudas where tc_mantic_clientes_deudas.id_venta= tc_mantic_ventas.id_venta) saldo,
						(select limite from tc_mantic_clientes_deudas where tc_mantic_clientes_deudas.id_venta= tc_mantic_ventas.id_venta) limite
					from 
						tc_mantic_ventas  				
					inner join 
						tc_mantic_clientes on tc_mantic_ventas.id_cliente= tc_mantic_clientes.id_cliente
					inner join 
						tc_mantic_almacenes on tc_mantic_ventas.id_almacen= tc_mantic_almacenes.id_almacen
					inner join 
						tc_mantic_empresas on tc_mantic_ventas.id_empresa= tc_mantic_empresas.id_empresa
					inner join 
						tc_mantic_ventas_estatus on tc_mantic_ventas.id_venta_estatus=tc_mantic_ventas_estatus.id_venta_estatus
					inner join 
						tc_janal_usuarios on tc_mantic_ventas.id_usuario = tc_janal_usuarios.id_usuario
					inner join				
						tc_mantic_personas on tc_mantic_personas.id_persona = tc_janal_usuarios.id_persona		
					inner join 
						tc_mantic_ventas_detalles on tc_mantic_ventas.id_venta = tc_mantic_ventas_detalles.id_venta
					where
						tc_mantic_ventas.id_empresa in ({idEmpresa})
						and {condicion}) principal
				group by 
					id_key, id_venta, id_empresa				
				{sortOrder}
			</select>
			<select id="clientes">
        select
					tc_mantic_clientes.id_cliente as id_key,
					tc_mantic_clientes.clave,  
					tc_mantic_clientes.limite_credito,
					tc_mantic_clientes.razon_social as nombre
				from 
					tc_mantic_ventas
				inner join
					tc_mantic_clientes on tc_mantic_ventas.id_cliente= tc_mantic_clientes.id_cliente       
				where 		
				  tc_mantic_ventas.id_empresa in ({sucursales})
				group by
					tc_mantic_clientes.id_cliente,
					tc_mantic_clientes.clave,  
					tc_mantic_clientes.limite_credito,
					tc_mantic_clientes.razon_social
				order by
				  tc_mantic_clientes.clave
			</select>
			<select id="descuentoGrupoVigente">
				select 
					tc_mantic_articulos.id_articulo as id_key,
					tr_mantic_articulo_grupo_descuento.porcentaje
				from 
					tc_mantic_articulos
				inner join 
					tr_mantic_articulo_grupo_descuento on tc_mantic_articulos.id_articulo = tr_mantic_articulo_grupo_descuento.id_articulo	    
				inner join 
					tc_mantic_grupos on tr_mantic_articulo_grupo_descuento.id_grupo= tc_mantic_grupos.id_grupo
				inner join
					tc_mantic_grupos_clientes on tc_mantic_grupos.id_grupo = tc_mantic_grupos_clientes.id_grupo
				where
					tc_mantic_articulos.id_articulo= {idArticulo}
				and 
					tc_mantic_grupos_clientes.id_cliente= {idCliente}
				and 
					(sysdate() between tr_mantic_articulo_grupo_descuento.vigencia_inicial and tr_mantic_articulo_grupo_descuento.vigencia_final)
				and 
					tc_mantic_articulos.id_empresa in ({idEmpresa})
			</select>
			<select id="descuentoArticuloVigente">
				select 
					tc_mantic_articulos.id_articulo as id_key,
					tc_mantic_articulos_descuentos.porcentaje
				from 
					tc_mantic_articulos
				inner join 
					tc_mantic_articulos_descuentos on tc_mantic_articulos.id_articulo = tc_mantic_articulos_descuentos.id_articulo	    				
				where
					tc_mantic_articulos.id_articulo= {idArticulo}				
				and 
					(sysdate() between tc_mantic_articulos_descuentos.vigencia_inicial and tc_mantic_articulos_descuentos.vigencia_final)				
			</select>
			<select id="facturacion">
				select
					tc_mantic_ventas.id_venta as id_key,
					tc_mantic_ventas.id_venta,
          tc_mantic_ventas.ticket,
					tc_mantic_clientes.id_cliente,
          tc_mantic_clientes.id_regimen_fiscal,
					tc_mantic_clientes.razon_social,									  					
					tc_mantic_ventas.id_tipo_pago,
					tc_mantic_facturas.id_factura,
					tc_mantic_facturas.id_facturama,
          tc_mantic_facturas.timbrado,
					tc_mantic_facturas.sello_sat,					
					tc_mantic_ventas.id_cliente_domicilio,
					tc_mantic_ventas.id_usuario,
					tc_mantic_empresas.nombre as nombre_empresa,
					tc_mantic_ventas.id_empresa,
					tc_mantic_ventas.id_tipo_documento,
					tc_mantic_facturas.intentos
				from 
					tc_mantic_ventas										
				inner join 
					tc_mantic_empresas on tc_mantic_ventas.id_empresa= tc_mantic_empresas.id_empresa
				inner join 
					tc_mantic_ventas_estatus on tc_mantic_ventas.id_venta_estatus=tc_mantic_ventas_estatus.id_venta_estatus
				inner join 
				  tc_janal_usuarios on tc_mantic_ventas.id_usuario = tc_janal_usuarios.id_usuario
				inner join				
					tc_mantic_personas on tc_mantic_personas.id_persona = tc_janal_usuarios.id_persona			
				inner join 
					tc_mantic_clientes on tc_mantic_ventas.id_cliente= tc_mantic_clientes.id_cliente
				inner join 
					tc_mantic_facturas on tc_mantic_ventas.id_factura = tc_mantic_facturas.id_factura				
				where					
			    tc_mantic_facturas.id_factura_estatus= {idEstatus} 
				  and tc_mantic_facturas.folio is null 
          and tc_mantic_facturas.id_facturama is null
          and tc_mantic_clientes.id_regimen_fiscal is not null
				group by 
					tc_mantic_ventas.id_venta,
					tc_mantic_clientes.id_cliente,
					tc_mantic_clientes.razon_social,									  					
					tc_mantic_ventas.id_tipo_pago,
					tc_mantic_facturas.id_factura,
					tc_mantic_facturas.id_facturama,
					tc_mantic_facturas.sello_sat,					
					tc_mantic_ventas.id_cliente_domicilio,
					tc_mantic_ventas.id_usuario,
					tc_mantic_empresas.nombre,
					tc_mantic_ventas.id_empresa,
					tc_mantic_ventas.id_tipo_documento,
					tc_mantic_facturas.intentos
			</select>
		</unit>		
		<unit id="VistaKardexDto">
			<select id="row">
				select
					tc_mantic_articulos.id_articulo as id_key,
					tc_mantic_articulos_codigos.codigo as propio,
					tc_mantic_articulos.nombre,
					tc_mantic_articulos.descripcion,
					tc_mantic_empaques.nombre as empaque,
					tc_mantic_unidades_medidas.nombre as unidad_medida,
					tc_mantic_articulos.cantidad,
					if(tc_mantic_articulos.id_redondear= 1, "Si", 'NO') as redondear,
					tc_mantic_articulos.precio,
					tc_mantic_articulos.precio as calculado,
					tc_mantic_articulos.precio as value,
					tc_mantic_articulos.iva,
					tc_mantic_articulos.menudeo,
					tc_mantic_articulos.limite_medio_mayoreo,
					tc_mantic_articulos.medio_mayoreo,
					tc_mantic_articulos.mayoreo,
					tc_mantic_articulos.especial,
					tc_mantic_articulos.limite_mayoreo,
					tc_mantic_articulos.id_imagen,
					tc_mantic_articulos.stock,
					tc_mantic_articulos.minimo,
					tc_mantic_articulos.maximo,
				  (((tc_mantic_articulos.menudeo- ((tc_mantic_articulos.precio* (tc_mantic_articulos.iva/ 100+ 1))))* 100)/ ((tc_mantic_articulos.precio* (tc_mantic_articulos.iva/ 100+ 1)))) as utilidad,
					tc_mantic_articulos.sat,
					if(tc_mantic_articulos.id_vigente= 1, "Si", 'NO') as vigente,
					tc_mantic_articulos.fecha,
					tc_mantic_articulos.descuento,
					tc_mantic_articulos.extra,
					tc_mantic_articulos.id_redondear,
					tc_mantic_articulos.id_vigente,
					tc_mantic_articulos.id_descontinuado,
					tc_mantic_articulos.actualizado,
          tc_mantic_articulos.id_articulo_impuesto,
					tc_mantic_articulos.registro
				from
					tc_mantic_articulos
				inner join
					tc_mantic_articulos_codigos on tc_mantic_articulos.id_articulo= tc_mantic_articulos_codigos.id_articulo and tc_mantic_articulos_codigos.id_principal= 1
				inner join
					tr_mantic_empaque_unidad_medida	on tc_mantic_articulos.id_empaque_unidad_medida= tr_mantic_empaque_unidad_medida.id_empaque_unidad_medida
				inner join
					tc_mantic_empaques on tr_mantic_empaque_unidad_medida.id_empaque= tc_mantic_empaques.id_empaque
				inner join
					tc_mantic_unidades_medidas on tr_mantic_empaque_unidad_medida.id_unidad_medida= tc_mantic_unidades_medidas.id_unidad_medida
				where 
					tc_mantic_articulos.id_articulo= {idArticulo}
				order by
					tc_mantic_articulos.registro
			</select>	
			<select id="historial">
				select
					tc_mantic_articulos_bitacora.id_articulo_bitacora as id_key,
					concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) as persona,
					if(tc_mantic_notas_entradas.consecutivo is null, 'KARDEX', tc_mantic_notas_entradas.consecutivo) as consecutivo,					
				  tc_mantic_articulos_bitacora.*,
				  ifnull(tc_mantic_proveedores.clave, '  ') as clave,
				  ifnull(tc_mantic_proveedores.razon_social, '  ') as razon_social
				from
					tc_mantic_articulos_bitacora
				inner join
					tc_janal_usuarios on tc_mantic_articulos_bitacora.id_usuario= tc_janal_usuarios.id_usuario
				inner join
					tc_mantic_personas on tc_janal_usuarios.id_persona= tc_mantic_personas.id_persona
				left join
					tc_mantic_notas_entradas on tc_mantic_articulos_bitacora.id_nota_entrada= tc_mantic_notas_entradas.id_nota_entrada
				left join
				  tc_mantic_proveedores on tc_mantic_notas_entradas.id_proveedor= tc_mantic_proveedores.id_proveedor
				where
					tc_mantic_articulos_bitacora.id_articulo= {idArticulo}
				  and date_format(tc_mantic_articulos_bitacora.registro, '%Y%m%d')&gt;= '{registro}'
				order by
					tc_mantic_articulos_bitacora.registro desc				
			</select>
			<select id="movimientos">
				select
					tc_mantic_movimientos.id_movimiento as id_key,
					tc_mantic_tipos_movimientos.id_tipo_movimiento,
					tc_mantic_tipos_movimientos.nombre as concepto,
					tc_mantic_empresas.clave,
					tc_mantic_empresas.nombre as nombre_empresa,
					tc_mantic_almacenes.id_almacen,
					tc_mantic_almacenes.nombre as almacen,
					tc_mantic_movimientos.consecutivo,
					tc_mantic_movimientos.id_articulo,
				  (select tc_mantic_articulos_codigos.codigo from tc_mantic_articulos_codigos where tc_mantic_articulos_codigos.id_articulo= tc_mantic_articulos.id_articulo and tc_mantic_articulos_codigos.id_principal= 1 limit 0, 1) as propio,
					tc_mantic_articulos.nombre,
					tc_mantic_movimientos.cantidad,
					tc_mantic_movimientos.stock,
					tc_mantic_movimientos.calculo,
					tc_mantic_movimientos.observaciones,
 					concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) as usuario,
					tc_mantic_movimientos.registro
				from
					tc_mantic_movimientos
				inner join
					tc_mantic_articulos on tc_mantic_movimientos.id_articulo= tc_mantic_articulos.id_articulo
				inner join 
					tc_mantic_tipos_movimientos on tc_mantic_movimientos.id_tipo_movimiento= tc_mantic_tipos_movimientos.id_tipo_movimiento
				inner join 
					tc_mantic_almacenes on tc_mantic_movimientos.id_almacen= tc_mantic_almacenes.id_almacen
				inner join 
					tc_mantic_empresas on tc_mantic_almacenes.id_empresa= tc_mantic_empresas.id_empresa
				inner join
					tc_janal_usuarios on tc_mantic_movimientos.id_usuario = tc_janal_usuarios.id_usuario
				inner join
					tc_mantic_personas on tc_janal_usuarios.id_persona = tc_mantic_personas.id_persona
				where
					tc_mantic_movimientos.id_almacen= {idAlmacen}
					and tc_mantic_movimientos.id_articulo= {idArticulo}
				  and date_format(tc_mantic_movimientos.registro, '%Y%m%d')&gt;= '{registro}'
				order by
					tc_mantic_movimientos.registro desc
			</select>
			<select id="conteo">
				select
					tc_mantic_movimientos.id_movimiento as id_key,
					tc_mantic_almacenes.nombre as razon_social,
					tc_mantic_movimientos.registro as fecha,
					1 as articulos,
					tc_mantic_articulos.precio as total,
					0 as impuestos,
					tc_mantic_articulos.precio as importe,
					tc_mantic_articulos.precio as precio,
          tc_mantic_inventarios.inicial,
          tc_mantic_inventarios.entradas as cantidad,
          tc_mantic_inventarios.salidas,
          tc_mantic_tipos_movimientos.id_tipo_movimiento,
					tc_mantic_tipos_movimientos.nombre as concepto,
					tc_mantic_empresas.clave,
					tc_mantic_empresas.nombre as nombre_empresa,
					tc_mantic_almacenes.id_almacen,
					tc_mantic_almacenes.nombre as almacen,
					tc_mantic_movimientos.consecutivo,
					tc_mantic_movimientos.id_articulo,
				  (select tc_mantic_articulos_codigos.codigo from tc_mantic_articulos_codigos where tc_mantic_articulos_codigos.id_articulo= tc_mantic_articulos.id_articulo and tc_mantic_articulos_codigos.id_principal= 1 limit 0, 1) as propio,
					tc_mantic_articulos.nombre,
					tc_mantic_movimientos.stock,
					tc_mantic_movimientos.calculo,
					tc_mantic_movimientos.observaciones,
 					concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) as usuario,
					tc_mantic_movimientos.registro
				from
					tc_mantic_movimientos
				inner join
					tc_mantic_articulos on tc_mantic_movimientos.id_articulo= tc_mantic_articulos.id_articulo
				inner join 
					tc_mantic_tipos_movimientos on tc_mantic_movimientos.id_tipo_movimiento= tc_mantic_tipos_movimientos.id_tipo_movimiento
				inner join 
					tc_mantic_almacenes on tc_mantic_movimientos.id_almacen= tc_mantic_almacenes.id_almacen
        inner join
            tc_mantic_inventarios on tc_mantic_movimientos.id_articulo= tc_mantic_inventarios.id_articulo and tc_mantic_movimientos.id_almacen= tc_mantic_inventarios.id_almacen
				inner join 
					tc_mantic_empresas on tc_mantic_almacenes.id_empresa= tc_mantic_empresas.id_empresa
				inner join
					tc_janal_usuarios on tc_mantic_movimientos.id_usuario = tc_janal_usuarios.id_usuario
				inner join
					tc_mantic_personas on tc_janal_usuarios.id_persona = tc_mantic_personas.id_persona
				where
					tc_mantic_movimientos.id_almacen= {idAlmacen}
					and tc_mantic_movimientos.id_articulo= {idArticulo}
				  and date_format(tc_mantic_movimientos.registro, '%Y%m%d')&gt;= '{registro}'
					and tc_mantic_movimientos.id_tipo_movimiento= 6
				order by
					tc_mantic_movimientos.registro desc
			</select>
			<select id="ver">
				select
					tc_mantic_movimientos.id_movimiento as id_key,
					tc_mantic_tipos_movimientos.id_tipo_movimiento,
					tc_mantic_tipos_movimientos.nombre as concepto,
					tc_mantic_empresas.clave,
					tc_mantic_empresas.nombre as nombre_empresa,
					tc_mantic_almacenes.id_almacen,
					tc_mantic_almacenes.nombre as almacen,
					tc_mantic_movimientos.consecutivo,
					tc_mantic_movimientos.id_articulo,
				  (select tc_mantic_articulos_codigos.codigo from tc_mantic_articulos_codigos where tc_mantic_articulos_codigos.id_articulo= tc_mantic_articulos.id_articulo and tc_mantic_articulos_codigos.id_principal= 1 limit 0, 1) as propio,
					tc_mantic_articulos.nombre,
					tc_mantic_movimientos.cantidad,
					tc_mantic_movimientos.stock,
          tc_mantic_movimientos.stock as total,
          tc_mantic_movimientos.stock as inicial,
          0.00 as salidas,
					tc_mantic_movimientos.calculo,
					tc_mantic_movimientos.observaciones,
 					concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) as razon_social,
					tc_mantic_movimientos.registro,
					tc_mantic_movimientos.registro as fecha
				from
					tc_mantic_movimientos
				inner join
					tc_mantic_articulos on tc_mantic_movimientos.id_articulo= tc_mantic_articulos.id_articulo
				inner join 
					tc_mantic_tipos_movimientos on tc_mantic_movimientos.id_tipo_movimiento= tc_mantic_tipos_movimientos.id_tipo_movimiento
				inner join 
					tc_mantic_almacenes on tc_mantic_movimientos.id_almacen= tc_mantic_almacenes.id_almacen
				inner join 
					tc_mantic_empresas on tc_mantic_almacenes.id_empresa= tc_mantic_empresas.id_empresa
				inner join
					tc_janal_usuarios on tc_mantic_movimientos.id_usuario = tc_janal_usuarios.id_usuario
				inner join
					tc_mantic_personas on tc_janal_usuarios.id_persona = tc_mantic_personas.id_persona
				where
					tc_mantic_movimientos.id_movimiento= {idMovimiento}
				order by
					tc_mantic_movimientos.registro desc
			</select>
			<select id="codigos">
        select      
          tc_mantic_articulos_codigos.id_articulo_codigo as id_key,
          tc_mantic_articulos_codigos.codigo,
          if(tc_mantic_articulos_codigos.id_principal= 1, 'SI', if(tc_mantic_articulos_codigos.id_proveedor is null, 'AUXILIAR', 'NO')) as principal,
          tc_mantic_proveedores.id_proveedor,
          tc_mantic_proveedores.clave,
          tc_mantic_proveedores.prefijo,
          tc_mantic_proveedores.razon_social,
          tc_mantic_articulos_codigos.orden,
				  tc_mantic_articulos_codigos.registro
        from      
          tc_mantic_articulos_codigos
        left join 
          tc_mantic_proveedores on tc_mantic_articulos_codigos.id_proveedor= tc_mantic_proveedores.id_proveedor
        where      
          tc_mantic_articulos_codigos.id_articulo = {idArticulo}
				order by
				  tc_mantic_articulos_codigos.orden
			</select>
			<select id="almacenes">
        select      
          tc_mantic_almacenes_articulos.id_almacen_articulo as id_key,
				  tc_mantic_almacenes_ubicaciones.id_almacen_ubicacion,
				  tc_mantic_almacenes.id_almacen,
          tc_mantic_almacenes.clave,
          tc_mantic_almacenes.nombre,
          tc_mantic_almacenes_articulos.id_articulo,
          tc_mantic_almacenes_articulos.stock,
          tc_mantic_almacenes_articulos.minimo,
          tc_mantic_almacenes_articulos.maximo,
          tc_mantic_almacenes_articulos.minimo as min,
          tc_mantic_almacenes_articulos.maximo as max,
          concat(tc_mantic_almacenes_ubicaciones.piso, '=> ', if(tc_mantic_almacenes_ubicaciones.cuarto is null, '', tc_mantic_almacenes_ubicaciones.cuarto), '=> ', if(tc_mantic_almacenes_ubicaciones.anaquel is null, '', tc_mantic_almacenes_ubicaciones.anaquel), '=> ', if(tc_mantic_almacenes_ubicaciones.charola is null, '', tc_mantic_almacenes_ubicaciones.charola)) as ubicacion,
          tc_mantic_almacenes.registro
				from      
          tc_mantic_almacenes_articulos
        inner join 
          tc_mantic_almacenes on tc_mantic_almacenes_articulos.id_almacen= tc_mantic_almacenes.id_almacen
        inner join 
          tc_mantic_almacenes_ubicaciones on tc_mantic_almacenes_articulos.id_almacen_ubicacion= tc_mantic_almacenes_ubicaciones.id_almacen_ubicacion
        where      
          tc_mantic_almacenes_articulos.id_articulo = {idArticulo}
					and (tc_mantic_almacenes_articulos.id_almacen= {idAlmacen} or {idAlmacen}= 0)
				order by
				  tc_mantic_almacenes.clave, tc_mantic_almacenes_ubicaciones.piso, tc_mantic_almacenes_ubicaciones.cuarto, tc_mantic_almacenes_ubicaciones.anaquel, tc_mantic_almacenes_ubicaciones.charola
			</select>
			<select id="localizado">
        select      
          tc_mantic_almacenes_articulos.id_almacen_articulo as id_key,
				  tc_mantic_almacenes_ubicaciones.id_almacen_ubicacion,
				  tc_mantic_almacenes.id_almacen,
          tc_mantic_almacenes.clave,
          tc_mantic_almacenes.nombre,
          tc_mantic_almacenes_articulos.id_articulo,
          tc_mantic_almacenes_articulos.stock,
          tc_mantic_almacenes_articulos.minimo,
          tc_mantic_almacenes_articulos.maximo,
          concat(tc_mantic_almacenes_ubicaciones.piso, '=> ', if(tc_mantic_almacenes_ubicaciones.cuarto is null, '', tc_mantic_almacenes_ubicaciones.cuarto), '=> ', if(tc_mantic_almacenes_ubicaciones.anaquel is null, '', tc_mantic_almacenes_ubicaciones.anaquel), '=> ', if(tc_mantic_almacenes_ubicaciones.charola is null, '', tc_mantic_almacenes_ubicaciones.charola)) as ubicacion,
          tc_mantic_almacenes.registro
				from      
          tc_mantic_almacenes_articulos
        inner join 
          tc_mantic_almacenes on tc_mantic_almacenes_articulos.id_almacen= tc_mantic_almacenes.id_almacen
        inner join 
          tc_mantic_almacenes_ubicaciones on tc_mantic_almacenes_articulos.id_almacen_ubicacion= tc_mantic_almacenes_ubicaciones.id_almacen_ubicacion
        where      
          tc_mantic_almacenes_articulos.id_articulo = {idArticulo}
				order by
				  tc_mantic_almacenes.clave, tc_mantic_almacenes_ubicaciones.piso, tc_mantic_almacenes_ubicaciones.cuarto, tc_mantic_almacenes_ubicaciones.anaquel, tc_mantic_almacenes_ubicaciones.charola
			</select>
			<select id="ubicaciones">
        select      
					tc_mantic_almacenes_ubicaciones.id_almacen_ubicacion as id_key,
					tc_mantic_almacenes.id_almacen,
					tc_mantic_almacenes.clave,
					tc_mantic_almacenes.nombre as almacen,
          tc_mantic_almacenes_ubicaciones.piso,  
				  if(tc_mantic_almacenes_ubicaciones.cuarto is null, '', tc_mantic_almacenes_ubicaciones.cuarto) as cuarto, 
				  if(tc_mantic_almacenes_ubicaciones.anaquel is null, '', tc_mantic_almacenes_ubicaciones.anaquel) as anaquel, 
				  if(tc_mantic_almacenes_ubicaciones.charola is null, '', tc_mantic_almacenes_ubicaciones.charola) as charola
				from
				  tc_mantic_almacenes_ubicaciones 
				inner join
					tc_mantic_almacenes on tc_mantic_almacenes.id_almacen= tc_mantic_almacenes_ubicaciones.id_almacen     
				where
					tc_mantic_almacenes_ubicaciones.id_almacen= {idAlmacen}  
				order by
				  tc_mantic_almacenes.clave, 
				  tc_mantic_almacenes_ubicaciones.piso, 
				  tc_mantic_almacenes_ubicaciones.cuarto, 
				  tc_mantic_almacenes_ubicaciones.anaquel, 
				  tc_mantic_almacenes_ubicaciones.charola
			</select>
			<select id="almacenesDetalle">
        select   
					almacenes.id_almacen as id_key,
          id_almacen_articulo,
					almacenes.*,   
					id_articulo,
					if(stock is null, 0, stock) stock,
					minimo,
					maximo,
					ubicacion,
					registro         
				from (
				select 
					tc_mantic_almacenes.id_almacen,
					tc_mantic_almacenes.clave,
					tc_mantic_almacenes.nombre
				from 
					tc_mantic_almacenes 
				where 
					 id_empresa in ({idEmpresa})) almacenes
				left join 
					(
					select
						tc_mantic_almacenes_articulos.id_almacen_articulo,
						tc_mantic_almacenes.id_almacen,
						tc_mantic_almacenes.clave,
						tc_mantic_almacenes.nombre,
						tc_mantic_almacenes_articulos.id_articulo,
						tc_mantic_almacenes_articulos.stock,
						tc_mantic_almacenes_articulos.minimo,
						tc_mantic_almacenes_articulos.maximo,
						concat(tc_mantic_almacenes_ubicaciones.piso,'=> ',
						if(tc_mantic_almacenes_ubicaciones.cuarto is null,'',tc_mantic_almacenes_ubicaciones.cuarto),'=> ',
						if(tc_mantic_almacenes_ubicaciones.anaquel is null,'',tc_mantic_almacenes_ubicaciones.anaquel),'=> ',
						if(tc_mantic_almacenes_ubicaciones.charola is null,'',tc_mantic_almacenes_ubicaciones.charola)) as ubicacion,
						tc_mantic_almacenes.registro         
					from
						tc_mantic_almacenes 
					left join
						tc_mantic_almacenes_articulos on tc_mantic_almacenes_articulos.id_almacen= tc_mantic_almacenes.id_almacen      
					left join
						tc_mantic_almacenes_ubicaciones on tc_mantic_almacenes_articulos.id_almacen_ubicacion= tc_mantic_almacenes_ubicaciones.id_almacen_ubicacion         
					left join 
						tc_mantic_articulos on tc_mantic_almacenes_articulos.id_articulo = tc_mantic_articulos.id_articulo
					where
						tc_mantic_articulos.id_articulo = {idArticulo}  
					) totales on almacenes.id_almacen = totales.id_almacen				
			</select>
			<select id="notaEntrada">
				select
					tc_mantic_notas_detalles.id_nota_detalle as id_key,
					tc_mantic_proveedores.razon_social,
					tc_mantic_notas_entradas.registro as fecha,
					tc_mantic_notas_entradas.consecutivo,
					tc_mantic_notas_entradas.total,
					(select tc_mantic_articulos_codigos.codigo from tc_mantic_articulos_codigos where tc_mantic_articulos_codigos.id_articulo= tc_mantic_notas_detalles.id_articulo and tc_mantic_articulos_codigos.id_principal= 1 limit 0, 1) as propio,
					tc_mantic_notas_detalles.nombre,
					tc_mantic_notas_detalles.cantidad,
					tc_mantic_notas_detalles.impuestos,
					tc_mantic_notas_detalles.costo as precio,
					tc_mantic_notas_detalles.importe
				from 
					tc_mantic_notas_entradas
				inner join
					tc_mantic_notas_detalles on tc_mantic_notas_entradas.id_nota_entrada= tc_mantic_notas_detalles.id_nota_entrada
				inner join 
					tc_mantic_proveedores on tc_mantic_notas_entradas.id_proveedor= tc_mantic_proveedores.id_proveedor
				where 
					tc_mantic_notas_entradas.id_nota_entrada= {idNotaEntrada}
				order by
					tc_mantic_notas_entradas.registro				
			</select>
			<select id="venta">
				select
					tc_mantic_ventas_detalles.id_venta_detalle as id_key,
					tc_mantic_clientes.razon_social,
					tc_mantic_ventas.registro as fecha,
					tc_mantic_ventas.ticket as consecutivo,
					tc_mantic_ventas.total,
					(select tc_mantic_articulos_codigos.codigo from tc_mantic_articulos_codigos where tc_mantic_articulos_codigos.id_articulo= tc_mantic_ventas_detalles.id_articulo and tc_mantic_articulos_codigos.id_principal= 1 limit 0, 1) as propio,
					tc_mantic_ventas_detalles.nombre,
					tc_mantic_ventas_detalles.cantidad,
					tc_mantic_ventas_detalles.costo as precio,
					tc_mantic_ventas_detalles.impuestos,
					tc_mantic_ventas_detalles.importe
				from 
					tc_mantic_ventas
				inner join
					tc_mantic_ventas_detalles on tc_mantic_ventas.id_venta= tc_mantic_ventas_detalles.id_venta
				inner join 
					tc_mantic_clientes on tc_mantic_ventas.id_cliente= tc_mantic_clientes.id_cliente
				where 
					tc_mantic_ventas.id_venta= {idVenta}
				order by
				  tc_mantic_ventas_detalles.registro				
			</select>
			<select id="devolucion">
				select
					tc_mantic_devoluciones_detalles.id_devolucion_detalle as id_key,
					tc_mantic_proveedores.razon_social,
					tc_mantic_devoluciones.registro as fecha,
					tc_mantic_devoluciones.consecutivo,
					tc_mantic_devoluciones.total,
					(select tc_mantic_articulos_codigos.codigo from tc_mantic_articulos_codigos where tc_mantic_articulos_codigos.id_articulo= tc_mantic_notas_detalles.id_articulo and tc_mantic_articulos_codigos.id_principal= 1 limit 0, 1) as propio,
					tc_mantic_notas_detalles.nombre,
					tc_mantic_devoluciones_detalles.cantidad,
					tc_mantic_notas_detalles.impuestos/ tc_mantic_devoluciones_detalles.cantidad as impuestos,
					tc_mantic_notas_detalles.costo as precio,
					tc_mantic_devoluciones_detalles.cantidad* tc_mantic_notas_detalles.importe as importe
				from 
					tc_mantic_devoluciones
				inner join
					tc_mantic_notas_entradas on tc_mantic_notas_entradas.id_nota_entrada= tc_mantic_devoluciones.id_nota_entrada
				inner join
					tc_mantic_devoluciones_detalles on tc_mantic_devoluciones_detalles.id_devolucion= tc_mantic_devoluciones.id_devolucion
				inner join
					tc_mantic_notas_detalles on tc_mantic_notas_detalles.id_nota_detalle= tc_mantic_devoluciones_detalles.id_nota_detalle
				inner join 
					tc_mantic_proveedores on tc_mantic_notas_entradas.id_proveedor= tc_mantic_proveedores.id_proveedor
				where 
					tc_mantic_devoluciones.id_devolucion= {idDevolucion}
				order by
					tc_mantic_devoluciones_detalles.registro				
			</select>
			<select id="traspaso">
				select
					tc_mantic_transferencias_detalles.id_transferencia_detalle as id_key,
					concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) as razon_social,
					tc_mantic_transferencias.registro as fecha,
					tc_mantic_transferencias.consecutivo,
					0 as total,
					(select tc_mantic_articulos_codigos.codigo from tc_mantic_articulos_codigos where tc_mantic_articulos_codigos.id_articulo= tc_mantic_transferencias_detalles.id_articulo and tc_mantic_articulos_codigos.id_principal= 1 limit 0, 1) as propio,
					tc_mantic_transferencias_detalles.nombre,
					tc_mantic_transferencias_detalles.cantidad,
					0 as impuestos,
					tc_mantic_articulos.precio,
					tc_mantic_transferencias_detalles.cantidad* tc_mantic_articulos.precio as importe,
					tc_mantic_almacenes.nombre as origen,
					(select tc_mantic_almacenes.nombre from tc_mantic_almacenes where tc_mantic_almacenes.id_almacen= tc_mantic_transferencias.id_destino) as destino,
				  tc_mantic_transferencias_detalles.registro
				from 
					tc_mantic_transferencias
				inner join
					tc_mantic_transferencias_detalles on tc_mantic_transferencias_detalles.id_transferencia= tc_mantic_transferencias.id_transferencia
				inner join
					tc_mantic_articulos on tc_mantic_transferencias_detalles.id_articulo= tc_mantic_articulos.id_articulo
				inner join 
					tc_janal_usuarios on tc_mantic_transferencias.id_usuario= tc_janal_usuarios.id_usuario
				inner join
					tc_mantic_personas on tc_janal_usuarios.id_persona= tc_mantic_personas.id_persona
				inner join
					tc_mantic_almacenes on tc_mantic_almacenes.id_almacen= tc_mantic_transferencias.id_almacen
				where 
					tc_mantic_transferencias.id_transferencia= {idTransferencia}				
				order by
					tc_mantic_transferencias_detalles.registro
			</select>
			<select id="garantia">
        select
					tc_mantic_garantias_detalles.id_garantia_detalle as id_key,
					tc_mantic_clientes.razon_social,
					tc_mantic_garantias.registro as fecha,
					tc_mantic_garantias.consecutivo,
					tc_mantic_garantias.total,
					(select tc_mantic_articulos_codigos.codigo from tc_mantic_articulos_codigos where tc_mantic_articulos_codigos.id_articulo= tc_mantic_ventas_detalles.id_articulo and tc_mantic_articulos_codigos.id_principal= 1 limit 0, 1) as propio,
					tc_mantic_ventas_detalles.nombre,
					tc_mantic_garantias_detalles.cantidad,
					tc_mantic_ventas_detalles.costo as precio,
					tc_mantic_garantias_detalles.impuestos,
					tc_mantic_garantias_detalles.importe
				from 
					tc_mantic_garantias
				inner join
					tc_mantic_ventas on tc_mantic_garantias.id_venta= tc_mantic_ventas.id_venta
				inner join
					tc_mantic_garantias_detalles on tc_mantic_garantias.id_garantia= tc_mantic_garantias_detalles.id_garantia
				inner join
					tc_mantic_ventas_detalles on tc_mantic_garantias_detalles.id_venta_detalle= tc_mantic_ventas_detalles.id_venta_detalle
				inner join 
					tc_mantic_clientes on tc_mantic_ventas.id_cliente= tc_mantic_clientes.id_cliente
				where 
					tc_mantic_garantias.id_garantia= {idGarantia}
				order by
					tc_mantic_garantias_detalles.registro				
			</select>
			<select id="conteo">
        select
					tc_mantic_inventarios.id_inventario as id_key,
					concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) as razon_social,
					tc_mantic_inventarios.registro as fecha,
					concat(tc_mantic_inventarios.ejercicio, ' ', tc_mantic_almacenes.nombre) as consecutivo,
					0 as total,
					(select tc_mantic_articulos_codigos.codigo from tc_mantic_articulos_codigos where tc_mantic_articulos_codigos.id_articulo= tc_mantic_inventarios.id_articulo and tc_mantic_articulos_codigos.id_principal= 1 limit 0, 1) as propio,
					tc_mantic_articulos.nombre,
					tc_mantic_inventarios.entradas as cantidad,
					tc_mantic_articulos.precio,
					0 as impuestos,
					0 as importe,
				  tc_mantic_inventarios.registro,
				  tc_mantic_inventarios.inicial,
				  tc_mantic_inventarios.salidas,
				  tc_mantic_inventarios.stock
				from 
					tc_mantic_inventarios
				inner join
					tc_mantic_articulos on tc_mantic_inventarios.id_articulo= tc_mantic_articulos.id_articulo
				inner join 
					tc_janal_usuarios on tc_mantic_inventarios.id_usuario= tc_janal_usuarios.id_usuario
				inner join
					tc_mantic_personas on tc_janal_usuarios.id_persona= tc_mantic_personas.id_persona
				inner join
					tc_mantic_almacenes on tc_mantic_inventarios.id_almacen= tc_mantic_almacenes.id_almacen
				where 
					tc_mantic_inventarios.id_articulo= {idArticulo}
				order by
					tc_mantic_inventarios.registro desc				
			</select>
			<select id="existencias">
    		select
				  tc_mantic_almacenes_articulos.id_articulo, sum(tc_mantic_almacenes_articulos.stock) as total
				from
				  tc_mantic_almacenes
				inner join 
				  tc_mantic_almacenes_articulos on tc_mantic_almacenes.id_almacen= tc_mantic_almacenes_articulos.id_almacen
				where
				  tc_mantic_almacenes.id_empresa in ({sucursales})
				  and tc_mantic_almacenes_articulos.id_articulo= {idArticulo}
				order by
				  tc_mantic_almacenes_articulos.id_articulo				
			</select>	
		</unit>
		<unit id="VistaArticulosDto">
			<select id="conteo">
				select 
				  tc_mantic_articulos.id_articulo as id_key,
				  tc_mantic_articulos.nombre,
				  tc_mantic_articulos.descripcion,
				  tc_mantic_articulos.actualizado,
					(select tc_mantic_articulos_codigos.codigo from tc_mantic_articulos_codigos where tc_mantic_articulos_codigos.id_articulo= tc_mantic_articulos.id_articulo and tc_mantic_articulos_codigos.id_principal= 1 and {condicion} limit 0, 1) as codigo,
				  ifnull(tc_mantic_articulos.id_imagen, 0) as id_imagen,
				  ifnull(tc_mantic_imagenes.alias, ' ') as alias,
				  tc_mantic_inventarios.stock,
				  tc_mantic_inventarios.registro as fecha,
				  tc_mantic_inventarios.registro as hora,
				  tc_mantic_inventarios.ejercicio,
          tc_mantic_inventarios.id_verificado
				from 
					tc_mantic_articulos
				left join
					tc_mantic_imagenes on tc_mantic_articulos.id_imagen = tc_mantic_imagenes.id_imagen
				inner join
				  tc_mantic_inventarios on tc_mantic_articulos.id_articulo= tc_mantic_inventarios.id_articulo and tc_mantic_inventarios.id_almacen= {idAlmacen}
				inner join
					tc_mantic_articulos_codigos on tc_mantic_articulos.id_articulo = tc_mantic_articulos_codigos.id_articulo and tc_mantic_articulos_codigos.id_principal= 1
				inner join 
					tc_mantic_empresas on tc_mantic_articulos.id_empresa = tc_mantic_empresas.id_empresa
				inner join
					tr_mantic_empaque_unidad_medida on tc_mantic_articulos.id_empaque_unidad_medida = tr_mantic_empaque_unidad_medida.id_empaque_unidad_medida
				inner join 
					tc_mantic_empaques on tr_mantic_empaque_unidad_medida.id_empaque = tc_mantic_empaques.id_empaque
				inner join 
					tc_mantic_unidades_medidas on tr_mantic_empaque_unidad_medida.id_unidad_medida = tc_mantic_unidades_medidas.id_unidad_medida
				where 
					tc_mantic_empresas.id_empresa in ({idEmpresa})
			  	and tc_mantic_articulos.id_articulo_tipo= 1
				  and {condicion}					
				group by 
				  tc_mantic_articulos.nombre        
				{sortOrder}
			</select>
			<select id="row">
				select 
				  tc_mantic_articulos.id_articulo as id_key,
				  tc_mantic_articulos.id_vigente,
				  tc_mantic_articulos.nombre,
				  tc_mantic_articulos.descripcion,
				  tc_mantic_articulos.sat,
				  tc_mantic_articulos.precio,
				  tc_mantic_articulos.menudeo,
				  tc_mantic_articulos.medio_mayoreo,
				  tc_mantic_articulos.mayoreo,
				  tc_mantic_articulos.especial,
				  tc_mantic_articulos.iva,
				  tc_mantic_articulos.desperdicio,
				  tc_mantic_articulos.actualizado,
					(select tc_mantic_articulos_codigos.codigo from tc_mantic_articulos_codigos where tc_mantic_articulos_codigos.id_articulo= tc_mantic_articulos.id_articulo and tc_mantic_articulos_codigos.id_principal= 1 and {condicion} limit 0, 1) as propio,
          (select tc_mantic_articulos_codigos.codigo from tc_mantic_articulos_codigos where tc_mantic_articulos_codigos.id_articulo= tc_mantic_articulos.id_articulo and tc_mantic_articulos_codigos.id_proveedor is null and tc_mantic_articulos_codigos.orden= 2 and tc_mantic_articulos_codigos.id_principal= 2 limit 0, 1) as auxiliar,
				  if(tc_mantic_articulos.id_facturama is null, -1, tc_mantic_articulos.id_facturama) id_facturama,
				  ifnull(tc_mantic_articulos.id_imagen, 0) as id_imagen,
				  sum(ifnull(tc_mantic_almacenes_articulos.stock, 0)) as stock,
				  ifnull(tc_mantic_imagenes.alias, ' ') as alias,
				  tc_mantic_articulos.id_redondear
				from 
					tc_mantic_articulos
				left join
					tc_mantic_imagenes on tc_mantic_articulos.id_imagen = tc_mantic_imagenes.id_imagen
				left join
				  tc_mantic_almacenes_articulos on tc_mantic_articulos.id_articulo= tc_mantic_almacenes_articulos.id_articulo {almacen}
				inner join
					tc_mantic_articulos_codigos on tc_mantic_articulos.id_articulo = tc_mantic_articulos_codigos.id_articulo and tc_mantic_articulos_codigos.id_principal= 1
				inner join 
					tc_mantic_empresas on tc_mantic_articulos.id_empresa = tc_mantic_empresas.id_empresa
				inner join
					tr_mantic_empaque_unidad_medida on tc_mantic_articulos.id_empaque_unidad_medida = tr_mantic_empaque_unidad_medida.id_empaque_unidad_medida
				inner join 
					tc_mantic_empaques on tr_mantic_empaque_unidad_medida.id_empaque = tc_mantic_empaques.id_empaque
				inner join 
					tc_mantic_unidades_medidas on tr_mantic_empaque_unidad_medida.id_unidad_medida = tc_mantic_unidades_medidas.id_unidad_medida
				where 
					tc_mantic_empresas.id_empresa in ({idEmpresa})
				  and {condicion}					
				group by 
					tc_mantic_articulos.id_vigente,
				  tc_mantic_articulos.nombre,          
				  tc_mantic_articulos.menudeo,          
				  tc_mantic_articulos.medio_mayoreo,          
				  tc_mantic_articulos.mayoreo,          
				  tc_mantic_articulos.iva,          
				  tc_mantic_articulos.desperdicio          
				{sortOrder}
			</select>
			<select id="lazy">
				select 
				  tc_mantic_articulos.id_articulo as id_key,
				  tc_mantic_articulos.id_vigente,
				  tc_mantic_articulos.nombre,
				  tc_mantic_articulos.descripcion,
				  tc_mantic_articulos.sat,
				  tc_mantic_articulos.precio,
				  tc_mantic_articulos.menudeo,
				  tc_mantic_articulos.medio_mayoreo,
				  tc_mantic_articulos.mayoreo,
				  tc_mantic_articulos.iva,
					(select tc_mantic_articulos_codigos.codigo from tc_mantic_articulos_codigos where tc_mantic_articulos_codigos.id_articulo= tc_mantic_articulos.id_articulo and tc_mantic_articulos_codigos.id_principal= 1 and {codigos} limit 0, 1) as propio,
				  ifnull(tc_mantic_articulos.id_imagen, 0) as id_imagen,
				  ifnull(tc_mantic_imagenes.alias, ' ') as alias,
          if({porcentaje}= -1, tc_mantic_articulos.menudeo, round(tc_mantic_articulos.precio* (1+ (tc_mantic_articulos.iva/100))* (1+ ({porcentaje}/ 100)), 4)) as especial
				from 
					tc_mantic_articulos
				left join
					tc_mantic_imagenes on tc_mantic_articulos.id_imagen = tc_mantic_imagenes.id_imagen
				inner join
					tc_mantic_articulos_codigos on tc_mantic_articulos.id_articulo = tc_mantic_articulos_codigos.id_articulo and tc_mantic_articulos_codigos.id_principal= 1
				inner join 
					tc_mantic_empresas on tc_mantic_articulos.id_empresa = tc_mantic_empresas.id_empresa
				inner join
					tr_mantic_empaque_unidad_medida on tc_mantic_articulos.id_empaque_unidad_medida = tr_mantic_empaque_unidad_medida.id_empaque_unidad_medida
				inner join 
					tc_mantic_empaques on tr_mantic_empaque_unidad_medida.id_empaque = tc_mantic_empaques.id_empaque
				inner join 
					tc_mantic_unidades_medidas on tr_mantic_empaque_unidad_medida.id_unidad_medida = tc_mantic_unidades_medidas.id_unidad_medida
				where 
					tc_mantic_empresas.id_empresa in ({idEmpresa})
				  and {condicion}					
				group by 
					tc_mantic_articulos.id_vigente,
				  tc_mantic_articulos.nombre,          
				  tc_mantic_articulos.menudeo,          
				  tc_mantic_articulos.medio_mayoreo,          
				  tc_mantic_articulos.mayoreo,          
				  tc_mantic_articulos.iva,          
				  tc_mantic_articulos.desperdicio          
				{sortOrder}
			</select>
			<select id="exportar">
				select 				  
					tc_mantic_articulos_codigos.codigo,
  				(select tc_mantic_articulos_codigos.codigo from tc_mantic_articulos_codigos where tc_mantic_articulos_codigos.id_articulo= tc_mantic_articulos.id_articulo and tc_mantic_articulos_codigos.id_proveedor is null and tc_mantic_articulos_codigos.orden= 2 and tc_mantic_articulos_codigos.id_principal= 2 limit 0, 1) as "codigo auxiliar", 
				  tc_mantic_articulos.nombre,
				  tc_mantic_articulos.precio as "costo s/iva",
				  tc_mantic_articulos.menudeo as "menudeo neto",
				  tc_mantic_articulos.medio_mayoreo as "medio neto",
				  tc_mantic_articulos.mayoreo as "mayoreo neto",
				  tc_mantic_articulos.especial as "especial neto",
					tc_mantic_unidades_medidas.nombre as "unidad medida",
					tc_mantic_articulos.iva,				  
				  tc_mantic_articulos.limite_medio_mayoreo as "limite menudeo",
				  tc_mantic_articulos.limite_mayoreo as "limite mayoreo",
				  tc_mantic_articulos.minimo as "stock minimo",
				  tc_mantic_articulos.maximo as "stock maximo",
					tc_mantic_articulos.sat,
				  tc_mantic_articulos.fabricante as "codigo fabricante",
					tc_mantic_articulos.actualizado
				from 
					tc_mantic_articulos
				left join
					tc_mantic_imagenes on tc_mantic_articulos.id_imagen = tc_mantic_imagenes.id_imagen
				left join
				  tc_mantic_almacenes_articulos on tc_mantic_articulos.id_articulo= tc_mantic_almacenes_articulos.id_articulo {almacen}
				inner join
					tc_mantic_articulos_codigos on tc_mantic_articulos.id_articulo = tc_mantic_articulos_codigos.id_articulo and tc_mantic_articulos_codigos.id_principal= 1
				inner join 
					tc_mantic_empresas on tc_mantic_articulos.id_empresa = tc_mantic_empresas.id_empresa
				inner join
					tr_mantic_empaque_unidad_medida on tc_mantic_articulos.id_empaque_unidad_medida = tr_mantic_empaque_unidad_medida.id_empaque_unidad_medida
				inner join 
					tc_mantic_empaques on tr_mantic_empaque_unidad_medida.id_empaque = tc_mantic_empaques.id_empaque
				inner join 
					tc_mantic_unidades_medidas on tr_mantic_empaque_unidad_medida.id_unidad_medida = tc_mantic_unidades_medidas.id_unidad_medida
				where 
					tc_mantic_empresas.id_empresa in ({idEmpresa})
				  and {condicion}					
				group by 
					tc_mantic_articulos_codigos.codigo,
				  tc_mantic_articulos.nombre,
				  tc_mantic_articulos.precio,
				  tc_mantic_articulos.menudeo,
				  tc_mantic_articulos.medio_mayoreo,
				  tc_mantic_articulos.mayoreo,
					tc_mantic_unidades_medidas.nombre,
					tc_mantic_articulos.iva,				  
				  tc_mantic_articulos.limite_medio_mayoreo,
				  tc_mantic_articulos.limite_mayoreo,
				  tc_mantic_articulos.minimo,
				  tc_mantic_articulos.maximo,
					tc_mantic_articulos.sat,
					tc_mantic_articulos.actualizado
				{sortOrder}
			</select>
			<select id="detalle">
				select 
				  tc_mantic_articulos.id_articulo as id_key,
					tc_mantic_articulos.id_articulo,
				  tc_mantic_articulos.nombre,          
				  tc_mantic_articulos.menudeo,          
				  tc_mantic_articulos.medio_mayoreo,          
				  tc_mantic_articulos.limite_medio_mayoreo,          
				  tc_mantic_articulos.mayoreo,          
				  tc_mantic_articulos.limite_mayoreo,          
				  tc_mantic_articulos.especial,          
				  tc_mantic_articulos.stock,       
				  tc_mantic_articulos.peso_estimado,       
				  tc_mantic_articulos.precio,       
				  tc_mantic_articulos.iva,          
				  tc_mantic_articulos.desperdicio,
					tc_mantic_articulos_codigos.codigo,
					tc_mantic_unidades_medidas.nombre unidad_medida,
					tc_mantic_empaques.nombre empaque
				from 
					tc_mantic_articulos
				inner join
					tc_mantic_articulos_codigos on tc_mantic_articulos.id_articulo = tc_mantic_articulos_codigos.id_articulo and tc_mantic_articulos_codigos.id_principal= 1
				inner join 
					tc_mantic_empresas on tc_mantic_articulos.id_empresa = tc_mantic_empresas.id_empresa
				inner join
					tr_mantic_empaque_unidad_medida on tc_mantic_articulos.id_empaque_unidad_medida = tr_mantic_empaque_unidad_medida.id_empaque_unidad_medida
				inner join 
					tc_mantic_empaques on tr_mantic_empaque_unidad_medida.id_empaque = tc_mantic_empaques.id_empaque
				inner join 
					tc_mantic_unidades_medidas on tr_mantic_empaque_unidad_medida.id_unidad_medida = tc_mantic_unidades_medidas.id_unidad_medida				
				where 
					tc_mantic_articulos.id_articulo = {idArticulo}				
			</select>
			<select id="informativo">
				select 
				  tc_mantic_articulos.id_articulo as id_key,
					tc_mantic_articulos.id_articulo,
				  tc_mantic_articulos.nombre,          
				  tc_mantic_articulos.menudeo,          
				  tc_mantic_articulos.medio_mayoreo,          
				  tc_mantic_articulos.limite_medio_mayoreo,          
				  tc_mantic_articulos.mayoreo,          
				  tc_mantic_articulos.limite_mayoreo,          
				  tc_mantic_articulos.especial,          
				  tc_mantic_almacenes_articulos.stock,       
				  tc_mantic_articulos.peso_estimado,       
				  tc_mantic_articulos.precio,       
				  tc_mantic_articulos.iva,          
				  tc_mantic_articulos.desperdicio,
					tc_mantic_articulos_codigos.codigo,
					tc_mantic_unidades_medidas.nombre unidad_medida,
					tc_mantic_empaques.nombre empaque,
					tc_mantic_almacenes_ubicaciones.piso, 
					tc_mantic_almacenes_ubicaciones.cuarto,
					tc_mantic_almacenes_ubicaciones.anaquel,
					tc_mantic_almacenes_ubicaciones.charola
				from 
					tc_mantic_articulos
				inner join
					tc_mantic_articulos_codigos on tc_mantic_articulos.id_articulo = tc_mantic_articulos_codigos.id_articulo and tc_mantic_articulos_codigos.id_principal= 1
				inner join 
					tc_mantic_empresas on tc_mantic_articulos.id_empresa = tc_mantic_empresas.id_empresa
				inner join
					tr_mantic_empaque_unidad_medida on tc_mantic_articulos.id_empaque_unidad_medida = tr_mantic_empaque_unidad_medida.id_empaque_unidad_medida
				inner join 
					tc_mantic_empaques on tr_mantic_empaque_unidad_medida.id_empaque = tc_mantic_empaques.id_empaque
				inner join 
					tc_mantic_unidades_medidas on tr_mantic_empaque_unidad_medida.id_unidad_medida = tc_mantic_unidades_medidas.id_unidad_medida
				left join 
					tc_mantic_almacenes_articulos on tc_mantic_articulos.id_articulo = tc_mantic_almacenes_articulos.id_articulo and tc_mantic_almacenes_articulos.id_almacen= {idAlmacen}
				left join 
					tc_mantic_almacenes_ubicaciones on tc_mantic_almacenes_articulos.id_almacen_ubicacion = tc_mantic_almacenes_ubicaciones.id_almacen_ubicacion
				where 
					tc_mantic_articulos.id_articulo = {idArticulo}				
			</select>
			<select id="inventario">
				select 
				  tc_mantic_articulos.id_articulo as id_key,
				  tc_mantic_articulos.nombre,          
				  tc_mantic_articulos.menudeo,          
				  tc_mantic_articulos.medio_mayoreo,          
				  tc_mantic_articulos.mayoreo,          
				  tc_mantic_articulos.especial,          
				  tc_mantic_articulos.stock,       
				  tc_mantic_articulos.iva,          
				  tc_mantic_articulos.desperdicio,
					tc_mantic_articulos_codigos.codigo          
				from 
					tc_mantic_articulos
				inner join
					tc_mantic_articulos_codigos on tc_mantic_articulos.id_articulo = tc_mantic_articulos_codigos.id_articulo
				inner join 
					tc_mantic_empresas on tc_mantic_articulos.id_empresa = tc_mantic_empresas.id_empresa
				inner join
					tr_mantic_empaque_unidad_medida on tc_mantic_articulos.id_empaque_unidad_medida = tr_mantic_empaque_unidad_medida.id_empaque_unidad_medida
				inner join 
					tc_mantic_empaques on tr_mantic_empaque_unidad_medida.id_empaque = tc_mantic_empaques.id_empaque
				inner join 
					tc_mantic_unidades_medidas on tr_mantic_empaque_unidad_medida.id_unidad_medida = tc_mantic_unidades_medidas.id_unidad_medida
				where 
					tc_mantic_empresas.id_empresa = {idEmpresa}
				and 
					(upper(tc_mantic_articulos_codigos.codigo) like upper('%{codigo}%')
				or
					upper(tc_mantic_articulos.nombre) like upper('%{nombre}%'))
				group by 
				  tc_mantic_articulos.nombre,          
				  tc_mantic_articulos.menudeo,          
				  tc_mantic_articulos.medio_mayoreo,          
				  tc_mantic_articulos.mayoreo,          
				  tc_mantic_articulos.stock,          
				  tc_mantic_articulos.iva,          
				  tc_mantic_articulos.desperdicio,
					tc_mantic_articulos_codigos.codigo         
			</select>
			<select id="barras">
        select 
				  tc_mantic_articulos.id_articulo as id_key,
				  tc_mantic_articulos.id_articulo,
				  (select tc_mantic_articulos_codigos.codigo from tc_mantic_articulos_codigos where tc_mantic_articulos_codigos.id_articulo= tc_mantic_notas_detalles.id_articulo and tc_mantic_articulos_codigos.id_principal= 1 limit 0, 1) as propio,
				  tc_mantic_articulos.nombre,
				  1 as cantidad,
				  tc_mantic_notas_detalles.cantidad as tope
				from
				  tc_mantic_notas_entradas
				inner join
				  tc_mantic_notas_detalles on tc_mantic_notas_entradas.id_nota_entrada= tc_mantic_notas_detalles.id_nota_entrada
				inner join
				  tc_mantic_articulos on tc_mantic_notas_detalles.id_articulo= tc_mantic_articulos.id_articulo
				where
				  tc_mantic_notas_entradas.id_nota_entrada= {idNotaEntrada}
				  and tc_mantic_articulos.id_barras= {idBarras}
				order by
				  tc_mantic_articulos.nombre
			</select>
			<select id="imagen">
        select 
				  tc_mantic_articulos.id_articulo as id_key,
				  tc_mantic_articulos.id_articulo,
				  (select tc_mantic_articulos_codigos.codigo from tc_mantic_articulos_codigos where tc_mantic_articulos_codigos.id_articulo= tc_mantic_articulos.id_articulo and tc_mantic_articulos_codigos.id_principal= 1 limit 0, 1) as propio,
				  tc_mantic_articulos.nombre,
				  ifnull(tc_mantic_imagenes.id_imagen, 0) as id_imagen,
				  ifnull(tc_mantic_imagenes.nombre, ' ') as imagen,
				  ifnull(tc_mantic_imagenes.alias, ' ') as alias,
				  concat(tc_mantic_articulos.id_empresa, '/', ifnull(tc_mantic_imagenes.archivo, ' ')) as archivo
				from
				  tc_mantic_articulos
        left join 
					tc_mantic_imagenes on tc_mantic_articulos.id_imagen = tc_mantic_imagenes.id_imagen
				where
				  tc_mantic_articulos.id_articulo= {idArticulo}
				order by
				  tc_mantic_articulos.nombre
			</select>
			<select id="facturama">
				select 
					tc_mantic_articulos.id_articulo as id,
					tc_mantic_articulos.id_facturama,
					(select tc_mantic_articulos_codigos.codigo from tc_mantic_articulos_codigos where tc_mantic_articulos_codigos.id_articulo= tc_mantic_articulos.id_articulo and tc_mantic_articulos_codigos.id_principal= 1 limit 0, 1) as identificador,
					tc_mantic_unidades_medidas.nombre unidad,
					tc_mantic_unidades_medidas.clave codigo,
					tc_mantic_articulos.nombre,
					tc_mantic_articulos.descripcion,
					tc_mantic_articulos.sat codigo_hacienda,
					tc_mantic_articulos.menudeo precio,    
					tc_mantic_articulos.iva
				from 
					tc_mantic_articulos
				inner join
					tc_mantic_articulos_codigos on tc_mantic_articulos.id_articulo = tc_mantic_articulos_codigos.id_articulo
				inner join
					tr_mantic_empaque_unidad_medida on tc_mantic_articulos.id_empaque_unidad_medida = tr_mantic_empaque_unidad_medida.id_empaque_unidad_medida
				inner join 
					tc_mantic_empaques on tr_mantic_empaque_unidad_medida.id_empaque = tc_mantic_empaques.id_empaque
				inner join 
					tc_mantic_unidades_medidas on tr_mantic_empaque_unidad_medida.id_unidad_medida = tc_mantic_unidades_medidas.id_unidad_medida
				where 
					{condicion}
				group by 
					tc_mantic_articulos.id_articulo,
					tc_mantic_articulos.id_facturama,  
					tc_mantic_unidades_medidas.nombre,
					tc_mantic_unidades_medidas.clave,
					tc_mantic_articulos.nombre,
					tc_mantic_articulos.descripcion,
					tc_mantic_articulos.sat,
					tc_mantic_articulos.menudeo,    
					tc_mantic_articulos.iva
			</select>
			<select id="facturamaCfdiVenta">
				select 
					tc_mantic_articulos.id_articulo as id,
					tc_mantic_articulos.id_facturama,
					(select tc_mantic_articulos_codigos.codigo from tc_mantic_articulos_codigos where tc_mantic_articulos_codigos.id_articulo= tc_mantic_articulos.id_articulo and tc_mantic_articulos_codigos.id_principal= 1 limit 0, 1) as identificador,
					tc_mantic_unidades_medidas.nombre unidad,
					tc_mantic_unidades_medidas.clave codigo,
					tc_mantic_ventas_detalles.nombre,
					tc_mantic_articulos.descripcion,
					tc_mantic_ventas_detalles.sat as codigo_hacienda,
					round(tc_mantic_ventas_detalles.unitario_sin_iva, 2) as precio,    
				  round(tc_mantic_ventas_detalles.cantidad, 2) as cantidad,
				  round(tc_mantic_ventas_detalles.sub_total, 2) as subtotal,
				  round(tc_mantic_ventas_detalles.importe, 2) as total,
					tc_mantic_ventas_detalles.iva,
					round(tc_mantic_ventas_detalles.impuestos, 2) as impuestos,
          tc_mantic_articulos_impuestos.codigo as codigo_impuesto
				from 
					tc_mantic_ventas_detalles
				inner join
					tc_mantic_articulos on tc_mantic_ventas_detalles.id_articulo = tc_mantic_articulos.id_articulo
				inner join
					tc_mantic_articulos_impuestos on tc_mantic_articulos.id_articulo_impuesto= tc_mantic_articulos_impuestos.id_articulo_impuesto
				inner join
					tc_mantic_articulos_codigos on tc_mantic_articulos.id_articulo = tc_mantic_articulos_codigos.id_articulo
				inner join
					tr_mantic_empaque_unidad_medida on tc_mantic_articulos.id_empaque_unidad_medida = tr_mantic_empaque_unidad_medida.id_empaque_unidad_medida
				inner join 
					tc_mantic_empaques on tr_mantic_empaque_unidad_medida.id_empaque = tc_mantic_empaques.id_empaque
				inner join 
					tc_mantic_unidades_medidas on tr_mantic_empaque_unidad_medida.id_unidad_medida = tc_mantic_unidades_medidas.id_unidad_medida
				where 
					{condicion}
				group by 
					tc_mantic_articulos.id_articulo,
					tc_mantic_articulos.id_facturama,
					tc_mantic_unidades_medidas.nombre,
					tc_mantic_unidades_medidas.clave,
					tc_mantic_ventas_detalles.nombre,
					tc_mantic_articulos.descripcion,
					tc_mantic_ventas_detalles.sat,
					tc_mantic_ventas_detalles.costo,    
				  tc_mantic_ventas_detalles.cantidad,
				  tc_mantic_ventas_detalles.sub_total,
				  tc_mantic_ventas_detalles.importe,
					tc_mantic_ventas_detalles.iva
			</select>
			<select id="detalleCfdi">
				select 
					tc_mantic_articulos.id_articulo as id,
					tc_mantic_articulos.id_facturama,
					(select tc_mantic_articulos_codigos.codigo from tc_mantic_articulos_codigos where tc_mantic_articulos_codigos.id_articulo= tc_mantic_articulos.id_articulo and tc_mantic_articulos_codigos.id_principal= 1 limit 0, 1) as identificador,
					tc_mantic_unidades_medidas.nombre unidad,
					tc_mantic_unidades_medidas.clave codigo,
					tc_mantic_ventas_detalles.nombre,
					tc_mantic_articulos.descripcion,
					tc_mantic_ventas_detalles.sat codigo_hacienda,
					round(tc_mantic_ventas_detalles.unitario_sin_iva, 2) as precio,    
				  round(tc_mantic_ventas_detalles.cantidad, 2) as cantidad,
				  round(tc_mantic_ventas_detalles.sub_total, 2) as subtotal,
				  round(tc_mantic_ventas_detalles.importe, 2) as total,
					tc_mantic_ventas_detalles.iva,
				  round(tc_mantic_ventas_detalles.impuestos, 2) as impuestos,
          tc_mantic_articulos_impuestos.codigo as codigo_impuesto
				from 
					tc_mantic_ventas_detalles
				inner join
					tc_mantic_articulos on tc_mantic_ventas_detalles.id_articulo= tc_mantic_articulos.id_articulo
				inner join
					tc_mantic_articulos_impuestos on tc_mantic_articulos.id_articulo_impuesto= tc_mantic_articulos_impuestos.id_articulo_impuesto
				inner join
					tc_mantic_articulos_codigos on tc_mantic_articulos.id_articulo= tc_mantic_articulos_codigos.id_articulo
				inner join
					tr_mantic_empaque_unidad_medida on tc_mantic_articulos.id_empaque_unidad_medida= tr_mantic_empaque_unidad_medida.id_empaque_unidad_medida
				inner join 
					tc_mantic_empaques on tr_mantic_empaque_unidad_medida.id_empaque= tc_mantic_empaques.id_empaque
				inner join 
					tc_mantic_unidades_medidas on tr_mantic_empaque_unidad_medida.id_unidad_medida= tc_mantic_unidades_medidas.id_unidad_medida
				where 
					{condicion}
				group by 
					tc_mantic_articulos.id_articulo,
					tc_mantic_articulos.id_facturama,
					tc_mantic_unidades_medidas.nombre,
					tc_mantic_unidades_medidas.clave,
					tc_mantic_ventas_detalles.nombre,
					tc_mantic_articulos.descripcion,
					tc_mantic_ventas_detalles.sat,
					tc_mantic_ventas_detalles.costo,    
				  tc_mantic_ventas_detalles.cantidad,
				  tc_mantic_ventas_detalles.sub_total,
				  tc_mantic_ventas_detalles.importe,
					tc_mantic_ventas_detalles.iva
			</select>
			<select id="existeCodigo">
        select      
          tc_mantic_articulos.id_articulo as id_key,
          tc_mantic_articulos_codigos.codigo,
			  	if(tc_mantic_articulos_codigos.id_principal= 1, 'PRINCIPAL', 'AUXILIAR') as principal,
          tc_mantic_articulos.nombre
        from      
          tc_mantic_articulos_codigos
				inner join
				  tc_mantic_articulos on tc_mantic_articulos_codigos.id_articulo= tc_mantic_articulos.id_articulo
        where      
          tc_mantic_articulos_codigos.codigo = '{codigo}' 
          and tc_mantic_articulos_codigos.id_proveedor is null
				  and {condicion}
			</select>
		</unit>
		<unit id="VistaEmpaqueUnidadMedidaDto">
			<select id="empaqueUnidadMedida">
				select 
					tr_mantic_empaque_unidad_medida.id_empaque_unidad_medida as id_key,
					tc_mantic_unidades_medidas.nombre,
					tc_mantic_unidades_medidas.clave,
					tc_mantic_unidades_medidas.descripcion,
					tc_mantic_unidades_medidas.proporcion
				from
				  tr_mantic_empaque_unidad_medida
				inner join 
					tc_mantic_unidades_medidas on tr_mantic_empaque_unidad_medida.id_unidad_medida = tc_mantic_unidades_medidas.id_unidad_medida
				where 
					id_empaque= {idEmpaque}
			</select>
		</unit>
		<unit id="VistaProveedoresDto">
			<select id="lazy">
				select 
					tc_mantic_proveedores.id_proveedor as id_key,
					tc_mantic_proveedores.clave,
					tc_mantic_proveedores.rfc,
					tc_mantic_proveedores.razon_social,
					tc_mantic_tipos_proveedores.nombre as tipo_proveedor,
					tc_mantic_proveedores.dias_entrega,
					tc_mantic_tipos_dias.nombre as tipo_dia,
					tc_mantic_proveedores.descuento,
					tr_mantic_proveedor_tipo_contacto.valor telefono,
					concat(tc_mantic_personas.nombres,' ',tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) agente,
					tr_mantic_persona_tipo_contacto.valor celular
				from   
					 tc_mantic_proveedores
				inner join
					 tc_mantic_tipos_proveedores on  tc_mantic_tipos_proveedores.id_tipo_proveedor= tc_mantic_proveedores.id_tipo_proveedor
				inner  join
					 tc_mantic_tipos_dias on tc_mantic_tipos_dias.id_tipo_dia=tc_mantic_proveedores.id_tipo_dia   
				left join
					 tr_mantic_proveedor_tipo_contacto on tc_mantic_proveedores.id_proveedor = tr_mantic_proveedor_tipo_contacto.id_proveedor and id_tipo_contacto &lt;= 1 and orden =1
				left join
					tr_mantic_proveedor_agente on tc_mantic_proveedores.id_proveedor = tr_mantic_proveedor_agente.id_proveedor and tr_mantic_proveedor_agente.id_principal= 1
				left join
					tc_mantic_personas on tr_mantic_proveedor_agente.id_agente = tc_mantic_personas.id_persona
				left join
					tr_mantic_persona_tipo_contacto on tc_mantic_personas.id_persona= tr_mantic_persona_tipo_contacto.id_persona and tr_mantic_persona_tipo_contacto.id_tipo_contacto &lt;= 6 and tr_mantic_persona_tipo_contacto.orden =1         
				where
					tc_mantic_proveedores.id_empresa in ({idEmpresa})    
          and tc_mantic_proveedores.id_proveedor> 0
			    and {condicion}        
				{sortOrder}
			</select>
			<select id="portal">
				select 
					tc_mantic_proveedores.id_proveedor as id_key,
					tc_mantic_proveedores.clave,
					tc_mantic_proveedores.rfc,
					tc_mantic_proveedores.razon_social,
					tc_mantic_tipos_proveedores.nombre as tipo_proveedor,
					tc_mantic_proveedores.dias_entrega,
					tc_mantic_tipos_dias.nombre as tipo_dia,
					tc_mantic_proveedores.descuento  
				 from   
					 tc_mantic_proveedores
				 inner join
					 tc_mantic_tipos_proveedores   on  tc_mantic_tipos_proveedores.id_tipo_proveedor= tc_mantic_proveedores.id_tipo_proveedor
				 inner  join
					 tc_mantic_tipos_dias  on tc_mantic_tipos_dias.id_tipo_dia=tc_mantic_proveedores.id_tipo_dia             
				 where
					 upper(tc_mantic_proveedores.razon_social) like upper('%{codigo}%')
					or
					 (upper(tc_mantic_proveedores.rfc) like upper('%{codigo}%') or upper(tc_mantic_proveedores.rfc is null))
					or
					 upper(tc_mantic_proveedores.clave like '%{codigo}%')
					and
						tc_mantic_proveedores.id_empresa in ({sucursales})
			</select>
			<select id="proveedorCondicionPago">
				select 
						tc_mantic_tipos_pagos.id_tipo_pago,
						tc_mantic_tipos_pagos.id_tipo_pago as id_key,            
						tc_mantic_tipos_pagos.nombre as nombre_pago,
						tc_mantic_tipos_formas_pagos.clave,
						tc_mantic_tipos_formas_pagos.nombre
				from 
					tc_mantic_tipos_pagos
				inner join 
					tc_mantic_tipos_formas_pagos on tc_mantic_tipos_formas_pagos.id_tipo_medio_pago=tc_mantic_tipos_pagos.id_tipo_medio_pago              
			</select>  
			 <select id="direccionProveedor">
				select 
				tc_janal_entidades.id_entidad,tc_janal_municipios.id_municipio,tc_janal_localidades.id_localidad, tc_janal_entidades.id_entidad as id_key
			from 
				tc_janal_entidades 
			inner join
				tc_janal_municipios  on tc_janal_municipios.id_entidad=tc_janal_entidades.id_entidad
			inner join    
				tc_janal_localidades on tc_janal_localidades.id_municipio=tc_janal_municipios.id_municipio
			 inner join
				tc_mantic_domicilios on tc_mantic_domicilios.id_localidad=tc_janal_localidades.id_localidad
			 where 
				tc_mantic_domicilios.id_domicilio={idDomicilio}
			</select>            
		</unit> 
		<unit id="VistaClientesDto"> 
      <select id="tickets">
				select
					tc_mantic_ventas_detalles.id_venta_detalle as id_key,
          tc_mantic_ventas.id_venta,
					tc_mantic_clientes.razon_social,
					tc_mantic_ventas.registro,
					tc_mantic_ventas.ticket as consecutivo,
					tc_mantic_ventas.total,
					(select tc_mantic_articulos_codigos.codigo from tc_mantic_articulos_codigos where tc_mantic_articulos_codigos.id_articulo= tc_mantic_ventas_detalles.id_articulo and tc_mantic_articulos_codigos.id_principal= 1 limit 0, 1) as propio,
					tc_mantic_ventas_detalles.nombre,
					tc_mantic_ventas_detalles.cantidad,
					tc_mantic_ventas_detalles.costo as precio,
					tc_mantic_ventas_detalles.impuestos,
					tc_mantic_ventas_detalles.importe,
          tc_mantic_ventas.observaciones,
          0 as total_final
				from 
					tc_mantic_ventas
				left join
					tc_mantic_ventas_detalles on tc_mantic_ventas.id_venta= tc_mantic_ventas_detalles.id_venta
				left join 
					tc_mantic_clientes on tc_mantic_ventas.id_cliente= tc_mantic_clientes.id_cliente
				where 
					tc_mantic_ventas.id_venta in ({ventas})
				order by
				  tc_mantic_ventas.id_venta, tc_mantic_ventas_detalles.registro	desc
      </select>
			<select id="eliminarPagos">
        select 
          tc_mantic_clientes_pagos.id_cliente_pago as id_key,
          tc_mantic_clientes_pagos_controles.id_cliente_pago_control,
          tc_mantic_clientes_pagos.id_cliente_pago,
          tc_mantic_clientes_deudas.id_cliente_deuda,
          tc_mantic_clientes_deudas.id_cliente,
          tc_mantic_clientes_pagos_controles.pago,
          tc_mantic_clientes_pagos.pago as abonado
        from
          tc_mantic_clientes_pagos_controles
        inner join
          tc_mantic_clientes_pagos on tc_mantic_clientes_pagos_controles.id_cliente_pago_control= tc_mantic_clientes_pagos.id_cliente_pago_control
        inner join
          tc_mantic_clientes_deudas on tc_mantic_clientes_pagos.id_cliente_deuda= tc_mantic_clientes_deudas.id_cliente_deuda
        where 
          tc_mantic_clientes_pagos_controles.id_cliente_pago_control= {idClientePagoControl}
        order by
          tc_mantic_clientes_pagos.registro desc
      </select>  
			<select id="detallePagosRealizados">
        select 
          tc_mantic_clientes_pagos.id_cliente_pago as id_key,
          tc_mantic_clientes.id_cliente,
          tc_mantic_ventas.ticket,
          tc_mantic_clientes_deudas.importe as venta,
          tc_mantic_clientes_pagos.pago as abonado,
          tc_mantic_tipos_medios_pagos.nombre as tipo_medio_pago,
          tc_mantic_bancos.nombre as banco,
          tc_mantic_clientes_pagos.referencia,
          ifnull(tc_mantic_clientes_pagos_controles.observaciones, ' ') as observaciones,
          tc_mantic_clientes_pagos.comentarios,
          tc_mantic_clientes_estatus.nombre as estatus
        from
          tc_mantic_clientes_pagos_controles
        inner join
          tc_mantic_clientes_pagos on tc_mantic_clientes_pagos_controles.id_cliente_pago_control= tc_mantic_clientes_pagos.id_cliente_pago_control
        inner join
          tc_janal_usuarios on tc_mantic_clientes_pagos_controles.id_usuario= tc_janal_usuarios.id_usuario
        inner join
          tc_mantic_clientes_deudas on tc_mantic_clientes_pagos.id_cliente_deuda= tc_mantic_clientes_deudas.id_cliente_deuda
        inner join
          tc_mantic_clientes on tc_mantic_clientes_deudas.id_cliente= tc_mantic_clientes.id_cliente
        inner join
          tc_mantic_clientes_estatus on tc_mantic_clientes_deudas.id_cliente_estatus= tc_mantic_clientes_estatus.id_cliente_estatus
        inner join
          tc_mantic_personas on tc_janal_usuarios.id_persona= tc_mantic_personas.id_persona 
        inner join
          tc_mantic_ventas on tc_mantic_clientes_deudas.id_venta= tc_mantic_ventas.id_venta
        left join
          tc_mantic_bancos on tc_mantic_clientes_pagos.id_banco= tc_mantic_bancos.id_banco
        left join
          tc_mantic_tipos_medios_pagos on tc_mantic_clientes_pagos.id_tipo_medio_pago= tc_mantic_tipos_medios_pagos.id_tipo_medio_pago
        where
          tc_mantic_clientes_pagos_controles.id_cliente_pago_control= {idClientePagoControl}	
        {sortOrder}        
      </select>  
			<select id="pagosRealizados">
        select 
          tc_mantic_clientes_pagos_controles.id_cliente_pago_control as id_key,
          tc_mantic_clientes_pagos_controles.id_cliente_pago_control,
          tc_mantic_clientes_deudas.id_cliente,
          tc_mantic_clientes_pagos.consecutivo,
          tc_mantic_clientes_pagos_controles.tipo,
          if(tc_mantic_clientes_pagos_controles.id_activo= 1, 'ACTIVO', 'CANCELADO') as estatus,
          tc_mantic_clientes_pagos_controles.pago,
          concat(tc_mantic_personas.nombres, ' ', ifnull(tc_mantic_personas.paterno, ''), ' ', ifnull(tc_mantic_personas.materno, '')) as usuario,
          tc_mantic_clientes_pagos_controles.observaciones,
          tc_mantic_clientes_pagos_controles.registro,
          count(*) as pagos,
          tc_mantic_clientes.razon_social,
          0 as eliminar
        from
          tc_mantic_clientes_pagos_controles
        inner join
          tc_mantic_clientes_pagos on tc_mantic_clientes_pagos_controles.id_cliente_pago_control= tc_mantic_clientes_pagos.id_cliente_pago_control
        inner join
          tc_mantic_clientes_deudas on tc_mantic_clientes_pagos.id_cliente_deuda= tc_mantic_clientes_deudas.id_cliente_deuda
        inner join
          tc_mantic_clientes on tc_mantic_clientes_deudas.id_cliente= tc_mantic_clientes.id_cliente
        inner join
          tc_janal_usuarios on tc_mantic_clientes_pagos_controles.id_usuario= tc_janal_usuarios.id_usuario
        inner join
          tc_mantic_personas on tc_janal_usuarios.id_persona= tc_mantic_personas.id_persona 
        where
          tc_mantic_clientes_deudas.id_cliente= {idCliente}	
          and date_format(tc_mantic_clientes_pagos_controles.registro, '%Y%m%d')&gt;= '{inicio}'
        group by
          tc_mantic_clientes_pagos_controles.id_cliente_pago_control
        order by
          tc_mantic_clientes_pagos.registro desc
      </select>  
			<select id="row">
				select 
					tc_mantic_clientes.id_cliente as id_key,
					tc_mantic_clientes.clave,
					tc_mantic_clientes.rfc,
					if(tc_mantic_clientes.id_credito = 1, 'SI', 'NO') credito,
					tc_mantic_clientes.id_credito,
					concat(tc_mantic_clientes.razon_social, ' ', ifnull(tc_mantic_clientes.paterno, ''), ' ', ifnull(tc_mantic_clientes.materno, '')) as razon_social,
					tc_mantic_clientes.limite_credito,
					tc_mantic_clientes.plazo_dias,
					if(tc_mantic_clientes.saldo is null, 0, tc_mantic_clientes.saldo) saldo,
					if(tc_mantic_clientes_deudas.limite is null, '0', datediff(tc_mantic_clientes_deudas.limite, now())) as dias,
				  if(tc_mantic_clientes.id_facturama is null, -1, tc_mantic_clientes.id_facturama) id_facturama
				from
					tc_mantic_clientes 
				left join
					tc_mantic_clientes_deudas on tc_mantic_clientes_deudas.id_cliente= tc_mantic_clientes.id_cliente and tc_mantic_clientes_deudas.id_cliente_estatus in (1, 2)
				where
					{condicion}					
				  and tc_mantic_clientes.id_empresa in ({idEmpresa}) 
				  and tc_mantic_clientes.id_credito in ({credito})
        group by
          tc_mantic_clientes.id_cliente
				{sortOrder}            
			</select>         
			<select id="findRazonSocial">
				select 
					tc_mantic_clientes.id_cliente as id_key,
					tc_mantic_clientes.id_cliente,
					tc_mantic_clientes.clave,
					tc_mantic_clientes.rfc,
					concat(tc_mantic_clientes.razon_social, ' ', ifnull(tc_mantic_clientes.paterno, ''), ' ', ifnull(tc_mantic_clientes.materno, '')) as razon_social,
					tc_mantic_clientes.limite_credito,
					tc_mantic_clientes.plazo_dias,
					tc_mantic_domicilios.calle,
					tc_mantic_domicilios.numero_exterior,
					tc_mantic_domicilios.asentamiento,
					tc_mantic_domicilios.codigo_postal, 
					tc_mantic_tipos_ventas.nombre as tipo_venta,
					tc_mantic_clientes.saldo,
          tc_mantic_clientes.especial,
          tc_mantic_clientes.id_regimen_fiscal
				from
					tc_mantic_clientes 
				inner join 
					tc_mantic_tipos_ventas on tc_mantic_clientes.id_tipo_venta = tc_mantic_tipos_ventas.id_tipo_venta
				left join
					tr_mantic_cliente_domicilio  on tr_mantic_cliente_domicilio.id_cliente=tc_mantic_clientes.id_cliente 
				  and tr_mantic_cliente_domicilio.id_tipo_domicilio= 1 
				  and tr_mantic_cliente_domicilio.id_principal= 1
				left join
					tc_mantic_domicilios on tc_mantic_domicilios.id_domicilio = tr_mantic_cliente_domicilio.id_domicilio
				where   
					({condicion})
				  and tc_mantic_clientes.id_empresa in ({idEmpresa})
				order by
				  tc_mantic_clientes.rfc 
			</select>    
			<select id="clienteDefault">
				select 
					tc_mantic_clientes.id_cliente as id_key,
					tc_mantic_clientes.id_cliente,
          tr_mantic_cliente_domicilio.id_cliente_domicilio,
					tc_mantic_clientes.clave,
					tc_mantic_clientes.rfc,
					concat(tc_mantic_clientes.razon_social, ' ', ifnull(tc_mantic_clientes.paterno, ''), ' ', ifnull(tc_mantic_clientes.materno, '')) as razon_social,
					tc_mantic_clientes.limite_credito,
					tc_mantic_clientes.plazo_dias,
					tc_mantic_domicilios.calle,
					tc_mantic_domicilios.numero_exterior,
					tc_mantic_domicilios.asentamiento,
					tc_mantic_domicilios.codigo_postal, 
					tc_mantic_tipos_ventas.nombre as tipo_venta,
          tc_mantic_clientes.especial,
          tc_mantic_clientes.id_regimen_fiscal
				from
					tc_mantic_clientes 
				inner join 
					tc_mantic_tipos_ventas on tc_mantic_clientes.id_tipo_venta = tc_mantic_tipos_ventas.id_tipo_venta
				left join
					tr_mantic_cliente_domicilio  on tr_mantic_cliente_domicilio.id_cliente=tc_mantic_clientes.id_cliente
				left join
					tc_mantic_domicilios on tc_mantic_domicilios.id_domicilio = tr_mantic_cliente_domicilio.id_domicilio
				where   
					tc_mantic_clientes.id_empresa in ({sucursales})
				  and tc_mantic_clientes.clave='{clave}'				                       
			</select>    
			<select id="cliente">
				select 
					tc_mantic_clientes.id_cliente as id_key,
					tc_mantic_clientes.id_cliente,
          tr_mantic_cliente_domicilio.id_cliente_domicilio,
					tc_mantic_clientes.clave,
					tc_mantic_clientes.rfc,
					concat(tc_mantic_clientes.razon_social, ' ', ifnull(tc_mantic_clientes.paterno, ''), ' ', ifnull(tc_mantic_clientes.materno, '')) as razon_social,
					tc_mantic_clientes.limite_credito,
					tc_mantic_clientes.plazo_dias,
					tc_mantic_domicilios.calle,
					tc_mantic_domicilios.numero_exterior,
					tc_mantic_domicilios.asentamiento,
					tc_mantic_domicilios.codigo_postal, 
					tc_mantic_tipos_ventas.nombre tipo_venta,
          tc_mantic_clientes.especial,
          tc_mantic_clientes.id_regimen_fiscal
				from
					tc_mantic_clientes 
				inner join 
					tc_mantic_tipos_ventas on tc_mantic_clientes.id_tipo_venta = tc_mantic_tipos_ventas.id_tipo_venta
				left join
					tr_mantic_cliente_domicilio on tr_mantic_cliente_domicilio.id_cliente=tc_mantic_clientes.id_cliente
				left join
					tc_mantic_domicilios on tc_mantic_domicilios.id_domicilio = tr_mantic_cliente_domicilio.id_domicilio
				where   
					tc_mantic_clientes.id_empresa in ({sucursales})
				  and tc_mantic_clientes.id_cliente= {idCliente}				                       
			</select>    
			<select id="cuentas">
				select
					tc_mantic_clientes_deudas.id_cliente_deuda as id_key,
					tc_mantic_clientes_deudas.id_cliente,
					tc_mantic_ventas.ticket,
					tc_mantic_ventas.consecutivo,
					tc_mantic_ventas.id_manual,
					tc_mantic_clientes_deudas.importe,
					tc_mantic_clientes_deudas.saldo,
					concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) as persona,
					tc_mantic_clientes_deudas.limite,
					tc_mantic_clientes_deudas.registro,
					(datediff(tc_mantic_clientes_deudas.limite, now())* -1) as dias,
					concat(tc_mantic_clientes.razon_social, ' ', ifnull(tc_mantic_clientes.paterno, ''), ' ', ifnull(tc_mantic_clientes.materno, '')) as razon_social,
					tc_mantic_clientes_deudas.id_cliente_estatus,
					tc_mantic_ventas.id_venta,
					tc_mantic_clientes_estatus.nombre as estatus
				from
					tc_mantic_clientes_deudas
				inner join
					tc_mantic_ventas on tc_mantic_clientes_deudas.id_venta= tc_mantic_ventas.id_venta
				inner join 
					tc_mantic_clientes on tc_mantic_clientes_deudas.id_cliente = tc_mantic_clientes.id_cliente
				inner join
					tc_janal_usuarios on tc_mantic_clientes_deudas.id_usuario= tc_janal_usuarios.id_usuario
				inner join
					tc_mantic_personas on tc_janal_usuarios.id_persona= tc_mantic_personas.id_persona
				inner join 
					tc_mantic_clientes_estatus on tc_mantic_clientes_deudas.id_cliente_estatus = tc_mantic_clientes_estatus.id_cliente_estatus
				where
					tc_mantic_clientes_deudas.id_cliente= {idCliente}
				  and {condicion}
				{sortOrder}								
			</select>	
			<select id="clientes">	
				select
					tc_mantic_clientes_deudas.id_cliente_deuda as id_key,
					tc_mantic_clientes_deudas.id_cliente,
					concat(tc_mantic_clientes.razon_social, ' ', ifnull(tc_mantic_clientes.paterno, ''), ' ', ifnull(tc_mantic_clientes.materno, '')) as razon_social,
					count(*) as cuentas,
					sum(tc_mantic_clientes_deudas.importe) as importe,
					sum(tc_mantic_clientes_deudas.saldo) as saldo,
					sum(tc_mantic_clientes_deudas.importe- tc_mantic_clientes_deudas.saldo) as abonado,
					tc_mantic_clientes.limite_credito
				from
					tc_mantic_clientes_deudas
				inner join 
					tc_mantic_clientes on tc_mantic_clientes_deudas.id_cliente = tc_mantic_clientes.id_cliente
				inner join
					tc_janal_usuarios on tc_mantic_clientes_deudas.id_usuario= tc_janal_usuarios.id_usuario
				inner join 
					tc_mantic_clientes_estatus on tc_mantic_clientes_deudas.id_cliente_estatus = tc_mantic_clientes_estatus.id_cliente_estatus
				inner join 
					tc_mantic_ventas on tc_mantic_clientes_deudas.id_venta= tc_mantic_ventas.id_venta
				where
          tc_mantic_ventas.id_empresa in ({idEmpresa})
          and {condicion}
        group by
          tc_mantic_clientes_deudas.id_cliente
				{sortOrder}								
			</select>	
			<select id="detalle">	
				select
					tc_mantic_clientes_deudas.id_cliente_deuda as id_key,
					tc_mantic_clientes_deudas.id_cliente_deuda,
					tc_mantic_clientes_deudas.id_cliente,
					tc_mantic_ventas.ticket,
					tc_mantic_ventas.id_manual,
					tc_mantic_clientes_deudas.importe,
					tc_mantic_clientes_deudas.saldo,
					(tc_mantic_clientes_deudas.importe- tc_mantic_clientes_deudas.saldo) as abonado,
					concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) as persona,
					tc_mantic_clientes_deudas.limite,
					tc_mantic_clientes_deudas.registro,
					(datediff(tc_mantic_clientes_deudas.limite, now())* -1) as dias,
					concat(tc_mantic_clientes.razon_social, ' ', ifnull(tc_mantic_clientes.paterno, ''), ' ', ifnull(tc_mantic_clientes.materno, '')) as razon_social,
					tc_mantic_ventas.id_venta,
          tc_mantic_clientes_estatus.id_cliente_estatus,
          tc_mantic_ventas.observaciones,
					tc_mantic_clientes_estatus.nombre as estatus
				from
					tc_mantic_clientes_deudas
				inner join
					tc_mantic_ventas on tc_mantic_clientes_deudas.id_venta= tc_mantic_ventas.id_venta
				inner join 
					tc_mantic_clientes_estatus on tc_mantic_clientes_deudas.id_cliente_estatus = tc_mantic_clientes_estatus.id_cliente_estatus
				inner join 
					tc_mantic_clientes on tc_mantic_clientes_deudas.id_cliente = tc_mantic_clientes.id_cliente
				inner join
					tc_janal_usuarios on tc_mantic_clientes_deudas.id_usuario= tc_janal_usuarios.id_usuario
				inner join
					tc_mantic_personas on tc_janal_usuarios.id_persona= tc_mantic_personas.id_persona
				where
					tc_mantic_clientes_deudas.id_cliente= {idCliente}
          and {condicion}		
				{sortOrder}		
			</select>	
			<select id="cuentasExcluye">
				select
					tc_mantic_clientes_deudas.id_cliente_deuda as id_key,
					tc_mantic_clientes_deudas.id_cliente,
					tc_mantic_ventas.consecutivo,
					tc_mantic_ventas.id_manual,
					tc_mantic_clientes_deudas.importe,
					tc_mantic_clientes_deudas.saldo,
					concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) as persona,
					tc_mantic_clientes_deudas.limite,
					tc_mantic_clientes_deudas.registro,
					datediff(tc_mantic_clientes_deudas.limite, now()) as dias,
					concat(tc_mantic_clientes.razon_social, ' ', ifnull(tc_mantic_clientes.paterno, ''), ' ', ifnull(tc_mantic_clientes.materno, '')) as razon_social,
					tc_mantic_clientes_deudas.id_cliente_estatus,
					tc_mantic_ventas.id_venta,
					tc_mantic_clientes_estatus.nombre as estatus
				from
					tc_mantic_clientes_deudas
				inner join
					tc_mantic_ventas on tc_mantic_clientes_deudas.id_venta= tc_mantic_ventas.id_venta
				inner join 
					tc_mantic_clientes on tc_mantic_clientes_deudas.id_cliente = tc_mantic_clientes.id_cliente
				inner join
					tc_janal_usuarios on tc_mantic_clientes_deudas.id_usuario= tc_janal_usuarios.id_usuario
				inner join
					tc_mantic_personas on tc_janal_usuarios.id_persona= tc_mantic_personas.id_persona
				inner join 
					tc_mantic_clientes_estatus on tc_mantic_clientes_deudas.id_cliente_estatus = tc_mantic_clientes_estatus.id_cliente_estatus
				where
					tc_mantic_clientes_deudas.id_cliente= {idCliente}
				  and tc_mantic_clientes_deudas.id_venta not in ({idVenta})
				  and tc_mantic_clientes_deudas.id_cliente_estatus not in ({estatus})
				  and {condicion}
				{sortOrder}								
			</select>	
			<select id="pagosCuentasCobrar">
				select
          tc_mantic_clientes_deudas.id_cliente_deuda as id_key,
          tc_mantic_clientes_deudas.id_cliente,
          tc_mantic_ventas.ticket,
          tc_mantic_ventas.consecutivo,
          tc_mantic_ventas.id_manual,
          tc_mantic_clientes_deudas.importe,
          round(tc_mantic_clientes_pagos.pago, 2) as pagado, 
          tc_mantic_clientes_deudas.saldo, concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) as persona,
          tc_mantic_clientes_deudas.limite,
          tc_mantic_clientes_deudas.registro,
          (datediff(tc_mantic_clientes_deudas.limite, now())* -1) as dias,
					concat(tc_mantic_clientes.razon_social, ' ', ifnull(tc_mantic_clientes.paterno, ''), ' ', ifnull(tc_mantic_clientes.materno, '')) as razon_social,
          tc_mantic_ventas.id_venta,
          tc_mantic_clientes_estatus.nombre estatus,
          tc_mantic_clientes_pagos_controles.registro as fecha
        from
          tc_mantic_clientes_deudas
        inner join
          tc_mantic_clientes_pagos on tc_mantic_clientes_deudas.id_cliente_deuda= tc_mantic_clientes_pagos.id_cliente_deuda
        inner join
          tc_mantic_clientes_pagos_controles on tc_mantic_clientes_pagos.id_cliente_pago_control= tc_mantic_clientes_pagos_controles.id_cliente_pago_control
        inner join
          tc_mantic_ventas on tc_mantic_clientes_deudas.id_venta= tc_mantic_ventas.id_venta     
        inner join
          tc_mantic_clientes_estatus on tc_mantic_clientes_deudas.id_cliente_estatus = tc_mantic_clientes_estatus.id_cliente_estatus     
        inner join
          tc_mantic_clientes on tc_mantic_clientes_deudas.id_cliente = tc_mantic_clientes.id_cliente     
        inner join
          tc_janal_usuarios on tc_mantic_clientes_deudas.id_usuario= tc_janal_usuarios.id_usuario     
        inner join
          tc_mantic_personas on tc_janal_usuarios.id_persona= tc_mantic_personas.id_persona     
        where
          tc_mantic_ventas.id_empresa in ({idEmpresa})           
          and tc_mantic_clientes_deudas.id_cliente= {idCliente} 
          and tc_mantic_clientes_pagos_controles.id_cliente_pago_control= {idClientePagoControl}
        {sortOrder}						
      </select>  
			<select id="cuentasBusqueda">
				select
					tc_mantic_clientes_deudas.id_cliente_deuda as id_key,
					tc_mantic_clientes_deudas.id_cliente,
					tc_mantic_ventas.ticket,
					tc_mantic_ventas.consecutivo,
					tc_mantic_ventas.id_manual,
					tc_mantic_clientes_deudas.importe,
          round(tc_mantic_clientes_deudas.importe- tc_mantic_clientes_deudas.saldo, 2) as pagado,
					tc_mantic_clientes_deudas.saldo,
					concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) as persona,
					tc_mantic_clientes_deudas.limite,
					tc_mantic_clientes_deudas.registro,
					(datediff(tc_mantic_clientes_deudas.limite, now())* -1) as dias,
					concat(tc_mantic_clientes.razon_social, ' ', ifnull(tc_mantic_clientes.paterno, ''), ' ', ifnull(tc_mantic_clientes.materno, '')) as razon_social,
					tc_mantic_ventas.id_venta,
					tc_mantic_clientes_estatus.nombre as estatus,
          null as fecha
				from
					tc_mantic_clientes_deudas
				inner join
					tc_mantic_ventas on tc_mantic_clientes_deudas.id_venta= tc_mantic_ventas.id_venta
				inner join 
					tc_mantic_clientes_estatus on tc_mantic_clientes_deudas.id_cliente_estatus = tc_mantic_clientes_estatus.id_cliente_estatus
				inner join 
					tc_mantic_clientes on tc_mantic_clientes_deudas.id_cliente = tc_mantic_clientes.id_cliente
				inner join
					tc_janal_usuarios on tc_mantic_clientes_deudas.id_usuario= tc_janal_usuarios.id_usuario
				inner join
					tc_mantic_personas on tc_janal_usuarios.id_persona= tc_mantic_personas.id_persona
				where
					tc_mantic_ventas.id_empresa in ({idEmpresa})
          and {condicion}								  
				{sortOrder}						
			</select>		
			<select id="deuda">
				select
					tc_mantic_clientes.id_cliente as id_key,
					concat(tc_mantic_clientes.razon_social, ' ', ifnull(tc_mantic_clientes.paterno, ''), ' ', ifnull(tc_mantic_clientes.materno, '')) as razon_social,
          sum(ifnull(tc_mantic_clientes_deudas.importe, 0)) as importe,
          sum(ifnull(tc_mantic_clientes_deudas.saldo, 0)) as saldo     
				from
					tc_mantic_clientes
				left join 
					tc_mantic_clientes_deudas on tc_mantic_clientes_deudas.id_cliente = tc_mantic_clientes.id_cliente and tc_mantic_clientes_deudas.id_cliente_estatus in (1, 2) 
				where
					tc_mantic_clientes.id_cliente= {idCliente}
				group by 
					tc_mantic_clientes.id_cliente
			</select>		
			<select id="pagos">
				select
					tc_mantic_clientes_pagos.id_cliente_pago as id_key,
					tc_mantic_ventas.consecutivo,
					tc_mantic_clientes_deudas.importe,
					tc_mantic_clientes_deudas.saldo,
					tc_mantic_clientes_pagos.pago,
					concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) as persona,
					tc_mantic_clientes_pagos.registro,
					tc_mantic_clientes_pagos.observaciones,
          tc_mantic_clientes_pagos.fecha_pago,
          tc_mantic_clientes_pagos.comentarios
				from
					tc_mantic_clientes_pagos
				inner join
					tc_mantic_clientes_deudas on tc_mantic_clientes_pagos.id_cliente_deuda= tc_mantic_clientes_deudas.id_cliente_deuda
				inner join
					tc_mantic_ventas on tc_mantic_clientes_deudas.id_venta= tc_mantic_ventas.id_venta
				inner join
					tc_janal_usuarios on tc_mantic_clientes_pagos.id_usuario= tc_janal_usuarios.id_usuario
				inner join
					tc_mantic_personas on tc_janal_usuarios.id_persona= tc_mantic_personas.id_persona
				where
					tc_mantic_clientes_deudas.id_cliente= {idCliente}
				order by
					tc_mantic_ventas.consecutivo, 
					tc_mantic_clientes_deudas.registro desc						
			</select>
      <select id="historial">
        select
          tc_mantic_clientes_pagos.id_cliente_pago as id_key,
          tc_mantic_ventas.ticket,
          tc_mantic_clientes_deudas.importe,
          concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) as persona,
          tc_mantic_clientes_pagos.pago,
          tc_mantic_clientes_pagos.observaciones,
          tc_mantic_clientes_pagos.comentarios,
          tc_mantic_clientes_pagos.fecha_pago,
          tc_mantic_clientes_pagos.registro
        from  
          tc_mantic_clientes_pagos
        inner join
          tc_mantic_clientes_deudas on tc_mantic_clientes_pagos.id_cliente_deuda= tc_mantic_clientes_deudas.id_cliente_deuda
        inner join
          tc_mantic_ventas on tc_mantic_clientes_deudas.id_venta= tc_mantic_ventas.id_venta
        inner join
          tc_janal_usuarios on tc_mantic_clientes_pagos.id_usuario= tc_janal_usuarios.id_usuario
        inner join
          tc_mantic_personas on tc_janal_usuarios.id_persona= tc_mantic_personas.id_persona
        where
          tc_mantic_clientes_deudas.id_cliente= {idCliente}
          and {condicion}
        {sortOrder}
      </select>  
			<select id="pagosDeuda">
				select
					tc_mantic_clientes_pagos.id_cliente_pago as id_key,
					tc_mantic_ventas.consecutivo,
					tc_mantic_clientes_deudas.importe,
					tc_mantic_clientes_deudas.saldo,
					tc_mantic_clientes_pagos.pago,
					concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) as persona,
					tc_mantic_clientes_pagos.registro,
					tc_mantic_clientes_pagos.observaciones,
          tc_mantic_clientes_pagos.fecha_pago,
					tc_mantic_clientes_pagos.comentarios,
					tc_mantic_tipos_medios_pagos.nombre as tipo_pago
				from
					tc_mantic_clientes_pagos
				inner join
					tc_mantic_clientes_deudas on tc_mantic_clientes_pagos.id_cliente_deuda= tc_mantic_clientes_deudas.id_cliente_deuda
				inner join
					tc_mantic_ventas on tc_mantic_clientes_deudas.id_venta= tc_mantic_ventas.id_venta
				inner join
					tc_janal_usuarios on tc_mantic_clientes_pagos.id_usuario= tc_janal_usuarios.id_usuario
				inner join
					tc_mantic_personas on tc_janal_usuarios.id_persona= tc_mantic_personas.id_persona
				inner join 
					tc_mantic_tipos_medios_pagos on tc_mantic_clientes_pagos.id_tipo_medio_pago = tc_mantic_tipos_medios_pagos.id_tipo_medio_pago
				where
					tc_mantic_clientes_deudas.id_cliente_deuda= {idClienteDeuda}									
				order by
					tc_mantic_clientes_pagos.registro desc				
			</select>
			<select id="pagosBusqueda">
				select
					tc_mantic_clientes_pagos.id_cliente_pago as id_key,
					tc_mantic_ventas.consecutivo,
					tc_mantic_clientes_deudas.importe,
					tc_mantic_clientes_deudas.saldo,
					tc_mantic_clientes_pagos.pago,
					concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) as persona,
					concat(tc_mantic_clientes.razon_social, ' ', ifnull(tc_mantic_clientes.paterno, ''), ' ', ifnull(tc_mantic_clientes.materno, '')) as razon_social,
					tc_mantic_clientes_pagos.registro,
				from
					tc_mantic_clientes_pagos
				inner join
					tc_mantic_clientes_deudas on tc_mantic_clientes_pagos.id_cliente_deuda= tc_mantic_clientes_deudas.id_cliente_deuda
				inner join 
					tc_mantic_clientes on tc_mantic_clientes_deudas.id_cliente = tc_mantic_clientes.id_cliente
				inner join
					tc_mantic_ventas on tc_mantic_clientes_deudas.id_venta= tc_mantic_ventas.id_venta
				inner join
					tc_janal_usuarios on tc_mantic_clientes_pagos.id_usuario= tc_janal_usuarios.id_usuario
				inner join
					tc_mantic_personas on tc_janal_usuarios.id_persona= tc_mantic_personas.id_persona
				where
					{condicion}				
				and 
					(tc_mantic_clientes.razon_social like upper('%{cliente}%') or tc_mantic_clientes.clave like upper('%{cliente}%') or tc_mantic_clientes.rfc like upper('%{cliente}%'))
				and 
					tc_mantic_ventas.id_empresa in ({idEmpresa})
				order by
					tc_mantic_ventas.consecutivo, 
					tc_mantic_clientes_deudas.registro desc						
			</select>
			<select id="venta">
				select
					tc_mantic_clientes_pagos.id_cliente_pago as id_key,
					tc_mantic_ventas.consecutivo,
					tc_mantic_clientes_deudas.importe,
					tc_mantic_clientes_deudas.saldo,
					tc_mantic_clientes_pagos.pago,
					concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) as persona,
					tc_mantic_clientes_pagos.registro
				from
					tc_mantic_clientes_pagos
				inner join
					tc_mantic_clientes_deudas on tc_mantic_clientes_pagos.id_cliente_deuda= tc_mantic_clientes_deudas.id_cliente_deuda
				inner join
					tc_mantic_ventas on tc_mantic_clientes_deudas.id_venta= tc_mantic_ventas.id_venta
				inner join
					tc_janal_usuarios on tc_mantic_clientes_pagos.id_usuario= tc_janal_usuarios.id_usuario
				inner join
					tc_mantic_personas on tc_janal_usuarios.id_persona= tc_mantic_personas.id_persona
				where
					tc_mantic_clientes_deudas.id_venta= {idVenta}
				{sortOrder}
			</select>
			<select id="importados">
				select
					tc_mantic_clientes_pagos_archivos.id_cliente_pago_archivo AS id_key,
					tc_mantic_clientes_pagos_archivos.id_cliente_pago,
					tc_mantic_clientes_pagos_archivos.id_tipo_archivo,
					tc_mantic_tipos_archivos.nombre as tipo,
					tc_mantic_clientes_pagos_archivos.nombre,
					tc_mantic_clientes_pagos_archivos.alias,
					tc_mantic_clientes_pagos_archivos.ruta,
					tc_mantic_clientes_pagos_archivos.id_principal,
					concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) as usuario,
					tc_mantic_clientes_pagos_archivos.observaciones,
					tc_mantic_clientes_pagos_archivos.registro,
					tc_mantic_clientes_pagos.pago
				from
					tc_mantic_clientes_pagos_archivos
				inner join
					tc_mantic_tipos_archivos on tc_mantic_clientes_pagos_archivos.id_tipo_archivo= tc_mantic_tipos_archivos.id_tipo_archivo
				inner join
					tc_mantic_clientes_pagos on tc_mantic_clientes_pagos_archivos.id_cliente_pago = tc_mantic_clientes_pagos.id_cliente_pago
				inner join
					tc_janal_usuarios on tc_mantic_clientes_pagos.id_usuario = tc_janal_usuarios.id_usuario
				inner join
					tc_mantic_personas on tc_janal_usuarios.id_persona = tc_mantic_personas.id_persona
				where
					tc_mantic_clientes_pagos.id_cliente_deuda= {idClienteDeuda}
				order by
					tc_mantic_clientes_pagos_archivos.id_tipo_archivo, 
				  tc_mantic_clientes_pagos_archivos.registro desc	
			</select>
			<select id="existsPagos">
        select      
          tc_mantic_clientes_pagos_archivos.*
        from      
          tc_mantic_clientes_pagos_archivos
				inner join
					tc_mantic_clientes_pagos on tc_mantic_clientes_pagos_archivos.id_cliente_pago = tc_mantic_clientes_pagos.id_cliente_pago
        where      
          tc_mantic_clientes_pagos_archivos.id_tipo_archivo = {idTipoArchivo} 
          and tc_mantic_clientes_pagos.id_cliente_deuda= {idClienteDeuda}
				order by
				  tc_mantic_clientes_pagos_archivos.registro desc
      </select>
			<select id="facturama">
				select 
					tc_mantic_clientes.id_cliente as id,
					tc_mantic_clientes.id_facturama,
					tc_mantic_clientes.rfc,
					concat(tc_mantic_clientes.razon_social, ' ', ifnull(tc_mantic_clientes.paterno, ''), ' ', ifnull(tc_mantic_clientes.materno, '')) as nombre,
					tc_mantic_domicilios.calle,
					tc_mantic_domicilios.numero_exterior,
					tc_mantic_domicilios.numero_interior,
					tc_mantic_domicilios.asentamiento as colonia,
					tc_mantic_domicilios.codigo_postal,
					tc_janal_localidades.descripcion as localidad,
					tc_janal_municipios.descripcion as municipio,
					tc_janal_entidades.descripcion as estado,
					tc_janal_paises.descripcion as pais,
					tr_mantic_cliente_tipo_contacto.valor as correo,
					tc_mantic_usos_cfdi.clave as tipo_cfdi,
          tc_mantic_clientes.id_regimen_fiscal,
          tc_mantic_regimenes_fiscales.codigo as regimen_fiscal
				from
					tc_mantic_clientes 
				left join
          tc_mantic_regimenes_fiscales on tc_mantic_clientes.id_regimen_fiscal= tc_mantic_regimenes_fiscales.id_regimen_fiscal
				left join
					tr_mantic_cliente_domicilio on tr_mantic_cliente_domicilio.id_cliente=tc_mantic_clientes.id_cliente and tr_mantic_cliente_domicilio.id_principal=1
				left join
					tc_mantic_domicilios on tc_mantic_domicilios.id_domicilio = tr_mantic_cliente_domicilio.id_domicilio
				left join 
					tc_janal_localidades on tc_mantic_domicilios.id_localidad = tc_janal_localidades.id_localidad
				left join 
					tc_janal_municipios on tc_janal_localidades.id_municipio = tc_janal_municipios.id_municipio
				left join 
					tc_janal_entidades on tc_janal_municipios.id_entidad = tc_janal_entidades.id_entidad
				left join 
					tc_janal_paises on tc_janal_entidades.id_pais = tc_janal_paises.id_pais
				left join
					tr_mantic_cliente_tipo_contacto on tc_mantic_clientes.id_cliente = tr_mantic_cliente_tipo_contacto.id_cliente and tr_mantic_cliente_tipo_contacto.id_tipo_contacto=9 and orden=1
				left join 
					tc_mantic_usos_cfdi on tc_mantic_clientes.id_uso_cfdi = tc_mantic_usos_cfdi.id_uso_cfdi
				where   
					{condicion}
			</select>
			<select id="facturamaDomicilio">
				select 
					tc_mantic_clientes.id_cliente as id,
					tc_mantic_clientes.id_facturama,
					tc_mantic_clientes.rfc,
					concat(tc_mantic_clientes.razon_social, ' ', ifnull(tc_mantic_clientes.paterno, ''), ' ', ifnull(tc_mantic_clientes.materno, '')) as nombre,
					tc_mantic_domicilios.calle,
					tc_mantic_domicilios.numero_exterior,
					tc_mantic_domicilios.numero_interior,
					tc_mantic_domicilios.asentamiento colonia,
					tc_mantic_domicilios.codigo_postal,
					tc_janal_localidades.descripcion localidad,
					tc_janal_municipios.descripcion municipio,
					tc_janal_entidades.descripcion estado,
					tc_janal_paises.descripcion pais,
					tr_mantic_cliente_tipo_contacto.valor correo,
					tc_mantic_usos_cfdi.clave tipo_cfdi,
          tc_mantic_clientes.id_regimen_fiscal,
          tc_mantic_regimenes_fiscales.codigo as regimen_fiscal
				from
					tc_mantic_ventas
				inner join
					tc_mantic_clientes on tc_mantic_ventas.id_cliente = tc_mantic_clientes.id_cliente
				inner join
					tr_mantic_cliente_domicilio on tr_mantic_cliente_domicilio.id_cliente_domicilio = tc_mantic_ventas.id_cliente_domicilio
				inner join
					tc_mantic_domicilios on tc_mantic_domicilios.id_domicilio = tr_mantic_cliente_domicilio.id_domicilio
				left join 
					tc_janal_localidades on tc_mantic_domicilios.id_localidad = tc_janal_localidades.id_localidad
				left join 
					tc_janal_municipios on tc_janal_localidades.id_municipio = tc_janal_municipios.id_municipio
				left join 
					tc_janal_entidades on tc_janal_municipios.id_entidad = tc_janal_entidades.id_entidad
				left join 
					tc_janal_paises on tc_janal_entidades.id_pais = tc_janal_paises.id_pais
				left join
					tr_mantic_cliente_tipo_contacto on tc_mantic_clientes.id_cliente = tr_mantic_cliente_tipo_contacto.id_cliente and tr_mantic_cliente_tipo_contacto.id_tipo_contacto=9 and tr_mantic_cliente_tipo_contacto.orden=1
				left join 
					tc_mantic_usos_cfdi on tc_mantic_clientes.id_uso_cfdi = tc_mantic_usos_cfdi.id_uso_cfdi
				left join
          tc_mantic_regimenes_fiscales on tc_mantic_clientes.id_regimen_fiscal= tc_mantic_regimenes_fiscales.id_regimen_fiscal
				where   
					{condicion}
			</select>
			<select id="facturamaDomicilioVenta">
				select 
					tc_mantic_clientes.id_cliente as id,
					tc_mantic_clientes.id_facturama,
					tc_mantic_clientes.rfc,
					concat(tc_mantic_clientes.razon_social, ' ', ifnull(tc_mantic_clientes.paterno, ''), ' ', ifnull(tc_mantic_clientes.materno, '')) as nombre,
					tc_mantic_domicilios.calle,
					tc_mantic_domicilios.numero_exterior,
					tc_mantic_domicilios.numero_interior,
					tc_mantic_domicilios.asentamiento as colonia,
					tc_mantic_domicilios.codigo_postal,
					tc_janal_localidades.descripcion as localidad,
					tc_janal_municipios.descripcion as municipio,
					tc_janal_entidades.descripcion as estado,
					tc_janal_paises.descripcion as pais,
					tr_mantic_cliente_tipo_contacto.valor as correo,
					tc_mantic_usos_cfdi.clave as tipo_cfdi,
          tc_mantic_clientes.id_regimen_fiscal,
          tc_mantic_regimenes_fiscales.codigo as regimen_fiscal        
				from					
					tc_mantic_clientes
				left join
          tc_mantic_regimenes_fiscales on tc_mantic_clientes.id_regimen_fiscal= tc_mantic_regimenes_fiscales.id_regimen_fiscal
				inner join
					tr_mantic_cliente_domicilio on tr_mantic_cliente_domicilio.id_cliente = tc_mantic_clientes.id_cliente
				inner join
					tc_mantic_domicilios on tc_mantic_domicilios.id_domicilio = tr_mantic_cliente_domicilio.id_domicilio
				left join 
					tc_janal_localidades on tc_mantic_domicilios.id_localidad = tc_janal_localidades.id_localidad
				left join 
					tc_janal_municipios on tc_janal_localidades.id_municipio = tc_janal_municipios.id_municipio
				left join 
					tc_janal_entidades on tc_janal_municipios.id_entidad = tc_janal_entidades.id_entidad
				left join 
					tc_janal_paises on tc_janal_entidades.id_pais = tc_janal_paises.id_pais
				left join
					tr_mantic_cliente_tipo_contacto on tc_mantic_clientes.id_cliente = tr_mantic_cliente_tipo_contacto.id_cliente and tr_mantic_cliente_tipo_contacto.id_tipo_contacto=9 and tr_mantic_cliente_tipo_contacto.orden=1
				left join 
					tc_mantic_usos_cfdi on tc_mantic_clientes.id_uso_cfdi = tc_mantic_usos_cfdi.id_uso_cfdi
				where   
					{condicion}
			</select>
			<select id="facturamaCfdiVentas">
				select 
					tc_mantic_clientes.id_cliente as id,
					tc_mantic_clientes.rfc,
					concat(tc_mantic_clientes.razon_social, ' ', ifnull(tc_mantic_clientes.paterno, ''), ' ', ifnull(tc_mantic_clientes.materno, '')) as nombre,
          tc_mantic_clientes.id_regimen_fiscal,
          tc_mantic_regimenes_fiscales.codigo as regimen_fiscal,
					tc_mantic_usos_cfdi.clave as uso_cfdi,				
					tc_mantic_clientes.id_facturama,
					tc_mantic_facturas.id_factura as folio,
					'I' as tipo_cfdi,										
					tc_mantic_facturas.observaciones,
					tc_mantic_tipos_medios_pagos.clave as medio_pago,
					tc_mantic_domicilios.codigo_postal,
					tt_mantic_domicilios.codigo_postal as codigo_postal_cliente
				from
					tc_mantic_ventas
				inner join 
					tc_mantic_facturas on tc_mantic_ventas.id_factura = tc_mantic_facturas.id_factura
				inner join
					tc_mantic_clientes on tc_mantic_ventas.id_cliente = tc_mantic_clientes.id_cliente								
				inner join
					tr_mantic_cliente_domicilio as tt_mantic_cliente_domicilio on tc_mantic_clientes.id_cliente= tt_mantic_cliente_domicilio.id_cliente
				inner join
					tc_mantic_domicilios as tt_mantic_domicilios on tt_mantic_domicilios.id_domicilio= tt_mantic_cliente_domicilio.id_domicilio
				inner join 
					tc_mantic_usos_cfdi on tc_mantic_ventas.id_uso_cfdi = tc_mantic_usos_cfdi.id_uso_cfdi
				inner join 
					tr_mantic_venta_medio_pago on tc_mantic_ventas.id_venta = tr_mantic_venta_medio_pago.id_venta				
				inner join 
					tc_mantic_tipos_medios_pagos on tr_mantic_venta_medio_pago.id_tipo_medio_pago = tc_mantic_tipos_medios_pagos.id_tipo_medio_pago
				inner join 
					tc_mantic_empresas on tc_mantic_ventas.id_empresa = tc_mantic_empresas.id_empresa
				left join
					tr_mantic_empresa_domicilio on tr_mantic_empresa_domicilio.id_empresa = tc_mantic_empresas.id_empresa_depende
				left join
					tc_mantic_domicilios on tc_mantic_domicilios.id_domicilio = tr_mantic_empresa_domicilio.id_domicilio and tr_mantic_empresa_domicilio.id_principal=1
				left join
          tc_mantic_regimenes_fiscales on tc_mantic_clientes.id_regimen_fiscal= tc_mantic_regimenes_fiscales.id_regimen_fiscal
				where   
					{condicion}
			</select>
			<select id="cfdiFicticia">
				select 
					tc_mantic_clientes.id_cliente as id,
					tc_mantic_clientes.rfc,
					concat(tc_mantic_clientes.razon_social, ' ', ifnull(tc_mantic_clientes.paterno, ''), ' ', ifnull(tc_mantic_clientes.materno, '')) as nombre,
					tc_mantic_usos_cfdi.clave uso_cfdi,				
					tc_mantic_clientes.id_facturama,
					tc_mantic_facturas.id_factura folio,
					'I' as tipo_cfdi,										
					tc_mantic_facturas.observaciones,
					tc_mantic_tipos_medios_pagos.clave medio_pago,
					tc_mantic_domicilios.codigo_postal,
					tc_mantic_tipos_pagos.clave metodo_pago,
          tc_mantic_clientes.id_regimen_fiscal,
          tc_mantic_regimenes_fiscales.codigo as regimen_fiscal,
					tt_mantic_domicilios.codigo_postal as codigo_postal_cliente
				from
					tc_mantic_ventas
				inner join
					tc_mantic_tipos_pagos on tc_mantic_tipos_pagos.id_tipo_pago = tc_mantic_ventas.id_tipo_pago
				inner join 
					tc_mantic_facturas on tc_mantic_ventas.id_factura = tc_mantic_facturas.id_factura
				inner join
					tc_mantic_clientes on tc_mantic_ventas.id_cliente = tc_mantic_clientes.id_cliente								
				inner join
					tr_mantic_cliente_domicilio as tt_mantic_cliente_domicilio on tc_mantic_clientes.id_cliente= tt_mantic_cliente_domicilio.id_cliente
				inner join
					tc_mantic_domicilios as tt_mantic_domicilios on tt_mantic_domicilios.id_domicilio= tt_mantic_cliente_domicilio.id_domicilio
				inner join 
					tc_mantic_usos_cfdi on tc_mantic_ventas.id_uso_cfdi = tc_mantic_usos_cfdi.id_uso_cfdi
				inner join 
					tc_mantic_tipos_medios_pagos on tc_mantic_ventas.id_tipo_medio_pago = tc_mantic_tipos_medios_pagos.id_tipo_medio_pago
				inner join 
					tc_mantic_empresas on tc_mantic_ventas.id_empresa = tc_mantic_empresas.id_empresa
				left join
					tr_mantic_empresa_domicilio on tr_mantic_empresa_domicilio.id_empresa = tc_mantic_empresas.id_empresa_depende
				left join
					tc_mantic_domicilios on tc_mantic_domicilios.id_domicilio = tr_mantic_empresa_domicilio.id_domicilio and tr_mantic_empresa_domicilio.id_principal=1
				left join
          tc_mantic_regimenes_fiscales on tc_mantic_clientes.id_regimen_fiscal= tc_mantic_regimenes_fiscales.id_regimen_fiscal
				where   
					{condicion}
			</select>
			<select id="domiciliosCliente">
				select 
					tr_mantic_cliente_domicilio.id_cliente_domicilio as id_key,
					tc_mantic_domicilios.calle,
					tc_mantic_domicilios.numero_exterior,
					tc_mantic_domicilios.numero_interior,
					tc_mantic_domicilios.asentamiento,
					tc_mantic_domicilios.codigo_postal,					
					tc_janal_localidades.descripcion as localidad,
					tc_janal_municipios.descripcion as municipio
				from 
					tr_mantic_cliente_domicilio
				inner join 
					tc_mantic_domicilios on tr_mantic_cliente_domicilio.id_domicilio = tc_mantic_domicilios.id_domicilio
				inner join 
					tc_janal_localidades on tc_mantic_domicilios.id_localidad = tc_janal_localidades.id_localidad
				inner join 
					tc_janal_municipios on tc_janal_localidades.id_municipio = tc_janal_municipios.id_municipio
				where 
					tr_mantic_cliente_domicilio.id_cliente= {idCliente}
				order by 
					tr_mantic_cliente_domicilio.id_principal
			</select>
		</unit>
		<unit id="VistaAlmacenesDto">
			<select id="lazy">
				select 
				  tc_mantic_almacenes.id_almacen as id_key,
					tc_mantic_empresas.clave as empresa,
          tc_mantic_empresas.nombre as nombre_empresa,
				  tc_mantic_almacenes.clave,
				  tc_mantic_almacenes.nombre,
				  tc_mantic_almacenes.descripcion,
				  tc_mantic_personas.nombres,
				  tc_mantic_personas.paterno,
				  tc_mantic_personas.materno,
				  tc_mantic_domicilios.calle,
				  tc_mantic_domicilios.numero_exterior,
				  tc_mantic_domicilios.asentamiento,
				  tc_mantic_domicilios.codigo_postal,
				  tc_janal_entidades.descripcion as entidad,
				  tc_janal_municipios.descripcion as municipio             
			  from 
				  tc_mantic_almacenes
			  inner join
			    tc_mantic_empresas on tc_mantic_empresas.id_empresa=tc_mantic_almacenes.id_empresa
			  inner join
			    tc_mantic_personas on tc_mantic_personas.id_persona=tc_mantic_almacenes.id_responsable
			  inner join
			    tr_mantic_almacen_domicilio on  tr_mantic_almacen_domicilio.id_almacen= tc_mantic_almacenes.id_almacen
			  inner join
			    tc_mantic_domicilios on tc_mantic_domicilios.id_domicilio = tr_mantic_almacen_domicilio.id_domicilio
			  inner join
			    tc_janal_localidades on tc_mantic_domicilios.id_localidad=tc_janal_localidades.id_localidad
			  inner join 
			    tc_janal_municipios on tc_janal_municipios.id_municipio= tc_janal_localidades.id_municipio
			  inner join
			    tc_janal_entidades on tc_janal_municipios.id_entidad=tc_janal_entidades.id_entidad
			  where
			    tc_mantic_almacenes.id_empresa in ({sucursales})
			    and {condicion} 
			  {sortOrder} 
			</select>  
			<select id="almacenesEmpresa">
				select 
				  tc_mantic_almacenes.id_almacen as id_key,
          tc_mantic_almacenes.id_almacen,
				  tc_mantic_almacenes.id_empresa,
				  tc_mantic_almacenes.clave,
				  tc_mantic_almacenes.nombre,
				  tc_mantic_almacenes.descripcion,
				  tc_mantic_personas.nombres,
				  tc_mantic_personas.paterno,
				  tc_mantic_personas.materno,
				  tc_mantic_domicilios.calle,
				  tc_mantic_domicilios.numero_exterior,
				  tc_mantic_domicilios.asentamiento,
				  tc_mantic_domicilios.codigo_postal,
				  tc_janal_entidades.descripcion as entidad,
				  tc_janal_municipios.descripcion as municipio,
				  tc_mantic_empresas.nombre as sucursal
			  from 
				  tc_mantic_almacenes
			  inner join
				  tc_mantic_personas on tc_mantic_personas.id_persona=tc_mantic_almacenes.id_responsable
			  inner join
				  tr_mantic_almacen_domicilio on tr_mantic_almacen_domicilio.id_almacen= tc_mantic_almacenes.id_almacen
			  inner join
				  tc_mantic_domicilios on tc_mantic_domicilios.id_domicilio = tr_mantic_almacen_domicilio.id_domicilio
			  inner join
				 tc_janal_localidades on tc_mantic_domicilios.id_localidad=tc_janal_localidades.id_localidad
			  inner join 
				  tc_janal_municipios on tc_janal_municipios.id_municipio= tc_janal_localidades.id_municipio
				inner join
					tc_janal_entidades on tc_janal_municipios.id_entidad=tc_janal_entidades.id_entidad
				inner join 
					tc_mantic_empresas on tc_mantic_almacenes.id_empresa = tc_mantic_empresas.id_empresa
				where					
					tc_mantic_almacenes.id_empresa in ({idEmpresa})
			</select> 
		</unit>
		<unit id="VistaPersonasDto">
			<select id="row">
				select 
				  tc_mantic_personas.id_persona as id_key,
				  tc_mantic_personas.nombres,
				  tc_mantic_personas.paterno,
				  tc_mantic_personas.materno,
					concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) nombre_completo,
				  tc_mantic_personas.rfc,
				  tc_mantic_personas.curp,
				  tc_mantic_personas.fecha_nacimiento,
				  tc_mantic_tipos_personas.nombre as tipo_persona,
				  tc_janal_tipos_sexos.id_tipo_sexo,
		 		  tc_janal_tipos_sexos.nombre as sexo,
				  tc_janal_tipos_sexos.nombre,
				  tc_mantic_personas.cuenta,
					tc_mantic_empresas.nombre sucursal,
					tc_mantic_puestos.nombre puesto,
					tr_mantic_persona_tipo_contacto.valor contacto
				from 
					tc_mantic_personas
				inner join
					tr_mantic_empresa_personal on tc_mantic_personas.id_persona = tr_mantic_empresa_personal.id_persona and tr_mantic_empresa_personal.id_puesto!= 10
				inner join 
					tc_mantic_empresas on tr_mantic_empresa_personal.id_empresa = tc_mantic_empresas.id_empresa
				inner join
					tc_mantic_personas_titulos on tc_mantic_personas_titulos.id_persona_titulo =tc_mantic_personas.id_persona_titulo
				inner join
					tc_mantic_tipos_personas on tc_mantic_personas.id_tipo_persona=tc_mantic_tipos_personas.id_tipo_persona
				inner join
					tc_janal_tipos_sexos on tc_janal_tipos_sexos.id_tipo_sexo = tc_mantic_personas.id_tipo_sexo
				left join
					tr_mantic_persona_tipo_contacto on tc_mantic_personas.id_persona= tr_mantic_persona_tipo_contacto.id_persona AND tr_mantic_persona_tipo_contacto.id_tipo_contacto &lt;= 6 and tr_mantic_persona_tipo_contacto.orden =1         
				left join 
					tc_mantic_puestos on tr_mantic_empresa_personal.id_puesto = tc_mantic_puestos.id_puesto
				where 
					(tc_mantic_personas.nombres like '%{nombres}%' 
				  or tc_mantic_personas.paterno like '%{paterno}%'
				  or tc_mantic_personas.materno like '%{materno}%')
				  and tc_mantic_personas.rfc like '%{rfc}%'
				  and tc_mantic_personas.id_tipo_sexo in ({idTipoSexo})
				  and tc_mantic_personas.id_tipo_persona in ({idTipoPersona})
				  and tr_mantic_empresa_personal.id_activo in ({idActivo})
				  and tr_mantic_empresa_personal.id_empresa in ({sucursales})
				{sortOrder}  
			</select>              
			<select id="rowAutocomplete">
				select 
				  tc_mantic_personas.id_persona as id_key,
				  tc_mantic_personas.nombres,
				  tc_mantic_personas.paterno,
				  tc_mantic_personas.materno,
					concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) nombre_completo,
				  tc_mantic_personas.rfc,
				  tc_mantic_personas.curp,
				  tc_mantic_personas.fecha_nacimiento,
				  tc_mantic_tipos_personas.nombre as tipo_persona,
				  tc_janal_tipos_sexos.id_tipo_sexo,
		 		  tc_janal_tipos_sexos.nombre as sexo,
				  tc_janal_tipos_sexos.nombre,
				  tc_mantic_personas.cuenta,
					tc_mantic_empresas.nombre sucursal,
					tc_mantic_puestos.nombre puesto,
					tr_mantic_persona_tipo_contacto.valor contacto
				from 
					tc_mantic_personas
				inner join
					tr_mantic_empresa_personal on tc_mantic_personas.id_persona = tr_mantic_empresa_personal.id_persona
				inner join 
					tc_mantic_empresas on tr_mantic_empresa_personal.id_empresa = tc_mantic_empresas.id_empresa
				inner join
					tc_mantic_personas_titulos on tc_mantic_personas_titulos.id_persona_titulo =tc_mantic_personas.id_persona_titulo
				inner join
					tc_mantic_tipos_personas  on tc_mantic_personas.id_tipo_persona=tc_mantic_tipos_personas.id_tipo_persona
				inner join
					tc_janal_tipos_sexos  on tc_janal_tipos_sexos.id_tipo_sexo = tc_mantic_personas.id_tipo_sexo
				left join
					tr_mantic_persona_tipo_contacto on tc_mantic_personas.id_persona= tr_mantic_persona_tipo_contacto.id_persona AND tr_mantic_persona_tipo_contacto.id_tipo_contacto &lt;= 6 and tr_mantic_persona_tipo_contacto.orden =1         
				left join 
					tc_mantic_puestos on tr_mantic_empresa_personal.id_puesto = tc_mantic_puestos.id_puesto
				where 
					(tc_mantic_personas.nombres like '%{nombreEmpleado}%' 
				  or tc_mantic_personas.paterno like '%{nombreEmpleado}%'
				  or tc_mantic_personas.materno  like '%{nombreEmpleado}%')
				  and tr_mantic_empresa_personal.id_empresa in ({idEmpresa})				
          and tr_mantic_empresa_personal.id_activo= 1
			</select>              
			<select id="rowAutocompleteAccion">
				select 
				  tc_mantic_personas.id_persona as id_key,
				  tc_mantic_personas.nombres,
				  tc_mantic_personas.paterno,
				  tc_mantic_personas.materno,
					concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) nombre_completo,
				  tc_mantic_personas.rfc,
				  tc_mantic_personas.curp,
				  tc_mantic_personas.fecha_nacimiento,
				  tc_mantic_tipos_personas.nombre as tipo_persona,
				  tc_janal_tipos_sexos.id_tipo_sexo,
		 		  tc_janal_tipos_sexos.nombre as sexo,
				  tc_janal_tipos_sexos.nombre,
				  tc_mantic_personas.cuenta,
					tc_mantic_empresas.nombre sucursal,
					tc_mantic_puestos.nombre puesto,
					tr_mantic_persona_tipo_contacto.valor contacto
				from 
					tc_mantic_personas
				inner join
					tr_mantic_empresa_personal on tc_mantic_personas.id_persona = tr_mantic_empresa_personal.id_persona
				inner join 
					tc_mantic_empresas on tr_mantic_empresa_personal.id_empresa = tc_mantic_empresas.id_empresa
				inner join
					tc_mantic_personas_titulos on tc_mantic_personas_titulos.id_persona_titulo =tc_mantic_personas.id_persona_titulo
				inner join
					tc_mantic_tipos_personas on tc_mantic_personas.id_tipo_persona=tc_mantic_tipos_personas.id_tipo_persona
				inner join
					tc_janal_tipos_sexos on tc_janal_tipos_sexos.id_tipo_sexo = tc_mantic_personas.id_tipo_sexo
				left join
					tr_mantic_persona_tipo_contacto on tc_mantic_personas.id_persona= tr_mantic_persona_tipo_contacto.id_persona and tr_mantic_persona_tipo_contacto.id_tipo_contacto &lt;= 6 and tr_mantic_persona_tipo_contacto.orden =1         
				left join 
					tc_mantic_puestos on tr_mantic_empresa_personal.id_puesto = tc_mantic_puestos.id_puesto
				where 
					(tc_mantic_personas.nombres like '%{nombreEmpleado}%' 
				  or tc_mantic_personas.paterno like '%{nombreEmpleado}%'
				  or tc_mantic_personas.materno  like '%{nombreEmpleado}%'
				  or tc_mantic_personas.id_persona = {idPersona})
				  and tr_mantic_empresa_personal.id_empresa in ({idEmpresa})				
          and tr_mantic_empresa_personal.id_activo= 1
			</select>              
			<select id="tipoPersona">
				select 
          tc_mantic_personas.id_persona as id_key,
					tc_mantic_personas.*
				from
					tc_mantic_personas
				inner join
					tr_mantic_empresa_personal on tc_mantic_personas.id_persona = tr_mantic_empresa_personal.id_persona
				where 
					tc_mantic_personas.id_tipo_persona= {idTipoPersona}
				  and tr_mantic_empresa_personal.id_empresa= {idEmpresa}
          and tr_mantic_empresa_personal.id_activo= 1
				order by
					paterno, materno, nombres
			</select>
    </unit>   
		<unit id="VistaGruposClientesDto">
			<select id="row">
				select      
					tc_mantic_grupos.id_grupo as id_key,
					tc_mantic_grupos.nombre,
					tc_mantic_grupos.registro
				from      
					tc_mantic_grupos
				left join
					tc_mantic_grupos_clientes on tc_mantic_grupos.id_grupo= tc_mantic_grupos_clientes.id_grupo
				where      
					tc_mantic_grupos.nombre like '%{nombre}%' {condicionCliente}
				group by
					tc_mantic_grupos.id_grupo,
					tc_mantic_grupos.nombre,
					tc_mantic_grupos.registro
				order by  
					tc_mantic_grupos.nombre
			</select>
		</unit>
		<unit id="VistaDevolucionesDto">
			<select id="movimientos">
				select
					tc_mantic_devoluciones_bitacora.id_devolucion_bitacora as id_key,
					tc_mantic_devoluciones_bitacora.consecutivo,
					tc_mantic_devoluciones_bitacora.importe,
					tc_mantic_devoluciones_bitacora.justificacion,
					concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) as nombre,
				  tc_mantic_devoluciones_estatus.nombre as estatus,
					tc_mantic_devoluciones_bitacora.registro
				from 
					tc_mantic_devoluciones_bitacora
				inner join
					tc_mantic_devoluciones_estatus on tc_mantic_devoluciones_bitacora.id_devolucion_estatus= tc_mantic_devoluciones_estatus.id_devolucion_estatus
				inner join
					tc_janal_usuarios on tc_mantic_devoluciones_bitacora.id_usuario= tc_janal_usuarios.id_usuario
				inner join
					tc_mantic_personas on tc_janal_usuarios.id_persona= tc_mantic_personas.id_persona
				where
					tc_mantic_devoluciones_bitacora.id_devolucion= {idDevolucion}
				order by
					tc_mantic_devoluciones_bitacora.registro desc				
			</select>	
			<select id="bitacora">
				select 
					tc_mantic_articulos_bitacora.id_articulo_bitacora as id_key,
					tc_mantic_notas_entradas.consecutivo,
					tc_mantic_articulos_bitacora.id_articulo,
					(select tc_mantic_articulos_codigos.codigo from tc_mantic_articulos_codigos where tc_mantic_articulos_codigos.id_articulo= tc_mantic_notas_detalles.id_articulo and tc_mantic_articulos_codigos.id_principal= 1 limit 0, 1) as propio,
					tc_mantic_notas_detalles.codigo,
					tc_mantic_notas_detalles.nombre,
					tc_mantic_articulos_bitacora.cantidad,
					tc_mantic_articulos_bitacora.costo,
					tc_mantic_articulos_bitacora.menudeo,
					tc_mantic_articulos_bitacora.medio_mayoreo,
					tc_mantic_articulos_bitacora.mayoreo,
					tc_mantic_articulos_bitacora.registro
				from
					tc_mantic_articulos_bitacora
				inner join
					tc_mantic_notas_entradas on tc_mantic_articulos_bitacora.id_nota_entrada= tc_mantic_notas_entradas.id_nota_entrada
				inner join
					tc_mantic_notas_detalles on tc_mantic_articulos_bitacora.id_articulo= tc_mantic_notas_detalles.id_articulo and tc_mantic_articulos_bitacora.id_nota_entrada= tc_mantic_notas_detalles.id_nota_entrada
				where 
					tc_mantic_articulos_bitacora.id_nota_entrada= {idNotaEntrada}
				{sortOrder}
			</select>	
			<select id="articulos">
				select 
					tc_mantic_articulos_bitacora.id_articulo_bitacora as id_key,
					tc_mantic_articulos_bitacora.id_articulo,
					(select tc_mantic_articulos_codigos.codigo from tc_mantic_articulos_codigos where tc_mantic_articulos_codigos.id_articulo= tc_mantic_notas_detalles.id_articulo and tc_mantic_articulos_codigos.id_principal= 1 limit 0, 1) as propio,
					tc_mantic_notas_detalles.codigo,
					tc_mantic_notas_detalles.nombre,
					tc_mantic_articulos.cantidad,
					tc_mantic_articulos.precio as costo,
					tc_mantic_articulos.menudeo,
					tc_mantic_articulos.medio_mayoreo,
					tc_mantic_articulos.mayoreo,
					tc_mantic_notas_detalles.registro
				from
					tc_mantic_articulos_bitacora
				inner join
					tc_mantic_notas_detalles on tc_mantic_articulos_bitacora.id_articulo= tc_mantic_notas_detalles.id_articulo and tc_mantic_articulos_bitacora.id_nota_entrada= tc_mantic_notas_detalles.id_nota_entrada
				inner join
					tc_mantic_articulos on tc_mantic_articulos_bitacora.id_articulo= tc_mantic_articulos.id_articulo
				where 
					tc_mantic_articulos_bitacora.id_nota_entrada= {idNotaEntrada}
				{sortOrder}
			</select>	
			<select id="lazy">
        select
					tc_mantic_devoluciones.id_devolucion as id_key,
					tc_mantic_devoluciones.id_devolucion,
					tc_mantic_devoluciones.id_nota_entrada,
          tc_mantic_notas_entradas.id_almacen,
          tc_mantic_notas_entradas.id_empresa,
          tc_mantic_notas_entradas.id_proveedor,
					tc_mantic_notas_entradas.consecutivo as nota_entrada,
					tc_mantic_devoluciones.consecutivo,
					tc_mantic_empresas.clave as empresa,
          tc_mantic_empresas.nombre as nombre_empresa,
			 	  (select sum(cantidad) from tc_mantic_devoluciones_detalles where tc_mantic_devoluciones_detalles.id_devolucion= tc_mantic_devoluciones.id_devolucion) as articulos,
					tc_mantic_devoluciones.total,
		  		tc_mantic_devoluciones_estatus.nombre as estatus,
					tc_mantic_devoluciones_estatus.id_devolucion_estatus,
				  tc_mantic_devoluciones_estatus.estatus_asociados,
					tc_mantic_devoluciones.registro     
        from
          tc_mantic_devoluciones         
        inner join
          tc_mantic_devoluciones_estatus on tc_mantic_devoluciones_estatus.id_devolucion_estatus= tc_mantic_devoluciones.id_devolucion_estatus         
        inner join
          tc_mantic_empresas on tc_mantic_devoluciones.id_empresa= tc_mantic_empresas.id_empresa         
        inner join
          tc_mantic_notas_entradas on tc_mantic_devoluciones.id_nota_entrada= tc_mantic_notas_entradas.id_nota_entrada
				inner join
					tc_mantic_proveedores on tc_mantic_notas_entradas.id_proveedor= tc_mantic_proveedores.id_proveedor       
        where
					tc_mantic_notas_entradas.id_empresa in ({idEmpresa})
					and {condicion}
				{sortOrder}
			</select>
      <select id="diferencia">
        select      
				  tc_mantic_notas_entradas.id_nota_entrada as id_key,
          tc_mantic_notas_entradas.id_sin_iva as sin_iva, 
					tc_mantic_notas_entradas.tipo_de_cambio, 
					tc_mantic_articulos.nombre, 
					tc_mantic_notas_detalles.sat, 
					tc_mantic_notas_detalles.codigo, 
					tc_mantic_notas_detalles.costo, 
					(tc_mantic_notas_detalles.costo- (tc_mantic_notas_detalles.descuentos/ tc_mantic_notas_detalles.cantidad)) as valor, 
					tc_mantic_notas_detalles.descuento, 
					tc_mantic_notas_detalles.id_nota_entrada, 
					tc_mantic_notas_detalles.extras, 
					tc_mantic_notas_detalles.importe, 
					tc_mantic_notas_entradas.total, 
					(select tc_mantic_articulos_codigos.codigo from tc_mantic_articulos_codigos where tc_mantic_articulos_codigos.id_articulo= tc_mantic_articulos.id_articulo and tc_mantic_articulos_codigos.id_principal= 1 limit 0, 1) as propio,
					tc_mantic_notas_detalles.iva, 
					tc_mantic_notas_detalles.impuestos, 
					tc_mantic_notas_detalles.sub_total, 
					0 as cantidad, 
					tc_mantic_notas_detalles.cantidades as solicitados, 
					tc_mantic_notas_detalles.id_nota_detalle as id_orden_detalle, 
					tc_mantic_notas_detalles.id_articulo, 
					tc_mantic_notas_detalles.descuentos, 
					tc_mantic_notas_entradas.id_proveedor, 
					false as ultimo, 
					false as solicitado, 
					0 as stock,
				  tc_mantic_notas_detalles.excedentes
        from      
          tc_mantic_notas_entradas
        inner join      
          tc_mantic_notas_detalles on tc_mantic_notas_entradas.id_nota_entrada= tc_mantic_notas_detalles.id_nota_entrada
        inner join
          tc_mantic_articulos on tc_mantic_notas_detalles.id_articulo= tc_mantic_articulos.id_articulo
        where      
          tc_mantic_notas_entradas.id_nota_entrada = {idNotaEntrada}
				  and tc_mantic_notas_detalles.cantidades&lt;&gt; 0
				order by
				  tc_mantic_notas_detalles.registro		
			</select>
			<select id="notas">
				select
				  tc_mantic_notas_entradas.id_nota_entrada as id_key,
				  tc_mantic_notas_entradas.consecutivo,
					tc_mantic_proveedores.clave,
					tc_mantic_proveedores.razon_social,
				  tc_mantic_notas_entradas.total,
					tc_mantic_notas_entradas.id_nota_estatus,
				  tc_mantic_notas_estatus.nombre as estatus,
				  tc_mantic_notas_entradas.registro
				from
				  tc_mantic_notas_entradas
				inner join 
					tc_mantic_empresas on tc_mantic_notas_entradas.id_empresa = tc_mantic_empresas.id_empresa
				inner join 
					tc_mantic_proveedores on tc_mantic_notas_entradas.id_proveedor= tc_mantic_proveedores.id_proveedor
				inner join 
					tc_mantic_notas_estatus on tc_mantic_notas_entradas.id_nota_estatus=tc_mantic_notas_estatus.id_nota_estatus
				where
				  tc_mantic_empresas.id_empresa in ({sucursales})
				  and tc_mantic_notas_entradas.id_nota_estatus in (3, 5)
				  and (tc_mantic_notas_entradas.id_nota_entrada= {idNotaEntrada} or {idNotaEntrada} is null)
				order by
				  tc_mantic_notas_entradas.registro						
			</select>
			<select id="consulta">
				select
					tc_mantic_notas_detalles.id_nota_detalle as id_key,
					tc_mantic_devoluciones.id_devolucion,
					tc_mantic_devoluciones.consecutivo,
					(select tc_mantic_articulos_codigos.codigo from tc_mantic_articulos_codigos where tc_mantic_articulos_codigos.id_articulo= tc_mantic_notas_detalles.id_articulo and tc_mantic_articulos_codigos.id_principal= 1 limit 0, 1) as propio,
					tc_mantic_notas_detalles.sat,
					tc_mantic_notas_detalles.codigo,
					tc_mantic_notas_detalles.nombre,
					tc_mantic_devoluciones_detalles.cantidad,
					tc_mantic_notas_detalles.costo,
					tc_mantic_notas_detalles.descuento,
					tc_mantic_notas_detalles.extras,
					tc_mantic_notas_detalles.importe,
				  tc_mantic_devoluciones_estatus.nombre as estatus,
				  tc_mantic_devoluciones.id_nota_entrada
				from
					tc_mantic_devoluciones
				inner join
					tc_mantic_devoluciones_detalles on tc_mantic_devoluciones.id_devolucion= tc_mantic_devoluciones_detalles.id_devolucion
				inner join
					tc_mantic_notas_detalles on tc_mantic_devoluciones_detalles.id_nota_detalle= tc_mantic_notas_detalles.id_nota_detalle
				inner join
				  tc_mantic_devoluciones_estatus on tc_mantic_devoluciones.id_devolucion_estatus= tc_mantic_devoluciones_estatus.id_devolucion_estatus
				where  
					tc_mantic_devoluciones.id_nota_entrada= {idNotaEntrada}
				  {condicion}
				{sortOrder}
			</select>
			<select id="confronta">
				select
					tc_mantic_notas_detalles.id_nota_detalle as id_key,
				  tc_mantic_notas_entradas.id_nota_entrada,
				  tc_mantic_notas_entradas.consecutivo,
					(select tc_mantic_articulos_codigos.codigo from tc_mantic_articulos_codigos where tc_mantic_articulos_codigos.id_articulo= tc_mantic_notas_detalles.id_articulo and tc_mantic_articulos_codigos.id_principal= 1 limit 0, 1) as propio,
					tc_mantic_notas_detalles.codigo,
					tc_mantic_notas_detalles.nombre,
					tc_mantic_notas_detalles.cantidad,
					tc_mantic_notas_detalles.costo,
					tc_mantic_notas_detalles.descuento,
					tc_mantic_notas_detalles.extras,
					tc_mantic_notas_detalles.importe,
					tc_mantic_notas_detalles.cantidades as unidades,
					tc_mantic_notas_detalles.cantidades,
				  tc_mantic_notas_detalles.id_articulo,
				  ifnull(tc_mantic_notas_archivos.id_principal, 2) as id_principal,
				  tc_mantic_notas_archivos.alias,
				  tc_mantic_notas_archivos.nombre as archivo
				from
					tc_mantic_notas_entradas
				left join
				  tc_mantic_notas_archivos on tc_mantic_notas_entradas.id_nota_entrada= tc_mantic_notas_archivos.id_nota_entrada and tc_mantic_notas_archivos.id_principal= 1 and tc_mantic_notas_archivos.id_tipo_archivo= 2
				inner join
					tc_mantic_notas_detalles on tc_mantic_notas_entradas.id_nota_entrada= tc_mantic_notas_detalles.id_nota_entrada
				where  
					tc_mantic_notas_entradas.id_nota_entrada= {idNotaEntrada}
				{sortOrder}
			</select>	
			<select id="detalle">
        select      
				  tc_mantic_devoluciones_detalles.id_devolucion as id_comodin,
          tc_mantic_devoluciones_detalles.id_devolucion,
          tc_mantic_devoluciones_detalles.id_nota_detalle,
          tc_mantic_notas_detalles.codigo,
          tc_mantic_notas_detalles.sat,
          tc_mantic_notas_detalles.nombre,
          tc_mantic_notas_detalles.costo,
          tc_mantic_notas_detalles.costo as valor,
          tc_mantic_notas_detalles.descuento,
          tc_mantic_notas_detalles.extras,
          tc_mantic_notas_detalles.iva,
          tc_mantic_notas_detalles.sub_total,
          tc_mantic_notas_detalles.importe,
          tc_mantic_notas_detalles.unidad_medida,
          tc_mantic_devoluciones_detalles.cantidad,
          tc_mantic_devoluciones_detalles.cantidad as cuantos,
          tc_mantic_devoluciones_detalles.cantidad as inicial,
          tc_mantic_devoluciones_detalles.registro
        from      
          tc_mantic_devoluciones_detalles
        inner join
          tc_mantic_notas_detalles on tc_mantic_devoluciones_detalles.id_nota_detalle= tc_mantic_notas_detalles.id_nota_detalle
        where      
          tc_mantic_devoluciones_detalles.id_devolucion = {idDevolucion}
				order by
				  tc_mantic_devoluciones_detalles.registro
			</select>	
			<select id="proveedores">
        select
					tc_mantic_proveedores.id_proveedor as id_key,
					tc_mantic_proveedores.clave,  
					tc_mantic_proveedores.razon_social as nombre,
					tc_mantic_proveedores.dias_entrega
				from 
					tc_mantic_notas_entradas
				inner join
					tc_mantic_proveedores on tc_mantic_notas_entradas.id_proveedor= tc_mantic_proveedores.id_proveedor       
				inner join
					tc_mantic_devoluciones on tc_mantic_notas_entradas.id_nota_entrada= tc_mantic_devoluciones.id_nota_entrada       
				where 		
				  tc_mantic_notas_entradas.id_empresa in ({sucursales})
				group by
          tc_mantic_proveedores.id_proveedor,
					tc_mantic_proveedores.clave,  
					tc_mantic_proveedores.razon_social,
					tc_mantic_proveedores.dias_entrega			
				order by
				  tc_mantic_proveedores.clave
			</select>
      <select id="registro">
        select      
				  tc_mantic_devoluciones_detalles.id_devolucion as id_comodin,
          tc_mantic_devoluciones_detalles.id_nota_detalle as id_orden_detalle,
          tc_mantic_notas_detalles.id_articulo,
				  tc_mantic_notas_detalles.codigo,
				  tc_mantic_notas_detalles.sat,
				  tc_mantic_notas_detalles.nombre,
				  tc_mantic_devoluciones_detalles.cantidad,
				  tc_mantic_notas_detalles.costo,
				  tc_mantic_notas_detalles.descuento,
				  tc_mantic_notas_detalles.extras,
				  tc_mantic_notas_detalles.iva
        from      
          tc_mantic_devoluciones_detalles
				inner join 
				  tc_mantic_notas_detalles on tc_mantic_devoluciones_detalles.id_nota_detalle= tc_mantic_notas_detalles.id_nota_detalle
        where      
          tc_mantic_devoluciones_detalles.id_devolucion = {idDevolucion}
				order by
				  tc_mantic_devoluciones_detalles.registro
      </select>
		</unit>
		<unit id="VistaNotasEntradasDto">
			<select id="codigos">
				select
				  count(*) as total
			  from
				  tc_mantic_notas_detalles
        inner join
          tc_mantic_articulos on tc_mantic_notas_detalles.id_articulo= tc_mantic_articulos.id_articulo and tc_mantic_articulos.id_barras= 1
				where
				  tc_mantic_notas_detalles.id_nota_entrada= {idNotaEntrada}
			</select>	
			<select id="surtidores">
				select
					tc_mantic_proveedores.id_proveedor as id_key,
					tc_mantic_proveedores.rfc,
					tc_mantic_proveedores.clave,
					tc_mantic_proveedores.razon_social
				from
					tc_mantic_proveedores
				where
					tc_mantic_proveedores.id_proveedor in (
					select
						distinct(tc_mantic_notas_entradas.id_proveedor) 
					from
						tc_mantic_notas_archivos
					inner join
						tc_mantic_notas_entradas on tc_mantic_notas_archivos.id_nota_entrada= tc_mantic_notas_entradas.id_nota_entrada
					where
						tc_mantic_notas_archivos.ejercicio= {ejercicio}
						and tc_mantic_notas_archivos.mes= {mes}
				)
				order by
					tc_mantic_proveedores.clave				
			</select>
			<select id="meses">
        select
          tc_janal_meses.id_mes as id_key,
          tc_janal_meses.nombre
        from
          tc_janal_meses 
        where
          tc_janal_meses.id_mes in (
        select      
          distinct(tc_mantic_notas_archivos.mes)
        from      
          tc_mantic_notas_archivos
				where
				  tc_mantic_notas_archivos.ejercicio= {ejercicio}
				)
 				order by
				  tc_janal_meses.id_mes				  
			</select>	
			<select id="facturas">
        select
					tc_mantic_notas_entradas.id_nota_entrada as id_key,
					tc_mantic_notas_archivos.ejercicio,
					tc_mantic_notas_archivos.mes,
				  tc_janal_meses.nombre,
					tc_mantic_notas_entradas.id_nota_entrada,
          tc_mantic_notas_entradas.id_empresa,
					tc_mantic_notas_entradas.consecutivo,
					tc_mantic_empresas.nombre as empresa,
					tc_mantic_proveedores.razon_social,
					tc_mantic_notas_entradas.total,
					tc_mantic_notas_entradas.registro     
        from
          tc_mantic_notas_archivos
				inner join
					tc_janal_meses on tc_mantic_notas_archivos.mes= tc_janal_meses.id_mes          
        inner join
          tc_mantic_notas_entradas on tc_mantic_notas_archivos.id_nota_entrada= tc_mantic_notas_entradas.id_nota_entrada       
        inner join
          tc_mantic_empresas on tc_mantic_notas_entradas.id_empresa= tc_mantic_empresas.id_empresa         
        inner join
          tc_mantic_proveedores on tc_mantic_notas_entradas.id_proveedor= tc_mantic_proveedores.id_proveedor         
        where
					tc_mantic_notas_entradas.id_empresa in ({idEmpresa})
					and tc_mantic_notas_archivos.id_principal= 1
					and {condicion}
				group by
					tc_mantic_notas_entradas.id_nota_entrada,
					tc_mantic_notas_archivos.ejercicio,
					tc_mantic_notas_archivos.mes,
				  tc_janal_meses.nombre,
					tc_mantic_notas_entradas.id_nota_entrada,
          tc_mantic_notas_entradas.id_empresa,
					tc_mantic_notas_entradas.consecutivo,
					tc_mantic_empresas.clave,
					tc_mantic_proveedores.razon_social,
					tc_mantic_notas_entradas.total,
					tc_mantic_notas_entradas.registro     
				{sortOrder}				
			</select>
			<select id="exportar">
        select
					tc_mantic_notas_archivos.alias as nombre
        from
          tc_mantic_notas_archivos
				inner join
					tc_janal_meses on tc_mantic_notas_archivos.mes= tc_janal_meses.id_mes          
        inner join
          tc_mantic_notas_entradas on tc_mantic_notas_archivos.id_nota_entrada= tc_mantic_notas_entradas.id_nota_entrada       
        inner join
          tc_mantic_empresas on tc_mantic_notas_entradas.id_empresa= tc_mantic_empresas.id_empresa         
        inner join
          tc_mantic_proveedores on tc_mantic_notas_entradas.id_proveedor= tc_mantic_proveedores.id_proveedor         
        where
					tc_mantic_notas_entradas.id_empresa in ({idEmpresa})
					and tc_mantic_notas_archivos.id_principal= 1
					and {condicion}
			</select>
			<select id="movimientos">
				select
					tc_mantic_notas_bitacora.id_nota_bitacora as id_key,
					tc_mantic_notas_bitacora.consecutivo,
					tc_mantic_notas_bitacora.importe,
					tc_mantic_notas_bitacora.justificacion,
					concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) as nombre,
				  tc_mantic_notas_estatus.nombre as estatus,
					tc_mantic_notas_bitacora.registro
				from 
					tc_mantic_notas_bitacora
				inner join
					tc_mantic_notas_estatus on tc_mantic_notas_bitacora.id_nota_estatus= tc_mantic_notas_estatus.id_nota_estatus
				inner join
					tc_janal_usuarios on tc_mantic_notas_bitacora.id_usuario= tc_janal_usuarios.id_usuario
				inner join
					tc_mantic_personas on tc_janal_usuarios.id_persona= tc_mantic_personas.id_persona
				where
					tc_mantic_notas_bitacora.id_nota_entrada= {idNotaEntrada}
				order by
					tc_mantic_notas_bitacora.registro desc				
			</select>		
			<select id="lazy">
        select
					tc_mantic_notas_entradas.id_nota_entrada as id_key,
					tc_mantic_notas_entradas.id_nota_entrada,
					tc_mantic_ordenes_compras.id_orden_compra,
          tc_mantic_notas_entradas.id_almacen,
          tc_mantic_notas_entradas.id_empresa,
          tc_mantic_proveedores.id_proveedor,
					tc_mantic_ordenes_compras.consecutivo as orden_compra,
					tc_mantic_notas_entradas.consecutivo,
          tc_mantic_notas_entradas.consecutivo as nota_entrada,
					tc_mantic_empresas.nombre as empresa,
					tc_mantic_notas_tipos.nombre as directa,
					tc_mantic_notas_entradas.id_nota_tipo,
					tc_mantic_proveedores.razon_social,
					tc_mantic_notas_entradas.total,
					tc_mantic_notas_estatus.id_nota_estatus,
					tc_mantic_notas_estatus.nombre as estatus,
					tc_mantic_notas_estatus.estatus_asociados,
					tc_mantic_notas_entradas.registro,
					count(*) as articulos,
					sum(if(tc_mantic_articulos.id_imagen is null, 1, 0)) as imagenes,
          tc_mantic_notas_entradas.factura
        from
          tc_mantic_notas_entradas         
        inner join
          tc_mantic_notas_tipos on tc_mantic_notas_entradas.id_nota_tipo= tc_mantic_notas_tipos.id_nota_tipo
        inner join
          tc_mantic_empresas on tc_mantic_notas_entradas.id_empresa= tc_mantic_empresas.id_empresa         
        inner join
          tc_mantic_proveedores on tc_mantic_notas_entradas.id_proveedor= tc_mantic_proveedores.id_proveedor         
        inner join
          tc_mantic_notas_estatus on tc_mantic_notas_entradas.id_nota_estatus= tc_mantic_notas_estatus.id_nota_estatus      
        left join
          tc_mantic_ordenes_compras on tc_mantic_notas_entradas.id_orden_compra= tc_mantic_ordenes_compras.id_orden_compra     
        left join
          tc_mantic_notas_detalles on tc_mantic_notas_entradas.id_nota_entrada= tc_mantic_notas_detalles.id_nota_entrada
        inner join
          tc_mantic_articulos on tc_mantic_articulos.id_articulo= tc_mantic_notas_detalles.id_articulo
        where
					tc_mantic_notas_entradas.id_empresa in ({idEmpresa})
					and {condicion}
				group by
					tc_mantic_notas_entradas.id_nota_entrada,
					tc_mantic_ordenes_compras.id_orden_compra,
          tc_mantic_notas_entradas.id_almacen,
          tc_mantic_notas_entradas.id_empresa,
          tc_mantic_proveedores.id_proveedor,
					tc_mantic_notas_entradas.consecutivo,
					tc_mantic_empresas.nombre,
					tc_mantic_notas_tipos.nombre,
					tc_mantic_notas_entradas.id_nota_tipo,
					tc_mantic_proveedores.razon_social,
					tc_mantic_notas_entradas.total,
					tc_mantic_notas_estatus.id_nota_estatus,
					tc_mantic_notas_estatus.nombre,
					tc_mantic_notas_estatus.estatus_asociados,
					tc_mantic_notas_entradas.registro
				{sortOrder}
			</select>
      <select id="incompleto">
				select
					count(*) as total
				from 
					tc_mantic_notas_entradas
				inner join 
					tc_mantic_notas_detalles on tc_mantic_notas_entradas.id_nota_entrada= tc_mantic_notas_detalles.id_nota_entrada
				where
					tc_mantic_notas_entradas.id_nota_entrada= {idNotaEntrada}
					and tc_mantic_notas_entradas.id_orden_compra= {idOrdenCompra}
					and tc_mantic_notas_detalles.id_orden_detalle is null				
			</select>	
      <select id="diferencia">
        select      
          1 as sin_iva, 
					1 as tipo_de_cambio, 
					tc_mantic_articulos.nombre, 
          ifnull(tc_mantic_ordenes_detalles.codigo, (select tc_mantic_articulos_codigos.codigo from tc_mantic_articulos_codigos where tc_mantic_articulos_codigos.id_articulo= tc_mantic_ordenes_detalles.id_articulo and tc_mantic_articulos_codigos.id_principal= 2 and tc_mantic_articulos_codigos.id_proveedor= {idProveedor} limit 0, 1)) as codigo,
				  tc_mantic_articulos.sat,
					0 as costo, 
					(tc_mantic_ordenes_detalles.costo- (tc_mantic_ordenes_detalles.descuentos/ tc_mantic_ordenes_detalles.cantidad)) as valor, 
					"0" as descuento, 
					tc_mantic_ordenes_detalles.id_orden_compra, 
					"0" as extras, 
					tc_mantic_ordenes_detalles.importe, 
					tc_mantic_ordenes_detalles.importes as total, 
					tc_mantic_ordenes_detalles.propio, 
					tc_mantic_ordenes_detalles.iva, 
					tc_mantic_ordenes_detalles.impuestos, 
					tc_mantic_ordenes_detalles.sub_total, 
					0 as cantidad, 
					tc_mantic_ordenes_detalles.cantidades as solicitados, 
					tc_mantic_ordenes_detalles.id_orden_detalle, 
					tc_mantic_ordenes_detalles.id_articulo, 
					tc_mantic_ordenes_detalles.descuentos, 
					tc_mantic_ordenes_compras.id_proveedor, 
					false as ultimo, 
					false as solicitado, 
					0 as stock,
				  0 as excedentes
        from      
          tc_mantic_ordenes_compras
        inner join      
          tc_mantic_ordenes_detalles on tc_mantic_ordenes_compras.id_orden_compra= tc_mantic_ordenes_detalles.id_orden_compra
        inner join
          tc_mantic_articulos on tc_mantic_ordenes_detalles.id_articulo= tc_mantic_articulos.id_articulo
        where      
          tc_mantic_ordenes_compras.id_orden_compra = {idOrdenCompra}
				  and tc_mantic_ordenes_detalles.cantidades&gt; 0
				order by
				  tc_mantic_ordenes_detalles.registro				
      </select>
			<select id="errores">
        select
					sum(tc_mantic_errores.total) as total
				from (    				
					select
					  count(*) as total
					from
					  tc_mantic_ordenes_detalles
					where      
					  tc_mantic_ordenes_detalles.id_orden_compra= {idOrdenCompra}
					  and (
  				    tc_mantic_ordenes_detalles.cantidades&lt;&gt; 0 or 
	  			    (abs(tc_mantic_ordenes_detalles.importes)* 100/ tc_mantic_ordenes_detalles.importe) between 2.1 and 1000000
						)
					union
					  select 
						  count(*) as total
					  from
						  tc_mantic_notas_entradas
					  inner join
						  tc_mantic_notas_detalles on tc_mantic_notas_entradas.id_nota_entrada= tc_mantic_notas_detalles.id_nota_entrada 
					  where
					    tc_mantic_notas_entradas.id_orden_compra= {idOrdenCompra}
						  and tc_mantic_notas_detalles.id_orden_detalle is null
				) as tc_mantic_errores
			</select>
			<select id="ordenes">
				select
				  tc_mantic_ordenes_compras.id_orden_compra as id_key,
				  tc_mantic_ordenes_compras.consecutivo,
					tc_mantic_proveedores.clave,
					tc_mantic_proveedores.razon_social,
				  tc_mantic_ordenes_compras.total,
					tc_mantic_ordenes_compras.id_orden_estatus,
				  tc_mantic_ordenes_estatus.nombre as estatus,
				  tc_mantic_ordenes_compras.registro
				from
				  tc_mantic_ordenes_compras
				inner join 
					tc_mantic_empresas on tc_mantic_ordenes_compras.id_empresa = tc_mantic_empresas.id_empresa
				inner join 
					tc_mantic_proveedores on tc_mantic_ordenes_compras.id_proveedor= tc_mantic_proveedores.id_proveedor
				inner join 
					tc_mantic_ordenes_estatus on tc_mantic_ordenes_compras.id_orden_estatus=tc_mantic_ordenes_estatus.id_orden_estatus
				where
				  tc_mantic_empresas.id_empresa in ({sucursales})
				  and tc_mantic_ordenes_compras.id_orden_estatus in (3,4,5,7)
				  and (tc_mantic_ordenes_compras.id_orden_compra= {idOrdenCompra} or {idOrdenCompra} is null)
				order by
				  tc_mantic_ordenes_compras.registro			
			</select>
			<select id="importados">
				select
					tc_mantic_notas_archivos.id_nota_archivo as id_key,
					tc_mantic_notas_archivos.id_nota_entrada,
			  	tc_mantic_notas_archivos.id_tipo_archivo,
					tc_mantic_tipos_archivos.nombre as tipo,
					tc_mantic_notas_archivos.nombre,
					tc_mantic_notas_archivos.alias,
					tc_mantic_notas_archivos.ruta,
					tc_mantic_notas_archivos.id_principal,
					concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) as usuario,
					tc_mantic_notas_archivos.observaciones,
					tc_mantic_notas_archivos.registro,
          tt_mantic_tipos_archivos.nombre as documento,
 					tc_mantic_notas_archivos.id_eliminado
				from
					tc_mantic_notas_archivos
				inner join
					tc_mantic_tipos_archivos on tc_mantic_notas_archivos.id_tipo_archivo= tc_mantic_tipos_archivos.id_tipo_archivo
				inner join
					tc_mantic_tipos_archivos as tt_mantic_tipos_archivos on tc_mantic_notas_archivos.id_tipo_documento= tt_mantic_tipos_archivos.id_tipo_archivo
				inner join
					tc_janal_usuarios on tc_mantic_notas_archivos.id_usuario= tc_janal_usuarios.id_usuario          
				inner join
					tc_mantic_personas on tc_janal_usuarios.id_persona= tc_mantic_personas.id_persona
				where
					tc_mantic_notas_archivos.id_nota_entrada= {idNotaEntrada}
          and (tc_mantic_notas_archivos.id_tipo_documento= {idTipoDocumento} or {idTipoDocumento}= -1)
				order by
					tc_mantic_notas_archivos.id_tipo_documento, 
          tc_mantic_notas_archivos.id_tipo_archivo, 
          tc_mantic_notas_archivos.registro desc				
			</select>
      <select id="detalle">
        select      
				  tc_mantic_notas_detalles.id_nota_detalle as id_comodin,
          tc_mantic_notas_detalles.id_nota_entrada,
          tc_mantic_notas_detalles.id_articulo,
          ifnull(tc_mantic_notas_detalles.codigo, (select tc_mantic_articulos_codigos.codigo from tc_mantic_articulos_codigos where tc_mantic_articulos_codigos.id_articulo= tc_mantic_notas_detalles.id_articulo and tc_mantic_articulos_codigos.id_principal= 2 and tc_mantic_articulos_codigos.id_proveedor= {idProveedor} limit 0, 1)) as codigo,
          tc_mantic_notas_detalles.sat,
          tc_mantic_notas_detalles.nombre,
          tc_mantic_notas_detalles.cantidad,
          tc_mantic_notas_detalles.costo,
          tc_mantic_notas_detalles.descuento,
          tc_mantic_notas_detalles.extras,
          tc_mantic_notas_detalles.iva,
          tc_mantic_notas_detalles.descuentos,
          tc_mantic_notas_detalles.excedentes,
          tc_mantic_notas_detalles.impuestos,
          tc_mantic_notas_detalles.sub_total,
          tc_mantic_notas_detalles.importe,
          tc_mantic_notas_detalles.unidad_medida,
          tc_mantic_notas_detalles.id_orden_detalle,
          tc_mantic_notas_detalles.id_aplicar,
          tc_mantic_notas_detalles.cantidades,
          tc_mantic_notas_detalles.declarados,
          tc_mantic_notas_detalles.diferencia,
          tc_mantic_notas_detalles.costo_real,
          tc_mantic_notas_detalles.costo_calculado,
          tc_mantic_notas_detalles.origen,
          tc_mantic_notas_detalles.registro,
          tc_mantic_notas_detalles.cantidad as cuantos,
          tc_mantic_notas_detalles.cantidad as inicial,
				  if(tc_mantic_ordenes_detalles.costo is null, tc_mantic_articulos.precio, tc_mantic_ordenes_detalles.costo) as valor
        from      
          tc_mantic_notas_detalles
        inner join
          tc_mantic_articulos on tc_mantic_notas_detalles.id_articulo= tc_mantic_articulos.id_articulo
        left join
          tc_mantic_ordenes_detalles on tc_mantic_notas_detalles.id_orden_detalle= tc_mantic_ordenes_detalles.id_orden_detalle
        where      
          tc_mantic_notas_detalles.id_nota_entrada = {idNotaEntrada}
				order by
				  tc_mantic_notas_detalles.registro
      </select>
      <select id="detalleImage">
        select      
				  tc_mantic_notas_detalles.id_nota_detalle as id_key,
          tc_mantic_notas_detalles.*,
          tc_mantic_notas_detalles.cantidad as cuantos,
          tc_mantic_notas_detalles.cantidad as inicial,
				  if(tc_mantic_ordenes_detalles.costo is null, tc_mantic_articulos.precio, tc_mantic_ordenes_detalles.costo) as valor,
					(select tc_mantic_articulos_codigos.codigo from tc_mantic_articulos_codigos where tc_mantic_articulos_codigos.id_articulo= tc_mantic_articulos.id_articulo and tc_mantic_articulos_codigos.id_principal= 1 limit 0, 1) as propio
        from      
          tc_mantic_notas_detalles
				inner join 
					tc_mantic_articulos on tc_mantic_notas_detalles.id_articulo = tc_mantic_articulos.id_articulo
        left join
          tc_mantic_ordenes_detalles on tc_mantic_notas_detalles.id_orden_detalle= tc_mantic_ordenes_detalles.id_orden_detalle
        where      
          tc_mantic_notas_detalles.id_nota_entrada = {idNotaEntrada}
				and 
					tc_mantic_articulos.id_imagen is null
				order by
				  tc_mantic_notas_detalles.registro
      </select>
      <select id="proveedor">
        select      
				  tc_mantic_articulos.id_articulo as id_key,
				  tc_mantic_articulos_codigos.id_proveedor,
				  tc_mantic_articulos.id_articulo,
					(select tc_mantic_articulos_codigos.codigo from tc_mantic_articulos_codigos where tc_mantic_articulos_codigos.id_articulo= tc_mantic_articulos.id_articulo and tc_mantic_articulos_codigos.id_principal= 1 limit 0, 1) as propio,
				  tc_mantic_articulos_codigos.codigo,
				  tc_mantic_articulos.nombre,
				  tc_mantic_articulos.descripcion,
				  tc_mantic_articulos.iva,
				  tc_mantic_articulos.sat,
				  tc_mantic_articulos.precio,
				  0 as descuento,
				  1 as cantidad,
				  tc_mantic_articulos.id_redondear,
				  tc_mantic_articulos.precio as valor
        from      
          tc_mantic_articulos
        inner join
          tc_mantic_articulos_codigos on tc_mantic_articulos.id_articulo= tc_mantic_articulos_codigos.id_articulo
        left join
          tc_mantic_notas_detalles on tc_mantic_articulos.id_articulo= tc_mantic_notas_detalles.id_articulo
        left join
          tc_mantic_notas_entradas on tc_mantic_notas_detalles.id_nota_entrada= tc_mantic_notas_entradas.id_nota_entrada
        where   
          tc_mantic_articulos_codigos.id_proveedor= {idProveedor}
          and {condicion}
				order by
				  tc_mantic_notas_entradas.registro desc
			</select>
			<select id="proveedores">
        select
					tc_mantic_proveedores.id_proveedor as id_key,
					tc_mantic_proveedores.clave,  
					tc_mantic_proveedores.razon_social as nombre,
					tc_mantic_proveedores.dias_entrega
				from 
					tc_mantic_notas_entradas
				inner join
					tr_mantic_proveedor_pago on tc_mantic_notas_entradas.id_proveedor_pago= tr_mantic_proveedor_pago.id_proveedor_pago
				inner join
					tc_mantic_proveedores on tr_mantic_proveedor_pago.id_proveedor= tc_mantic_proveedores.id_proveedor       
				where 		
				  tc_mantic_notas_entradas.id_empresa in ({sucursales})
				group by
          tc_mantic_proveedores.id_proveedor,
					tc_mantic_proveedores.clave,  
					tc_mantic_proveedores.razon_social,
					tc_mantic_proveedores.dias_entrega			
				order by
				  tc_mantic_proveedores.clave
			</select>			
		</unit>
		<unit id="VistaOrdenesComprasDto">
			<select id="exportar">
     		select 
					tc_mantic_articulos_codigos.id_articulo_codigo as id_key,
					tc_mantic_productos.id_producto,
				  tc_mantic_articulos.id_articulo,
				  tc_mantic_articulos_codigos.codigo as propio,
				  tc_mantic_productos_detalles.descripcion as nombre,
				  tc_mantic_productos_detalles.medida,
				  tc_mantic_articulos.precio,
				  tc_mantic_articulos.menudeo,
				  tc_mantic_articulos.medio_mayoreo,
				  tc_mantic_articulos.mayoreo,
				  tc_mantic_articulos.iva,
          if({porcentaje}= -1, tc_mantic_articulos.menudeo, round(tc_mantic_articulos.precio* (1+ (tc_mantic_articulos.iva/100))* (1+ ({porcentaje}/ 100)), 4)) as especial,
				  concat(tc_mantic_productos_categorias.padre, tc_mantic_productos_categorias.nombre) as categoria,
				  tc_mantic_productos_marcas.nombre as marca
				from 
					tc_mantic_articulos
				inner join 
					tc_mantic_empresas on tc_mantic_articulos.id_empresa= tc_mantic_empresas.id_empresa								
				left join
				  tc_mantic_imagenes on tc_mantic_articulos.id_imagen= tc_mantic_imagenes.id_imagen
				left join
				  tc_mantic_productos_detalles on tc_mantic_articulos.id_articulo= tc_mantic_productos_detalles.id_articulo
        left join
          tc_mantic_articulos_codigos on tc_mantic_articulos_codigos.id_articulo_codigo= tc_mantic_productos_detalles.id_articulo_codigo
				left join
				  tc_mantic_productos on tc_mantic_productos.id_producto= tc_mantic_productos_detalles.id_producto
				left join
				  tc_mantic_productos_categorias on tc_mantic_productos.id_producto_categoria= tc_mantic_productos_categorias.id_producto_categoria
				left join
 				  tc_mantic_productos_marcas on tc_mantic_productos.id_producto_marca= tc_mantic_productos_marcas.id_producto_marca
				where 
				  tc_mantic_articulos.id_articulo_tipo= 1
				  and tc_mantic_articulos.id_vigente= 1
				  and (concat(tc_mantic_productos_categorias.padre, tc_mantic_productos_categorias.nombre) like '%{codigo}%' or tc_mantic_productos_marcas.nombre like '%{codigo}%')
				{sortOrder}        
      </select>
			<select id="galeria">
				select 
					tc_mantic_articulos_codigos.id_articulo_codigo as id_key,
				  tc_mantic_articulos.id_articulo,
				  (select tc_mantic_articulos_codigos.codigo from tc_mantic_articulos_codigos where tc_mantic_articulos_codigos.id_articulo= tc_mantic_articulos.id_articulo and tc_mantic_articulos_codigos.id_principal= 1 limit 0, 1) as propio,
				  tc_mantic_productos.nombre,
          ifnull(tc_mantic_imagenes.id_imagen, -1) as id_imagen,
				  concat(tc_mantic_articulos.id_empresa, '/', ifnull(tc_mantic_imagenes.archivo, 'sin-foto.png')) as archivo,
				  max(ifnull(tc_mantic_productos_detalles.id_producto, 0)) as id_producto,
				  concat(tc_mantic_productos_categorias.padre, tc_mantic_productos_categorias.nombre) as categoria,
				  tc_mantic_productos_marcas.nombre as marca,
          count(distinct(tc_mantic_productos_detalles.id_producto_detalle)) as partidas     
				from 
					tc_mantic_articulos
				inner join
					tc_mantic_articulos_codigos on tc_mantic_articulos.id_articulo= tc_mantic_articulos_codigos.id_articulo and tc_mantic_articulos_codigos.id_principal= 1
				inner join 
					tc_mantic_empresas on tc_mantic_articulos.id_empresa = tc_mantic_empresas.id_empresa								
				left join
				  tc_mantic_imagenes on tc_mantic_articulos.id_imagen= tc_mantic_imagenes.id_imagen
				left join
				  tc_mantic_productos_detalles on tc_mantic_articulos.id_articulo= tc_mantic_productos_detalles.id_articulo
				left join
				  tc_mantic_productos on tc_mantic_productos.id_producto= tc_mantic_productos_detalles.id_producto
				left join
				  tc_mantic_productos_categorias on tc_mantic_productos.id_producto_categoria= tc_mantic_productos_categorias.id_producto_categoria
				left join
 				  tc_mantic_productos_marcas on tc_mantic_productos.id_producto_marca= tc_mantic_productos_marcas.id_producto_marca
				where 
				  tc_mantic_articulos.id_articulo_tipo= 1
				  and tc_mantic_articulos.id_vigente= 1
				  and (
            concat(tc_mantic_productos_categorias.padre, tc_mantic_productos_categorias.nombre) like '%{codigo}%' 
            or tc_mantic_productos_marcas.nombre like '%{codigo}%'
            or tc_mantic_productos_marcas.descripcion like '%{codigo}%'
          )
				group by
				  tc_mantic_productos.id_producto 
				order by 
				  tc_mantic_productos.nombre
      </select>  
			<select id="porAmbos">
				select 
				  tc_mantic_articulos_codigos.id_articulo_codigo as id_key,
				  tc_mantic_articulos.id_articulo,
				  (select tc_mantic_articulos_codigos.codigo from tc_mantic_articulos_codigos where tc_mantic_articulos_codigos.id_articulo= tc_mantic_articulos.id_articulo and tc_mantic_articulos_codigos.id_principal= 1 limit 0, 1) as propio,
				  tc_mantic_articulos.nombre,
				  tc_mantic_articulos.menudeo,
          ifnull(tc_mantic_imagenes.id_imagen, -1) as id_imagen,
				  concat(tc_mantic_articulos.id_empresa, '/', ifnull(tc_mantic_imagenes.archivo, 'sin-foto.png')) as archivo,
				  max(ifnull(tc_mantic_productos_detalles.id_producto, 0)) as id_producto
				from 
					tc_mantic_articulos
				inner join
					tc_mantic_articulos_codigos on tc_mantic_articulos.id_articulo= tc_mantic_articulos_codigos.id_articulo and tc_mantic_articulos_codigos.id_principal= 1
				inner join 
					tc_mantic_empresas on tc_mantic_articulos.id_empresa = tc_mantic_empresas.id_empresa								
				left join
				  tc_mantic_imagenes on tc_mantic_articulos.id_imagen= tc_mantic_imagenes.id_imagen
				left join
				  tc_mantic_productos_detalles on tc_mantic_articulos.id_articulo= tc_mantic_productos_detalles.id_articulo
				where 
				  tc_mantic_articulos.id_articulo_tipo= 1
				  and tc_mantic_articulos.id_vigente= 1
				  and ((upper(tc_mantic_articulos_codigos.codigo) regexp '.*{codigo}.*') or (upper(tc_mantic_articulos.nombre) regexp '.*{codigo}.*'))
				group by
				  tc_mantic_articulos.id_articulo  
				order by 
				  tc_mantic_articulos.nombre
      </select>  
			<select id="porCodigoCompleto">
select 
  tc_mantic_articulos_codigos.id_articulo_codigo as id_key,
  tc_mantic_articulos.id_articulo,
  (select tc_mantic_articulos_codigos.codigo from tc_mantic_articulos_codigos where tc_mantic_articulos_codigos.id_articulo= tc_mantic_articulos.id_articulo and tc_mantic_articulos_codigos.id_principal= 1 limit 0, 1) as propio,
  (select tc_mantic_articulos_codigos.codigo from tc_mantic_articulos_codigos where tc_mantic_articulos_codigos.id_articulo= tc_mantic_articulos.id_articulo and (tc_mantic_articulos_codigos.id_proveedor= {idProveedor} and tc_mantic_articulos_codigos.id_principal> 1) and ((upper(tc_mantic_articulos_codigos.codigo) like '{codigo}%' and (tc_mantic_articulos_codigos.id_proveedor = {idProveedor} and tc_mantic_articulos_codigos.id_principal> 1)) or tc_mantic_articulos.id_articulo= {idArticulo}) limit 0, 1) as codigo,
  tc_mantic_articulos.fabricante,  
  tc_mantic_articulos.nombre,
  ' ' as origen,
  tc_mantic_articulos.descripcion,
  tc_mantic_articulos.precio,
  tc_mantic_articulos.precio as original,
  tc_mantic_articulos.menudeo,
  tc_mantic_articulos.medio_mayoreo,
  tc_mantic_articulos.mayoreo,
  tc_mantic_articulos.sat,
  tc_mantic_articulos.limite_medio_mayoreo,
  tc_mantic_articulos.limite_mayoreo,
  tc_mantic_articulos.iva,
  tc_mantic_articulos.id_redondear,
  tc_mantic_unidades_medidas.nombre unidad_medida,
  ifnull(tc_mantic_articulos.extra, '0') as morado,
  concat(ifnull(tc_mantic_articulos.descuento, '0'), ',', ifnull(tc_mantic_articulos.extra, '0')) as porcentajes,	
  ifnull(tc_mantic_imagenes.id_imagen, -1) as id_imagen,	
  concat(tc_mantic_articulos.id_empresa, '/', ifnull(tc_mantic_imagenes.archivo, 'sin-foto.png')) as archivo,
  if(sum(tc_mantic_almacenes_articulos.stock) is null, 0, sum(tc_mantic_almacenes_articulos.stock)) as stock        
from 
  tc_mantic_articulos
inner join
  tc_mantic_articulos_codigos on tc_mantic_articulos.id_articulo = tc_mantic_articulos_codigos.id_articulo
inner join 
  tc_mantic_empresas on tc_mantic_articulos.id_empresa = tc_mantic_empresas.id_empresa								
inner join
  tr_mantic_empaque_unidad_medida on tc_mantic_articulos.id_empaque_unidad_medida = tr_mantic_empaque_unidad_medida.id_empaque_unidad_medida
inner join 
  tc_mantic_empaques on tr_mantic_empaque_unidad_medida.id_empaque = tc_mantic_empaques.id_empaque
inner join 
  tc_mantic_unidades_medidas on tr_mantic_empaque_unidad_medida.id_unidad_medida = tc_mantic_unidades_medidas.id_unidad_medida
left join
  tc_mantic_imagenes on tc_mantic_articulos.id_imagen= tc_mantic_imagenes.id_imagen
left join
  tc_mantic_almacenes_articulos on tc_mantic_almacenes_articulos.id_articulo= tc_mantic_articulos.id_articulo and tc_mantic_almacenes_articulos.id_almacen= {idAlmacen}
where 
  tc_mantic_empresas.id_empresa in ({sucursales})
  and tc_mantic_articulos.id_articulo_tipo= {idArticuloTipo}
  and tc_mantic_articulos.id_vigente= 1
  and (
    (upper(tc_mantic_articulos_codigos.codigo) like '{codigo}%' and tc_mantic_articulos_codigos.id_proveedor is null)
    or
    (upper(tc_mantic_articulos_codigos.codigo) like '{codigo}%' and tc_mantic_articulos_codigos.id_proveedor = {idProveedor})
    or	
    tc_mantic_articulos.id_articulo= {idArticulo}
   )		
group by
  tc_mantic_articulos.id_articulo
order by   
  tc_mantic_articulos.nombre
			</select>     
			<select id="porNombreCompleto">
select 
  tc_mantic_articulos.id_articulo as id_key,
  tc_mantic_articulos.id_articulo,
  (select tc_mantic_articulos_codigos.codigo from tc_mantic_articulos_codigos where tc_mantic_articulos_codigos.id_articulo= tc_mantic_articulos.id_articulo and tc_mantic_articulos_codigos.id_principal= 1 and (upper(tc_mantic_articulos.nombre) regexp '.*{codigo}.*' or tc_mantic_articulos.id_articulo= {idArticulo}) limit 0, 1) as propio,
  (select tc_mantic_articulos_codigos.codigo from tc_mantic_articulos_codigos where tc_mantic_articulos_codigos.id_articulo= tc_mantic_articulos.id_articulo and tc_mantic_articulos_codigos.id_proveedor= {idProveedor} and (upper(tc_mantic_articulos.nombre) regexp '.*{codigo}.*' or tc_mantic_articulos.id_articulo= {idArticulo}) limit 0, 1) as codigo,
  tc_mantic_articulos.fabricante,  
  tc_mantic_articulos.nombre,
  '   ' as origen,
  tc_mantic_articulos.descripcion,
  tc_mantic_articulos.precio,
  tc_mantic_articulos.precio as original,
  tc_mantic_articulos.menudeo,
  tc_mantic_articulos.medio_mayoreo,
  tc_mantic_articulos.mayoreo,
  tc_mantic_articulos.sat,
  tc_mantic_articulos.limite_medio_mayoreo,
  tc_mantic_articulos.limite_mayoreo,
  tc_mantic_articulos.iva,
  tc_mantic_articulos.id_redondear,
  tc_mantic_unidades_medidas.nombre unidad_medida,
  ifnull(tc_mantic_articulos.extra, '0') as morado,
  concat(ifnull(tc_mantic_articulos.descuento, '0'), ',', ifnull(tc_mantic_articulos.extra, '0')) as porcentajes,
  ifnull(tc_mantic_imagenes.id_imagen, -1) as id_imagen,
  concat(tc_mantic_articulos.id_empresa, '/', ifnull(tc_mantic_imagenes.archivo, 'sin-foto.png')) as archivo,
  if(sum(tc_mantic_almacenes_articulos.stock) is null, 0, sum(tc_mantic_almacenes_articulos.stock)) as stock        
from 
  tc_mantic_articulos
inner join 
  tc_mantic_empresas on tc_mantic_articulos.id_empresa = tc_mantic_empresas.id_empresa
inner join
  tr_mantic_empaque_unidad_medida on tc_mantic_articulos.id_empaque_unidad_medida = tr_mantic_empaque_unidad_medida.id_empaque_unidad_medida
inner join 
  tc_mantic_empaques on tr_mantic_empaque_unidad_medida.id_empaque = tc_mantic_empaques.id_empaque
inner join 
  tc_mantic_unidades_medidas on tr_mantic_empaque_unidad_medida.id_unidad_medida = tc_mantic_unidades_medidas.id_unidad_medida
left join
  tc_mantic_imagenes on tc_mantic_articulos.id_imagen= tc_mantic_imagenes.id_imagen
left join
  tc_mantic_almacenes_articulos on tc_mantic_almacenes_articulos.id_articulo= tc_mantic_articulos.id_articulo and tc_mantic_almacenes_articulos.id_almacen= {idAlmacen}
where 
  tc_mantic_empresas.id_empresa in ({sucursales})
  and tc_mantic_articulos.id_articulo_tipo= {idArticuloTipo}
  and tc_mantic_articulos.id_vigente= 1
  and 
  (upper(tc_mantic_articulos.nombre) regexp '.*{codigo}.*' or tc_mantic_articulos.id_articulo= {idArticulo})
group by
  tc_mantic_articulos.id_articulo
order by   
  tc_mantic_articulos.nombre
			</select>       
			<select id="comprados">
				select
					tc_mantic_notas_detalles.id_articulo as id_key,
					tc_mantic_notas_detalles.id_articulo
				from
					tc_mantic_notas_entradas                 
				inner join
					tc_mantic_notas_detalles on tc_mantic_notas_entradas.id_nota_entrada= tc_mantic_notas_detalles.id_nota_entrada         
				where
				  tc_mantic_notas_entradas.id_empresa in ({sucursales})
					and tc_mantic_notas_entradas.id_proveedor= {idProveedor}	
					and tc_mantic_notas_detalles.id_articulo in ({articulos})	
					and tc_mantic_notas_entradas.id_nota_estatus in (3, 5, 6)
        group by
          tc_mantic_notas_detalles.id_articulo				
			</select>
			<select id="pendientes">
				select
					tc_mantic_devoluciones.id_devolucion as id_key,
					tc_mantic_devoluciones.consecutivo,
					tc_mantic_devoluciones.id_devolucion_estatus,
					tc_mantic_devoluciones.total,
					tc_mantic_devoluciones.registro registro
				from
					tc_mantic_notas_entradas                 
				inner join
					tc_mantic_devoluciones on tc_mantic_notas_entradas.id_nota_entrada= tc_mantic_devoluciones.id_nota_entrada         
				inner join
					tc_mantic_empresas on tc_mantic_devoluciones.id_empresa= tc_mantic_empresas.id_empresa         
				inner join
					tc_mantic_devoluciones_estatus on tc_mantic_devoluciones.id_devolucion_estatus=tc_mantic_devoluciones_estatus.id_devolucion_estatus and tc_mantic_devoluciones.id_devolucion_estatus= 1
				where
					tc_mantic_notas_entradas.id_proveedor= {idProveedor}			
			</select>
			<select id="movimientos">
				select
					tc_mantic_ordenes_bitacora.id_orden_bitacora as id_key,
					tc_mantic_ordenes_bitacora.consecutivo,
					tc_mantic_ordenes_bitacora.importe,
					tc_mantic_ordenes_bitacora.justificacion,
					concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) as nombre,
				  tc_mantic_ordenes_estatus.nombre as estatus,
					tc_mantic_ordenes_bitacora.registro
				from 
					tc_mantic_ordenes_bitacora
				inner join
					tc_mantic_ordenes_estatus on tc_mantic_ordenes_bitacora.id_orden_estatus= tc_mantic_ordenes_estatus.id_orden_estatus
				inner join
					tc_janal_usuarios on tc_mantic_ordenes_bitacora.id_usuario= tc_janal_usuarios.id_usuario
				inner join
					tc_mantic_personas on tc_janal_usuarios.id_persona= tc_mantic_personas.id_persona
				where
					tc_mantic_ordenes_bitacora.id_orden_compra= {idOrdenCompra}
				order by
					tc_mantic_ordenes_bitacora.registro desc				
			</select>		
			<select id="lazy">
				select
					tc_mantic_ordenes_compras.id_orden_compra as id_key,
					tc_mantic_ordenes_compras.id_empresa,  
          tc_mantic_ordenes_compras.id_almacen,
          tc_mantic_almacenes.nombre as almacen,
				  tc_mantic_empresas.nombre as empresa,  
					tc_mantic_ordenes_compras.consecutivo,  
					tc_mantic_proveedores.id_proveedor,  
					tc_mantic_proveedores.razon_social as proveedor,
					tc_mantic_ordenes_compras.total,
				  tc_mantic_ordenes_estatus.nombre as estatus,
					tc_mantic_ordenes_compras.id_orden_estatus,
					tc_mantic_ordenes_compras.registro,
					tc_mantic_ordenes_estatus.estatus_asociados,
				  tc_mantic_clientes.id_cliente,
				  if(tc_mantic_clientes.razon_social is null, '', tc_mantic_clientes.razon_social) as cliente
				from 
					tc_mantic_ordenes_compras
				inner join 
					tr_mantic_proveedor_pago on tc_mantic_ordenes_compras.id_proveedor_pago= tr_mantic_proveedor_pago.id_proveedor_pago
				inner join 
					tc_mantic_proveedores on tr_mantic_proveedor_pago.id_proveedor= tc_mantic_proveedores.id_proveedor
				inner join 
					tc_mantic_empresas on tc_mantic_ordenes_compras.id_empresa= tc_mantic_empresas.id_empresa
				inner join 
					tc_mantic_ordenes_estatus on tc_mantic_ordenes_compras.id_orden_estatus=tc_mantic_ordenes_estatus.id_orden_estatus
				inner join 
					tc_mantic_almacenes on tc_mantic_ordenes_compras.id_almacen=tc_mantic_almacenes.id_almacen
				left join 
					tc_mantic_clientes on tc_mantic_ordenes_compras.id_cliente=tc_mantic_clientes.id_cliente
				where
					tc_mantic_ordenes_compras.id_empresa in ({idEmpresa})
					and {condicion}
				{sortOrder}
			</select>
			<select id="solicitado">
        select      
          tc_mantic_ordenes_detalles.id_orden_detalle as id_key,
				  tc_mantic_articulos.nombre,     
				  tc_mantic_ordenes_compras.consecutivo,
          tc_mantic_ordenes_detalles.cantidad,
          tc_mantic_ordenes_detalles.costo/tc_mantic_ordenes_compras.tipo_de_cambio as costo,
				  tc_mantic_ordenes_detalles.descuento,
				  tc_mantic_ordenes_detalles.extras,
          tc_mantic_proveedores.rfc,
          tc_mantic_proveedores.prefijo,
          tc_mantic_proveedores.razon_social,
          tc_mantic_tipos_monedas.nombre as moneda,
          tc_mantic_ordenes_detalles.registro
        from      
          tc_mantic_ordenes_detalles
				inner join
					tc_mantic_articulos on tc_mantic_ordenes_detalles.id_articulo = tc_mantic_articulos.id_articulo
				inner join 
					tc_mantic_ordenes_compras on tc_mantic_ordenes_detalles.id_orden_compra= tc_mantic_ordenes_compras.id_orden_compra
				inner join
					tc_mantic_proveedores on tc_mantic_ordenes_compras.id_proveedor= tc_mantic_proveedores.id_proveedor       
        inner join 
          tc_mantic_tipos_monedas on tc_mantic_proveedores.id_tipo_moneda= tc_mantic_tipos_monedas.id_tipo_moneda
        where      
          tc_mantic_ordenes_detalles.id_articulo= {idArticulo}
				  and tc_mantic_ordenes_compras.id_almacen= {idAlmacen}
          and tc_mantic_ordenes_compras.id_orden_estatus in (3,4)
        order by
          tc_mantic_ordenes_detalles.registro desc				
			</select>
			<select id="almacen">
				select
					tc_mantic_articulos.id_articulo as id_key,
				  tc_mantic_almacenes.id_empresa,
					tc_mantic_articulos_codigos.codigo as propio,
					tc_mantic_articulos.nombre,
					tc_mantic_articulos.precio as costo,
					'0.00' as descuento,
					-1 as id_orden_compra,
					'0.00' as extras,
					tc_mantic_articulos.precio as importe,
					(select tc_mantic_articulos_codigos.codigo from tc_mantic_articulos_codigos where tc_mantic_articulos_codigos.id_articulo= tc_mantic_articulos.id_articulo and tc_mantic_articulos_codigos.id_proveedor= {idProveedor} limit 0, 1) as codigo,
					tc_mantic_articulos.iva,
					0.0 as total_impuesto,
					0.0 as sub_total,
					tc_mantic_almacenes_articulos.maximo- tc_mantic_almacenes_articulos.stock as cantidad,
					-1 as id_orden_detalle,
					tc_mantic_articulos.id_articulo,
					0.0 as descuentos,
					-1 as id_proveedor,
					tc_mantic_almacenes_articulos.stock,
					tc_mantic_almacenes_articulos.minimo,
					tc_mantic_almacenes_articulos.maximo
				from
					tc_mantic_articulos
				inner join
					tc_mantic_almacenes_articulos on tc_mantic_articulos.id_articulo= tc_mantic_almacenes_articulos.id_articulo
				inner join
					tc_mantic_almacenes on tc_mantic_almacenes_articulos.id_almacen= tc_mantic_almacenes.id_almacen
				inner join
					tc_mantic_articulos_codigos on tc_mantic_articulos.id_articulo= tc_mantic_articulos_codigos.id_articulo
				where 
					tc_mantic_almacenes.id_empresa in ({sucursales})
					and tc_mantic_almacenes.id_almacen= {idAlmacen}
					and tc_mantic_almacenes_articulos.stock &lt;= tc_mantic_almacenes_articulos.minimo
					and tc_mantic_articulos_codigos.id_principal= 1
				order by
					tc_mantic_articulos.nombre
			</select>
			<select id="proveedor">
				select
					tc_mantic_articulos.id_articulo as id_key,
					(select tc_mantic_articulos_codigos.codigo from tc_mantic_articulos_codigos where tc_mantic_articulos_codigos.id_articulo= tc_mantic_articulos.id_articulo and tc_mantic_articulos_codigos.id_principal= 1 limit 0, 1) as propio,
					tc_mantic_articulos.nombre,
					tc_mantic_articulos.precio as costo,
					'0.00' as descuento,
					-1 as id_orden_compra,
					'0.00' as extras,
					tc_mantic_articulos.precio as importe,
					tc_mantic_articulos_codigos.codigo,
					tc_mantic_articulos.iva,
					0.0 as total_impuesto,
					0.0 as sub_total,
					tc_mantic_almacenes_articulos.maximo- tc_mantic_almacenes_articulos.stock as cantidad,
					-1 as id_orden_detalle,
					tc_mantic_articulos.id_articulo,
					0.0 as descuentos,
					tc_mantic_proveedores.id_proveedor,
					tc_mantic_almacenes_articulos.stock,
					tc_mantic_almacenes_articulos.minimo,
					tc_mantic_almacenes_articulos.maximo
				from
					tc_mantic_articulos
				inner join
					tc_mantic_almacenes_articulos on tc_mantic_articulos.id_articulo= tc_mantic_almacenes_articulos.id_articulo
				inner join
					tc_mantic_almacenes on tc_mantic_almacenes_articulos.id_almacen= tc_mantic_almacenes.id_almacen
				inner join
					tc_mantic_articulos_codigos on tc_mantic_articulos.id_articulo= tc_mantic_articulos_codigos.id_articulo
				inner join
					tc_mantic_proveedores on tc_mantic_articulos_codigos.id_proveedor= tc_mantic_proveedores.id_proveedor
				where 
					tc_mantic_almacenes.id_empresa in ({sucursales})
					and tc_mantic_almacenes.id_almacen= {idAlmacen}
					and tc_mantic_almacenes_articulos.stock&lt;= tc_mantic_almacenes_articulos.minimo
					and tc_mantic_proveedores.id_proveedor= {idProveedor}
				order by
					tc_mantic_articulos.nombre				
			</select>
			<select id="faltantes">
				select * from
					(select
						tc_mantic_articulos.id_articulo as id_key,
						tc_mantic_articulos.id_articulo,
				    -1 as id_orden_detalle,
						tc_mantic_articulos_codigos.codigo as propio,
						tc_mantic_articulos.nombre,
						(select tc_mantic_articulos_codigos.codigo from tc_mantic_articulos_codigos where tc_mantic_articulos_codigos.id_articulo= tc_mantic_articulos.id_articulo and tc_mantic_articulos_codigos.id_proveedor= {idProveedor} limit 0, 1) as codigo,
						tc_mantic_articulos.iva,
						tc_mantic_articulos.precio as costo,
						tc_mantic_articulos.precio,
						'   ' as consecutivo,
						0 as id_orden_estatus,
						'   ' as estatus, 
						0 as solicitado,
						0 as llegaron,
						tc_mantic_almacenes_articulos.maximo- tc_mantic_almacenes_articulos.stock as cantidad,
						tc_mantic_almacenes_articulos.stock,
						tc_mantic_almacenes_articulos.minimo,
						tc_mantic_almacenes_articulos.maximo
					from
						tc_mantic_articulos
					inner join
						tc_mantic_almacenes_articulos on tc_mantic_articulos.id_articulo= tc_mantic_almacenes_articulos.id_articulo
					inner join
						tc_mantic_almacenes on tc_mantic_almacenes_articulos.id_almacen= tc_mantic_almacenes.id_almacen
					inner join 
						tc_mantic_inventarios on tc_mantic_articulos.id_articulo= tc_mantic_inventarios.id_articulo and tc_mantic_inventarios.id_almacen= {idAlmacen}
					inner join
						tc_mantic_articulos_codigos on tc_mantic_articulos.id_articulo= tc_mantic_articulos_codigos.id_articulo
					where 
						tc_mantic_almacenes.id_empresa in ({sucursales})
						and tc_mantic_almacenes.id_almacen= {idAlmacen}
				    and tc_mantic_articulos.id_descontinuado= 2
				    and tc_mantic_articulos.id_vigente= 1
						and tc_mantic_inventarios.id_automatico= 2
						and tc_mantic_almacenes_articulos.stock &lt;= tc_mantic_almacenes_articulos.minimo
						and tc_mantic_articulos_codigos.id_principal= 1
            and (tc_mantic_articulos.nombre regexp '.*{codigoFaltante}.*' or upper(tc_mantic_articulos_codigos.codigo) regexp '.*{codigoFaltante}.*')										
						and tc_mantic_articulos.id_articulo not in 
				    (select tc_mantic_ordenes_detalles.id_articulo from tc_mantic_ordenes_detalles 
				     inner join tc_mantic_ordenes_compras on tc_mantic_ordenes_detalles.id_orden_compra= tc_mantic_ordenes_compras.id_orden_compra and tc_mantic_ordenes_compras.id_orden_estatus in (3,4,5,7))
				union						
					select
						 id_key,
						 id_articulo,
						 id_orden_detalle,
						 propio,
						 nombre,
						 codigo,
						 iva,
						 costo,
						 precio,
						 consecutivo,
						 id_orden_estatus,
						 estatus,
						 solicitado,
						 llegaron,
						 cantidad,
						 stock,
						 minimo,
						 maximo      
					from (
						select
							tc_mantic_articulos.id_articulo as id_key,
							tc_mantic_articulos.id_articulo,
							tc_mantic_ordenes_detalles.id_orden_detalle,
							tc_mantic_articulos_codigos.codigo as propio,
							tc_mantic_articulos.nombre,
							(select tc_mantic_articulos_codigos.codigo from tc_mantic_articulos_codigos where tc_mantic_articulos_codigos.id_articulo= tc_mantic_articulos.id_articulo and tc_mantic_articulos_codigos.id_proveedor= {idProveedor} limit 0, 1) as codigo,
							tc_mantic_articulos.iva,
							tc_mantic_articulos.precio as costo,
							tc_mantic_articulos.precio,
							ifnull(tc_mantic_ordenes_compras.consecutivo, '   ') as consecutivo,
							ifnull(tc_mantic_ordenes_compras.id_orden_estatus, 0) as id_orden_estatus,
							ifnull(tc_mantic_ordenes_estatus.nombre, '   ') as estatus, 
							ifnull(tc_mantic_ordenes_detalles.cantidad, 0) as solicitado,
							ifnull(tc_mantic_ordenes_detalles.cantidad- tc_mantic_ordenes_detalles.cantidades, 0) as llegaron,
							tc_mantic_almacenes_articulos.maximo- tc_mantic_almacenes_articulos.stock as cantidad,
							tc_mantic_almacenes_articulos.stock,
							tc_mantic_almacenes_articulos.minimo,
							tc_mantic_almacenes_articulos.maximo
						from
							tc_mantic_articulos
						inner join
							tc_mantic_almacenes_articulos on tc_mantic_articulos.id_articulo= tc_mantic_almacenes_articulos.id_articulo
						inner join
							tc_mantic_almacenes on tc_mantic_almacenes_articulos.id_almacen= tc_mantic_almacenes.id_almacen
						inner join 
							tc_mantic_inventarios on tc_mantic_articulos.id_articulo= tc_mantic_inventarios.id_articulo and tc_mantic_inventarios.id_almacen= {idAlmacen}
						inner join
							tc_mantic_articulos_codigos on tc_mantic_articulos.id_articulo= tc_mantic_articulos_codigos.id_articulo
						left join	
							tc_mantic_ordenes_detalles on tc_mantic_articulos.id_articulo= tc_mantic_ordenes_detalles.id_articulo
						left join 
							tc_mantic_ordenes_compras on tc_mantic_ordenes_detalles.id_orden_compra= tc_mantic_ordenes_compras.id_orden_compra
						left join
							tc_mantic_ordenes_estatus on tc_mantic_ordenes_estatus.id_orden_estatus= tc_mantic_ordenes_compras.id_orden_estatus
						where 
							tc_mantic_almacenes.id_empresa in ({sucursales})
							and tc_mantic_almacenes.id_almacen= {idAlmacen}
  				    and tc_mantic_articulos.id_descontinuado= 2
   				    and tc_mantic_articulos.id_vigente= 1
							and tc_mantic_inventarios.id_automatico= 2
							and tc_mantic_almacenes_articulos.stock &lt;= tc_mantic_almacenes_articulos.minimo
							and tc_mantic_articulos_codigos.id_principal= 1
              and (tc_mantic_articulos.nombre regexp '.*{codigoFaltante}.*' or upper(tc_mantic_articulos_codigos.codigo) regexp '.*{codigoFaltante}.*')										
							and (tc_mantic_ordenes_compras.id_orden_estatus in (3,4,5,7) or tc_mantic_ordenes_compras.id_orden_estatus is null)
						order by
							tc_mantic_articulos.nombre, tc_mantic_ordenes_detalles.registro desc
					) as faltantes
					inner join (
						select 
							max(tc_mantic_ordenes_detalles.id_orden_detalle) as id_maximo_detalle,
							tc_mantic_ordenes_detalles.id_articulo as id_maximo_articulo
						from 
							tc_mantic_ordenes_detalles 
						inner join
							tc_mantic_ordenes_compras on tc_mantic_ordenes_detalles.id_orden_compra= tc_mantic_ordenes_compras.id_orden_compra   
						 where
							 (tc_mantic_ordenes_compras.id_orden_estatus in (3,4,5,7) or tc_mantic_ordenes_compras.id_orden_estatus is null)
						group by
							tc_mantic_ordenes_detalles.id_articulo  
						order by  
							tc_mantic_ordenes_detalles.id_articulo      
					) as ultimo on faltantes.id_orden_detalle= ultimo.id_maximo_detalle and faltantes.id_articulo= ultimo.id_maximo_articulo
				) as compras
				order by
					propio				
			</select>			
			<select id="prealmacen">
				select 
				  compras.*,
				  '0.00' as descuento,
				  '0.00' as extras, 
				  0.0 as total_impuesto,
				  0.0 as sub_total,
				  0.0 as descuentos,
				  compras.precio as importe,
				  -1 as id_orden_compra,
				  {idProveedor} as id_proveedor
				from
					(select
						tc_mantic_articulos.id_articulo as id_key,
						tc_mantic_articulos.id_articulo,
				    -1 as id_orden_detalle,
						tc_mantic_articulos_codigos.codigo as propio,
						tc_mantic_articulos.nombre,
						(select tc_mantic_articulos_codigos.codigo from tc_mantic_articulos_codigos where tc_mantic_articulos_codigos.id_articulo= tc_mantic_articulos.id_articulo and tc_mantic_articulos_codigos.id_proveedor= {idProveedor} limit 0, 1) as codigo,
						tc_mantic_articulos.iva,
						tc_mantic_articulos.precio as costo,
						tc_mantic_articulos.precio,
						'   ' as consecutivo,
						0 as id_orden_estatus,
						'   ' as estatus, 
						0 as solicitado,
						0 as llegaron,
						tc_mantic_almacenes_articulos.maximo- tc_mantic_almacenes_articulos.stock as cantidad,
						tc_mantic_almacenes_articulos.stock,
						tc_mantic_almacenes_articulos.minimo,
						tc_mantic_almacenes_articulos.maximo,
				    (select tc_mantic_articulos_codigos.multiplo from tc_mantic_articulos_codigos where tc_mantic_articulos_codigos.id_articulo= tc_mantic_articulos.id_articulo and tc_mantic_articulos_codigos.id_proveedor= {idProveedor} limit 0, 1) as multiplo
					from
						tc_mantic_articulos
					inner join
						tc_mantic_almacenes_articulos on tc_mantic_articulos.id_articulo= tc_mantic_almacenes_articulos.id_articulo
					inner join
						tc_mantic_almacenes on tc_mantic_almacenes_articulos.id_almacen= tc_mantic_almacenes.id_almacen
					inner join 
						tc_mantic_inventarios on tc_mantic_articulos.id_articulo= tc_mantic_inventarios.id_articulo and tc_mantic_inventarios.id_almacen= {idAlmacen}
					inner join
						tc_mantic_articulos_codigos on tc_mantic_articulos.id_articulo= tc_mantic_articulos_codigos.id_articulo
					where 
						tc_mantic_almacenes.id_empresa= {idSucursal}
						and tc_mantic_almacenes.id_almacen= {idAlmacen}
				    and tc_mantic_articulos.id_descontinuado= 2
				    and tc_mantic_articulos.id_vigente= 1
						and tc_mantic_inventarios.id_automatico= 2
						and tc_mantic_almacenes_articulos.stock &lt;= tc_mantic_almacenes_articulos.minimo
						and tc_mantic_articulos_codigos.id_principal= 1
            and (tc_mantic_articulos.nombre regexp '.*{codigoFaltante}.*' or upper(tc_mantic_articulos_codigos.codigo) regexp '.*{codigoFaltante}.*')										
						and tc_mantic_articulos.id_articulo not in 
				    (select 
				      tc_mantic_ordenes_detalles.id_articulo 
				     from 
				      tc_mantic_ordenes_detalles 
				     inner join tc_mantic_ordenes_compras on tc_mantic_ordenes_detalles.id_orden_compra= tc_mantic_ordenes_compras.id_orden_compra 
				      and tc_mantic_ordenes_compras.id_orden_estatus in (3,4,5)
				      and tc_mantic_ordenes_compras.id_proveedor= {idProveedor})
				union						
					select
						 id_key,
						 id_articulo,
						 id_orden_detalle,
						 propio,
						 nombre,
						 codigo,
						 iva,
						 costo,
						 precio,
						 consecutivo,
						 id_orden_estatus,
						 estatus,
						 solicitado,
						 llegaron,
						 cantidad,
						 stock,
						 minimo,
						 maximo,
						 multiplo      
					from (
						select
							tc_mantic_articulos.id_articulo as id_key,
							tc_mantic_articulos.id_articulo,
							tc_mantic_ordenes_detalles.id_orden_detalle,
							tc_mantic_articulos_codigos.codigo as propio,
							tc_mantic_articulos.nombre,
							(select tc_mantic_articulos_codigos.codigo from tc_mantic_articulos_codigos where tc_mantic_articulos_codigos.id_articulo= tc_mantic_articulos.id_articulo and tc_mantic_articulos_codigos.id_proveedor= {idProveedor} limit 0, 1) as codigo,
							tc_mantic_articulos.iva,
							tc_mantic_articulos.precio as costo,
							tc_mantic_articulos.precio,
							ifnull(tc_mantic_ordenes_compras.consecutivo, '   ') as consecutivo,
							ifnull(tc_mantic_ordenes_compras.id_orden_estatus, 0) as id_orden_estatus,
							ifnull(tc_mantic_ordenes_estatus.nombre, '   ') as estatus, 
							ifnull(tc_mantic_ordenes_detalles.cantidad, 0) as solicitado,
							ifnull(tc_mantic_ordenes_detalles.cantidad- tc_mantic_ordenes_detalles.cantidades, 0) as llegaron,
							tc_mantic_almacenes_articulos.maximo- tc_mantic_almacenes_articulos.stock as cantidad,
							tc_mantic_almacenes_articulos.stock,
							tc_mantic_almacenes_articulos.minimo,
							tc_mantic_almacenes_articulos.maximo,
							(select tc_mantic_articulos_codigos.multiplo from tc_mantic_articulos_codigos where tc_mantic_articulos_codigos.id_articulo= tc_mantic_articulos.id_articulo and tc_mantic_articulos_codigos.id_proveedor= {idProveedor} limit 0, 1) as multiplo
						from
							tc_mantic_articulos
						inner join
							tc_mantic_almacenes_articulos on tc_mantic_articulos.id_articulo= tc_mantic_almacenes_articulos.id_articulo
						inner join
							tc_mantic_almacenes on tc_mantic_almacenes_articulos.id_almacen= tc_mantic_almacenes.id_almacen
						inner join 
							tc_mantic_inventarios on tc_mantic_articulos.id_articulo= tc_mantic_inventarios.id_articulo and tc_mantic_inventarios.id_almacen= {idAlmacen}
						inner join
							tc_mantic_articulos_codigos on tc_mantic_articulos.id_articulo= tc_mantic_articulos_codigos.id_articulo
						left join	
							tc_mantic_ordenes_detalles on tc_mantic_articulos.id_articulo= tc_mantic_ordenes_detalles.id_articulo
						left join 
							tc_mantic_ordenes_compras on tc_mantic_ordenes_detalles.id_orden_compra= tc_mantic_ordenes_compras.id_orden_compra
						left join
							tc_mantic_ordenes_estatus on tc_mantic_ordenes_estatus.id_orden_estatus= tc_mantic_ordenes_compras.id_orden_estatus
						where 
							tc_mantic_almacenes.id_empresa= {idSucursal}
							and tc_mantic_almacenes.id_almacen= {idAlmacen}
  				    and tc_mantic_articulos.id_descontinuado= 2
   				    and tc_mantic_articulos.id_vigente= 1
							and tc_mantic_inventarios.id_automatico= 2
							and tc_mantic_almacenes_articulos.stock &lt;= tc_mantic_almacenes_articulos.minimo
							and tc_mantic_articulos_codigos.id_principal= 1
              and (tc_mantic_articulos.nombre regexp '.*{codigoFaltante}.*' or upper(tc_mantic_articulos_codigos.codigo) regexp '.*{codigoFaltante}.*')										
							and (tc_mantic_ordenes_compras.id_orden_estatus in (3,4,5) or tc_mantic_ordenes_compras.id_orden_estatus is null)
							and tc_mantic_ordenes_compras.id_proveedor= {idProveedor}
						order by
							tc_mantic_articulos.nombre, tc_mantic_ordenes_detalles.registro desc
					) as faltantes
					inner join (
						select 
							max(tc_mantic_ordenes_detalles.id_orden_detalle) as id_maximo_detalle,
							tc_mantic_ordenes_detalles.id_articulo as id_maximo_articulo
						from 
							tc_mantic_ordenes_detalles 
						inner join
							tc_mantic_ordenes_compras on tc_mantic_ordenes_detalles.id_orden_compra= tc_mantic_ordenes_compras.id_orden_compra   
						 where
							 (tc_mantic_ordenes_compras.id_orden_estatus in (3,4,5,7) or tc_mantic_ordenes_compras.id_orden_estatus is null)
							 and tc_mantic_ordenes_compras.id_proveedor= {idProveedor}
						group by
							tc_mantic_ordenes_detalles.id_articulo  
						order by  
							tc_mantic_ordenes_detalles.id_articulo      
					) as ultimo on faltantes.id_orden_detalle= ultimo.id_maximo_detalle and faltantes.id_articulo= ultimo.id_maximo_articulo
				) as compras
				order by
					propio				
			</select>			
			<select id="ultimo">
        select      
          tc_mantic_notas_detalles.id_orden_detalle as id_key,
				  tc_mantic_articulos.nombre,
				  tc_mantic_notas_entradas.consecutivo,
          tc_mantic_notas_detalles.costo,
          tc_mantic_notas_detalles.costo_real,
          tc_mantic_notas_detalles.costo_calculado,
				  tc_mantic_notas_detalles.descuento,
				  tc_mantic_notas_detalles.extras,
          tc_mantic_articulos.stock,
          tc_mantic_proveedores.razon_social,
          tc_mantic_tipos_monedas.nombre as moneda,
          tc_mantic_notas_detalles.registro
        from      
          tc_mantic_notas_detalles
				inner join
					tc_mantic_articulos on tc_mantic_notas_detalles.id_articulo = tc_mantic_articulos.id_articulo
				inner join 
					tc_mantic_notas_entradas on tc_mantic_notas_detalles.id_nota_entrada= tc_mantic_notas_entradas.id_nota_entrada
				inner join
					tc_mantic_proveedores on tc_mantic_notas_entradas.id_proveedor= tc_mantic_proveedores.id_proveedor       
        inner join 
          tc_mantic_tipos_monedas on tc_mantic_proveedores.id_tipo_moneda= tc_mantic_tipos_monedas.id_tipo_moneda
        where      
          tc_mantic_notas_detalles.id_articulo= {idArticulo}
				  and tc_mantic_notas_entradas.id_almacen= {idAlmacen}
          and tc_mantic_notas_entradas.id_nota_estatus in (3,5)
        order by
          tc_mantic_notas_detalles.registro desc				
			</select>
			<select id="sugerido">
        select      
          tr_mantic_articulo_precio_sugerido.id_articulo_precio_sugerido as id_key,   
				  tc_mantic_articulos.nombre,     
          tc_mantic_proveedores.clave as clave_proveedor,
          tc_mantic_proveedores.razon_social as proveedor,
          tr_mantic_articulo_precio_sugerido.precio,
          tr_mantic_articulo_precio_sugerido.descuento,
          tr_mantic_articulo_precio_sugerido.observaciones,
          tr_mantic_articulo_precio_sugerido.id_leido
        from      
          tr_mantic_articulo_precio_sugerido
				inner join
					tc_mantic_articulos on tr_mantic_articulo_precio_sugerido.id_articulo = tc_mantic_articulos.id_articulo
				inner join 
					tc_mantic_proveedores on tr_mantic_articulo_precio_sugerido.id_proveedor= tc_mantic_proveedores.id_proveedor
        where      
          tr_mantic_articulo_precio_sugerido.id_articulo = {idArticulo} and tr_mantic_articulo_precio_sugerido.id_leido= 2
				order by
				  tr_mantic_articulo_precio_sugerido.registro				
			</select>
			<select id="articulo">
        select 
          tc_mantic_articulos_codigos.id_articulo_codigo as id_key,
				  tc_mantic_articulos.id_articulo,
				  tc_mantic_articulos_codigos.codigo,
				  tc_mantic_articulos_codigos.id_principal,
				  tc_mantic_articulos_codigos.id_proveedor
				from 
					tc_mantic_articulos
				inner join
					tc_mantic_articulos_codigos on tc_mantic_articulos.id_articulo = tc_mantic_articulos_codigos.id_articulo
				inner join 
					tc_mantic_empresas on tc_mantic_articulos.id_empresa = tc_mantic_empresas.id_empresa
				where 
					tc_mantic_empresas.id_empresa in ({sucursales})
				  and (
				    (tc_mantic_articulos.id_articulo= {idArticulo} and tc_mantic_articulos_codigos.id_principal= 1)
				    or
				    (tc_mantic_articulos.id_articulo= {idArticulo} and tc_mantic_articulos_codigos.id_proveedor= {idProveedor})	
				   ) 			
				order by 
				  tc_mantic_articulos_codigos.id_articulo,
				  tc_mantic_articulos_codigos.id_principal
			</select>
			<select id="codigos">
				select 
				  tc_mantic_articulos_codigos.id_articulo_codigo as id_key,
				  tc_mantic_articulos.id_articulo,
				  tc_mantic_articulos_codigos.codigo as propio,
				  (select tc_mantic_articulos_codigos.codigo from tc_mantic_articulos_codigos where tc_mantic_articulos_codigos.id_articulo= tc_mantic_articulos.id_articulo and tc_mantic_articulos_codigos.id_proveedor= {idProveedor} limit 0, 1) as codigo,
				  tc_mantic_articulos_codigos.id_principal,
				  tc_mantic_articulos_codigos.id_proveedor,
				  tc_mantic_articulos.nombre,
				  tc_mantic_articulos.precio,
				  tc_mantic_articulos.iva,
				  tc_mantic_articulos.id_redondear
				from 
					tc_mantic_articulos
				inner join
					tc_mantic_articulos_codigos on tc_mantic_articulos.id_articulo = tc_mantic_articulos_codigos.id_articulo
				inner join 
					tc_mantic_empresas on tc_mantic_articulos.id_empresa = tc_mantic_empresas.id_empresa
				where 
					tc_mantic_empresas.id_empresa in ({sucursales})
				  and (
				      upper(tc_mantic_articulos_codigos.codigo) like '%{codigo}%'
				    or 
				      upper(tc_mantic_articulos.nombre) regexp '.*{codigo}.*'
				    or
				      (upper(tc_mantic_articulos_codigos.codigo) like '%{codigo}%' and tc_mantic_articulos_codigos.id_proveedor= {idProveedor})	
				    or
				      tc_mantic_articulos.id_articulo= {idArticulo}
				   ) 			
				order by 
				  tc_mantic_articulos.nombre
			</select>			
			<select id="porNombre">
select 
  tc_mantic_articulos.id_articulo as id_key,
  tc_mantic_articulos.id_articulo,
  (select tc_mantic_articulos_codigos.codigo from tc_mantic_articulos_codigos where tc_mantic_articulos_codigos.id_articulo= tc_mantic_articulos.id_articulo and tc_mantic_articulos_codigos.id_principal= 1 and (upper(tc_mantic_articulos.nombre) regexp '.*{codigo}.*' or tc_mantic_articulos.id_articulo= {idArticulo}) limit 0, 1) as propio,
  (select tc_mantic_articulos_codigos.codigo from tc_mantic_articulos_codigos where tc_mantic_articulos_codigos.id_articulo= tc_mantic_articulos.id_articulo and tc_mantic_articulos_codigos.id_proveedor= {idProveedor} and (upper(tc_mantic_articulos.nombre) regexp '.*{codigo}.*' or tc_mantic_articulos.id_articulo= {idArticulo}) limit 0, 1) as codigo,
  tc_mantic_articulos.fabricante,  
  tc_mantic_articulos.nombre,
  '   ' as origen,
  tc_mantic_articulos.descripcion,
  tc_mantic_articulos.precio,
  tc_mantic_articulos.precio as original,
  tc_mantic_articulos.menudeo,
  tc_mantic_articulos.medio_mayoreo,
  tc_mantic_articulos.mayoreo,
  tc_mantic_articulos.sat,
  tc_mantic_articulos.limite_medio_mayoreo,
  tc_mantic_articulos.limite_mayoreo,
  tc_mantic_articulos.iva,
  tc_mantic_articulos.id_redondear,
  tc_mantic_unidades_medidas.nombre unidad_medida,
  ifnull(tc_mantic_articulos.extra, '0') as morado,
  concat(ifnull(tc_mantic_articulos.descuento, '0'), ',', ifnull(tc_mantic_articulos.extra, '0')) as porcentajes,
  ifnull(tc_mantic_imagenes.id_imagen, -1) as id_imagen,
  concat(tc_mantic_articulos.id_empresa, '/', ifnull(tc_mantic_imagenes.archivo, 'sin-foto.png')) as archivo,
  if(sum(tc_mantic_almacenes_articulos.stock) is null, 0, sum(tc_mantic_almacenes_articulos.stock)) as stock
from 
  tc_mantic_articulos
inner join 
  tc_mantic_empresas on tc_mantic_articulos.id_empresa = tc_mantic_empresas.id_empresa
inner join
  tr_mantic_empaque_unidad_medida on tc_mantic_articulos.id_empaque_unidad_medida = tr_mantic_empaque_unidad_medida.id_empaque_unidad_medida
inner join 
  tc_mantic_empaques on tr_mantic_empaque_unidad_medida.id_empaque = tc_mantic_empaques.id_empaque
inner join 
  tc_mantic_unidades_medidas on tr_mantic_empaque_unidad_medida.id_unidad_medida = tc_mantic_unidades_medidas.id_unidad_medida
left join
  tc_mantic_imagenes on tc_mantic_articulos.id_imagen= tc_mantic_imagenes.id_imagen
left join
  tc_mantic_almacenes_articulos on tc_mantic_almacenes_articulos.id_articulo= tc_mantic_articulos.id_articulo and tc_mantic_almacenes_articulos.id_almacen= {idAlmacen}
where 
  tc_mantic_empresas.id_empresa in ({sucursales})
  and tc_mantic_articulos.id_articulo_tipo= 1
  and tc_mantic_articulos.id_vigente= 1
  and (upper(tc_mantic_articulos.nombre) regexp '.*{codigo}.*' or tc_mantic_articulos.id_articulo= {idArticulo})
group by
  tc_mantic_articulos.id_articulo
order by   
  tc_mantic_articulos.nombre
			</select>
			<select id="porTodos">
select 
  tc_mantic_articulos.id_articulo as id_key,
  tc_mantic_articulos.id_articulo,
  ifnull(tc_mantic_articulos.id_imagen, 0) as id_imagen,
  (select tc_mantic_articulos_codigos.codigo from tc_mantic_articulos_codigos where tc_mantic_articulos_codigos.id_articulo= tc_mantic_articulos.id_articulo and tc_mantic_articulos_codigos.id_principal= 1 and upper(tc_mantic_articulos.nombre) regexp '.*{codigo}.*' limit 0, 1) as propio,
  tc_mantic_articulos.fabricante,  
  tc_mantic_articulos.nombre,
  tc_mantic_articulos.descripcion,
  tc_mantic_articulos.precio,
  tc_mantic_articulos.menudeo,
  tc_mantic_articulos.medio_mayoreo,
  tc_mantic_articulos.mayoreo,
  tc_mantic_articulos.sat,
  tc_mantic_articulos.limite_medio_mayoreo,
  tc_mantic_articulos.limite_mayoreo,
  tc_mantic_articulos.iva,
  tc_mantic_articulos.id_redondear,
  tc_mantic_unidades_medidas.nombre unidad_medida,
  ifnull(tc_mantic_imagenes.id_imagen, -1) as id_imagen,
  concat(tc_mantic_articulos.id_empresa, '/', ifnull(tc_mantic_imagenes.archivo, 'sin-foto.png')) as archivo,
  if(sum(tc_mantic_almacenes_articulos.stock) is null, 0, sum(tc_mantic_almacenes_articulos.stock)) as stock
from 
  tc_mantic_articulos
inner join 
  tc_mantic_empresas on tc_mantic_articulos.id_empresa = tc_mantic_empresas.id_empresa
inner join
  tr_mantic_empaque_unidad_medida on tc_mantic_articulos.id_empaque_unidad_medida = tr_mantic_empaque_unidad_medida.id_empaque_unidad_medida
inner join 
  tc_mantic_empaques on tr_mantic_empaque_unidad_medida.id_empaque = tc_mantic_empaques.id_empaque
inner join 
  tc_mantic_unidades_medidas on tr_mantic_empaque_unidad_medida.id_unidad_medida = tc_mantic_unidades_medidas.id_unidad_medida
left join
  tc_mantic_imagenes on tc_mantic_articulos.id_imagen= tc_mantic_imagenes.id_imagen
left join
  tc_mantic_almacenes_articulos on tc_mantic_almacenes_articulos.id_articulo= tc_mantic_articulos.id_articulo and tc_mantic_almacenes_articulos.id_almacen= {idAlmacen}
where 
  tc_mantic_empresas.id_empresa in ({sucursales})
  and tc_mantic_articulos.id_vigente= 1
  and {condicion}
group by
  tc_mantic_articulos.id_articulo
order by   
  tc_mantic_articulos.nombre
			</select>		
			<select id="porNombreTipoArticulo">
				select 
				  tc_mantic_articulos.id_articulo as id_key,
				  tc_mantic_articulos.id_articulo,
				  (select tc_mantic_articulos_codigos.codigo from tc_mantic_articulos_codigos where tc_mantic_articulos_codigos.id_articulo= tc_mantic_articulos.id_articulo and tc_mantic_articulos_codigos.id_principal= 1 and (upper(tc_mantic_articulos.nombre) regexp '.*{codigo}.*' or tc_mantic_articulos.id_articulo= {idArticulo}) limit 0, 1) as propio,
				  (select tc_mantic_articulos_codigos.codigo from tc_mantic_articulos_codigos where tc_mantic_articulos_codigos.id_articulo= tc_mantic_articulos.id_articulo and tc_mantic_articulos_codigos.id_proveedor= {idProveedor} and (upper(tc_mantic_articulos.nombre) regexp '.*{codigo}.*' or tc_mantic_articulos.id_articulo= {idArticulo}) limit 0, 1) as codigo,
				  tc_mantic_articulos.fabricante,  
				  tc_mantic_articulos.nombre,
				  '   ' as origen,
				  tc_mantic_articulos.descripcion,
				  tc_mantic_articulos.precio,
				  tc_mantic_articulos.precio as original,
				  tc_mantic_articulos.menudeo,
				  tc_mantic_articulos.medio_mayoreo,
				  tc_mantic_articulos.mayoreo,
				  tc_mantic_articulos.sat,
				  tc_mantic_articulos.limite_medio_mayoreo,
				  tc_mantic_articulos.limite_mayoreo,
				  tc_mantic_articulos.iva,
				  tc_mantic_articulos.id_redondear,
				  tc_mantic_unidades_medidas.nombre unidad_medida,
				  ifnull(tc_mantic_articulos.extra, '0') as morado,
				  concat(ifnull(tc_mantic_articulos.descuento, '0'), ',', ifnull(tc_mantic_articulos.extra, '0')) as porcentajes,		
          ifnull(tc_mantic_imagenes.id_imagen, -1) as id_imagen,
				  concat(tc_mantic_articulos.id_empresa, '/', ifnull(tc_mantic_imagenes.archivo, 'sin-foto.png')) as archivo
				from 
					tc_mantic_articulos
				inner join 
					tc_mantic_empresas on tc_mantic_articulos.id_empresa = tc_mantic_empresas.id_empresa
				inner join
					tr_mantic_empaque_unidad_medida on tc_mantic_articulos.id_empaque_unidad_medida = tr_mantic_empaque_unidad_medida.id_empaque_unidad_medida
				inner join 
					tc_mantic_empaques on tr_mantic_empaque_unidad_medida.id_empaque = tc_mantic_empaques.id_empaque
				inner join 
					tc_mantic_unidades_medidas on tr_mantic_empaque_unidad_medida.id_unidad_medida = tc_mantic_unidades_medidas.id_unidad_medida
				left join
				  tc_mantic_imagenes on tc_mantic_articulos.id_imagen= tc_mantic_imagenes.id_imagen
				where 
					tc_mantic_empresas.id_empresa in ({sucursales})
				  and tc_mantic_articulos.id_articulo_tipo in (1,2,3)
				  and 
				  (upper(tc_mantic_articulos.nombre) regexp '.*{codigo}.*' or tc_mantic_articulos.id_articulo= {idArticulo}) 			
				order by 
				  tc_mantic_articulos.nombre				
			</select>
			<select id="porCodigo">
select 
  tc_mantic_articulos_codigos.id_articulo_codigo as id_key,
  tc_mantic_articulos.id_articulo,
  (select tc_mantic_articulos_codigos.codigo from tc_mantic_articulos_codigos where tc_mantic_articulos_codigos.id_articulo= tc_mantic_articulos.id_articulo and tc_mantic_articulos_codigos.id_principal= 1 limit 0, 1) as propio,
  (select tc_mantic_articulos_codigos.codigo from tc_mantic_articulos_codigos where tc_mantic_articulos_codigos.id_articulo= tc_mantic_articulos.id_articulo and (tc_mantic_articulos_codigos.id_proveedor= {idProveedor} and tc_mantic_articulos_codigos.id_principal> 1) and ((upper(tc_mantic_articulos_codigos.codigo) like '{codigo}%' and (tc_mantic_articulos_codigos.id_proveedor = {idProveedor} and tc_mantic_articulos_codigos.id_principal> 1)) or tc_mantic_articulos.id_articulo= {idArticulo}) limit 0, 1) as codigo,
  tc_mantic_articulos.fabricante,  
  tc_mantic_articulos.nombre,
  ' ' as origen,
  tc_mantic_articulos.descripcion,
  tc_mantic_articulos.precio,
  tc_mantic_articulos.precio as original,
  tc_mantic_articulos.menudeo,
  tc_mantic_articulos.medio_mayoreo,
  tc_mantic_articulos.mayoreo,
  tc_mantic_articulos.sat,
  tc_mantic_articulos.limite_medio_mayoreo,
  tc_mantic_articulos.limite_mayoreo,
  tc_mantic_articulos.iva,
  tc_mantic_articulos.id_redondear,
  tc_mantic_unidades_medidas.nombre unidad_medida,
  ifnull(tc_mantic_articulos.extra, '0') as morado,
  concat(ifnull(tc_mantic_articulos.descuento, '0'), ',', ifnull(tc_mantic_articulos.extra, '0')) as porcentajes,		
  ifnull(tc_mantic_imagenes.id_imagen, -1) as id_imagen,
  concat(tc_mantic_articulos.id_empresa, '/', ifnull(tc_mantic_imagenes.archivo, 'sin-foto.png')) as archivo,
  if(sum(tc_mantic_almacenes_articulos.stock) is null, 0, sum(tc_mantic_almacenes_articulos.stock)) as stock
from 
  tc_mantic_articulos
inner join
  tc_mantic_articulos_codigos on tc_mantic_articulos.id_articulo = tc_mantic_articulos_codigos.id_articulo
inner join 
  tc_mantic_empresas on tc_mantic_articulos.id_empresa = tc_mantic_empresas.id_empresa								
inner join
  tr_mantic_empaque_unidad_medida on tc_mantic_articulos.id_empaque_unidad_medida = tr_mantic_empaque_unidad_medida.id_empaque_unidad_medida
inner join 
  tc_mantic_empaques on tr_mantic_empaque_unidad_medida.id_empaque = tc_mantic_empaques.id_empaque
inner join 
  tc_mantic_unidades_medidas on tr_mantic_empaque_unidad_medida.id_unidad_medida = tc_mantic_unidades_medidas.id_unidad_medida
left join
  tc_mantic_imagenes on tc_mantic_articulos.id_imagen= tc_mantic_imagenes.id_imagen
left join
  tc_mantic_almacenes_articulos on tc_mantic_almacenes_articulos.id_articulo= tc_mantic_articulos.id_articulo and tc_mantic_almacenes_articulos.id_almacen= {idAlmacen}
where 
  tc_mantic_empresas.id_empresa in ({sucursales})
  and tc_mantic_articulos.id_articulo_tipo= 1
  and tc_mantic_articulos.id_vigente= 1
  and (
    (upper(tc_mantic_articulos_codigos.codigo) like '{codigo}%' and tc_mantic_articulos_codigos.id_proveedor is null)
    or
    (upper(tc_mantic_articulos_codigos.codigo) like '{codigo}%' and tc_mantic_articulos_codigos.id_proveedor = {idProveedor})
    or	
    tc_mantic_articulos.id_articulo= {idArticulo}
   )
group by
  tc_mantic_articulos.id_articulo
order by   
  tc_mantic_articulos_codigos.codigo
			</select>
			<select id="porCodigoIgual">
select 
  tc_mantic_articulos_codigos.id_articulo_codigo as id_key,
  tc_mantic_articulos.id_articulo,
  (select tc_mantic_articulos_codigos.codigo from tc_mantic_articulos_codigos where tc_mantic_articulos_codigos.id_articulo= tc_mantic_articulos.id_articulo and tc_mantic_articulos_codigos.id_principal= 1 limit 0, 1) as propio,
  (select tc_mantic_articulos_codigos.codigo from tc_mantic_articulos_codigos where tc_mantic_articulos_codigos.id_articulo= tc_mantic_articulos.id_articulo and (tc_mantic_articulos_codigos.id_proveedor= {idProveedor} and tc_mantic_articulos_codigos.id_principal> 1) and ((upper(tc_mantic_articulos_codigos.codigo) like '{codigo}%' and (tc_mantic_articulos_codigos.id_proveedor = {idProveedor} and tc_mantic_articulos_codigos.id_principal> 1)) or tc_mantic_articulos.id_articulo= {idArticulo}) limit 0, 1) as codigo,
  tc_mantic_articulos.fabricante,  
  tc_mantic_articulos.nombre,
  ' ' as origen,
  tc_mantic_articulos.descripcion,
  tc_mantic_articulos.precio,
  tc_mantic_articulos.precio as original,
  tc_mantic_articulos.menudeo,
  tc_mantic_articulos.medio_mayoreo,
  tc_mantic_articulos.mayoreo,
  tc_mantic_articulos.sat,
  tc_mantic_articulos.limite_medio_mayoreo,
  tc_mantic_articulos.limite_mayoreo,
  tc_mantic_articulos.iva,
  tc_mantic_articulos.id_redondear,
  tc_mantic_unidades_medidas.nombre unidad_medida,
  ifnull(tc_mantic_articulos.extra, '0') as morado,
  concat(ifnull(tc_mantic_articulos.descuento, '0'), ',', ifnull(tc_mantic_articulos.extra, '0')) as porcentajes,		
  ifnull(tc_mantic_imagenes.id_imagen, -1) as id_imagen,
  concat(tc_mantic_articulos.id_empresa, '/', ifnull(tc_mantic_imagenes.archivo, 'sin-foto.png')) as archivo,
  if(sum(tc_mantic_almacenes_articulos.stock) is null, 0, sum(tc_mantic_almacenes_articulos.stock)) as stock
from 
  tc_mantic_articulos
inner join
  tc_mantic_articulos_codigos on tc_mantic_articulos.id_articulo = tc_mantic_articulos_codigos.id_articulo
inner join 
  tc_mantic_empresas on tc_mantic_articulos.id_empresa = tc_mantic_empresas.id_empresa								
inner join
  tr_mantic_empaque_unidad_medida on tc_mantic_articulos.id_empaque_unidad_medida = tr_mantic_empaque_unidad_medida.id_empaque_unidad_medida
inner join 
  tc_mantic_empaques on tr_mantic_empaque_unidad_medida.id_empaque = tc_mantic_empaques.id_empaque
inner join 
  tc_mantic_unidades_medidas on tr_mantic_empaque_unidad_medida.id_unidad_medida = tc_mantic_unidades_medidas.id_unidad_medida
left join
  tc_mantic_imagenes on tc_mantic_articulos.id_imagen= tc_mantic_imagenes.id_imagen
left join
  tc_mantic_almacenes_articulos on tc_mantic_almacenes_articulos.id_articulo= tc_mantic_articulos.id_articulo and tc_mantic_almacenes_articulos.id_almacen= {idAlmacen}
where 
  tc_mantic_empresas.id_empresa in ({sucursales})
  and tc_mantic_articulos.id_articulo_tipo= 1
  and tc_mantic_articulos.id_vigente= 1
  and (
    (upper(tc_mantic_articulos_codigos.codigo)= '{codigo}' and tc_mantic_articulos_codigos.id_proveedor is null)
    or
    (upper(tc_mantic_articulos_codigos.codigo)= '{codigo}' and tc_mantic_articulos_codigos.id_proveedor = {idProveedor})
    or	
    tc_mantic_articulos.id_articulo= {idArticulo}
  )      
group by
  tc_mantic_articulos.id_articulo
order by   
  tc_mantic_articulos_codigos.codigo
			</select>
			<select id="porLikeNombre">
select 
  tc_mantic_articulos.id_articulo as id_key,
  tc_mantic_articulos.id_articulo,
  (select tc_mantic_articulos_codigos.codigo from tc_mantic_articulos_codigos where tc_mantic_articulos_codigos.id_articulo= tc_mantic_articulos.id_articulo and tc_mantic_articulos_codigos.id_principal= 1 and (upper(tc_mantic_articulos.nombre) like upper('{codigo}%') or tc_mantic_articulos.id_articulo= {idArticulo}) limit 0, 1) as propio,
  (select tc_mantic_articulos_codigos.codigo from tc_mantic_articulos_codigos where tc_mantic_articulos_codigos.id_articulo= tc_mantic_articulos.id_articulo and tc_mantic_articulos_codigos.id_proveedor= {idProveedor} and (upper(tc_mantic_articulos.nombre) like upper('{codigo}%') or tc_mantic_articulos.id_articulo= {idArticulo}) limit 0, 1) as codigo,
  tc_mantic_articulos.fabricante,  
  tc_mantic_articulos.nombre,
  ' ' as origen,
  tc_mantic_articulos.descripcion,
  tc_mantic_articulos.precio,
  tc_mantic_articulos.precio as original,
  tc_mantic_articulos.menudeo,
  tc_mantic_articulos.medio_mayoreo,
  tc_mantic_articulos.mayoreo,
  tc_mantic_articulos.sat,
  tc_mantic_articulos.limite_medio_mayoreo,
  tc_mantic_articulos.limite_mayoreo,
  tc_mantic_articulos.iva,
  tc_mantic_articulos.id_redondear,
  tc_mantic_unidades_medidas.nombre unidad_medida,
  ifnull(tc_mantic_articulos.extra, '0') as morado,
  concat(ifnull(tc_mantic_articulos.descuento, '0'), ',', ifnull(tc_mantic_articulos.extra, '0')) as porcentajes,		
  ifnull(tc_mantic_imagenes.id_imagen, -1) as id_imagen,
  concat(tc_mantic_articulos.id_empresa, '/', ifnull(tc_mantic_imagenes.archivo, 'sin-foto.png')) as archivo,
  if(sum(tc_mantic_almacenes_articulos.stock) is null, 0, sum(tc_mantic_almacenes_articulos.stock)) as stock
from 
  tc_mantic_articulos
inner join 
  tc_mantic_empresas on tc_mantic_articulos.id_empresa = tc_mantic_empresas.id_empresa
inner join
  tr_mantic_empaque_unidad_medida on tc_mantic_articulos.id_empaque_unidad_medida = tr_mantic_empaque_unidad_medida.id_empaque_unidad_medida
inner join 
  tc_mantic_empaques on tr_mantic_empaque_unidad_medida.id_empaque = tc_mantic_empaques.id_empaque
inner join 
  tc_mantic_unidades_medidas on tr_mantic_empaque_unidad_medida.id_unidad_medida = tc_mantic_unidades_medidas.id_unidad_medida
left join
  tc_mantic_imagenes on tc_mantic_articulos.id_imagen= tc_mantic_imagenes.id_imagen
left join
  tc_mantic_almacenes_articulos on tc_mantic_almacenes_articulos.id_articulo= tc_mantic_articulos.id_articulo and tc_mantic_almacenes_articulos.id_almacen= {idAlmacen}
where 
  tc_mantic_empresas.id_empresa in ({sucursales})
  and tc_mantic_articulos.id_articulo_tipo= 1
  and tc_mantic_articulos.id_vigente= 1
  and (upper(tc_mantic_articulos.nombre) like upper('{codigo}%') or tc_mantic_articulos.id_articulo= {idArticulo})
group by
  tc_mantic_articulos.id_articulo
order by   
  tc_mantic_articulos.nombre
			</select>
			<select id="clientes">
        select
					tc_mantic_clientes.id_cliente as id_key,
          tc_mantic_clientes.id_cliente,
					tc_mantic_clientes.clave,  
					tc_mantic_clientes.razon_social as nombre
				from 
					tc_mantic_ordenes_compras
				inner join
					tc_mantic_clientes on tc_mantic_ordenes_compras.id_cliente= tc_mantic_clientes.id_cliente
				where 		
				  tc_mantic_ordenes_compras.id_empresa in ({sucursales})
				group by
          tc_mantic_clientes.id_cliente,
					tc_mantic_clientes.clave,  
					tc_mantic_clientes.razon_social
				order by
				  tc_mantic_clientes.clave
			</select>			
			<select id="proveedores">
        select
					tc_mantic_proveedores.id_proveedor as id_key,
					tc_mantic_proveedores.clave,  
					tc_mantic_proveedores.razon_social as nombre,
					tc_mantic_proveedores.dias_entrega
				from 
					tc_mantic_ordenes_compras
				inner join
					tr_mantic_proveedor_pago on tc_mantic_ordenes_compras.id_proveedor_pago= tr_mantic_proveedor_pago.id_proveedor_pago
				inner join
					tc_mantic_proveedores on tr_mantic_proveedor_pago.id_proveedor= tc_mantic_proveedores.id_proveedor       
				where 		
				  tc_mantic_ordenes_compras.id_empresa in ({sucursales})
				group by
          tc_mantic_proveedores.id_proveedor,
					tc_mantic_proveedores.clave,  
					tc_mantic_proveedores.razon_social,
					tc_mantic_proveedores.dias_entrega			
				order by
				  tc_mantic_proveedores.clave
			</select>
			<select id="condiciones">
        select      
				  tr_mantic_proveedor_pago.id_proveedor_pago as id_key,
          tr_mantic_proveedor_pago.id_proveedor,
          tr_mantic_proveedor_pago.clave,
          tr_mantic_proveedor_pago.descuento,
				  tr_mantic_proveedor_pago.plazo,
          tr_mantic_proveedor_pago.id_tipo_pago,
          tc_mantic_tipos_pagos.nombre,
          tr_mantic_proveedor_pago.observaciones
        from      
          tr_mantic_proveedor_pago
        inner join 
          tc_mantic_tipos_pagos on tr_mantic_proveedor_pago.id_tipo_pago= tc_mantic_tipos_pagos.id_tipo_pago
        where      
          tr_mantic_proveedor_pago.id_proveedor = {idProveedor}
				order by
				  tr_mantic_proveedor_pago.clave				
			</select>	
			<select id="moneda">
        select      
					tc_mantic_proveedores.id_proveedor as id_key,
          tc_mantic_proveedores.*,
          tc_mantic_tipos_monedas.nombre as moneda,
          tc_mantic_tipos_monedas.siglas,
          tc_mantic_tipos_monedas.simbolo,
          tc_mantic_tipos_proveedores.nombre as tipo_proveedor,
          tc_mantic_tipos_proveedores.dias,
          tc_mantic_tipos_dias.nombre as tipo_dia
        from      
          tc_mantic_proveedores
        inner join 
          tc_mantic_tipos_monedas on tc_mantic_proveedores.id_tipo_moneda= tc_mantic_tipos_monedas.id_tipo_moneda
        inner join 
          tc_mantic_tipos_proveedores on tc_mantic_proveedores.id_tipo_proveedor= tc_mantic_tipos_proveedores.id_tipo_proveedor
        inner join 
          tc_mantic_tipos_dias on tc_mantic_proveedores.id_tipo_dia= tc_mantic_tipos_dias.id_tipo_dia
        where 
          tc_mantic_proveedores.id_empresa in ({sucursales})
				order by
				  tc_mantic_proveedores.clave
			</select>
		  <select id="consulta">
				select
					tc_mantic_notas_detalles.id_nota_detalle as id_key,
					tc_mantic_notas_entradas.consecutivo,
					(select tc_mantic_articulos_codigos.codigo from tc_mantic_articulos_codigos where tc_mantic_articulos_codigos.id_articulo= tc_mantic_notas_detalles.id_articulo and tc_mantic_articulos_codigos.id_principal= 1 limit 0, 1) as propio,
					tc_mantic_notas_detalles.sat,
					tc_mantic_notas_detalles.codigo,
					tc_mantic_notas_detalles.nombre,
					tc_mantic_notas_detalles.cantidad,
					tc_mantic_notas_detalles.descuento,
					tc_mantic_notas_detalles.extras,
					tc_mantic_notas_detalles.cantidades,
					tc_mantic_notas_detalles.costo,
					tc_mantic_notas_detalles.costo_real,
					tc_mantic_notas_detalles.costo_calculado,
					tc_mantic_notas_detalles.importe,
				  if(tc_mantic_notas_detalles.id_orden_detalle is null, '*', '') as nuevo,
  				tc_mantic_notas_detalles.declarados,
  				tc_mantic_notas_detalles.diferencia,
				  tc_mantic_notas_estatus.nombre as estatus,
				  tc_mantic_notas_estatus.id_nota_estatus,
				  tc_mantic_notas_entradas.id_nota_entrada,
				  tc_mantic_notas_entradas.id_orden_compra,
				  if(tc_mantic_ordenes_detalles.costo is null, tc_mantic_articulos.precio, tc_mantic_ordenes_detalles.costo) as valor,
				  if(tc_mantic_ordenes_detalles.costo is null, tc_mantic_notas_detalles.costo_calculado, tc_mantic_ordenes_detalles.costo_calculado- tc_mantic_notas_detalles.costo_calculado) as temporal,
				  if(if(tc_mantic_ordenes_detalles.costo is null, 100, (tc_mantic_notas_detalles.costo_calculado* 100/ tc_mantic_ordenes_detalles.costo_calculado)- 100)&lt; -5, 'janal-color-orange', if(if(tc_mantic_ordenes_detalles.costo is null, 100, (tc_mantic_notas_detalles.costo_calculado* 100/ tc_mantic_ordenes_detalles.costo_calculado)-100)&gt; 5, 'janal-color-blue', 'janal-color-green')) as color,
				  if(tc_mantic_ordenes_detalles.costo is null, 100, (tc_mantic_notas_detalles.costo_calculado* 100/ tc_mantic_ordenes_detalles.costo_calculado)- 100) as porcentaje,
				  tc_mantic_notas_detalles.id_aplicar,
					tc_mantic_notas_detalles.id_articulo,
				  ifnull(tc_mantic_notas_archivos.id_principal, 2) as id_principal,
				  tc_mantic_notas_archivos.alias,
				  tc_mantic_notas_archivos.nombre as archivo,
					tc_mantic_notas_entradas.observaciones
				from
					tc_mantic_notas_entradas
				inner join
					tc_mantic_notas_detalles on tc_mantic_notas_entradas.id_nota_entrada= tc_mantic_notas_detalles.id_nota_entrada
				inner join
					tc_mantic_articulos on tc_mantic_notas_detalles.id_articulo= tc_mantic_articulos.id_articulo
				inner join
				  tc_mantic_notas_estatus on tc_mantic_notas_entradas.id_nota_estatus= tc_mantic_notas_estatus.id_nota_estatus
				left join
				  tc_mantic_notas_archivos on tc_mantic_notas_entradas.id_nota_entrada= tc_mantic_notas_archivos.id_nota_entrada and tc_mantic_notas_archivos.id_principal= 1 and tc_mantic_notas_archivos.id_tipo_archivo= 2
				left join
				  tc_mantic_ordenes_detalles on tc_mantic_notas_detalles.id_orden_detalle= tc_mantic_ordenes_detalles.id_orden_detalle
				where  
					tc_mantic_notas_entradas.id_orden_compra= {idOrdenCompra}
				  {condicion}
				{sortOrder}
			</select>
			<select id="confronta">
				select
					tc_mantic_ordenes_detalles.id_orden_detalle as id_key,
					tc_mantic_ordenes_detalles.id_orden_detalle,
				  tc_mantic_ordenes_compras.id_empresa,
				  tc_mantic_ordenes_compras.consecutivo,
					tc_mantic_ordenes_detalles.propio,
					tc_mantic_ordenes_detalles.codigo,
					tc_mantic_ordenes_detalles.nombre,
					tc_mantic_ordenes_detalles.cantidad,
				  tc_mantic_ordenes_detalles.cantidad as solicitar,
					tc_mantic_ordenes_detalles.costo,
					tc_mantic_ordenes_detalles.costo as precio,
					tc_mantic_ordenes_detalles.costo_real,
					tc_mantic_ordenes_detalles.costo_calculado,
					tc_mantic_ordenes_detalles.descuento,
					tc_mantic_ordenes_detalles.extras,
					tc_mantic_ordenes_detalles.importe,
					tc_mantic_ordenes_detalles.cantidades,
					tc_mantic_ordenes_detalles.cantidades as unidades,
					tc_mantic_ordenes_detalles.importes,
					tc_mantic_ordenes_detalles.importes as valores,
				  tc_mantic_ordenes_compras.id_orden_compra,
					tc_mantic_ordenes_detalles.id_articulo,
				  if(if(tc_mantic_ordenes_detalles.costo is null, 100, (tc_mantic_ordenes_detalles.costo* 100/ tc_mantic_ordenes_detalles.costo_real)- 100)&lt; -5, 'janal-color-orange', if(if(tc_mantic_ordenes_detalles.costo is null, 100, (tc_mantic_ordenes_detalles.costo* 100/ tc_mantic_ordenes_detalles.costo_real)-100)&gt; 5, 'janal-color-blue', 'janal-color-green')) as color,
				  if(tc_mantic_ordenes_detalles.costo is null, 100, (tc_mantic_ordenes_detalles.costo* 100/ tc_mantic_ordenes_detalles.costo_real)- 100) as porcentaje
				from
					tc_mantic_ordenes_compras
				inner join
					tc_mantic_ordenes_detalles on tc_mantic_ordenes_compras.id_orden_compra= tc_mantic_ordenes_detalles.id_orden_compra
				where  
					tc_mantic_ordenes_detalles.id_orden_compra= {idOrdenCompra}
				  and {condicion}
				{sortOrder}
			</select>
			<select id="registrados">
        select      
          tc_mantic_faltantes.id_faltante as id_key,
          tc_mantic_faltantes.id_empresa,
				  tc_mantic_empresas.clave as empresa,  
				  tc_mantic_empresas.nombre as nombre_empresa,  
          tc_mantic_articulos_codigos.codigo,
          tc_mantic_articulos_codigos.codigo as propio,
				  tc_mantic_articulos.id_articulo,
				  tc_mantic_articulos.nombre,
				  tc_mantic_articulos.precio,
				  tc_mantic_articulos.iva,
          tc_mantic_faltantes.cantidad,
          concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) as usuario,
				  tc_mantic_faltantes.registro
        from      
          tc_mantic_faltantes
				inner join 
					tc_mantic_empresas on tc_mantic_faltantes.id_empresa = tc_mantic_empresas.id_empresa
        inner join
          tc_mantic_articulos on tc_mantic_faltantes.id_articulo= tc_mantic_articulos.id_articulo
        inner join
					tc_janal_usuarios on tc_mantic_faltantes.id_usuario= tc_janal_usuarios.id_usuario          
				inner join
					tc_mantic_personas on tc_janal_usuarios.id_persona= tc_mantic_personas.id_persona
        left join
          tc_mantic_articulos_codigos on tc_mantic_faltantes.id_articulo= tc_mantic_articulos_codigos.id_articulo and tc_mantic_articulos_codigos.id_principal= 1
				where 
				  tc_mantic_faltantes.id_vigente= 1
				  and tc_mantic_articulos.id_descontinuado= 2
				  and tc_mantic_articulos.id_vigente= 1
				  and tc_mantic_faltantes.id_empresa= {idSucursal}
          and (tc_mantic_articulos.nombre regexp '.*{codigoPerdido}.*' or upper(tc_mantic_articulos_codigos.codigo) regexp '.*{codigoPerdido}.*')				
				order by
				  tc_mantic_faltantes.registro desc
			</select>
			<select id="preregistrados">
        select      
          tc_mantic_articulos.id_articulo as id_key,
          tc_mantic_faltantes.id_empresa,
				  tc_mantic_empresas.clave as empresa,  
				  tc_mantic_empresas.nombre as nombre_empresa,  
          tc_mantic_articulos_codigos.codigo as propio,
          (select tc_mantic_articulos_codigos.codigo from tc_mantic_articulos_codigos where tc_mantic_articulos_codigos.id_articulo= tc_mantic_articulos.id_articulo and tc_mantic_articulos_codigos.id_proveedor= {idProveedor} limit 0, 1) as codigo,				
				  tc_mantic_articulos.id_articulo,
				  tc_mantic_articulos.nombre,
				  tc_mantic_articulos.precio as costo,
				  tc_mantic_articulos.precio,
				  tc_mantic_articulos.iva,
          tc_mantic_faltantes.cantidad,
				  tc_mantic_faltantes.registro,
          tc_mantic_articulos.stock,
          tc_mantic_articulos.minimo,
          tc_mantic_articulos.maximo,
				  (select tc_mantic_articulos_codigos.multiplo from tc_mantic_articulos_codigos where tc_mantic_articulos_codigos.id_articulo= tc_mantic_articulos.id_articulo and tc_mantic_articulos_codigos.id_proveedor= {idProveedor} limit 0, 1) as multiplo,
				  '0.00' as descuento,
				  '0.00' as extras, 
				  0.0 as total_impuesto,
				  0.0 as sub_total,
				  0.0 as descuentos,
				  tc_mantic_articulos.precio as importe,
				  {idProveedor} as id_proveedor
        from      
          tc_mantic_faltantes
				inner join 
					tc_mantic_empresas on tc_mantic_faltantes.id_empresa = tc_mantic_empresas.id_empresa
        inner join
          tc_mantic_articulos on tc_mantic_faltantes.id_articulo= tc_mantic_articulos.id_articulo
        inner join
					tc_janal_usuarios on tc_mantic_faltantes.id_usuario= tc_janal_usuarios.id_usuario          
				inner join
					tc_mantic_personas on tc_janal_usuarios.id_persona= tc_mantic_personas.id_persona
        left join
          tc_mantic_articulos_codigos on tc_mantic_faltantes.id_articulo= tc_mantic_articulos_codigos.id_articulo and tc_mantic_articulos_codigos.id_principal= 1
				where 
				  tc_mantic_faltantes.id_vigente= 1
				  and tc_mantic_articulos.id_descontinuado= 2
				  and tc_mantic_articulos.id_vigente= 1
				  and tc_mantic_faltantes.id_empresa= {idSucursal}
          and (tc_mantic_articulos.nombre regexp '.*.*' or upper(tc_mantic_articulos_codigos.codigo) regexp '.*.*')				
          and tc_mantic_articulos.id_articulo not in 
				    (select 
				      tc_mantic_ordenes_detalles.id_articulo 
				     from 
				      tc_mantic_ordenes_detalles 
				     inner join tc_mantic_ordenes_compras on tc_mantic_ordenes_detalles.id_orden_compra= tc_mantic_ordenes_compras.id_orden_compra 
				      and tc_mantic_ordenes_compras.id_orden_estatus in (3,4,5)
				      and tc_mantic_ordenes_compras.id_proveedor= {idProveedor}
				      and date_format(tc_mantic_ordenes_compras.registro, '%Y%m%d')>= '{mes}')				
				order by
				  tc_mantic_faltantes.registro desc
			</select>
      <select id="detalle">
        select      
				  tc_mantic_ordenes_detalles.id_orden_detalle as id_comodin,
					tc_mantic_ordenes_detalles.id_orden_detalle,
					tc_mantic_ordenes_detalles.id_articulo,
					ifnull(tc_mantic_ordenes_detalles.codigo, tc_mantic_articulos_codigos.codigo) as codigo,
					tc_mantic_ordenes_detalles.propio,
					tc_mantic_ordenes_detalles.nombre,
					tc_mantic_ordenes_detalles.cantidad,
					tc_mantic_ordenes_detalles.costo,
					tc_mantic_ordenes_detalles.descuento,
					tc_mantic_ordenes_detalles.extras,
					tc_mantic_ordenes_detalles.iva,
					tc_mantic_ordenes_detalles.descuentos,
					tc_mantic_ordenes_detalles.excedentes,
					tc_mantic_ordenes_detalles.impuestos,
					tc_mantic_ordenes_detalles.sub_total,
					tc_mantic_ordenes_detalles.importe,
					tc_mantic_ordenes_detalles.cantidades,
					tc_mantic_ordenes_detalles.precios,
					tc_mantic_ordenes_detalles.importes,
					tc_mantic_ordenes_detalles.costo_real,
					tc_mantic_ordenes_detalles.costo_calculado,
					tc_mantic_ordenes_detalles.registro,
					tc_mantic_ordenes_detalles.cantidad as cuantos,
          tc_mantic_ordenes_detalles.cantidad as inicial,
				  tc_mantic_articulos.precio as valor,
				  tc_mantic_articulos_codigos.multiplo 
        from      
          tc_mantic_ordenes_detalles
        inner join
          tc_mantic_articulos on tc_mantic_ordenes_detalles.id_articulo= tc_mantic_articulos.id_articulo
        left join
          tc_mantic_articulos_codigos on tc_mantic_ordenes_detalles.id_articulo= tc_mantic_articulos_codigos.id_articulo and id_principal= 2 and tc_mantic_articulos_codigos.id_proveedor= {idProveedor}
        where      
          tc_mantic_ordenes_detalles.id_orden_compra = {idOrdenCompra}
				order by
				  tc_mantic_ordenes_detalles.registro
      </select>
		  <select id="porcentajes">
				select
					tc_mantic_notas_detalles.id_nota_detalle as id_key,
					tc_mantic_notas_entradas.id_nota_entrada,
					tc_mantic_notas_entradas.consecutivo,
				  if(tc_mantic_ordenes_detalles.costo is null, 100, (tc_mantic_notas_detalles.costo_calculado* 100/ tc_mantic_ordenes_detalles.costo_calculado)- 100) as porcentaje,
					tc_mantic_notas_entradas.observaciones
				from
					tc_mantic_notas_entradas
				inner join
					tc_mantic_notas_detalles on tc_mantic_notas_entradas.id_nota_entrada= tc_mantic_notas_detalles.id_nota_entrada
				inner join
				  tc_mantic_ordenes_detalles on tc_mantic_notas_detalles.id_orden_detalle= tc_mantic_ordenes_detalles.id_orden_detalle and tc_mantic_ordenes_detalles.id_orden_detalle= {idOrdenDetalle}
				where  
					tc_mantic_notas_entradas.id_orden_compra= {idOrdenCompra}
			</select>			
		</unit>
		<unit id="VistaDomiciliosCatalogosDto">
			<select id="domicilios">
				select 
          tc_mantic_domicilios.id_domicilio as id_key,
          tc_mantic_domicilios.*,
          concat(tc_janal_entidades.descripcion,' , ',calle,' ',numero_exterior,' ',asentamiento) as domicilio,          
          tc_janal_localidades.clave as clave_localidad,
          tc_janal_localidades.descripcion as localidad,
          tc_janal_municipios.id_municipio,
          tc_janal_municipios.clave as clave_municipio,
          tc_janal_municipios.descripcion as municipio,
          tc_janal_entidades.id_entidad,
          tc_janal_entidades.clave as clave_entidad,
          tc_janal_entidades.descripcion as entidad
        from 
          tc_mantic_domicilios
        inner join 
          tc_janal_localidades on tc_mantic_domicilios.id_localidad = tc_janal_localidades.id_localidad
        inner join
          tc_janal_municipios on tc_janal_localidades.id_municipio = tc_janal_municipios.id_municipio
        inner join 
          tc_janal_entidades on tc_janal_municipios.id_entidad = tc_janal_entidades.id_entidad
        where 
          {condicion}
        order by 
          tc_janal_entidades.clave,
          tc_janal_municipios.clave,
          tc_janal_localidades.clave,
          tc_mantic_domicilios.codigo_postal
			</select>
		</unit>
		<unit id="VistaArticulosAlmacenDto">
			<select id="articulos">
				select 
				  tc_mantic_articulos_codigos.id_articulo_codigo as id_key,
				  tc_mantic_articulos.id_articulo,
				  tc_mantic_articulos_codigos.codigo as propio,
				  (select tc_mantic_articulos_codigos.codigo from tc_mantic_articulos_codigos where tc_mantic_articulos_codigos.id_articulo= tc_mantic_articulos.id_articulo and tc_mantic_articulos_codigos.id_principal= 1 and ((upper(tc_mantic_articulos_codigos.codigo) like '%{codigo}%' and tc_mantic_articulos_codigos.id_principal= 1) or upper(tc_mantic_articulos.nombre) regexp '.*{codigo}.*' or upper(tc_mantic_articulos_codigos.codigo) like '%{codigo}%') limit 0, 1) as codigo,
				  tc_mantic_articulos_codigos.id_principal,
				  tc_mantic_articulos_codigos.id_proveedor,
				  tc_mantic_articulos.nombre,
				  tc_mantic_articulos.precio,
				  tc_mantic_articulos.iva,
				  tc_mantic_articulos.id_redondear
				from 
					tc_mantic_articulos
				inner join
					tc_mantic_articulos_codigos on tc_mantic_articulos.id_articulo = tc_mantic_articulos_codigos.id_articulo
				inner join 
					tc_mantic_empresas on tc_mantic_articulos.id_empresa = tc_mantic_empresas.id_empresa
				where 
					tc_mantic_empresas.id_empresa in ({sucursales})
				  and (
				    (upper(tc_mantic_articulos_codigos.codigo) like '%{codigo}%' and tc_mantic_articulos_codigos.id_principal= 1)
				    or 
				    upper(tc_mantic_articulos.nombre) regexp '.*{codigo}.*'
				    or
				    upper(tc_mantic_articulos_codigos.codigo) like '%{codigo}%' 
				   ) 			
				order by 
				  tc_mantic_articulos.nombre
			</select>
			<select id="findArticulo">
				select 
					*
				from (
					select 				  
						tc_mantic_articulos.id_articulo as id_key,				  
						(select tc_mantic_articulos_codigos.codigo from tc_mantic_articulos_codigos where tc_mantic_articulos_codigos.id_articulo= tc_mantic_articulos.id_articulo and tc_mantic_articulos_codigos.id_principal= 1 limit 0, 1) as codigo,				  
						tc_mantic_articulos.nombre				  
					from 
						tc_mantic_articulos
					inner join
						tc_mantic_articulos_codigos on tc_mantic_articulos.id_articulo = tc_mantic_articulos_codigos.id_articulo
					inner join 
						tc_mantic_empresas on tc_mantic_articulos.id_empresa = tc_mantic_empresas.id_empresa
					where 
						tc_mantic_empresas.id_empresa in ({sucursales})
						and (
							(upper(tc_mantic_articulos_codigos.codigo) like '%{codigo}%' and tc_mantic_articulos_codigos.id_principal= 1)
							or 
							upper(tc_mantic_articulos.nombre) regexp '.*{codigo}.*'
							or
							upper(tc_mantic_articulos_codigos.codigo) like '%{codigo}%' 
						 ) 		
					order by 
						tc_mantic_articulos.nombre) principal
				group by 
					id_key, codigo, nombre
			</select>
		</unit>
		<unit id="VistaPortalProveedoresDto">
			<select id="banca">
				select 
					tc_mantic_proveedores_bancos.id_proveedor_banca as id_key,
					tc_mantic_proveedores_bancos.convenio_cuenta,
					tc_mantic_proveedores_bancos.clabe_referencia,
					tc_mantic_bancos.nombre
				 from 
					 tc_mantic_proveedores_bancos
				 inner join
					 tc_mantic_bancos on tc_mantic_proveedores_bancos.id_banco = tc_mantic_bancos.id_banco
				 where 
					 tc_mantic_proveedores_bancos.id_proveedor = {idProveedor}
					and 
					 tc_mantic_proveedores_bancos.id_tipo_cuenta= {idTipoCuenta}
			</select>
		</unit>
		<unit id="VistaEmpresasDto">
      <select id="exportar">
        select
          tt_keet_documentos.*
        from (
          select
            tc_mantic_notas_archivos.id_nota_archivo as id_key,
            concat('N-', tc_mantic_notas_entradas.consecutivo) as consecutivo,
            tc_mantic_tipos_archivos.nombre as tipo,
            tc_mantic_notas_archivos.id_nota_entrada,
            tc_mantic_notas_archivos.id_tipo_documento,
            tc_mantic_notas_archivos.id_tipo_archivo,
            tc_mantic_notas_archivos.nombre,
            tc_mantic_notas_archivos.ruta,
            tc_mantic_notas_archivos.alias,
            tc_mantic_notas_archivos.registro 
          from
            tc_mantic_empresas_deudas         
          inner join
            tc_mantic_notas_entradas on tc_mantic_empresas_deudas.id_nota_entrada= tc_mantic_notas_entradas.id_nota_entrada         
          inner join
            tc_mantic_notas_archivos on tc_mantic_empresas_deudas.id_nota_entrada= tc_mantic_notas_archivos.id_nota_entrada         
          inner join
            tc_mantic_tipos_archivos on tc_mantic_notas_archivos.id_tipo_documento= tc_mantic_tipos_archivos.id_tipo_archivo
          where
            tc_mantic_empresas_deudas.id_nota_entrada= {idNotaEntrada}     
            and tc_mantic_notas_archivos.id_eliminado= 2
          union all  
          select
            (50000+ tc_mantic_egresos_archivos.id_egreso_archivo) as id_key,
            concat('N-', tc_mantic_notas_entradas.consecutivo) as consecutivo,
            tc_mantic_tipos_archivos.nombre as tipo,
            tc_mantic_egresos_notas.id_nota_entrada,
            tc_mantic_egresos_archivos.id_tipo_documento,
            tc_mantic_egresos_archivos.id_tipo_archivo,
            tc_mantic_egresos_archivos.nombre,
            tc_mantic_egresos_archivos.ruta,
            tc_mantic_egresos_archivos.alias,
            tc_mantic_egresos_archivos.registro
          from
            tc_mantic_egresos_notas         
          inner join
            tc_mantic_notas_entradas on tc_mantic_egresos_notas.id_nota_entrada= tc_mantic_notas_entradas.id_nota_entrada         
          inner join
            tc_mantic_egresos_archivos on tc_mantic_egresos_notas.id_egreso= tc_mantic_egresos_archivos.id_egreso         
          inner join
            tc_mantic_tipos_archivos on tc_mantic_egresos_archivos.id_tipo_documento= tc_mantic_tipos_archivos.id_tipo_archivo
          where
            tc_mantic_egresos_notas.id_nota_entrada= {idNotaEntrada}     
            and tc_mantic_egresos_archivos.id_eliminado= 2
        ) as tt_keet_documentos   
        order by          
         tt_keet_documentos.id_tipo_documento,
         tt_keet_documentos.id_tipo_archivo,
         tt_keet_documentos.registro desc 
      </select>  
			<select id="observaciones">
				select 
					tc_mantic_egresos_notas.id_egreso_nota as id_key,
					tc_mantic_egresos_notas.*,
					concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) as persona
				from 
					tc_mantic_egresos_notas
				inner join
					tc_janal_usuarios on tc_mantic_egresos_notas.id_usuario= tc_janal_usuarios.id_usuario          
				inner join
					tc_mantic_personas on tc_janal_usuarios.id_persona= tc_mantic_personas.id_persona
				where 
					tc_mantic_egresos_notas.id_nota_entrada= {idNotaEntrada}
			</select>	
			<select id="eliminarPagos">
        select 
          tc_mantic_empresas_pagos.id_empresa_pago as id_key,
          tc_mantic_empresas_pagos_controles.id_empresa_pago_control,
          tc_mantic_empresas_pagos.id_empresa_pago,
          tc_mantic_empresas_deudas.id_empresa_deuda,
          tc_mantic_empresas_deudas.id_empresa,
          tc_mantic_empresas_pagos_controles.pago,
          tc_mantic_empresas_pagos.pago as abonado
        from
          tc_mantic_empresas_pagos_controles
        inner join
          tc_mantic_empresas_pagos on tc_mantic_empresas_pagos_controles.id_empresa_pago_control= tc_mantic_empresas_pagos.id_empresa_pago_control
        inner join
          tc_mantic_empresas_deudas on tc_mantic_empresas_pagos.id_empresa_deuda= tc_mantic_empresas_deudas.id_empresa_deuda
        where 
          tc_mantic_empresas_pagos_controles.id_empresa_pago_control= {idEmpresaPagoControl}
        order by
          tc_mantic_empresas_pagos.registro desc
      </select>  
			<select id="detallePagosRealizados">
        select 
          tc_mantic_empresas_pagos.id_empresa_pago as id_key,
          tc_mantic_notas_entradas.consecutivo as ticket,
          tc_mantic_empresas_deudas.importe as venta,
          tc_mantic_empresas_pagos.pago as abonado,
          tc_mantic_tipos_medios_pagos.nombre as tipo_medio_pago,
          tc_mantic_bancos.nombre as banco,
          tc_mantic_empresas_pagos.referencia,
          ifnull(tc_mantic_empresas_pagos.observaciones, ' ') as observaciones,
          tc_mantic_empresas_pagos.comentarios,
          tc_mantic_empresas_estatus.nombre as estatus
        from
          tc_mantic_empresas_pagos_controles
        inner join
          tc_mantic_empresas_pagos on tc_mantic_empresas_pagos_controles.id_empresa_pago_control= tc_mantic_empresas_pagos.id_empresa_pago_control
        inner join
          tc_janal_usuarios on tc_mantic_empresas_pagos_controles.id_usuario= tc_janal_usuarios.id_usuario
        inner join
          tc_mantic_empresas_deudas on tc_mantic_empresas_pagos.id_empresa_deuda= tc_mantic_empresas_deudas.id_empresa_deuda
        inner join
          tc_mantic_empresas_estatus on tc_mantic_empresas_deudas.id_empresa_estatus= tc_mantic_empresas_estatus.id_empresa_estatus
        inner join
          tc_mantic_personas on tc_janal_usuarios.id_persona= tc_mantic_personas.id_persona 
        inner join
          tc_mantic_notas_entradas on tc_mantic_empresas_deudas.id_nota_entrada= tc_mantic_notas_entradas.id_nota_entrada
        left join
          tc_mantic_bancos on tc_mantic_empresas_pagos.id_banco= tc_mantic_bancos.id_banco
        left join
          tc_mantic_tipos_medios_pagos on tc_mantic_empresas_pagos.id_tipo_medio_pago= tc_mantic_tipos_medios_pagos.id_tipo_medio_pago
        where
          tc_mantic_empresas_pagos_controles.id_empresa_pago_control= {idEmpresaPagoControl}	
        {sortOrder}        
      </select>  
			<select id="pagosRealizados">
        select 
          tc_mantic_empresas_pagos_controles.id_empresa_pago_control as id_key,
          tc_mantic_empresas_pagos_controles.id_empresa_pago_control,
          tc_mantic_empresas_pagos.consecutivo,
          tc_mantic_empresas_pagos_controles.tipo,
          if(tc_mantic_empresas_pagos_controles.id_activo= 1, 'ACTIVO', 'CANCELADO') as estatus,
          tc_mantic_empresas_pagos_controles.pago,
          concat(tc_mantic_personas.nombres, ' ', ifnull(tc_mantic_personas.paterno, ''), ' ', ifnull(tc_mantic_personas.materno, '')) as usuario,
          tc_mantic_empresas_pagos_controles.observaciones,
          tc_mantic_empresas_pagos_controles.registro,
          count(*) as pagos,
          0 as eliminar
        from
          tc_mantic_empresas_pagos_controles
        inner join
          tc_mantic_empresas_pagos on tc_mantic_empresas_pagos_controles.id_empresa_pago_control= tc_mantic_empresas_pagos.id_empresa_pago_control
        inner join
          tc_mantic_empresas_deudas on tc_mantic_empresas_pagos.id_empresa_deuda= tc_mantic_empresas_deudas.id_empresa_deuda
        inner join
          tc_mantic_notas_entradas on tc_mantic_empresas_deudas.id_nota_entrada= tc_mantic_notas_entradas.id_nota_entrada
        inner join
          tc_janal_usuarios on tc_mantic_empresas_pagos_controles.id_usuario= tc_janal_usuarios.id_usuario
        inner join
          tc_mantic_personas on tc_janal_usuarios.id_persona= tc_mantic_personas.id_persona 
        where
          tc_mantic_notas_entradas.id_proveedor= {idProveedor}	
          and date_format(tc_mantic_empresas_pagos_controles.registro, '%Y%m%d')&gt;= '{inicio}'
        group by
          tc_mantic_empresas_pagos_controles.id_empresa_pago_control
        order by
          tc_mantic_empresas_pagos.registro desc
      </select>      
			<select id="saldoFavorEntradas">
				select      
          tc_mantic_empresas_deudas.id_empresa_deuda as id_key,
					tc_mantic_empresas_deudas.id_empresa,
					tc_mantic_notas_entradas.consecutivo,
					tc_mantic_notas_entradas.factura,
					tc_mantic_empresas_deudas.importe,
				  tc_mantic_empresas_deudas.pagar,
					tc_mantic_empresas_deudas.saldo,
					concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) as persona,
					tc_mantic_empresas_deudas.limite,
					tc_mantic_empresas_deudas.registro,
					datediff(tc_mantic_empresas_deudas.limite, now()) as dias,
					tc_mantic_empresas.nombre,
          tc_mantic_empresas.clave,
					tc_mantic_proveedores.razon_social proveedor,
					tc_mantic_almacenes.nombre almacen,
          tc_mantic_almacenes.id_almacen,
					tc_mantic_proveedores.id_proveedor,
				  tc_mantic_notas_entradas.id_nota_tipo,
				  tc_mantic_notas_entradas.id_nota_entrada,
				  tc_mantic_notas_tipos.nombre as directa
        from
					tc_mantic_empresas_deudas
				inner join
					tc_mantic_notas_entradas on tc_mantic_empresas_deudas.id_nota_entrada= tc_mantic_notas_entradas.id_nota_entrada				
				inner join 
					tc_mantic_proveedores on tc_mantic_notas_entradas.id_proveedor = tc_mantic_proveedores.id_proveedor
				inner join 
					tc_mantic_almacenes on tc_mantic_notas_entradas.id_almacen = tc_mantic_almacenes.id_almacen
				inner join 
					tc_mantic_empresas on tc_mantic_empresas_deudas.id_empresa = tc_mantic_empresas.id_empresa
				inner join
					tc_janal_usuarios on tc_mantic_empresas_deudas.id_usuario= tc_janal_usuarios.id_usuario
				inner join
					tc_mantic_personas on tc_janal_usuarios.id_persona= tc_mantic_personas.id_persona				
				inner join
					tc_mantic_notas_tipos on tc_mantic_notas_entradas.id_nota_tipo= tc_mantic_notas_tipos.id_nota_tipo
        where 
          tc_mantic_empresas_deudas.saldo &lt; 0
				  and tc_mantic_proveedores.id_proveedor= {idProveedor}
				  and tc_mantic_empresas_deudas.id_empresa_estatus in ({idEmpresaEstatus})
				order by 
					tc_mantic_notas_entradas.registro desc
			</select>
			<select id="row">
				select 
					tc_mantic_empresas.id_empresa as id_key,
					tc_mantic_empresas.id_tipo_empresa,
					tc_mantic_empresas.clave, 
					tc_mantic_empresas.nombre,
					tc_mantic_empresas.titulo,
					tc_mantic_tipos_empresas.nombre tipo 
				from 
					tc_mantic_empresas
				inner join 
					tc_mantic_tipos_empresas on tc_mantic_tipos_empresas.id_tipo_empresa = tc_mantic_empresas.id_tipo_empresa
				where 
					upper(tc_mantic_empresas.clave) like upper('%{clave}%')
				  and upper(tc_mantic_empresas.nombre) like upper('%{nombre}%')
				  and upper(tc_mantic_empresas.titulo) like upper('%{titulo}%')
				  and tc_mantic_tipos_empresas.id_tipo_empresa in ({tipoEmpresa}) 					
				{sortOrder}
			</select>
			<select id="proveedores">
				select
					tc_mantic_empresas_deudas.id_empresa_deuda as id_key,
					tc_mantic_empresas.clave,
					tc_mantic_empresas.nombre,
					tc_mantic_proveedores.id_proveedor,
					tc_mantic_proveedores.clave as clave_proveedor,
					tc_mantic_proveedores.razon_social,
					count(*) as cuentas,
					sum(tc_mantic_empresas_deudas.importe) as importe,
					sum(tc_mantic_empresas_deudas.pagar) as pagar,
					abs(sum(tc_mantic_empresas_deudas.saldo)) as saldo,
					sum(tc_mantic_empresas_deudas.pagar+ tc_mantic_empresas_deudas.saldo) as abonado
				from
					tc_mantic_empresas_deudas
				inner join
					tc_mantic_notas_entradas on tc_mantic_empresas_deudas.id_nota_entrada= tc_mantic_notas_entradas.id_nota_entrada				
				inner join 
					tc_mantic_empresas_estatus on tc_mantic_empresas_deudas.id_empresa_estatus = tc_mantic_empresas_estatus.id_empresa_estatus
				inner join 
					tc_mantic_proveedores on tc_mantic_notas_entradas.id_proveedor = tc_mantic_proveedores.id_proveedor
  			inner join 
	  			tc_mantic_almacenes on tc_mantic_notas_entradas.id_almacen = tc_mantic_almacenes.id_almacen
				inner join 
					tc_mantic_empresas on tc_mantic_empresas_deudas.id_empresa = tc_mantic_empresas.id_empresa
				where
					tc_mantic_empresas_deudas.id_empresa in (1, 2)
          and {condicion}
				group by	
          tc_mantic_proveedores.id_proveedor
        {sortOrder}					        
      </select>  
			<select id="detalle">
				select 
					principal.*,
					(select count(*) from tc_mantic_empresas_pagos where id_empresa_deuda= principal.id_key) as abonos,
					(select count(*) from tc_mantic_empresas_pagos where id_empresa_deuda= principal.id_key and id_egreso is not null) as abonos_egresos  
				from (
					select
						tc_mantic_empresas_deudas.id_empresa_deuda as id_key,
						tc_mantic_empresas_deudas.id_empresa,
						tc_mantic_notas_entradas.id_nota_entrada,
						tc_mantic_notas_entradas.consecutivo,
						tc_mantic_notas_entradas.consecutivo as ticket,
						tc_mantic_notas_entradas.factura,
						tc_mantic_notas_entradas.fecha_factura as fecha,
						tc_mantic_empresas_deudas.importe,
						tc_mantic_empresas_deudas.pagar,
						abs(tc_mantic_empresas_deudas.saldo) as saldo,
            tc_mantic_empresas_deudas.id_revisado,
            (tc_mantic_empresas_deudas.pagar+ tc_mantic_empresas_deudas.saldo) as abonado,
						concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) as persona,
						tc_mantic_empresas_deudas.limite,
						tc_mantic_empresas_deudas.registro,
						(datediff(tc_mantic_empresas_deudas.limite, now())* -1) as dias,
						tc_mantic_empresas.nombre,
						tc_mantic_empresas.clave,
						tc_mantic_proveedores.clave clave_proveedor,
						tc_mantic_proveedores.razon_social as proveedor,
						tc_mantic_almacenes.nombre as almacen,
						tc_mantic_almacenes.id_almacen,
						tc_mantic_proveedores.id_proveedor,
						tc_mantic_notas_entradas.id_nota_tipo,
						tc_mantic_notas_tipos.nombre as directa,
            tc_mantic_empresas_estatus.id_empresa_estatus,
						tc_mantic_empresas_estatus.nombre as estatus,
						tc_mantic_notas_entradas.original
					from
						tc_mantic_empresas_deudas
					inner join
						tc_mantic_notas_entradas on tc_mantic_empresas_deudas.id_nota_entrada= tc_mantic_notas_entradas.id_nota_entrada				
					inner join 
						tc_mantic_empresas_estatus on tc_mantic_empresas_deudas.id_empresa_estatus = tc_mantic_empresas_estatus.id_empresa_estatus
					inner join 
						tc_mantic_proveedores on tc_mantic_notas_entradas.id_proveedor = tc_mantic_proveedores.id_proveedor
					inner join 
						tc_mantic_almacenes on tc_mantic_notas_entradas.id_almacen = tc_mantic_almacenes.id_almacen
					inner join 
						tc_mantic_empresas on tc_mantic_empresas_deudas.id_empresa = tc_mantic_empresas.id_empresa
					inner join
						tc_janal_usuarios on tc_mantic_empresas_deudas.id_usuario= tc_janal_usuarios.id_usuario
					inner join
						tc_mantic_personas on tc_janal_usuarios.id_persona= tc_mantic_personas.id_persona				
					inner join
						tc_mantic_notas_tipos on tc_mantic_notas_entradas.id_nota_tipo= tc_mantic_notas_tipos.id_nota_tipo
					where
					  tc_mantic_empresas_deudas.id_empresa in ({idEmpresa})
            and tc_mantic_notas_entradas.id_proveedor= {idProveedor}
            and {condicion}
				  ) principal 
				{sortOrder}					
			</select>		
			<select id="documentos">
        select
          tt_keet_documentos.id_key,
          tt_keet_documentos.id_empresa_deuda,
          tt_keet_documentos.id_empresa,
          tt_keet_documentos.id_nota_entrada,
          tt_keet_documentos.consecutivo,
          tt_keet_documentos.ticket,
          tt_keet_documentos.factura,
          tt_keet_documentos.fecha,
          tt_keet_documentos.importe,
          tt_keet_documentos.pagar,
          tt_keet_documentos.original,
          tt_keet_documentos.id_proveedor,
          tt_keet_documentos.id_nota_tipo,
          tt_keet_documentos.directa,
          tt_keet_documentos.id_empresa_estatus,
          tt_keet_documentos.estatus,
          sum(if(tc_mantic_egresos_archivos.id_tipo_documento= 13, 1, 0))+ tt_keet_documentos.facturas as facturas,
          sum(if(tc_mantic_egresos_archivos.id_tipo_documento= 14, 1, 0))+ tt_keet_documentos.creditos as creditos,
          sum(if(tc_mantic_egresos_archivos.id_tipo_documento= 15, 1, 0))+ tt_keet_documentos.comprobantes as comprobantes,
          sum(if(tc_mantic_egresos_archivos.id_tipo_documento= 16, 1, 0))+ tt_keet_documentos.vouchers as vouchers,
          tt_keet_documentos.egresos,
          tt_keet_documentos.id_completo,
          tt_keet_documentos.registro
        from (
          select
            tt_keet_cuentas.*,
            tc_mantic_egresos_notas.id_egreso,
            count(distinct(tc_mantic_egresos_notas.id_egreso)) as egresos
          from (
            select
              tc_mantic_empresas_deudas.id_empresa_deuda as id_key,
              tc_mantic_empresas_deudas.id_empresa_deuda,
              tc_mantic_empresas_deudas.id_empresa,
              tc_mantic_notas_entradas.id_nota_entrada,
              tc_mantic_notas_entradas.consecutivo,
              tc_mantic_notas_entradas.consecutivo as ticket,
              tc_mantic_notas_entradas.factura,
              tc_mantic_notas_entradas.fecha_factura as fecha,
              tc_mantic_empresas_deudas.importe,
              tc_mantic_empresas_deudas.pagar,
              tc_mantic_notas_entradas.original,
              tc_mantic_proveedores.id_proveedor,
              tc_mantic_notas_entradas.id_nota_tipo,
              tc_mantic_notas_tipos.nombre as directa,
              tc_mantic_empresas_estatus.id_empresa_estatus,
              tc_mantic_empresas_estatus.nombre as estatus,
              sum(if(tc_mantic_notas_archivos.id_tipo_documento= 13, 1, 0)) as facturas,
              sum(if(tc_mantic_notas_archivos.id_tipo_documento= 14, 1, 0)) as creditos,
              sum(if(tc_mantic_notas_archivos.id_tipo_documento= 15, 1, 0)) as comprobantes,
              sum(if(tc_mantic_notas_archivos.id_tipo_documento= 16, 1, 0)) as vouchers,
              tc_mantic_empresas_deudas.id_completo,
              tc_mantic_empresas_deudas.registro
            from
              tc_mantic_empresas_deudas
            inner join
              tc_mantic_notas_entradas on tc_mantic_empresas_deudas.id_nota_entrada= tc_mantic_notas_entradas.id_nota_entrada				
            inner join 
              tc_mantic_empresas_estatus on tc_mantic_empresas_deudas.id_empresa_estatus = tc_mantic_empresas_estatus.id_empresa_estatus
            inner join 
              tc_mantic_proveedores on tc_mantic_notas_entradas.id_proveedor = tc_mantic_proveedores.id_proveedor
            inner join
              tc_mantic_notas_tipos on tc_mantic_notas_entradas.id_nota_tipo= tc_mantic_notas_tipos.id_nota_tipo
            left join
              tc_mantic_notas_archivos on tc_mantic_notas_entradas.id_nota_entrada= tc_mantic_notas_archivos.id_nota_entrada
            where
              tc_mantic_empresas_deudas.id_empresa in ({idEmpresa})
              and tc_mantic_notas_entradas.id_proveedor= {idProveedor}
              and tc_mantic_notas_archivos.id_eliminado= 2
              and {condicion}
            group by
              tc_mantic_notas_entradas.id_nota_entrada
        ) as tt_keet_cuentas
        left join
          tc_mantic_egresos_notas on tt_keet_cuentas.id_nota_entrada = tc_mantic_egresos_notas.id_nota_entrada
        group by
          tt_keet_cuentas.id_nota_entrada
        ) as tt_keet_documentos
        left join
          tc_mantic_egresos_archivos on tt_keet_documentos.id_egreso= tc_mantic_egresos_archivos.id_egreso
        group by
          tt_keet_documentos.id_nota_entrada
        {sortOrder} 
      </select>  
			<select id="completos">
        select
          tt_keet_documentos.*
        from (  
	 			  select
				  	tc_mantic_notas_archivos.id_nota_archivo as id_key,
					  tc_mantic_notas_archivos.id_nota_entrada,
					  tc_mantic_notas_archivos.id_tipo_documento,
			  	  tc_mantic_notas_archivos.id_tipo_archivo,
            tc_mantic_tipos_archivos.nombre as tipo,
            tc_mantic_notas_archivos.nombre,
            tc_mantic_notas_archivos.alias,
            tc_mantic_notas_archivos.ruta,
            tc_mantic_notas_archivos.id_principal,
            concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) as usuario,
            tc_mantic_notas_archivos.observaciones,
            tc_mantic_notas_archivos.registro,
            tt_mantic_tipos_archivos.nombre as documento,
            tc_mantic_notas_archivos.id_eliminado,
            'facturas/' as repositorio
          from
            tc_mantic_notas_archivos
          inner join
            tc_mantic_tipos_archivos on tc_mantic_notas_archivos.id_tipo_archivo= tc_mantic_tipos_archivos.id_tipo_archivo
          inner join
            tc_mantic_tipos_archivos as tt_mantic_tipos_archivos on tc_mantic_notas_archivos.id_tipo_documento= tt_mantic_tipos_archivos.id_tipo_archivo
          inner join
            tc_janal_usuarios on tc_mantic_notas_archivos.id_usuario= tc_janal_usuarios.id_usuario          
          inner join
            tc_mantic_personas on tc_janal_usuarios.id_persona= tc_mantic_personas.id_persona
          where
            tc_mantic_notas_archivos.id_nota_entrada= {idNotaEntrada}
            and (tc_mantic_notas_archivos.id_tipo_documento= {idTipoDocumento} or {idTipoDocumento}= -1)
          union all  				
          select
            (50000+ tc_mantic_egresos_archivos.id_egreso_archivo) as id_key,
            tc_mantic_egresos_notas.id_nota_entrada,
            tc_mantic_egresos_archivos.id_tipo_documento,
            tc_mantic_egresos_archivos.id_tipo_archivo,
            tc_mantic_tipos_archivos.nombre as tipo,
            tc_mantic_egresos_archivos.nombre,
            tc_mantic_egresos_archivos.alias,
            tc_mantic_egresos_archivos.ruta,
            tc_mantic_egresos_archivos.id_principal,
            concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) as usuario,
            tc_mantic_egresos_archivos.observaciones,
            tc_mantic_egresos_archivos.registro,
            tt_mantic_tipos_archivos.nombre as documento,
            tc_mantic_egresos_archivos.id_eliminado,
            'egresos/' as repositorio
          from
            tc_mantic_egresos_archivos
          inner join
            tc_mantic_egresos_notas on tc_mantic_egresos_archivos.id_egreso= tc_mantic_egresos_notas.id_egreso
          inner join
            tc_mantic_tipos_archivos on tc_mantic_egresos_archivos.id_tipo_archivo= tc_mantic_tipos_archivos.id_tipo_archivo
          inner join
            tc_mantic_tipos_archivos as tt_mantic_tipos_archivos on tc_mantic_egresos_archivos.id_tipo_documento= tt_mantic_tipos_archivos.id_tipo_archivo
          inner join
            tc_janal_usuarios on tc_mantic_egresos_archivos.id_usuario= tc_janal_usuarios.id_usuario          
          inner join
            tc_mantic_personas on tc_janal_usuarios.id_persona= tc_mantic_personas.id_persona
          where
            tc_mantic_egresos_notas.id_nota_entrada= {idNotaEntrada}
            and (tc_mantic_egresos_archivos.id_tipo_documento= {idTipoDocumento} or {idTipoDocumento}= -1)
        ) as tt_keet_documentos   
	  		order by
		  	  tt_keet_documentos.id_tipo_documento, 
          tt_keet_documentos.id_tipo_archivo, 
          tt_keet_documentos.registro desc        
			</select>      
			<select id="cuentasBusqueda">
				select 
					principal.*,
					(select count(*) from tc_mantic_empresas_pagos where id_empresa_deuda= principal.id_key) as abonos,
					(select count(*) from tc_mantic_empresas_pagos where id_empresa_deuda= principal.id_key and id_egreso is not null) as abonos_egresos  
				from (
					select
						tc_mantic_empresas_deudas.id_empresa_deuda as id_key,
						tc_mantic_empresas_deudas.id_empresa,
						tc_mantic_notas_entradas.id_nota_entrada,
						tc_mantic_notas_entradas.consecutivo,
						tc_mantic_notas_entradas.factura,
						tc_mantic_notas_entradas.fecha_factura,
						tc_mantic_empresas_deudas.importe,
						tc_mantic_empresas_deudas.pagar,
						tc_mantic_empresas_deudas.saldo,
						concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) as persona,
						tc_mantic_empresas_deudas.limite,
						tc_mantic_empresas_deudas.registro,
						(datediff(tc_mantic_empresas_deudas.limite, now())* -1) as dias,
						tc_mantic_empresas.nombre,
						tc_mantic_empresas.clave,
						tc_mantic_proveedores.clave clave_proveedor,
						tc_mantic_proveedores.razon_social proveedor,
						tc_mantic_almacenes.nombre almacen,
						tc_mantic_almacenes.id_almacen,
						tc_mantic_proveedores.id_proveedor,
						tc_mantic_notas_entradas.id_nota_tipo,
						tc_mantic_notas_tipos.nombre as directa,
						tc_mantic_empresas_estatus.nombre estatus,
						tc_mantic_notas_entradas.original
					from
						tc_mantic_empresas_deudas
					inner join
						tc_mantic_notas_entradas on tc_mantic_empresas_deudas.id_nota_entrada= tc_mantic_notas_entradas.id_nota_entrada				
					inner join 
						tc_mantic_empresas_estatus on tc_mantic_empresas_deudas.id_empresa_estatus = tc_mantic_empresas_estatus.id_empresa_estatus
					inner join 
						tc_mantic_proveedores on tc_mantic_notas_entradas.id_proveedor = tc_mantic_proveedores.id_proveedor
					inner join 
						tc_mantic_almacenes on tc_mantic_notas_entradas.id_almacen = tc_mantic_almacenes.id_almacen
					inner join 
						tc_mantic_empresas on tc_mantic_empresas_deudas.id_empresa = tc_mantic_empresas.id_empresa
					inner join
						tc_janal_usuarios on tc_mantic_empresas_deudas.id_usuario= tc_janal_usuarios.id_usuario
					inner join
						tc_mantic_personas on tc_janal_usuarios.id_persona= tc_mantic_personas.id_persona				
					inner join
						tc_mantic_notas_tipos on tc_mantic_notas_entradas.id_nota_tipo= tc_mantic_notas_tipos.id_nota_tipo
					where
						{condicion}								  
					  and tc_mantic_almacenes.id_empresa in ({idEmpresa})				  
					  and tc_mantic_notas_entradas.id_empresa in ({idEmpresa})
				) principal 
				{sortOrder}					
			</select>		
			<select id="cuentas">
				select
					tc_mantic_empresas_deudas.id_empresa_deuda as id_key,
					tc_mantic_empresas_deudas.id_empresa,
					tc_mantic_empresas_deudas.id_empresa_estatus,
				  tc_mantic_notas_entradas.id_nota_entrada,
					tc_mantic_notas_entradas.consecutivo,
					tc_mantic_notas_entradas.factura,
					tc_mantic_empresas_deudas.importe,
					tc_mantic_empresas_deudas.saldo as debe,
					tc_mantic_empresas_deudas.saldo,
          tc_mantic_empresas_deudas.id_revisado,
					concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) as persona,
					tc_mantic_empresas_deudas.limite,
					tc_mantic_empresas_deudas.registro,
					datediff(tc_mantic_empresas_deudas.limite, now()) as dias,
					tc_mantic_empresas.nombre,
					tc_mantic_proveedores.id_proveedor,
					tc_mantic_proveedores.razon_social proveedor,
					tc_mantic_almacenes.nombre almacen,
					tc_mantic_empresas_estatus.nombre estatus
				from
					tc_mantic_empresas_deudas
				inner join
					tc_mantic_notas_entradas on tc_mantic_empresas_deudas.id_nota_entrada= tc_mantic_notas_entradas.id_nota_entrada				
				inner join 
					tc_mantic_empresas_estatus on tc_mantic_empresas_deudas.id_empresa_estatus = tc_mantic_empresas_estatus.id_empresa_estatus
				inner join 
					tc_mantic_proveedores on tc_mantic_notas_entradas.id_proveedor = tc_mantic_proveedores.id_proveedor
				inner join 
					tc_mantic_almacenes on tc_mantic_notas_entradas.id_almacen = tc_mantic_almacenes.id_almacen
				inner join 
					tc_mantic_empresas on tc_mantic_empresas_deudas.id_empresa = tc_mantic_empresas.id_empresa
				inner join
					tc_janal_usuarios on tc_mantic_empresas_deudas.id_usuario= tc_janal_usuarios.id_usuario
				inner join
					tc_mantic_personas on tc_janal_usuarios.id_persona= tc_mantic_personas.id_persona				
				where
					tc_mantic_empresas_deudas.id_empresa_deuda = {idEmpresaDeuda}								
				{sortOrder}						
			</select>		
			<select id="cuentasProveedor">
				select
					tc_mantic_empresas_deudas.id_empresa_deuda as id_key,
					tc_mantic_empresas_deudas.id_empresa,
					tc_mantic_empresas_deudas.id_empresa_estatus,
					tc_mantic_notas_entradas.consecutivo,
					tc_mantic_notas_entradas.factura,
					tc_mantic_empresas_deudas.importe,
					abs(tc_mantic_empresas_deudas.saldo) as saldo,
					concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) as persona,
					tc_mantic_empresas_deudas.limite,
					tc_mantic_empresas_deudas.registro,
					(datediff(tc_mantic_empresas_deudas.limite, now())* -1) as dias,
					tc_mantic_empresas.nombre,
					tc_mantic_proveedores.razon_social proveedor,
					tc_mantic_almacenes.nombre almacen,
					tc_mantic_empresas_estatus.nombre estatus
				from
					tc_mantic_empresas_deudas
				inner join
					tc_mantic_notas_entradas on tc_mantic_empresas_deudas.id_nota_entrada= tc_mantic_notas_entradas.id_nota_entrada				
				inner join 
					tc_mantic_empresas_estatus on tc_mantic_empresas_deudas.id_empresa_estatus = tc_mantic_empresas_estatus.id_empresa_estatus
				inner join 
					tc_mantic_proveedores on tc_mantic_notas_entradas.id_proveedor = tc_mantic_proveedores.id_proveedor
				inner join 
					tc_mantic_almacenes on tc_mantic_notas_entradas.id_almacen = tc_mantic_almacenes.id_almacen
				inner join 
					tc_mantic_empresas on tc_mantic_empresas_deudas.id_empresa = tc_mantic_empresas.id_empresa
				inner join
					tc_janal_usuarios on tc_mantic_empresas_deudas.id_usuario= tc_janal_usuarios.id_usuario
				inner join
					tc_mantic_personas on tc_janal_usuarios.id_persona= tc_mantic_personas.id_persona				
				where
					{condicion}
				  and tc_mantic_proveedores.id_proveedor = {idProveedor}								
				{sortOrder}						
			</select>		
			<select id="pagosDeuda">
				select
					tc_mantic_empresas_pagos.id_empresa_pago as id_key,
					tc_mantic_notas_entradas.consecutivo,
					tc_mantic_notas_entradas.factura,
					tc_mantic_empresas_deudas.importe,
					tc_mantic_empresas_deudas.saldo,
					tc_mantic_empresas_pagos.pago,
					concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) as persona,
					tc_mantic_empresas_pagos.registro,
					tc_mantic_empresas_pagos.observaciones,
					tc_mantic_tipos_medios_pagos.clave,
					tc_mantic_tipos_medios_pagos.nombre,
					if(tc_mantic_empresas_pagos.id_egreso is null, '0', tc_mantic_empresas_pagos.id_egreso) id_egreso,					
					tc_mantic_empresas_pagos.id_credito_nota,
					tc_mantic_empresas_pagos.id_nota_entrada, 
					if(archivos.total is null, 0, archivos.total) total_archivos,
          tc_mantic_empresas_pagos.comentarios
				from
					tc_mantic_empresas_pagos
				inner join
					tc_mantic_empresas_deudas on tc_mantic_empresas_pagos.id_empresa_deuda= tc_mantic_empresas_deudas.id_empresa_deuda
				inner join
					tc_mantic_notas_entradas on tc_mantic_empresas_deudas.id_nota_entrada= tc_mantic_notas_entradas.id_nota_entrada
				inner join
					tc_janal_usuarios on tc_mantic_empresas_pagos.id_usuario= tc_janal_usuarios.id_usuario
				inner join
					tc_mantic_personas on tc_janal_usuarios.id_persona= tc_mantic_personas.id_persona
				inner join 
					tc_mantic_tipos_medios_pagos on tc_mantic_empresas_pagos.id_tipo_medio_pago = tc_mantic_tipos_medios_pagos.id_tipo_medio_pago
				left join
					(select id_empresa_pago, count(*) total from tc_mantic_empresas_archivos group by id_empresa_pago) archivos on tc_mantic_empresas_pagos.id_empresa_pago = archivos.id_empresa_pago
				where
					tc_mantic_empresas_deudas.id_empresa_deuda= {idEmpresaDeuda}									
				order by
					tc_mantic_empresas_pagos.registro desc					
			</select>
			<select id="pagosBusqueda">				
				select
					tc_mantic_empresas_pagos.id_empresa_pago as id_key,
					tc_mantic_notas_entradas.consecutivo,
					tc_mantic_empresas_deudas.importe,
					tc_mantic_empresas_deudas.saldo,
					tc_mantic_empresas_pagos.pago,
					concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) as persona,
					tc_mantic_empresas_pagos.registro,
					tc_mantic_empresas.nombre
				from
					tc_mantic_empresas_pagos
				inner join
					tc_mantic_empresas_deudas on tc_mantic_empresas_pagos.id_empresa_deuda= tc_mantic_empresas_deudas.id_empresa_deuda
				inner join
					tc_mantic_notas_entradas on tc_mantic_empresas_deudas.id_nota_entrada= tc_mantic_notas_entradas.id_nota_entrada
				inner join 
					tc_mantic_proveedores on tc_mantic_notas_entradas.id_proveedor = tc_mantic_proveedores.id_proveedor
				inner join 
					tc_mantic_almacenes on tc_mantic_notas_entradas.id_almacen = tc_mantic_almacenes.id_almacen
				inner join 
					tc_mantic_empresas on tc_mantic_empresas_deudas.id_empresa = tc_mantic_empresas.id_empresa				
				inner join
					tc_janal_usuarios on tc_mantic_empresas_pagos.id_usuario= tc_janal_usuarios.id_usuario
				inner join
					tc_mantic_personas on tc_janal_usuarios.id_persona= tc_mantic_personas.id_persona
				where
					{condicion}				
				and	tc_mantic_proveedores.razon_social like '%{proveedor}%'
				and tc_mantic_almacenes.id_empresa in ({idEmpresa})
				and (tc_mantic_almacenes.clave like upper('%{almacen}%') or tc_mantic_almacenes.nombre like upper('%{almacen}%'))
				and tc_mantic_notas_entradas.id_empresa in ({idEmpresa})
				order by
					tc_mantic_notas_entradas.consecutivo, 
					tc_mantic_empresas_deudas.registro desc
			</select>
			<select id="importados">
				select
					tc_mantic_empresas_archivos.id_empresa_archivo as id_key,
					tc_mantic_empresas_archivos.id_empresa_pago,
			  	tc_mantic_empresas_archivos.id_tipo_archivo,
					tc_mantic_tipos_archivos.nombre as tipo,
					tc_mantic_empresas_archivos.archivo as nombre,
					tc_mantic_empresas_archivos.alias,
					tc_mantic_empresas_archivos.ruta,
					tc_mantic_empresas_archivos.id_principal,
					concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) as usuario,
					tc_mantic_empresas_archivos.observaciones,
					tc_mantic_empresas_archivos.registro,
				  tc_mantic_empresas_pagos.pago,
				  tc_mantic_empresas_archivos.pago registro_pago,
					tc_mantic_tipos_comprobantes.nombre comprobante
				from
					tc_mantic_empresas_archivos
				inner join
					tc_mantic_tipos_archivos on tc_mantic_empresas_archivos.id_tipo_archivo= tc_mantic_tipos_archivos.id_tipo_archivo				
				inner join 
					tc_mantic_empresas_pagos on tc_mantic_empresas_archivos.id_empresa_pago = tc_mantic_empresas_pagos.id_empresa_pago
				inner join 
					tc_mantic_empresas_deudas on tc_mantic_empresas_pagos.id_empresa_deuda = tc_mantic_empresas_deudas.id_empresa_deuda
				inner join
					tc_janal_usuarios on tc_mantic_empresas_archivos.id_usuario= tc_janal_usuarios.id_usuario
				inner join
					tc_mantic_personas on tc_janal_usuarios.id_persona= tc_mantic_personas.id_persona
				left join 
					tc_mantic_tipos_comprobantes on tc_mantic_empresas_archivos.id_tipo_comprobante = tc_mantic_tipos_comprobantes.id_tipo_comprobante
				where
					tc_mantic_empresas_deudas.id_empresa_deuda= {idEmpresaDeuda}
				order by
					tc_mantic_empresas_archivos.id_tipo_archivo, 
				  tc_mantic_empresas_archivos.registro desc				
			</select>
			<select id="exists">
        select      
          tc_mantic_empresas_archivos.*
        from      
          tc_mantic_empresas_archivos
				inner join 
					tc_mantic_empresas_pagos on tc_mantic_empresas_archivos.id_empresa_pago = tc_mantic_empresas_pagos.id_empresa_pago
				inner join 
					tc_mantic_empresas_deudas on tc_mantic_empresas_pagos.id_empresa_deuda = tc_mantic_empresas_deudas.id_empresa_deuda
        where      
          tc_mantic_empresas_archivos.id_tipo_archivo = {idTipoArchivo} and tc_mantic_empresas_deudas.id_empresa_deuda = {idEmpresaDeuda}
				order by
				  tc_mantic_empresas_archivos.registro desc
      </select>
			<select id="deuda">
				select
					tc_mantic_proveedores.id_proveedor as id_key,
					tc_mantic_proveedores.razon_social,															
					sum(tc_mantic_empresas_deudas.importe) as importe,
					sum(tc_mantic_empresas_deudas.saldo) as debe,
					sum(tc_mantic_empresas_deudas.saldo) as saldo
				from
					tc_mantic_proveedores
				inner join
					tc_mantic_notas_entradas on tc_mantic_proveedores.id_proveedor = tc_mantic_notas_entradas.id_proveedor
				left join
					tc_mantic_empresas_deudas on tc_mantic_empresas_deudas.id_nota_entrada= tc_mantic_notas_entradas.id_nota_entrada and tc_mantic_empresas_deudas.id_empresa_estatus in (1, 2, 3)
				where
					tc_mantic_proveedores.id_proveedor= {idProveedor}
				group by 
					tc_mantic_proveedores.id_proveedor
			</select>	
		</unit>
		<unit id="VistaTallerServiciosDto">
      <select id="proveedor">
        select      
				  tr_mantic_proveedor_pago.id_proveedor_pago as id_key,
          tr_mantic_proveedor_pago.id_proveedor_pago,
          tr_mantic_proveedor_pago.id_proveedor,
				  tc_mantic_proveedores.id_tipo_dia,
				  tc_mantic_proveedores.dias_entrega as dias
        from      
          tr_mantic_proveedor_pago
        inner join  
          tc_mantic_proveedores on tr_mantic_proveedor_pago.id_proveedor= tc_mantic_proveedores.id_proveedor
        where      
          tc_mantic_proveedores.id_proveedor= {idProveedor}
				order by
				  tr_mantic_proveedor_pago.clave	
      </select>
      <select id="existe">
		    select 
          tc_mantic_articulos.id_articulo as id_key,
          tc_mantic_articulos.*
        from 
          tc_mantic_articulos_codigos 
        inner join
          tc_mantic_articulos on tc_mantic_articulos_codigos.id_articulo= tc_mantic_articulos.id_articulo 
        where 
          tc_mantic_articulos.id_articulo_tipo= {idArticuloTipo}
          and (
           (tc_mantic_articulos_codigos.id_principal= 1 and upper(tc_mantic_articulos_codigos.codigo) regexp '.*{codigo}.*')
           or 
           upper(tc_mantic_articulos.nombre)=  upper('{nombre}')
          )
      </select>
      <select id="stock">
        select      
          tc_mantic_inventarios.*
        from      
          tc_mantic_inventarios
        inner join
          tc_mantic_articulos on tc_mantic_inventarios.id_articulo= tc_mantic_articulos.id_articulo
        where      
          tc_mantic_inventarios.id_almacen in ({idAlmacen})
				  and tc_mantic_inventarios.id_articulo= {idArticulo}
          and tc_mantic_articulos.id_articulo_tipo= {idArticuloTipo}
				order by
				 registro desc
      </select>
			<select id="porNombre">
				select 
				  tc_mantic_articulos.id_articulo as id_key,
				  tc_mantic_articulos.id_articulo,
				  (select tc_mantic_articulos_codigos.codigo from tc_mantic_articulos_codigos where tc_mantic_articulos_codigos.id_articulo= tc_mantic_articulos.id_articulo and tc_mantic_articulos_codigos.id_principal= 1 and (upper(tc_mantic_articulos.nombre) regexp '.*{codigo}.*' or tc_mantic_articulos.id_articulo= {idArticulo}) limit 0, 1) as propio,
				  tc_mantic_articulos.fabricante,  
				  tc_mantic_articulos.nombre,
				  tc_mantic_articulos.descripcion,
				  tc_mantic_articulos.precio as costo,
				  tc_mantic_articulos.menudeo as precio,
				  tc_mantic_articulos.menudeo,
				  tc_mantic_articulos.precio as original,
				  tc_mantic_articulos.iva,
				  tc_mantic_articulos.sat,
				  tc_mantic_articulos.id_redondear,
				  tc_mantic_articulos_tipos.id_articulo_tipo is_articulo,
				  tc_mantic_articulos_tipos.nombre as is_tipo
				from 
					tc_mantic_articulos
				inner join 
					tc_mantic_empresas on tc_mantic_articulos.id_empresa = tc_mantic_empresas.id_empresa
				inner join 
					tc_mantic_articulos_tipos on tc_mantic_articulos.id_articulo_tipo = tc_mantic_articulos_tipos.id_articulo_tipo
				where 
					tc_mantic_empresas.id_empresa in ({sucursales})
				  and tc_mantic_articulos.id_articulo_tipo= {idArticuloTipo}
				  and 
				  (
            upper(tc_mantic_articulos.nombre) regexp upper('.*{codigo}.*')
				    or
				    tc_mantic_articulos.id_articulo= {idArticulo}
          )
				order by
				  tc_mantic_articulos.nombre			
			</select>
			<select id="porArticulosLikeNombre">
				select 
				  tc_mantic_articulos.id_articulo as id_key,
				  tc_mantic_articulos.id_articulo,
				  (select tc_mantic_articulos_codigos.codigo from tc_mantic_articulos_codigos where tc_mantic_articulos_codigos.id_articulo= tc_mantic_articulos.id_articulo and tc_mantic_articulos_codigos.id_principal= 1 and (upper(tc_mantic_articulos.nombre) like '{codigo}%' or tc_mantic_articulos.id_articulo= {idArticulo}) limit 0, 1) as propio,
				  tc_mantic_articulos.fabricante,  
				  tc_mantic_articulos.nombre,
				  tc_mantic_articulos.descripcion,
				  tc_mantic_articulos.precio as costo,
				  tc_mantic_articulos.menudeo as precio,
				  tc_mantic_articulos.menudeo,
				  tc_mantic_articulos.precio as original,
				  tc_mantic_articulos.iva,
				  tc_mantic_articulos.sat,
				  tc_mantic_articulos.id_redondear,
				  tc_mantic_articulos_tipos.id_articulo_tipo is_articulo,
				  tc_mantic_articulos_tipos.nombre as is_tipo
				from 
					tc_mantic_articulos
				inner join 
					tc_mantic_empresas on tc_mantic_articulos.id_empresa = tc_mantic_empresas.id_empresa
				inner join 
					tc_mantic_articulos_tipos on tc_mantic_articulos.id_articulo_tipo = tc_mantic_articulos_tipos.id_articulo_tipo
				where 
					tc_mantic_empresas.id_empresa in ({sucursales})
				  and tc_mantic_articulos.id_articulo_tipo= {idArticuloTipo}
				  and 
				  (
            upper(tc_mantic_articulos.nombre) regexp upper('.*{codigo}.*')
				    or
				    tc_mantic_articulos.id_articulo= {idArticulo}
          )
				order by
				  tc_mantic_articulos.nombre			
			</select>
			<select id="porRefaccionesLikeNombre">
				select 
				  tc_mantic_refacciones.id_refaccion as id_key,
				  0 as id_articulo,
				  tc_mantic_refacciones.codigo as propio,
				  tc_mantic_refacciones.fabricante,  
				  tc_mantic_refacciones.nombre,
				  tc_mantic_refacciones.nombre as descripcion,
				  tc_mantic_refacciones.costo,
				  tc_mantic_refacciones.precio,
				  tc_mantic_refacciones.precio as menudeo,
				  tc_mantic_refacciones.costo as original,
				  tc_mantic_refacciones.iva,
				  tc_mantic_refacciones.sat,
          2 as id_redondear,
          2 as is_articulo,
				  'REFACCION' as is_tipo
				from 
					tc_mantic_refacciones
				where 
					tc_mantic_refacciones.id_empresa in ({sucursales})
				  and upper(tc_mantic_refacciones.nombre) regexp upper('.*{codigo}.*')
				order by
				  tc_mantic_refacciones.nombre			
			</select>
			<select id="porServiciosLikeNombre">
				select 
				  tc_mantic_encargos.id_encargo as id_key,
				  0 as id_articulo,
				  tc_mantic_encargos.codigo as propio,
				  ' ' as fabricante,  
				  tc_mantic_encargos.nombre,
				  tc_mantic_encargos.nombre as descripcion,
				  tc_mantic_encargos.costo,
				  tc_mantic_encargos.precio,
				  tc_mantic_encargos.precio as menudeo,
				  tc_mantic_encargos.costo as original,
				  tc_mantic_encargos.iva,
				  tc_mantic_encargos.sat,
          2 as id_redondear,
          3 as is_articulo,
				  'SERVICIO' as is_tipo
				from 
					tc_mantic_encargos
				where 
					tc_mantic_encargos.id_empresa in ({sucursales})
				  and upper(tc_mantic_encargos.nombre) regexp upper('.*{codigo}.*')
				order by
				  tc_mantic_encargos.nombre		
			</select>
			<select id="porArticulosCodigo">
				select 
				  tc_mantic_articulos.id_articulo as id_key,
				  tc_mantic_articulos.id_articulo,
				  (select tc_mantic_articulos_codigos.codigo from tc_mantic_articulos_codigos where tc_mantic_articulos_codigos.id_articulo= tc_mantic_articulos.id_articulo and tc_mantic_articulos_codigos.id_principal= 1 limit 0, 1) as propio,
				  tc_mantic_articulos.fabricante,  
				  tc_mantic_articulos.nombre,
				  tc_mantic_articulos.descripcion,
				  tc_mantic_articulos.precio as costo,
				  tc_mantic_articulos.menudeo as precio,
				  tc_mantic_articulos.menudeo,
				  tc_mantic_articulos.precio as original,
				  tc_mantic_articulos.iva,
          tc_mantic_articulos.sat,
          tc_mantic_articulos.id_redondear,
				  tc_mantic_articulos.id_articulo_tipo is_articulo,
				  tc_mantic_articulos_tipos.nombre as is_tipo
				from 
					tc_mantic_articulos
				inner join
					tc_mantic_articulos_codigos on tc_mantic_articulos.id_articulo = tc_mantic_articulos_codigos.id_articulo
				inner join 
					tc_mantic_empresas on tc_mantic_articulos.id_empresa = tc_mantic_empresas.id_empresa
				inner join 
					tc_mantic_articulos_tipos on tc_mantic_articulos.id_articulo_tipo = tc_mantic_articulos_tipos.id_articulo_tipo
				where 
					tc_mantic_empresas.id_empresa in ({sucursales})
				  and tc_mantic_articulos.id_articulo_tipo= {idArticuloTipo}
				  and tc_mantic_articulos.id_vigente= 1
				  and 
				  ((upper(tc_mantic_articulos_codigos.codigo) regexp '.*{codigo}.*' and tc_mantic_articulos_codigos.id_proveedor is null)
			     or
			      (upper(tc_mantic_articulos_codigos.codigo) regexp '.*{codigo}.*' and tc_mantic_articulos_codigos.id_proveedor = {idProveedor})
				   or
				    tc_mantic_articulos.id_articulo= {idArticulo}) 			
				order by
				  propio
			</select>			
			<select id="porRefaccionCodigo">
				select 
				  tc_mantic_refacciones.id_refaccion as id_key,
				  0 as id_articulo,
				  tc_mantic_refacciones.codigo as propio,
				  tc_mantic_refacciones.fabricante,  
				  tc_mantic_refacciones.nombre,
				  tc_mantic_refacciones.nombre as descripcion,
				  tc_mantic_refacciones.costo,
				  tc_mantic_refacciones.precio,
				  tc_mantic_refacciones.precio as menudeo,
				  tc_mantic_refacciones.costo as original,
				  tc_mantic_refacciones.iva,
				  tc_mantic_refacciones.sat,
          2 as id_redondear,
          2 as is_articulo,
				  'REFACCION' as is_tipo
				from 
					tc_mantic_refacciones
				where 
					tc_mantic_refacciones.id_empresa in ({sucursales})
				  and upper(tc_mantic_encargos.codigo) regexp upper('.*{codigo}.*')
				order by
				  tc_mantic_refacciones.nombre		        
      </select>  
			<select id="porServicioCodigo">
				select 
				  tc_mantic_encargos.id_encargo as id_key,
				  0 as id_articulo,
				  tc_mantic_encargos.codigo as propio,
				  ' ' as fabricante,  
				  tc_mantic_encargos.nombre,
				  tc_mantic_encargos.nombre as descripcion,
				  tc_mantic_encargos.costo,
				  tc_mantic_encargos.precio,
				  tc_mantic_encargos.precio as menudeo,
				  tc_mantic_encargos.costo as original,
				  tc_mantic_encargos.iva,
				  tc_mantic_encargos.sat,
          2 as id_redondear,
          3 as is_articulo,
				  'SERVICIO' as is_tipo
				from 
					tc_mantic_encargos
				where 
					tc_mantic_encargos.id_empresa in ({sucursales})
				  and upper(tc_mantic_encargos.codigo) regexp upper('.*{codigo}.*')
				order by
				  tc_mantic_encargos.nombre		        
      </select>  
			<select id="porCodigo">
				select 
				  tc_mantic_articulos.id_articulo as id_key,
				  tc_mantic_articulos.id_articulo,
				  (select tc_mantic_articulos_codigos.codigo from tc_mantic_articulos_codigos where tc_mantic_articulos_codigos.id_articulo= tc_mantic_articulos.id_articulo and tc_mantic_articulos_codigos.id_principal= 1 limit 0, 1) as propio,
				  tc_mantic_articulos.fabricante,  
				  tc_mantic_articulos.nombre,
				  tc_mantic_articulos.descripcion,
				  tc_mantic_articulos.precio as costo,
				  tc_mantic_articulos.menudeo as precio,
				  tc_mantic_articulos.menudeo,
				  tc_mantic_articulos.precio as original,
				  tc_mantic_articulos.iva,
				  tc_mantic_articulos.sat,
				  tc_mantic_articulos.id_redondear,
				  tc_mantic_articulos.id_articulo_tipo is_articulo,
				  tc_mantic_articulos_tipos.nombre as is_tipo
				from 
					tc_mantic_articulos
				inner join
					tc_mantic_articulos_codigos on tc_mantic_articulos.id_articulo = tc_mantic_articulos_codigos.id_articulo
				inner join 
					tc_mantic_empresas on tc_mantic_articulos.id_empresa = tc_mantic_empresas.id_empresa
				inner join 
					tc_mantic_articulos_tipos on tc_mantic_articulos.id_articulo_tipo = tc_mantic_articulos_tipos.id_articulo_tipo
				where 
					tc_mantic_empresas.id_empresa in ({sucursales})
				  and tc_mantic_articulos.id_articulo_tipo= {idArticuloTipo}
				  and tc_mantic_articulos.id_vigente= 1
				  and 
				  ((upper(tc_mantic_articulos_codigos.codigo) regexp '.*{codigo}.*' and tc_mantic_articulos_codigos.id_proveedor is null)
			     or
			      (upper(tc_mantic_articulos_codigos.codigo) regexp '.*{codigo}.*' and tc_mantic_articulos_codigos.id_proveedor = {idProveedor})
				   or
				    tc_mantic_articulos.id_articulo= {idArticulo}) 			
				order by
				  propio
			</select>			
			<select id="movimientos">
				select
					tc_mantic_servicios_bitacora.id_servicio_bitacora as id_key,
					tc_mantic_servicios_bitacora.consecutivo,
					tc_mantic_servicios_bitacora.importe,
					tc_mantic_servicios_bitacora.seguimiento as justificacion,
					concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) as nombre,
				  tc_mantic_servicios_estatus.nombre as estatus,
					tc_mantic_servicios_bitacora.registro
				from 
					tc_mantic_servicios_bitacora
				inner join
					tc_mantic_servicios_estatus on tc_mantic_servicios_bitacora.id_servicio_estatus= tc_mantic_servicios_estatus.id_servicio_estatus
				inner join
					tc_janal_usuarios on tc_mantic_servicios_bitacora.id_usuario= tc_janal_usuarios.id_usuario
				inner join
					tc_mantic_personas on tc_janal_usuarios.id_persona= tc_mantic_personas.id_persona
				where
					tc_mantic_servicios_bitacora.id_servicio= {idServicio}
				order by
					tc_mantic_servicios_bitacora.registro desc				
			</select>
			<select id="principal">
				select 
          tc_mantic_principal.*,
          sum(tc_mantic_principal.cantidad) as refacciones
        from (
          select  
            tc_mantic_servicios.id_servicio as id_key,
            tc_mantic_servicios.*,
            tc_mantic_almacenes.id_almacen as id_principal,
            ifnull(tc_mantic_servicios.cliente, tc_mantic_clientes.razon_social) as razon_social, 
            tc_mantic_servicios_estatus.nombre estatus,
            tc_mantic_servicios_estatus.estatus_asociados,
            ifnull(tc_mantic_servicios_detalles.cantidad, 0) as cantidad
          from 
            tc_mantic_servicios
          inner join 
            tc_mantic_servicios_estatus on tc_mantic_servicios.id_servicio_estatus = tc_mantic_servicios_estatus.id_servicio_estatus
          inner join 
            tc_mantic_almacenes on tc_mantic_servicios.id_empresa = tc_mantic_almacenes.id_empresa and tc_mantic_almacenes.id_principal= 1
          left join 
            tc_mantic_clientes on tc_mantic_servicios.id_cliente = tc_mantic_clientes.id_cliente
          left join 
            tc_mantic_servicios_detalles on tc_mantic_servicios.id_servicio = tc_mantic_servicios_detalles.id_servicio
          left join 
            tc_mantic_articulos on tc_mantic_servicios_detalles.id_articulo = tc_mantic_articulos.id_articulo
          where 
            tc_mantic_servicios.id_empresa={idEmpresa}
            and {condicion}					
          ) as tc_mantic_principal
				group by 
					id_key,
					consecutivo,
					herramienta,
					marca,
					modelo,
					total,
					registro,
					fecha_estimada,
          razon_social, 
					estatus,
					estatus_asociados
        {sortOrder}
			</select>		
		</unit>
    <unit id="VistaInformacionProveedor">		
      <select id="telefonos">
        select group_concat(telefono_proveedor.valor separator ' , ') tels from 
          tc_mantic_ordenes_compras
        inner join 
          tc_mantic_proveedores on tc_mantic_ordenes_compras.id_proveedor= tc_mantic_proveedores.id_proveedor
        left join 
          tr_mantic_proveedor_tipo_contacto telefono_proveedor on tc_mantic_proveedores.id_proveedor = telefono_proveedor.id_proveedor and telefono_proveedor.id_tipo_contacto between 1 and 8
        where 
          tc_mantic_ordenes_compras.id_orden_compra= {idOrdenCompra}
      </select>	
      <select id="emails">
        select group_concat(valor separator ' , ') emails from 
          tc_mantic_ordenes_compras
        inner join 
          tc_mantic_proveedores on tc_mantic_ordenes_compras.id_proveedor= tc_mantic_proveedores.id_proveedor
        left join 
          tr_mantic_proveedor_tipo_contacto on tc_mantic_proveedores.id_proveedor = tc_mantic_proveedores.id_proveedor and tr_mantic_proveedor_tipo_contacto.id_tipo_contacto between 9 and 11
        where 
        tc_mantic_ordenes_compras.id_orden_compra= {idOrdenCompra}
      </select>
    </unit>	    			
    <unit id="VistaInformacionAlmacen">		
      <select id="telefonos">
        select group_concat(tr_mantic_almacen_tipo_contacto.valor separator ' , ') tels from 
          tc_mantic_ordenes_compras
        inner join 
          tc_mantic_almacenes on tc_mantic_ordenes_compras.id_almacen= tc_mantic_almacenes.id_almacen
        left join 
          tr_mantic_almacen_tipo_contacto on tc_mantic_almacenes.id_almacen = tr_mantic_almacen_tipo_contacto.id_almacen and tr_mantic_almacen_tipo_contacto.id_tipo_contacto between 1 and 8
        where 
          tc_mantic_ordenes_compras.id_orden_compra= {idOrdenCompra}
      </select>	
      <select id="emails">
        select group_concat(tr_mantic_almacen_tipo_contacto.valor separator ' , ') emails from 
          tc_mantic_ordenes_compras
        inner join 
          tc_mantic_almacenes on tc_mantic_ordenes_compras.id_almacen= tc_mantic_almacenes.id_almacen
        left join 
          tr_mantic_almacen_tipo_contacto on tc_mantic_almacenes.id_almacen = tr_mantic_almacen_tipo_contacto.id_almacen and tr_mantic_almacen_tipo_contacto.id_tipo_contacto between 9 and 11
        where 
          tc_mantic_ordenes_compras.id_orden_compra= {idOrdenCompra}
      </select>
    </unit>	    			
    <unit id="VistaInformacionEmpresas">	
      <select id="datosEmpresa">
        select
					tc_mantic_empresas.id_empresa,
          tc_mantic_empresas.clave,
          tc_mantic_empresas.nombre,
					domicilio_empresa.numero_interior,
					concat(domicilio_empresa.calle, case  when domicilio_empresa.numero_exterior is null then ' ' else concat(' # ',domicilio_empresa.numero_exterior) end, case  when domicilio_empresa.numero_interior is null then ' ' else concat(' INT. ',domicilio_empresa.numero_interior) end) as empresa_direccion,
          domicilio_empresa.codigo_postal,
					domicilio_empresa.asentamiento as colonia,
				  (select 
					  group_concat(tr_mantic_empresa_tipo_contacto.valor separator ' , ') tels 
					 from 
					   tc_mantic_empresas left join tr_mantic_empresa_tipo_contacto on tc_mantic_empresas.id_empresa = tr_mantic_empresa_tipo_contacto.id_empresa and tr_mantic_empresa_tipo_contacto.id_tipo_contacto between 1 and 8 
					 where 
        				tc_mantic_empresas.id_empresa) telefonos_empresa,
        	(select 
					  group_concat(tr_mantic_empresa_tipo_contacto.valor separator ' , ') emails 
					 from 
					   tc_mantic_empresas left join tr_mantic_empresa_tipo_contacto on tc_mantic_empresas.id_empresa = tr_mantic_empresa_tipo_contacto.id_empresa and tr_mantic_empresa_tipo_contacto.id_tipo_contacto between 9 and 11 
					 where 
        	tc_mantic_empresas.id_empresa) emails_empresa,
        	concat(responsable_empresa.nombres,' ' ,responsable_empresa.paterno,' ',responsable_empresa.materno) as responsable_empresa,
          responsable_empresa.rfc rfc_empresa,	 
          concat(replace(replace(upper(municipio_empresa.descripcion),char(10),' '),char(13),' '),', ' ,upper(entidad_empresa.descripcion),', ',upper(pais_empresa.descripcion)) as empresa_region,            
          (select 
					  group_concat(tr_mantic_persona_tipo_contacto.valor separator ' , ') emails 
					 from 
					   tc_mantic_personas left join tr_mantic_persona_tipo_contacto on tc_mantic_personas.id_persona  = tr_mantic_persona_tipo_contacto.id_persona and tr_mantic_persona_tipo_contacto.id_tipo_contacto between 9 and 11 
					 where 
        				tc_mantic_personas.id_persona= responsable_empresa.id_persona) emails_contacto,
          (select 
            group_concat(tr_mantic_persona_tipo_contacto.valor separator ' , ') tels 
          from 
            tc_mantic_personas left join tr_mantic_persona_tipo_contacto on tc_mantic_personas.id_persona  = tr_mantic_persona_tipo_contacto.id_persona and tr_mantic_persona_tipo_contacto.id_tipo_contacto between 1 and 8 
          where 
            tc_mantic_personas.id_persona= responsable_empresa.id_persona) telefonos_contacto
				from 
					tc_mantic_empresas 
				inner join 
					tr_mantic_empresa_domicilio  on tc_mantic_empresas.id_empresa= tr_mantic_empresa_domicilio.id_empresa
				inner join 
					tc_mantic_domicilios  domicilio_empresa on tr_mantic_empresa_domicilio.id_domicilio = domicilio_empresa.id_domicilio				
				inner join 
					tc_janal_localidades localidad_empresa on domicilio_empresa.id_localidad = localidad_empresa.id_localidad
				inner join
          tc_janal_municipios municipio_empresa on localidad_empresa.id_municipio = municipio_empresa.id_municipio
        inner join
					tc_janal_entidades  entidad_empresa on municipio_empresa.id_entidad = entidad_empresa.id_entidad
				inner join
					tc_janal_paises  pais_empresa on entidad_empresa.id_pais = pais_empresa.id_pais
				left join 
					tc_mantic_personas responsable_empresa on tc_mantic_empresas.id_responsable = responsable_empresa.id_persona
				left join 
					tr_mantic_persona_tipo_contacto telefono on responsable_empresa.id_persona = telefono.id_persona and telefono.id_tipo_contacto=1
				left join 
					tr_mantic_persona_tipo_contacto correo on telefono.id_persona = correo.id_persona and correo.id_tipo_contacto=9
				where
					tc_mantic_empresas.id_empresa in ({idEmpresa})
      </select>	
      <select id="datosAlmacen">
        select
					tc_mantic_almacenes.id_almacen,
        	tc_mantic_almacenes.clave,
					domicilio_almacen.numero_interior,
					concat(domicilio_almacen.calle, case  when domicilio_almacen.numero_exterior is null then ' ' else concat(' # ',domicilio_almacen.numero_exterior) end, case  when domicilio_almacen.numero_interior is null then ' ' else concat(' INT. ',domicilio_almacen.numero_interior) end) as almacen_direccion,	
          domicilio_almacen.codigo_postal,
					domicilio_almacen.asentamiento as colonia,
				  (select 
					  group_concat(tr_mantic_almacen_tipo_contacto.valor separator ' , ') tels 
					 from 
					   tc_mantic_almacenes left join tr_mantic_almacen_tipo_contacto on tc_mantic_almacenes.id_almacen = tr_mantic_almacen_tipo_contacto.id_almacen and tr_mantic_almacen_tipo_contacto.id_tipo_contacto between 1 and 8 
					 where 
        				tc_mantic_almacenes.id_almacen) telefonos_almacen,
        	(select 
					  group_concat(tr_mantic_almacen_tipo_contacto.valor separator ' , ') emails 
					 from 
					   tc_mantic_almacenes left join tr_mantic_almacen_tipo_contacto on tc_mantic_almacenes.id_almacen = tr_mantic_almacen_tipo_contacto.id_almacen and tr_mantic_almacen_tipo_contacto.id_tipo_contacto between 9 and 11 
					 where 
        	tc_mantic_almacenes.id_almacen) emails_almacen,
        	concat(responsable_almacen.nombres,' ' ,responsable_almacen.paterno,' ',responsable_almacen.materno) as responsable_almacen,
          responsable_almacen.rfc rfc_almacen,
	        concat(replace(replace(upper(municipio_almacen.descripcion),char(10),' '),char(13),' '),', ' ,upper(entidad_almacen.descripcion),', ',upper(pais_almacen.descripcion)) as almacen_region,
          (select 
					  group_concat(tr_mantic_persona_tipo_contacto.valor separator ' , ') emails 
					 from 
					   tc_mantic_personas left join tr_mantic_persona_tipo_contacto on tc_mantic_personas.id_persona  = tr_mantic_persona_tipo_contacto.id_persona and tr_mantic_persona_tipo_contacto.id_tipo_contacto between 9 and 11 
					 where 
        				tc_mantic_personas.id_persona= responsable_almacen.id_persona) emails_contacto,
          (select 
            group_concat(tr_mantic_persona_tipo_contacto.valor separator ' , ') tels 
          from 
            tc_mantic_personas left join tr_mantic_persona_tipo_contacto on tc_mantic_personas.id_persona  = tr_mantic_persona_tipo_contacto.id_persona and tr_mantic_persona_tipo_contacto.id_tipo_contacto between 1 and 8 
          where 
            tc_mantic_personas.id_persona= responsable_almacen.id_persona) telefonos_contacto
				from 
					tc_mantic_almacenes 
				inner join 
					tr_mantic_almacen_domicilio  on tc_mantic_almacenes.id_almacen= tr_mantic_almacen_domicilio.id_almacen
				inner join 
					tc_mantic_domicilios  domicilio_almacen on tr_mantic_almacen_domicilio.id_domicilio = domicilio_almacen.id_domicilio
				inner join 
					tc_janal_localidades localidad_almacen on domicilio_almacen.id_localidad = localidad_almacen.id_localidad
				inner join
          tc_janal_municipios municipio_almacen on localidad_almacen.id_municipio = municipio_almacen.id_municipio
        inner join
					tc_janal_entidades  entidad_almacen on municipio_almacen.id_entidad = entidad_almacen.id_entidad
				inner join
					tc_janal_paises  pais_almacen on entidad_almacen.id_pais = pais_almacen.id_pais
				left join 
					tc_mantic_personas responsable_almacen on tc_mantic_almacenes.id_responsable = responsable_almacen.id_persona
				left join 
					tr_mantic_persona_tipo_contacto telefono on responsable_almacen.id_persona = telefono.id_persona and telefono.id_tipo_contacto=1
				left join 
					tr_mantic_persona_tipo_contacto correo on telefono.id_persona = correo.id_persona and correo.id_tipo_contacto=9
				where
					tc_mantic_almacenes.id_almacen in ({idAlmacen})
      </select>
      <select id="datosProveedor">
        select
					tc_mantic_proveedores.id_proveedor,
          tc_mantic_proveedores.clave,
          tc_mantic_proveedores.rfc,
          tc_mantic_proveedores.razon_social,
					domicilio_proveedor.numero_interior,
					domicilio_proveedor.calle,
					concat(domicilio_proveedor.calle, case  when domicilio_proveedor.numero_exterior is null then ' ' else concat(' # ',domicilio_proveedor.numero_exterior) end, case  when domicilio_proveedor.numero_interior is null then ' ' else concat(' INT. ',domicilio_proveedor.numero_interior) end) as proveedor_direccion,
					domicilio_proveedor.codigo_postal,
					domicilio_proveedor.asentamiento as colonia,
          concat(replace(replace(upper(municipio_proveedor.descripcion),char(10),' '),char(13),' '),', ' ,upper(entidad_proveedor.descripcion),', ',upper(pais_proveedor.descripcion)) as proveedor_region,
          concat(agentes.nombres, ' ' ,  agentes.paterno, ' ',agentes.materno) as agente,
				  (select 
					  group_concat(tr_mantic_proveedor_tipo_contacto.valor separator ' , ') tels 
           from 
					   tc_mantic_proveedores left join tr_mantic_proveedor_tipo_contacto on tc_mantic_proveedores.id_proveedor = tr_mantic_proveedor_tipo_contacto.id_proveedor and tr_mantic_proveedor_tipo_contacto.id_tipo_contacto between 1 and 8 
					 where 
        				tc_mantic_proveedores.id_proveedor in ({idProveedor})) telefonos_proveedor,
        	(select 
					  group_concat(tr_mantic_proveedor_tipo_contacto.valor separator ' , ') emails 
          from 
            tc_mantic_proveedores left join tr_mantic_proveedor_tipo_contacto on tc_mantic_proveedores.id_proveedor = tr_mantic_proveedor_tipo_contacto.id_proveedor and tr_mantic_proveedor_tipo_contacto.id_tipo_contacto between 9 and 11 
          where 
            tc_mantic_proveedores.id_proveedor in ({idProveedor})) emails_proveedor
        from 
          tc_mantic_proveedores 
        inner join 
          tr_mantic_proveedor_domicilio  on tc_mantic_proveedores.id_proveedor= tr_mantic_proveedor_domicilio.id_proveedor
        inner join 
          tc_mantic_domicilios  domicilio_proveedor on tr_mantic_proveedor_domicilio.id_domicilio = domicilio_proveedor.id_domicilio
        inner join 
          tc_janal_localidades localidad_proveedor on domicilio_proveedor.id_localidad = localidad_proveedor.id_localidad
        inner join
          tc_janal_municipios municipio_proveedor on localidad_proveedor.id_municipio = municipio_proveedor.id_municipio
        inner join
          tc_janal_entidades  entidad_proveedor on municipio_proveedor.id_entidad = entidad_proveedor.id_entidad
        inner join
          tc_janal_paises  pais_proveedor on entidad_proveedor.id_pais = pais_proveedor.id_pais
        left join 
					tr_mantic_proveedor_agente on tc_mantic_proveedores.id_proveedor = tr_mantic_proveedor_agente.id_proveedor and tr_mantic_proveedor_agente.id_principal=1
				left join 
					tc_mantic_personas agentes on tr_mantic_proveedor_agente.id_agente= agentes.id_persona
        where
          tc_mantic_proveedores.id_proveedor in ({idProveedor})
      </select>
      <select id="telefonos">
        select group_concat(tr_mantic_empresa_tipo_contacto.valor separator ' , ') tels from 
          tc_mantic_ordenes_compras
        inner join 
          tc_mantic_empresas on tc_mantic_ordenes_compras.id_empresa= tc_mantic_empresas.id_empresa
        left join 
          tr_mantic_empresa_tipo_contacto on tc_mantic_empresas.id_empresa = tr_mantic_empresas_tipo_contacto.id_empresa and tr_mantic_empresas_tipo_contacto.id_tipo_contacto between 1 and 8
        where 
          tc_mantic_ordenes_compras.id_orden_compra= {idOrdenCompra}
      </select>	
      <select id="emails">
        select group_concat(tr_mantic_empresa_tipo_contacto.valor separator ' , ') emails from 
          tc_mantic_ordenes_compras
        inner join 
          tc_mantic_empresas on tc_mantic_ordenes_compras.id_empresa= tc_mantic_empresas.id_empresa
        left join 
          tr_mantic_empresa_tipo_contacto on tc_mantic_empresas.id_empresa = tr_mantic_empresas_tipo_contacto.id_empresa and tr_mantic_empresas_tipo_contacto.id_tipo_contacto between 9 and 11
        where 
          tc_mantic_ordenes_compras.id_orden_compra= {idOrdenCompra}
      </select>
      <select id="datosCliente">
        select
					tc_mantic_clientes.id_cliente,
        	tc_mantic_clientes.clave,
          tc_mantic_clientes.razon_social,
          tc_mantic_clientes.rfc,
					domicilio_cliente.numero_interior,
					concat(domicilio_cliente.calle, case  when domicilio_cliente.numero_exterior is null then ' ' else concat(' # ',domicilio_cliente.numero_exterior) end, case  when domicilio_cliente.numero_interior is null then ' ' else concat(' INT. ',domicilio_cliente.numero_interior) end) as cliente_direccion,	
          domicilio_cliente.codigo_postal,
					domicilio_cliente.asentamiento as colonia,
          concat(tc_mantic_regimenes_fiscales.codigo, ' - ', tc_mantic_regimenes_fiscales.nombre) as regimen_fiscal,        
				  (select 
					  group_concat(tr_mantic_cliente_tipo_contacto.valor separator ' , ') tels 
					 from 
					   tc_mantic_clientes left join tr_mantic_cliente_tipo_contacto on tc_mantic_clientes.id_cliente = tr_mantic_cliente_tipo_contacto.id_cliente and tr_mantic_cliente_tipo_contacto.id_tipo_contacto between 1 and 8 
					 where 
        				tc_mantic_clientes.id_cliente in ({idCliente})) telefonos_cliente,
        	(select 
					  group_concat(tr_mantic_cliente_tipo_contacto.valor separator ' , ') emails 
					 from 
					   tc_mantic_clientes left join tr_mantic_cliente_tipo_contacto on tc_mantic_clientes.id_cliente = tr_mantic_cliente_tipo_contacto.id_cliente and tr_mantic_cliente_tipo_contacto.id_tipo_contacto between 9 and 11 
					 where 
        	tc_mantic_clientes.id_cliente in ({idCliente})) emails_cliente,
        	concat(responsable_cliente.nombres,' ' ,responsable_cliente.paterno,' ',responsable_cliente.materno) as responsable_cliente,
          responsable_cliente.rfc rfc_cliente,
	        concat(replace(replace(upper(municipio_cliente.descripcion),char(10),' '),char(13),' '),', ' ,upper(entidad_cliente.descripcion),', ',upper(pais_cliente.descripcion)) as cliente_region,
          (select 
					  group_concat(tr_mantic_persona_tipo_contacto.valor separator ' , ') emails 
					 from 
					   tc_mantic_personas left join tr_mantic_persona_tipo_contacto on tc_mantic_personas.id_persona  = tr_mantic_persona_tipo_contacto.id_persona and tr_mantic_persona_tipo_contacto.id_tipo_contacto between 9 and 11 
					 where 
        				tc_mantic_personas.id_persona= responsable_cliente.id_persona) emails_contacto,
          (select 
            group_concat(tr_mantic_persona_tipo_contacto.valor separator ' , ') tels 
          from 
            tc_mantic_personas left join tr_mantic_persona_tipo_contacto on tc_mantic_personas.id_persona  = tr_mantic_persona_tipo_contacto.id_persona and tr_mantic_persona_tipo_contacto.id_tipo_contacto between 1 and 8 
          where 
            tc_mantic_personas.id_persona= responsable_cliente.id_persona) telefonos_contacto
				from 
					tc_mantic_clientes 
				inner join 
					tr_mantic_cliente_domicilio  on tc_mantic_clientes.id_cliente= tr_mantic_cliente_domicilio.id_cliente
				inner join 
					tc_mantic_domicilios  domicilio_cliente on tr_mantic_cliente_domicilio.id_domicilio = domicilio_cliente.id_domicilio
				inner join 
					tc_janal_localidades localidad_cliente on domicilio_cliente.id_localidad = localidad_cliente.id_localidad
				inner join
          tc_janal_municipios municipio_cliente on localidad_cliente.id_municipio = municipio_cliente.id_municipio
        inner join
					tc_janal_entidades  entidad_cliente on municipio_cliente.id_entidad = entidad_cliente.id_entidad
				inner join
					tc_janal_paises  pais_cliente on entidad_cliente.id_pais = pais_cliente.id_pais
				left join 
					tc_mantic_personas responsable_cliente on tc_mantic_clientes.id_cliente = responsable_cliente.id_persona
				left join 
					tr_mantic_persona_tipo_contacto telefono on responsable_cliente.id_persona = telefono.id_persona and telefono.id_tipo_contacto=1
				left join 
					tr_mantic_persona_tipo_contacto correo on telefono.id_persona = correo.id_persona and correo.id_tipo_contacto=9
				left join
          tc_mantic_regimenes_fiscales on tc_mantic_clientes.id_regimen_fiscal= tc_mantic_regimenes_fiscales.id_regimen_fiscal
        where
          tc_mantic_clientes.id_cliente in ({idCliente})
      </select>
    </unit>	    		
		<unit id="VistaTrabajosDto">
			<select id="row">
				select 
					tc_mantic_trabajos.id_trabajo as id_key,
					tc_mantic_trabajos.*
				from 
					tc_mantic_trabajos
				where 
					codigo like '%{codigo}%'
				and 
					nombre like '%{nombre}%'
				and 
					descripcion like '%{descripcion}%'
				and 
					id_empresa= {idEmpresa}
			</select>
		</unit>
		<unit id="VistaClientesRepresentantesDto">
			<select id="representantesCliente">
				select 
					tr_mantic_cliente_representante.id_cliente_representante as id_key,
					tr_mantic_cliente_representante.id_cliente,
					tr_mantic_cliente_representante.id_representante,
					tr_mantic_cliente_representante.id_principal,
					concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) as nombre_completo,
					tc_mantic_personas.rfc,
					tc_mantic_personas.curp,
					tr_mantic_cliente_representante.observaciones,
					tr_mantic_cliente_representante.registro
				from 	
					tr_mantic_cliente_representante
				inner join
					tc_mantic_personas on tr_mantic_cliente_representante.id_representante = tc_mantic_personas.id_persona
				where 
					tr_mantic_cliente_representante.id_cliente={idCliente}
			</select>
			<select id="todos">
				select 
					tc_janal_usuarios.id_usuario as id_key,
					tr_mantic_cliente_representante.id_cliente,
          tc_mantic_clientes.especial,
					tr_mantic_cliente_representante.id_representante,
					tr_mantic_cliente_representante.id_principal,
					concat(tc_mantic_personas.nombres, ' ', ifnull(tc_mantic_personas.paterno, ''), ' ', ifnull(tc_mantic_personas.materno, '')) as nombre_completo,
					tc_mantic_personas.rfc,
					tc_mantic_personas.curp,
					tr_mantic_cliente_representante.observaciones,
					tr_mantic_cliente_representante.registro
				from 	
					tr_mantic_cliente_representante
				inner join
					tc_mantic_personas on tr_mantic_cliente_representante.id_representante = tc_mantic_personas.id_persona
        inner join
          tc_mantic_clientes on tr_mantic_cliente_representante.id_cliente = tc_mantic_clientes.id_cliente
        inner join 
          tc_janal_usuarios on tc_mantic_personas.id_persona= tc_janal_usuarios.id_persona
        where
          tc_mantic_clientes.especial&gt; 0
				order by
         concat(tc_mantic_personas.nombres, ' ', ifnull(tc_mantic_personas.paterno, ''), ' ', ifnull(tc_mantic_personas.materno, ''))
			</select>
			<select id="cliente">
				select 
					tr_mantic_cliente_representante.id_cliente_representante as id_key,
					tc_janal_usuarios.id_usuario,
					tr_mantic_cliente_representante.id_cliente,
          tc_mantic_clientes.especial,
					tr_mantic_cliente_representante.id_representante,
					tr_mantic_cliente_representante.id_principal,
					concat(tc_mantic_personas.nombres, ' ', ifnull(tc_mantic_personas.paterno, ''), ' ', ifnull(tc_mantic_personas.materno, '')) as nombre_completo,
					tc_mantic_personas.rfc,
					tc_mantic_personas.curp,
					tr_mantic_cliente_representante.observaciones,
					tr_mantic_cliente_representante.registro
				from 	
					tr_mantic_cliente_representante
				inner join
					tc_mantic_personas on tr_mantic_cliente_representante.id_representante = tc_mantic_personas.id_persona
        inner join
          tc_mantic_clientes on tr_mantic_cliente_representante.id_cliente = tc_mantic_clientes.id_cliente
        inner join 
          tc_janal_usuarios on tc_mantic_personas.id_persona= tc_janal_usuarios.id_persona
				where 
					tc_janal_usuarios.id_usuario= {idUsuario}
			</select>
			<select id="importados">
				select
					tc_mantic_clientes_archivos.id_cliente_archivo as id_key,
					tc_mantic_clientes_archivos.id_cliente_representante,
			  	tc_mantic_clientes_archivos.id_tipo_archivo,
					tc_mantic_tipos_archivos.nombre as tipo,
					tc_mantic_clientes_archivos.nombre,
					tc_mantic_clientes_archivos.alias,
					tc_mantic_clientes_archivos.ruta,
					tc_mantic_clientes_archivos.id_principal,
					concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) as usuario,
					tc_mantic_clientes_archivos.observaciones,
					tc_mantic_clientes_archivos.registro
				from
					tc_mantic_clientes_archivos
				inner join
					tc_mantic_tipos_archivos on tc_mantic_clientes_archivos.id_tipo_archivo= tc_mantic_tipos_archivos.id_tipo_archivo
				inner join
					tr_mantic_cliente_representante on tc_mantic_clientes_archivos.id_cliente_representante = tr_mantic_cliente_representante.id_cliente_representante
				inner join
					tc_mantic_personas on tr_mantic_cliente_representante.id_representante = tc_mantic_personas.id_persona
				where
					tr_mantic_cliente_representante.id_cliente= {idCliente}
				order by
					tc_mantic_clientes_archivos.id_tipo_archivo, 
				  tc_mantic_clientes_archivos.registro desc				
			</select>
			<select id="exists">
        select      
          tc_mantic_clientes_archivos.*
        from      
          tc_mantic_clientes_archivos
				inner join
					tr_mantic_cliente_representante on tc_mantic_clientes_archivos.id_cliente_representante = tr_mantic_cliente_representante.id_cliente_representante
        where      
          tc_mantic_clientes_archivos.id_tipo_archivo = {idTipoArchivo} and tr_mantic_cliente_representante.id_cliente = {idCliente}
				order by
				  tc_mantic_clientes_archivos.registro desc
      </select>
		</unit>
    <unit id="VistaAlmacenesTransferenciasDto">
			<select id="porNombre">
				select 
				  tc_mantic_articulos.id_articulo as id_key,
				  tc_mantic_articulos.id_articulo,
				  (select tc_mantic_articulos_codigos.codigo from tc_mantic_articulos_codigos where tc_mantic_articulos_codigos.id_articulo= tc_mantic_articulos.id_articulo and tc_mantic_articulos_codigos.id_principal= 1 and (upper(tc_mantic_articulos.nombre) regexp '.*{codigo}.*' or tc_mantic_articulos.id_articulo= {idArticulo}) limit 0, 1) as propio,
				  (select tc_mantic_articulos_codigos.codigo from tc_mantic_articulos_codigos where tc_mantic_articulos_codigos.id_articulo= tc_mantic_articulos.id_articulo and tc_mantic_articulos_codigos.id_proveedor= {idProveedor} and (upper(tc_mantic_articulos.nombre) regexp '.*{codigo}.*' or tc_mantic_articulos.id_articulo= {idArticulo}) limit 0, 1) as codigo,
				  tc_mantic_articulos.fabricante,  
				  tc_mantic_articulos.nombre,
				  '   ' as origen,
				  tc_mantic_articulos.descripcion,
				  tc_mantic_articulos.precio,
				  tc_mantic_articulos.precio as original,
				  tc_mantic_articulos.menudeo,
				  tc_mantic_articulos.medio_mayoreo,
				  tc_mantic_articulos.mayoreo,
				  tc_mantic_articulos.sat,
				  tc_mantic_articulos.limite_medio_mayoreo,
				  tc_mantic_articulos.limite_mayoreo,
				  tc_mantic_articulos.iva,
				  tc_mantic_articulos.id_redondear,
				  tc_mantic_unidades_medidas.nombre unidad_medida,
          ifnull(tc_mantic_almacenes_articulos.stock, 0) as stock,
				  true as vacio
				from 
					tc_mantic_articulos
				inner join 
					tc_mantic_empresas on tc_mantic_articulos.id_empresa = tc_mantic_empresas.id_empresa
				inner join
					tr_mantic_empaque_unidad_medida on tc_mantic_articulos.id_empaque_unidad_medida = tr_mantic_empaque_unidad_medida.id_empaque_unidad_medida
				inner join 
					tc_mantic_empaques on tr_mantic_empaque_unidad_medida.id_empaque = tc_mantic_empaques.id_empaque
				inner join 
					tc_mantic_unidades_medidas on tr_mantic_empaque_unidad_medida.id_unidad_medida = tc_mantic_unidades_medidas.id_unidad_medida
        left join
          tc_mantic_almacenes_articulos on tc_mantic_articulos.id_articulo= tc_mantic_almacenes_articulos.id_articulo and tc_mantic_almacenes_articulos.id_almacen= {idAlmacen}
				where 
					tc_mantic_empresas.id_empresa in ({sucursales})
				  and tc_mantic_articulos.id_articulo_tipo= 1
				  and tc_mantic_articulos.id_vigente= 1
				  and (
				    upper(tc_mantic_articulos.nombre) regexp '.*{codigo}.*'
				  or
				    tc_mantic_articulos.id_articulo= {idArticulo}
				  ) 			
				order by 
				  tc_mantic_articulos.nombre				
			</select>
			<select id="porCodigo">
				select 
				  tc_mantic_articulos_codigos.id_articulo_codigo as id_key,
				  tc_mantic_articulos.id_articulo,
				  (select tc_mantic_articulos_codigos.codigo from tc_mantic_articulos_codigos where tc_mantic_articulos_codigos.id_articulo= tc_mantic_articulos.id_articulo and tc_mantic_articulos_codigos.id_principal= 1 limit 0, 1) as propio,
				  (select tc_mantic_articulos_codigos.codigo from tc_mantic_articulos_codigos where tc_mantic_articulos_codigos.id_articulo= tc_mantic_articulos.id_articulo and tc_mantic_articulos_codigos.id_proveedor= {idProveedor} and ((upper(tc_mantic_articulos_codigos.codigo) like '{codigo}%' and tc_mantic_articulos_codigos.id_proveedor = {idProveedor}) or tc_mantic_articulos.id_articulo= {idArticulo}) limit 0, 1) as codigo,
				  tc_mantic_articulos.fabricante,  
				  tc_mantic_articulos.nombre,
				  ' ' as origen,
				  tc_mantic_articulos.descripcion,
				  tc_mantic_articulos.precio,
				  tc_mantic_articulos.precio as original,
				  tc_mantic_articulos.menudeo,
				  tc_mantic_articulos.medio_mayoreo,
				  tc_mantic_articulos.mayoreo,
					tc_mantic_articulos.sat,
				  tc_mantic_articulos.limite_medio_mayoreo,
				  tc_mantic_articulos.limite_mayoreo,
				  tc_mantic_articulos.iva,
				  tc_mantic_articulos.id_redondear,
				  tc_mantic_unidades_medidas.nombre unidad_medida,
          ifnull(tc_mantic_almacenes_articulos.stock, 0) as stock,
				  true as vacio
				from 
					tc_mantic_articulos
				inner join
					tc_mantic_articulos_codigos on tc_mantic_articulos.id_articulo = tc_mantic_articulos_codigos.id_articulo
				inner join 
					tc_mantic_empresas on tc_mantic_articulos.id_empresa = tc_mantic_empresas.id_empresa
				inner join
					tr_mantic_empaque_unidad_medida on tc_mantic_articulos.id_empaque_unidad_medida = tr_mantic_empaque_unidad_medida.id_empaque_unidad_medida
				inner join 
					tc_mantic_empaques on tr_mantic_empaque_unidad_medida.id_empaque = tc_mantic_empaques.id_empaque
				inner join 
					tc_mantic_unidades_medidas on tr_mantic_empaque_unidad_medida.id_unidad_medida = tc_mantic_unidades_medidas.id_unidad_medida
        left join
          tc_mantic_almacenes_articulos on tc_mantic_articulos.id_articulo= tc_mantic_almacenes_articulos.id_articulo and tc_mantic_almacenes_articulos.id_almacen= {idAlmacen}
				where 
					tc_mantic_empresas.id_empresa in ({sucursales})
				  and tc_mantic_articulos.id_articulo_tipo= 1
				  and tc_mantic_articulos.id_vigente= 1
				  and (
				      (upper(tc_mantic_articulos_codigos.codigo) like '{codigo}%' and tc_mantic_articulos_codigos.id_proveedor is null)
				    or
				      (upper(tc_mantic_articulos_codigos.codigo) like '{codigo}%' and tc_mantic_articulos_codigos.id_proveedor = {idProveedor})
			      or	
				      tc_mantic_articulos.id_articulo= {idArticulo}
				   ) 			
				order by 
				  tc_mantic_articulos_codigos.codigo
			</select>  			
			<select id="transporto">
				select
					concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) as nombre
				from 
					tc_mantic_transferencias_bitacora
				inner join
					tc_mantic_personas on tc_mantic_transferencias_bitacora.id_transporto= tc_mantic_personas.id_persona
				where
					tc_mantic_transferencias_bitacora.id_transporto= {idTransporto}
				order by
					tc_mantic_transferencias_bitacora.registro desc				
			</select>		
			<select id="movimientos">
				select
					tc_mantic_transferencias_bitacora.id_transferencia_bitacora as id_key,
					tc_mantic_transferencias.consecutivo,
				  0 as importe,
				  tc_mantic_transferencias_bitacora.id_transporto,
					tc_mantic_transferencias_bitacora.justificacion,
					concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) as nombre,
				  tc_mantic_transferencias_estatus.nombre as estatus,
					tc_mantic_transferencias_bitacora.registro
				from 
					tc_mantic_transferencias_bitacora
				inner join
					tc_mantic_transferencias on tc_mantic_transferencias_bitacora.id_transferencia= tc_mantic_transferencias.id_transferencia
				inner join
					tc_mantic_transferencias_estatus on tc_mantic_transferencias_bitacora.id_transferencia_estatus= tc_mantic_transferencias_estatus.id_transferencia_estatus
				inner join
					tc_janal_usuarios on tc_mantic_transferencias_bitacora.id_usuario= tc_janal_usuarios.id_usuario
				inner join
					tc_mantic_personas on tc_janal_usuarios.id_persona= tc_mantic_personas.id_persona
				where
					tc_mantic_transferencias_bitacora.id_transferencia= {idTransferencia}
				order by
					tc_mantic_transferencias_bitacora.registro desc				
			</select>		
      <select id="lazy">
        select 
          tc_mantic_transferencias.id_transferencia as id_key,
          tc_mantic_transferencias.id_transferencia,
				  tc_mantic_transferencias.consecutivo,
          tc_mantic_transferencias.id_almacen,
          tc_mantic_transferencias.id_destino,
          origen.nombre as nombre_origen,
          origen.clave as clave_origen,
          destino.nombre nombre_destino,
          destino.clave clave_destino,
          tc_mantic_transferencias.id_solicito,
          concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) as solicito,
          tc_mantic_transferencias.id_usuario,
          tc_mantic_transferencias.registro,
          tc_mantic_transferencias.observaciones,
          tc_mantic_transferencias.id_transferencia_estatus estatus,
          tc_mantic_transferencias_estatus.nombre nombre_estatus,
          tc_mantic_transferencias_estatus.estatus_asociados,
				  tc_mantic_transferencias_tipos.id_transferencia_tipo,
				  tc_mantic_transferencias_tipos.nombre as tipo
        from
          tc_mantic_transferencias
        inner join
          tc_mantic_transferencias_estatus on tc_mantic_transferencias.id_transferencia_estatus = tc_mantic_transferencias_estatus.id_transferencia_estatus
        inner join 
					tc_mantic_empresas on tc_mantic_transferencias.id_empresa = tc_mantic_empresas.id_empresa
        left join 
          tc_mantic_personas on tc_mantic_transferencias.id_solicito = tc_mantic_personas.id_persona
        inner join 
        	tc_mantic_almacenes origen on tc_mantic_transferencias.id_almacen = origen.id_almacen
        inner join 
        	tc_mantic_almacenes destino on tc_mantic_transferencias.id_destino = destino.id_almacen
        inner join 
        	tc_mantic_transferencias_tipos on tc_mantic_transferencias.id_transferencia_tipo = tc_mantic_transferencias_tipos.id_transferencia_tipo
				where 
          tc_mantic_empresas.id_empresa in ({idEmpresa}) 
				  and {condicion}	
        {sortOrder}
      </select>   
      <select id="articulo">
				select 
				  tc_mantic_articulos.id_articulo as id_key,
				  tc_mantic_articulos.id_articulo,
				  (select tc_mantic_articulos_codigos.codigo from tc_mantic_articulos_codigos where tc_mantic_articulos_codigos.id_articulo= tc_mantic_articulos.id_articulo and tc_mantic_articulos_codigos.id_principal= 1 limit 0, 1) as propio,
          tc_mantic_articulos.nombre,
				  tc_mantic_articulos.precio,
				  tc_mantic_articulos.menudeo,
				  tc_mantic_articulos.medio_mayoreo,
				  tc_mantic_articulos.mayoreo,
				  tc_mantic_articulos.limite_medio_mayoreo,
				  tc_mantic_articulos.limite_mayoreo,
				  tc_mantic_articulos.iva,
          tc_mantic_almacenes_articulos.stock,
          tc_mantic_almacenes_articulos.minimo,
          tc_mantic_almacenes_articulos.maximo,
				  tc_mantic_articulos.id_redondear,
				  tc_mantic_imagenes.ruta,
				  tc_mantic_imagenes.archivo
				from 
					tc_mantic_articulos
        left join 
					tc_mantic_imagenes on tc_mantic_articulos.id_imagen = tc_mantic_imagenes.id_imagen
				inner join 
					tc_mantic_empresas on tc_mantic_articulos.id_empresa = tc_mantic_empresas.id_empresa
				inner join 
					tc_mantic_almacenes_articulos on tc_mantic_articulos.id_articulo = tc_mantic_almacenes_articulos.id_articulo 
				inner join 
				  tc_mantic_almacenes on tc_mantic_almacenes_articulos.id_almacen= tc_mantic_almacenes.id_almacen
				inner join 
				  tc_mantic_almacenes_ubicaciones on tc_mantic_almacenes_articulos.id_almacen_ubicacion= tc_mantic_almacenes_ubicaciones.id_almacen_ubicacion
				where 
					tc_mantic_empresas.id_empresa in ({sucursales})
				  and tc_mantic_articulos.id_articulo= {idArticulo}
          and tc_mantic_almacenes.id_almacen= {idDestino}  						   
        order by 
				  tc_mantic_articulos.id_articulo
			</select>
			<select id="solicito">
				select
					tc_mantic_personas.id_persona as id_key,
					tc_mantic_personas.id_persona,
					tc_mantic_personas.nombres,
					tc_mantic_personas.paterno,
					tc_mantic_personas.materno
				from
					tr_mantic_empresa_personal
				inner join
					tc_mantic_personas on tr_mantic_empresa_personal.id_persona= tc_mantic_personas.id_persona
				where
					tr_mantic_empresa_personal.id_empresa in ({sucursales})
					and tc_mantic_personas.id_tipo_persona in (2, 6)
          and tr_mantic_empresa_personal.id_activo= 1
				order by
					tc_mantic_personas.rfc			
			</select>
      <select id="detalle">
        select      
				  tc_mantic_transferencias_detalles.id_transferencia_detalle as id_comodin,
				  tc_mantic_transferencias_detalles.id_transferencia as id_orden_detalle,
          tc_mantic_transferencias_detalles.codigo as propio,
          tc_mantic_transferencias_detalles.*,
          ifnull(tc_mantic_transferencias_detalles.cantidad, 0) as solicitados,
          tc_mantic_transferencias_detalles.cantidad as cuantos,
          tc_mantic_transferencias_detalles.cantidad as inicial,
				  tc_mantic_articulos.precio as valor
        from      
          tc_mantic_transferencias_detalles
        inner join
          tc_mantic_articulos on tc_mantic_transferencias_detalles.id_articulo= tc_mantic_articulos.id_articulo
        where      
          tc_mantic_transferencias_detalles.id_transferencia= {idTransferencia}
				order by
				  tc_mantic_transferencias_detalles.caja, tc_mantic_transferencias_detalles.codigo
      </select>
			<select id="faltantes">
				select
					tc_mantic_articulos.id_articulo as id_key,
				  tc_mantic_almacenes.id_empresa,
					tc_mantic_articulos.id_articulo,
					tc_mantic_articulos_codigos.codigo as propio,
					tc_mantic_articulos.nombre,
					(select tc_mantic_articulos_codigos.codigo from tc_mantic_articulos_codigos where tc_mantic_articulos_codigos.id_articulo= tc_mantic_articulos.id_articulo and tc_mantic_articulos_codigos.id_proveedor= {idProveedor} limit 0, 1) as codigo,
					tc_mantic_articulos.iva,
					tc_mantic_articulos.precio as costo,
					tc_mantic_articulos.precio,
					tc_mantic_almacenes_articulos.maximo- if(tc_mantic_almacenes_articulos.stock&lt; 0, 0, tc_mantic_almacenes_articulos.stock) as cantidad,
					tc_mantic_inventarios.stock,
					tc_mantic_almacenes_articulos.minimo,
					tc_mantic_almacenes_articulos.maximo
				from
					tc_mantic_articulos
        inner join
          tc_mantic_almacenes_articulos on tc_mantic_articulos.id_articulo= tc_mantic_almacenes_articulos.id_articulo and tc_mantic_almacenes_articulos.id_almacen= {idAlmacen}
        inner join
          tc_mantic_inventarios on tc_mantic_almacenes_articulos.id_almacen= tc_mantic_inventarios.id_almacen and tc_mantic_almacenes_articulos.id_articulo= tc_mantic_inventarios.id_articulo and tc_mantic_inventarios.id_automatico= 2     
        inner join
          (select
              max(tc_mantic_inventarios.id_inventario) as id_inventario
            from
              tc_mantic_inventarios         
            group by
              id_almacen, id_articulo  
          ) as tc_mantic_maximos on tc_mantic_inventarios.id_inventario= tc_mantic_maximos.id_inventario        
				inner join
					tc_mantic_almacenes on tc_mantic_almacenes_articulos.id_almacen= tc_mantic_almacenes.id_almacen
				inner join
					tc_mantic_articulos_codigos on tc_mantic_articulos.id_articulo= tc_mantic_articulos_codigos.id_articulo
				where 
					tc_mantic_almacenes.id_empresa in ({sucursales})
					and tc_mantic_almacenes.id_almacen= {idAlmacen}
					and tc_mantic_inventarios.stock &lt;= tc_mantic_almacenes_articulos.minimo
					and tc_mantic_articulos_codigos.id_principal= 1
					and tc_mantic_articulos.id_vigente= 1
					and tc_mantic_articulos.id_descontinuado= 2
					and (tc_mantic_articulos.nombre regexp '.*{codigoFaltante}.*' or upper(tc_mantic_articulos_codigos.codigo) regexp '.*{codigoFaltante}.*')
				group by
					tc_mantic_almacenes.id_empresa,
					tc_mantic_articulos.id_articulo,
					tc_mantic_almacenes.id_almacen
				order by
					tc_mantic_articulos.nombre
			</select>		
      <select id="siguiente">
        select
					max(tc_mantic_confrontas.orden)+ 1 as siguiente
				from 
					tc_mantic_confrontas
				inner join
          tc_mantic_transferencias on tc_mantic_confrontas.id_transferencia = tc_mantic_transferencias.id_transferencia
				where
				  tc_mantic_confrontas.ejercicio= {ejercicio} 
				  and tc_mantic_transferencias.id_empresa= {idEmpresa}				
			</select>		
    </unit>
		<unit id="VistaRequisicionesDto">
			<select id="lazy">
        select
					tc_mantic_requisiciones.id_requisicion as id_key,
					tc_mantic_requisiciones.id_empresa,  
				  tc_mantic_empresas.clave as empresa,  
				  tc_mantic_empresas.nombre as nombre_empresa,  
					tc_mantic_requisiciones.consecutivo,  															
				  tc_mantic_requisiciones_estatus.nombre as estatus,
					tc_mantic_requisiciones.id_requisicion_estatus,
					tc_mantic_requisiciones.registro,
					tc_mantic_requisiciones.observaciones,
					tc_mantic_requisiciones.fecha_pedido,
					tc_mantic_requisiciones.fecha_entregada,
					tc_mantic_requisiciones_estatus.estatus_asociados, 					
					tc_mantic_personas.cuenta,
					concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) as nombre					          
				from 
					tc_mantic_requisiciones				
				inner join 
					tc_mantic_empresas on tc_mantic_requisiciones.id_empresa= tc_mantic_empresas.id_empresa
				inner join 
					tc_mantic_requisiciones_estatus on tc_mantic_requisiciones.id_requisicion_estatus=tc_mantic_requisiciones_estatus.id_requisicion_estatus				
				inner join				
					tc_mantic_personas on tc_mantic_personas.id_persona = tc_mantic_requisiciones.id_solicita
				where
					tc_mantic_requisiciones.id_empresa in ({idEmpresa})
					and {condicion}
				{sortOrder}
			</select>
		</unit>
		<unit id="VistaListasArchivosDto">
			<select id="lazy">
        select 
          tc_mantic_listas_precios.id_lista_precio as id_key,
          tc_mantic_listas_precios.id_lista_precio,
          tc_mantic_listas_precios.id_proveedor,
          tc_mantic_listas_precios.observaciones,
          tc_mantic_listas_precios.registro,
          if(tc_mantic_listas_precios.id_proveedor is null, tc_mantic_listas_precios.nombre, tc_mantic_proveedores.razon_social) as razon_social,
				  if(tc_mantic_listas_precios.id_proveedor is null, tc_mantic_listas_precios.nombre, tc_mantic_proveedores.clave) as clave,
          tc_mantic_proveedores.rfc,
          tc_mantic_proveedores.id_empresa
        from 
          tc_mantic_listas_precios 
        left join
          tc_mantic_proveedores on tc_mantic_listas_precios.id_proveedor= tc_mantic_proveedores.id_proveedor
        where
          tc_mantic_listas_precios.id_empresa in ({idEmpresa})
          and {condicion}
        {sortOrder}
			</select>
      <select id="importados">
				select
					tc_mantic_listas_precios_archivos.id_lista_precio_archivo as id_key,
					tc_mantic_listas_precios_archivos.id_lista_precio,
			  	tc_mantic_listas_precios_archivos.id_tipo_archivo,
					tc_mantic_tipos_archivos.nombre as tipo,
					tc_mantic_listas_precios_archivos.nombre,
					tc_mantic_listas_precios_archivos.alias,
					tc_mantic_listas_precios_archivos.ruta,
					tc_mantic_listas_precios_archivos.id_principal,
					concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) as usuario,
					tc_mantic_listas_precios_archivos.observaciones,
					tc_mantic_listas_precios_archivos.registro
				from
					tc_mantic_listas_precios
				inner join
					tc_mantic_listas_precios_archivos on tc_mantic_listas_precios.id_lista_precio= tc_mantic_listas_precios_archivos.id_lista_precio     
				inner join
					tc_mantic_tipos_archivos on tc_mantic_listas_precios_archivos.id_tipo_archivo= tc_mantic_tipos_archivos.id_tipo_archivo
				inner join
					tc_janal_usuarios on tc_mantic_listas_precios_archivos.id_usuario= tc_janal_usuarios.id_usuario          
				inner join
					tc_mantic_personas on tc_janal_usuarios.id_persona= tc_mantic_personas.id_persona
				where
					tc_mantic_listas_precios.id_empresa in ({sucursales})
			    and tc_mantic_listas_precios.id_proveedor= {idProveedor}
				order by
					tc_mantic_listas_precios_archivos.id_principal, tc_mantic_listas_precios_archivos.registro desc, tc_mantic_listas_precios_archivos.id_tipo_archivo asc				
			</select>
      <select id="lazyProveedores">
        select 
          tc_mantic_listas_precios.id_lista_precio as id_key,
          tc_mantic_listas_precios.id_lista_precio,
          tc_mantic_listas_precios.id_empresa,
          tc_mantic_listas_precios.id_proveedor,
          tc_mantic_listas_precios.observaciones,
          date_format(tc_mantic_listas_precios.registro,'%d/%m/%Y') registro,
          if(tc_mantic_listas_precios.id_proveedor is null, tc_mantic_listas_precios.nombre, tc_mantic_proveedores.razon_social) as razon_social,
          if(tc_mantic_listas_precios.id_proveedor is null, tc_mantic_listas_precios.nombre, tc_mantic_proveedores.clave) as clave,
          tc_mantic_proveedores.rfc,
          if(tc_mantic_listas_precios.id_proveedor is null, tc_mantic_listas_precios.logotipo, ifnull(tc_mantic_proveedores.logotipo, '{logo}')) as logotipo,
          tc_mantic_listas_precios_archivos.alias,
          tc_mantic_listas_precios_archivos.nombre,
          tc_mantic_listas_precios_archivos.ruta
        from 
          tc_mantic_listas_precios 
        inner join 
      		tc_mantic_listas_precios_archivos on tc_mantic_listas_precios.id_lista_precio = tc_mantic_listas_precios_archivos.id_lista_precio and tc_mantic_listas_precios_archivos.id_tipo_archivo= 2 and tc_mantic_listas_precios_archivos.id_principal= 1
        left join
          tc_mantic_proveedores on tc_mantic_listas_precios.id_proveedor= tc_mantic_proveedores.id_proveedor
        where
          tc_mantic_listas_precios.id_empresa in ({idEmpresa})
          and {condicion}
        {sortOrder}
			</select>
      <select id="porCatalogo">
        select 
          tc_mantic_listas_precios.id_lista_precio as id_key,
          tc_mantic_listas_precios.id_lista_precio,
          tc_mantic_listas_precios.id_empresa,
          tc_mantic_listas_precios.id_proveedor,
          tc_mantic_listas_precios.observaciones,
          tc_mantic_listas_precios.registro,
          if(tc_mantic_listas_precios.id_proveedor is null, tc_mantic_listas_precios.nombre, tc_mantic_proveedores.razon_social) as razon_social,
          if(tc_mantic_listas_precios.id_proveedor is null, tc_mantic_listas_precios.nombre, tc_mantic_proveedores.clave) as clave,
          tc_mantic_proveedores.rfc,
          if(tc_mantic_listas_precios.id_proveedor is null, tc_mantic_listas_precios.logotipo, ifnull(tc_mantic_proveedores.logotipo, '{logo}')) as logotipo,
          tc_mantic_listas_precios_archivos.alias,
          tc_mantic_listas_precios_archivos.nombre,
          tc_mantic_listas_precios_archivos.ruta
        from 
          tc_mantic_listas_precios 
        inner join 
      		tc_mantic_listas_precios_archivos on tc_mantic_listas_precios.id_lista_precio = tc_mantic_listas_precios_archivos.id_lista_precio and tc_mantic_listas_precios_archivos.id_tipo_archivo= 2 and tc_mantic_listas_precios_archivos.id_principal= 1
        left join
          tc_mantic_proveedores on tc_mantic_listas_precios.id_proveedor= tc_mantic_proveedores.id_proveedor
        where
          tc_mantic_listas_precios.id_empresa in ({idEmpresa})
          and (
				    upper(tc_mantic_listas_precios.nombre) regexp '.*{codigo}.*'
				   or
				    upper(tc_mantic_proveedores.clave) regexp '.*{codigo}.*'
				   or
				    upper(tc_mantic_proveedores.razon_social) regexp '.*{codigo}.*'
				 )
			</select>
      <select id="lazyArticulos">
				select 
				  tc_mantic_listas_precios_detalles.id_lista_precio_detalle as id_key,
				  tc_mantic_listas_precios_detalles.* ,
				  tc_mantic_proveedores.razon_social as proveedor         
				from 
					tc_mantic_listas_precios_detalles
				inner join 
      		tc_mantic_listas_precios on tc_mantic_listas_precios_detalles.id_lista_precio = tc_mantic_listas_precios.id_lista_precio 
				inner join
          tc_mantic_proveedores on tc_mantic_listas_precios.id_proveedor= tc_mantic_proveedores.id_proveedor
        where
					{condicion}			      
				{sortOrder}
			</select>
      <select id="proveedores">
				select 
				  distinct(tc_mantic_proveedores.id_proveedor) as id_key,
				  tc_mantic_proveedores.clave,
				  tc_mantic_proveedores.razon_social
				from 
					tc_mantic_listas_precios_detalles
				inner join 
      		tc_mantic_listas_precios on tc_mantic_listas_precios_detalles.id_lista_precio = tc_mantic_listas_precios.id_lista_precio 
				inner join
          tc_mantic_proveedores on tc_mantic_listas_precios.id_proveedor= tc_mantic_proveedores.id_proveedor
        where
					{condicion}			      
			</select>
			<select id="porNombre">
				select 
				  tc_mantic_listas_precios_detalles.id_lista_precio_detalle as id_key,
				  tc_mantic_listas_precios_detalles.id_lista_precio_detalle,
				  tc_mantic_listas_precios_detalles.codigo,
				  tc_mantic_listas_precios_detalles.auxiliar,
				  tc_mantic_listas_precios_detalles.descripcion,
				  tc_mantic_listas_precios_detalles.costo,
				  tc_mantic_listas_precios_detalles.precio,
				  tc_mantic_listas_precios_detalles.precio as original,
				  tc_mantic_listas_precios_detalles.registro
				from 
					tc_mantic_listas_precios
				inner join 
					tc_mantic_listas_precios_detalles on tc_mantic_listas_precios.id_lista_precio = tc_mantic_listas_precios_detalles.id_lista_precio
				where 
					tc_mantic_listas_precios.id_empresa in ({sucursales})
				  and upper(tc_mantic_listas_precios_detalles.descripcion) regexp '.*{codigo}.*'
				order by 
				  tc_mantic_listas_precios_detalles.descripcion				
			</select>
			<select id="porCodigo">
				select 
				  tc_mantic_listas_precios_detalles.id_lista_precio_detalle as id_key,
				  tc_mantic_listas_precios_detalles.id_lista_precio_detalle,
				  tc_mantic_listas_precios_detalles.codigo,
				  tc_mantic_listas_precios_detalles.auxiliar,
				  tc_mantic_listas_precios_detalles.descripcion,
				  tc_mantic_listas_precios_detalles.costo,
				  tc_mantic_listas_precios_detalles.costo as original,
				  tc_mantic_listas_precios_detalles.precio,
				  tc_mantic_listas_precios_detalles.registro
				from 
					tc_mantic_listas_precios
				inner join 
					tc_mantic_listas_precios_detalles on tc_mantic_listas_precios.id_lista_precio = tc_mantic_listas_precios_detalles.id_lista_precio
				where 
					tc_mantic_listas_precios.id_empresa in ({sucursales})
				  and ( upper(tc_mantic_listas_precios_detalles.codigo) like '{codigo}%' or upper(tc_mantic_listas_precios_detalles.auxiliar) like '{codigo}%')
				order by 
				  tc_mantic_listas_precios_detalles.descripcion	
			</select>			
		</unit>
		<unit id="VistaTcManticVentasDetallesDto">
			<select id="garantia">
        select
					tc_mantic_garantias.id_garantia as id_key,
					tc_mantic_garantias.id_garantia,
					tc_mantic_garantias.id_venta,
					tc_mantic_ventas.ticket,  
					tc_mantic_garantias.consecutivo,
					tc_mantic_garantias.impuestos,
					tc_mantic_garantias.sub_total,
					tc_mantic_garantias.total,
					tc_mantic_garantias.observaciones,
					concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) as nombre,
					tc_mantic_garantias_estatus.nombre as estatus,
					tc_mantic_garantias.registro
				from 
				  tc_mantic_garantias
				inner join 
					tc_mantic_ventas on tc_mantic_ventas.id_venta= tc_mantic_garantias.id_venta
				inner join 
				  tc_janal_usuarios on tc_mantic_garantias.id_usuario= tc_janal_usuarios.id_usuario
				inner join				
					tc_mantic_personas on tc_mantic_personas.id_persona= tc_janal_usuarios.id_persona				
				inner join				
					tc_mantic_garantias_estatus on tc_mantic_garantias.id_garantia_estatus = tc_mantic_garantias_estatus.id_garantia_estatus				
				where
					tc_mantic_garantias.id_venta= {idVenta}
        {sortOrder}
      </select>  
			<select id="garantiaDetalle">
        select
					tc_mantic_garantias_detalles.id_garantia_detalle as id_key,
					tc_mantic_ventas_detalles.codigo,
					tc_mantic_ventas_detalles.nombre,
					tc_mantic_garantias_detalles.cantidad,
					tc_mantic_garantias_detalles.impuestos,
					tc_mantic_garantias_detalles.sub_total,
					tc_mantic_garantias_detalles.importe,
					tc_mantic_garantias_detalles.registro
				from 
				  tc_mantic_garantias
				inner join 
					tc_mantic_garantias_detalles on tc_mantic_garantias.id_garantia = tc_mantic_garantias_detalles.id_garantia
				inner join 
					tc_mantic_ventas_detalles on tc_mantic_garantias_detalles.id_venta_detalle = tc_mantic_ventas_detalles.id_venta_detalle
				where
					tc_mantic_garantias.id_garantia= {idGarantia}
          and tc_mantic_garantias_detalles.cantidad &gt; 0
        {sortOrder}
      </select>  
			<select id="detalle">
				select
					tc_mantic_ventas_detalles.id_venta_detalle as id_key,
					tc_mantic_ventas_detalles.id_venta_detalle as id_comodin,
          tc_mantic_articulos.fabricante,
          tc_mantic_ventas_detalles.*,
          if(tc_mantic_ventas_detalles.factor= 1, 'menudeo', 'ESPECIAL') as descripcion_precio,
          tc_mantic_ventas_detalles.cantidad as cuantos,
          tc_mantic_ventas_detalles.cantidad as inicial,
					(select tc_mantic_articulos_codigos.codigo from tc_mantic_articulos_codigos where tc_mantic_articulos_codigos.id_articulo= tc_mantic_articulos.id_articulo and tc_mantic_articulos_codigos.id_principal= 1 limit 0, 1) as propio,
					tc_mantic_articulos.menudeo,
					if(tc_mantic_ventas_detalles.descuentos is not null and tc_mantic_ventas_detalles.descuentos &gt; 0, true, false) descuento_activo,
					false as viejos_precios,
          ifnull((select tc_mantic_inventarios.stock from tc_mantic_inventarios where tc_mantic_inventarios.id_almacen= {idAlmacen} and tc_mantic_inventarios.id_articulo= tc_mantic_ventas_detalles.id_articulo order by tc_mantic_inventarios.registro desc limit 0, 1), 0) as stock,
          ifnull((select tc_mantic_inventarios.id_automatico from tc_mantic_inventarios where tc_mantic_inventarios.id_almacen= {idAlmacen} and tc_mantic_inventarios.id_articulo= tc_mantic_ventas_detalles.id_articulo order by tc_mantic_inventarios.registro desc limit 0, 1), 1) as id_automatico
				from 
					tc_mantic_ventas_detalles 
				inner join
					tc_mantic_articulos on tc_mantic_ventas_detalles.id_articulo = tc_mantic_articulos.id_articulo
				inner join
					tc_mantic_ventas on tc_mantic_ventas_detalles.id_venta= tc_mantic_ventas.id_venta
				where  
					tc_mantic_ventas_detalles.id_venta = {idVenta}
				order by
					tc_mantic_ventas_detalles.registro
			</select>
			<select id="facturacion">
				select
					tc_mantic_ventas_detalles.id_venta_detalle as id_key,
					tc_mantic_ventas_detalles.id_venta_detalle as id_comodin,
          tc_mantic_articulos.fabricante,
          tc_mantic_ventas_detalles.*,
          if(tc_mantic_ventas_detalles.factor= 1, 'menudeo', 'ESPECIAL') as descripcion_precio,
          tc_mantic_ventas_detalles.cantidad as cuantos,
          tc_mantic_ventas_detalles.cantidad as inicial,
					(select tc_mantic_articulos_codigos.codigo from tc_mantic_articulos_codigos where tc_mantic_articulos_codigos.id_articulo= tc_mantic_articulos.id_articulo and tc_mantic_articulos_codigos.id_principal= 1 limit 0, 1) as propio,
					tc_mantic_ventas_detalles.costo as menudeo,
					if(tc_mantic_ventas_detalles.descuentos is not null and tc_mantic_ventas_detalles.descuentos &gt; 0, true, false) descuento_activo,
					true as viejos_precios,
          ifnull((select tc_mantic_inventarios.stock from tc_mantic_inventarios where tc_mantic_inventarios.id_almacen= {idAlmacen} and tc_mantic_inventarios.id_articulo= tc_mantic_ventas_detalles.id_articulo order by tc_mantic_inventarios.registro desc limit 0, 1), 0) as stock,
          ifnull((select tc_mantic_inventarios.id_automatico from tc_mantic_inventarios where tc_mantic_inventarios.id_almacen= {idAlmacen} and tc_mantic_inventarios.id_articulo= tc_mantic_ventas_detalles.id_articulo order by tc_mantic_inventarios.registro desc limit 0, 1), 1) as id_automatico
				from 
					tc_mantic_ventas_detalles 
				inner join
					tc_mantic_articulos on tc_mantic_ventas_detalles.id_articulo = tc_mantic_articulos.id_articulo
				where  
					tc_mantic_ventas_detalles.id_venta = {idVenta}
				order by
					tc_mantic_ventas_detalles.registro
			</select>
			<select id="detalleArticulo">
				select
					tc_mantic_articulos.id_articulo as id_key,
					tc_mantic_articulos.id_articulo,
					tc_mantic_articulos.id_empresa,
					tc_mantic_articulos.nombre,
					tc_mantic_articulos.descripcion,
					tc_mantic_articulos.id_empaque_unidad_medida,
					tc_mantic_articulos.cantidad,
					tc_mantic_articulos.id_redondear,
					tc_mantic_articulos.iva,
					tc_mantic_ventas_detalles.costo as menudeo,
					tc_mantic_articulos.medio_mayoreo,
					tc_mantic_articulos.limite_medio_mayoreo,
					tc_mantic_articulos.mayoreo,
					tc_mantic_articulos.limite_mayoreo,
					tc_mantic_articulos.meta_tag,
					tc_mantic_articulos.meta_tag_descipcion,
					tc_mantic_articulos.meta_tag_teclado,
					tc_mantic_articulos.id_imagen,
					tc_mantic_articulos.id_categoria,
					tc_mantic_articulos.precio,
					tc_mantic_articulos.descuentos,
					tc_mantic_articulos.peso_estimado,
					tc_mantic_articulos.extras,
					tc_mantic_articulos.fecha,
					tc_mantic_articulos.desperdicio,
					tc_mantic_articulos.minimo,
					tc_mantic_articulos.maximo,
					tc_mantic_articulos.stock,
					tc_mantic_articulos.sat,
					tc_mantic_articulos.id_vigente,
					tc_mantic_articulos.id_iva,
					tc_mantic_articulos.id_articulo_tipo,
					tc_mantic_articulos.id_barras,
					tc_mantic_articulos.descuento,
					tc_mantic_articulos.extra,
					tc_mantic_articulos.id_facturama,
					tc_mantic_articulos.id_usuario,
					tc_mantic_articulos.registro,
					tc_mantic_articulos.unidad,
					tc_mantic_articulos.codigo,
					tc_mantic_articulos.alterno,
					tc_mantic_articulos.actualizado
				from 
					tc_mantic_articulos 
				inner join
					tc_mantic_ventas_detalles on tc_mantic_ventas_detalles.id_articulo = tc_mantic_articulos.id_articulo
				where  
					tc_mantic_articulos.id_articulo= {idArticulo}
				  and tc_mantic_ventas_detalles.id_venta_detalle= {idComodin}
			</select>
		</unit>
		<unit id="VistaTcManticGarantiasArticulosDto">
			<select id="garantia">
				select      
				  tc_mantic_garantias.id_garantia as id_key,
					tc_mantic_garantias.*,
					tc_mantic_ventas.id_empresa
        from      
          tc_mantic_garantias
				inner join 
					tc_mantic_ventas on tc_mantic_garantias.id_venta = tc_mantic_ventas.id_venta
        where 
          id_garantia = {idGarantia} 
			</select>
			<select id="detalle">				
				select
					tc_mantic_ventas_detalles.id_venta_detalle as id_comodin,
          tc_mantic_ventas_detalles.id_venta_detalle,
          tc_mantic_ventas_detalles.id_venta,
          tc_mantic_ventas_detalles.id_articulo,
          tc_mantic_ventas_detalles.codigo,
          tc_mantic_ventas_detalles.sat,
          tc_mantic_ventas_detalles.nombre,          
          tc_mantic_ventas_detalles.precio,
          tc_mantic_ventas_detalles.costo,
          tc_mantic_ventas_detalles.descuento,
          tc_mantic_ventas_detalles.extras,
          tc_mantic_ventas_detalles.descuentos,
          tc_mantic_ventas_detalles.iva,
          tc_mantic_ventas_detalles.impuestos,
          tc_mantic_ventas_detalles.sub_total,
          tc_mantic_ventas_detalles.importe,
          tc_mantic_ventas_detalles.unidad_medida,
          tc_mantic_ventas_detalles.utilidad,
          tc_mantic_ventas_detalles.registro,
          0 as cantidad,
          (tc_mantic_ventas_detalles.cantidad - if(garantia_cantidad.cantidad is null, 0, garantia_cantidad.cantidad)) as cantidad_garantia,
					tr_mantic_articulo_proveedor.id_proveedor,
					(select tc_mantic_articulos_codigos.codigo from tc_mantic_articulos_codigos where tc_mantic_articulos_codigos.id_articulo= tc_mantic_articulos.id_articulo and tc_mantic_articulos_codigos.id_principal= 1 limit 0, 1) as propio
				from 
					tc_mantic_ventas_detalles 
				inner join
					tc_mantic_articulos on tc_mantic_ventas_detalles.id_articulo = tc_mantic_articulos.id_articulo
				left join 
					tr_mantic_articulo_proveedor on tc_mantic_articulos.id_articulo = tr_mantic_articulo_proveedor.id_articulo
				left join (
					select 
						tc_mantic_garantias_detalles.id_venta_detalle,
						sum(tc_mantic_garantias_detalles.cantidad) cantidad
					from 
						tc_mantic_garantias_detalles
					inner join 
				    tc_mantic_ventas_detalles on tc_mantic_garantias_detalles.id_venta_detalle = tc_mantic_ventas_detalles.id_venta_detalle
					where 
						tc_mantic_ventas_detalles.id_venta= {idVenta}
					group by 
						tc_mantic_garantias_detalles.id_venta_detalle
					) garantia_cantidad on tc_mantic_ventas_detalles.id_venta_detalle = garantia_cantidad.id_venta_detalle
				where  
					id_venta = {idVenta}
				order by
					tc_mantic_ventas_detalles.registro			
			</select>
			<select id="detalleCantidad">				
				select
					tc_mantic_ventas_detalles.id_venta_detalle as id_comodin,
          tc_mantic_ventas_detalles.id_venta_detalle,
          tc_mantic_ventas_detalles.id_venta,
          tc_mantic_ventas_detalles.id_articulo,
          tc_mantic_ventas_detalles.codigo,
          tc_mantic_ventas_detalles.sat,
          tc_mantic_ventas_detalles.nombre,          
          tc_mantic_ventas_detalles.precio,
          tc_mantic_ventas_detalles.costo,
          tc_mantic_ventas_detalles.descuento,
          tc_mantic_ventas_detalles.extras,
          tc_mantic_ventas_detalles.descuentos,
          tc_mantic_ventas_detalles.iva,
          tc_mantic_ventas_detalles.impuestos,
          tc_mantic_ventas_detalles.sub_total,
          tc_mantic_ventas_detalles.importe,
          tc_mantic_ventas_detalles.unidad_medida,
          tc_mantic_ventas_detalles.utilidad,
          tc_mantic_ventas_detalles.registro,
          (tc_mantic_ventas_detalles.cantidad - if(garantia_cantidad.cantidad is null, 0, garantia_cantidad.cantidad)) as cantidad,
          (tc_mantic_ventas_detalles.cantidad - if(garantia_cantidad.cantidad is null, 0, garantia_cantidad.cantidad)) as cantidad_garantia,
					tr_mantic_articulo_proveedor.id_proveedor,
					(select tc_mantic_articulos_codigos.codigo from tc_mantic_articulos_codigos where tc_mantic_articulos_codigos.id_articulo= tc_mantic_articulos.id_articulo and tc_mantic_articulos_codigos.id_principal= 1 limit 0, 1) as propio
				from 
					tc_mantic_ventas_detalles 
				inner join
					tc_mantic_articulos on tc_mantic_ventas_detalles.id_articulo = tc_mantic_articulos.id_articulo
				left join 
					tr_mantic_articulo_proveedor on tc_mantic_articulos.id_articulo = tr_mantic_articulo_proveedor.id_articulo
				left join (
					select 
						tc_mantic_garantias_detalles.id_venta_detalle,
						sum(tc_mantic_garantias_detalles.cantidad) cantidad
					from 
						tc_mantic_garantias_detalles
					inner join 
				    tc_mantic_ventas_detalles on tc_mantic_garantias_detalles.id_venta_detalle = tc_mantic_ventas_detalles.id_venta_detalle
					where 
						tc_mantic_ventas_detalles.id_venta= {idVenta}
					group by 
						tc_mantic_garantias_detalles.id_venta_detalle
					) garantia_cantidad on tc_mantic_ventas_detalles.id_venta_detalle = garantia_cantidad.id_venta_detalle
				where  
					id_venta = {idVenta}
				order by
					tc_mantic_ventas_detalles.registro			
			</select>
			<select id="detalleGarantia">
				select
					tc_mantic_garantias_detalles.id_garantia_detalle as id_comodin,
          tc_mantic_garantias_detalles.*,
					tc_mantic_ventas_detalles.sat,
					tc_mantic_ventas_detalles.nombre,
					tc_mantic_ventas_detalles.unidad_medida,
					tc_mantic_ventas_detalles.codigo,
					tc_mantic_ventas_detalles.precio,
					tc_mantic_ventas_detalles.costo,
          (tc_mantic_ventas_detalles.cantidad - if(tc_mantic_garantias_detalles.cantidad is null, 0, tc_mantic_garantias_detalles.cantidad)) as cantidad_garantia,					
					(select tc_mantic_articulos_codigos.codigo from tc_mantic_articulos_codigos where tc_mantic_articulos_codigos.id_articulo= tc_mantic_articulos.id_articulo and tc_mantic_articulos_codigos.id_principal= 1 limit 0, 1) as propio,
				  if(tc_mantic_garantias_detalles.id_reparacion is not null and tc_mantic_garantias_detalles.id_reparacion= 1, true, false) as aplicar 
				from 
					tc_mantic_garantias_detalles
				inner join 
					tc_mantic_ventas_detalles on tc_mantic_garantias_detalles.id_venta_detalle = tc_mantic_ventas_detalles.id_venta_detalle
				inner join
					tc_mantic_articulos on tc_mantic_ventas_detalles.id_articulo = tc_mantic_articulos.id_articulo
				left join 
					tr_mantic_articulo_proveedor on tc_mantic_articulos.id_articulo = tr_mantic_articulo_proveedor.id_articulo
				where  
					tc_mantic_garantias_detalles.id_garantia = {idGarantia}
				order by
					tc_mantic_garantias_detalles.registro
			</select>
		</unit>
		<unit id="VistaCotizacionesDto">
			<select id="lazy">
        select
					tc_mantic_ventas.id_venta as id_key,
					tc_mantic_ventas.id_empresa,
				  tc_mantic_empresas.clave as empresa,
				  tc_mantic_empresas.nombre as nombre_empresa,
					tc_mantic_ventas.consecutivo,
					tc_mantic_ventas.ticket,
					tc_mantic_ventas.total,
					tc_mantic_ventas.sub_total,
					tc_mantic_ventas.impuestos as iva,
					tc_mantic_ventas.total as precio_total,
				  tc_mantic_ventas_estatus.nombre as estatus,
					tc_mantic_ventas.id_venta_estatus,
					tc_mantic_ventas.registro,
					tc_mantic_ventas_estatus.estatus_asociados, 					
					tc_mantic_personas.cuenta,
					concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) as nombre,					
					tc_mantic_clientes.razon_social cliente,
					tc_mantic_clientes.id_cliente
				from 
					tc_mantic_ventas						
				left join 
					tc_mantic_ventas_detalles on tc_mantic_ventas.id_venta = tc_mantic_ventas_detalles.id_venta
				inner join 
					tc_mantic_empresas on tc_mantic_ventas.id_empresa= tc_mantic_empresas.id_empresa
				inner join 
					tc_mantic_ventas_estatus on tc_mantic_ventas.id_venta_estatus=tc_mantic_ventas_estatus.id_venta_estatus
				inner join 
				  tc_janal_usuarios on tc_mantic_ventas.id_usuario = tc_janal_usuarios.id_usuario
				inner join				
					tc_mantic_personas on tc_mantic_personas.id_persona = tc_janal_usuarios.id_persona							
				inner join 
					tc_mantic_clientes on tc_mantic_ventas.id_cliente= tc_mantic_clientes.id_cliente
				where
					tc_mantic_ventas.id_empresa in ({idEmpresa})
				  and tc_mantic_ventas.id_tipo_documento= 3
					and {condicion}
				group by 
					tc_mantic_ventas.id_venta,
					tc_mantic_ventas.id_empresa,  
				  tc_mantic_empresas.clave ,  
				  tc_mantic_empresas.nombre,  
					tc_mantic_ventas.consecutivo,  													
					tc_mantic_ventas.total,	
					tc_mantic_ventas.sub_total,
					tc_mantic_ventas.impuestos,				
				  tc_mantic_ventas_estatus.nombre,
					tc_mantic_ventas.id_venta_estatus,
					tc_mantic_ventas.registro,
					tc_mantic_ventas_estatus.estatus_asociados, 					
					tc_mantic_personas.cuenta,
					concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno),					
					tc_mantic_clientes.razon_social,
					tc_mantic_clientes.id_cliente 
				{sortOrder}
			</select>
		</unit>
		<unit id="VistaFicticiasDto">
			<select id="factura">
				select      
					tc_mantic_facturas.id_factura as id_key,
          tc_mantic_facturas.*
        from      
          tc_mantic_facturas
				inner join 
				  tc_mantic_ventas on tc_mantic_facturas.id_factura= tc_mantic_ventas.id_factura
        where      
          tc_mantic_ventas.id_venta = {idVenta}
			</select>
			<select id="movimientos">
				select
					tc_mantic_ventas_bitacora.id_venta_bitacora as id_key,
					tc_mantic_ventas_bitacora.consecutivo,
					tc_mantic_ventas_bitacora.importe,
					tc_mantic_ventas_bitacora.justificacion,
					concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) as nombre,
				  tc_mantic_ventas_estatus.nombre as estatus,
					tc_mantic_ventas_bitacora.registro
				from 
					tc_mantic_ventas_bitacora
				inner join
					tc_mantic_ventas_estatus on tc_mantic_ventas_bitacora.id_venta_estatus= tc_mantic_ventas_estatus.id_venta_estatus
				inner join
					tc_janal_usuarios on tc_mantic_ventas_bitacora.id_usuario= tc_janal_usuarios.id_usuario
				inner join
					tc_mantic_personas on tc_janal_usuarios.id_persona= tc_mantic_personas.id_persona
				where
					tc_mantic_ventas_bitacora.id_venta= {idFicticia}
				order by
					tc_mantic_ventas_bitacora.registro desc				
			</select>	
			<select id="concentrado">
 				select 
					ifnull(sum(tc_mantic_garantias.total), 0) as cantidad
				from 
					tc_mantic_garantias
				where 
					tc_mantic_garantias.id_venta= {idVenta}
					and tc_mantic_garantias.id_garantia_estatus in (3,4,6)
			</select>
			<select id="devoluciones">
				select 
					ifnull(sum(tc_mantic_garantias_detalles.cantidad), 0) as cantidad
				from 
					tc_mantic_garantias_detalles
				inner join 
					tc_mantic_ventas_detalles on tc_mantic_garantias_detalles.id_venta_detalle = tc_mantic_ventas_detalles.id_venta_detalle
				inner join  
					tc_mantic_garantias on tc_mantic_garantias_detalles.id_garantia= tc_mantic_garantias.id_garantia
				where 
					tc_mantic_garantias_detalles.id_venta_detalle= {idVentaDetalle}
					and tc_mantic_garantias.id_garantia_estatus in (3,4,6)
			</select>
			<select id="masivo">
				select
					tc_mantic_ventas_detalles.id_venta_detalle as id_key,
					tc_mantic_ventas_detalles.id_venta_detalle as id_comodin,
          tc_mantic_ventas_detalles.*,
				  tc_mantic_ventas_detalles.importe as total,
          tc_mantic_ventas_detalles.cantidad as cuantos,
          tc_mantic_ventas_detalles.cantidad as inicial,
					(select tc_mantic_articulos_codigos.codigo from tc_mantic_articulos_codigos where tc_mantic_articulos_codigos.id_articulo= tc_mantic_articulos.id_articulo and tc_mantic_articulos_codigos.id_principal= 1 limit 0, 1) as propio,
				  true as costo_libre
				from 
					tc_mantic_ventas_detalles 
				inner join
					tc_mantic_articulos on tc_mantic_ventas_detalles.id_articulo= tc_mantic_articulos.id_articulo
				where  
					id_venta in ({idVenta})
				order by
					tc_mantic_ventas_detalles.id_articulo, tc_mantic_ventas_detalles.cantidad
			</select>
			<select id="importados">
				select
					tc_mantic_facturas_archivos.id_factura as id_key,
					tc_mantic_facturas_archivos.id_factura,
			  	tc_mantic_facturas_archivos.id_tipo_archivo,
					tc_mantic_tipos_archivos.nombre as tipo,
					tc_mantic_facturas_archivos.nombre,
					tc_mantic_facturas_archivos.alias,
					tc_mantic_facturas_archivos.ruta,
					tc_mantic_facturas_archivos.id_principal,
					concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) as usuario,
					tc_mantic_facturas_archivos.observaciones,
					tc_mantic_facturas_archivos.registro
				from
					tc_mantic_facturas_archivos
				inner join
					tc_mantic_tipos_archivos on tc_mantic_facturas_archivos.id_tipo_archivo= tc_mantic_tipos_archivos.id_tipo_archivo
				inner join
					tc_janal_usuarios on tc_mantic_facturas_archivos.id_usuario= tc_janal_usuarios.id_usuario          
				inner join
					tc_mantic_personas on tc_janal_usuarios.id_persona= tc_mantic_personas.id_persona
				where
					tc_mantic_facturas_archivos.id_factura= {idFactura}
				order by
					tc_mantic_facturas_archivos.id_tipo_archivo, tc_mantic_facturas_archivos.registro desc				
			</select>			
			<select id="descargas">
				select
					tc_mantic_facturas_archivos.id_factura as id_key,
					tc_mantic_facturas_archivos.id_factura,
					tc_mantic_facturas_archivos.id_tipo_archivo,
					tc_mantic_facturas_archivos.nombre,
					tc_mantic_facturas_archivos.alias,
					tc_mantic_facturas_archivos.ruta,
					tc_mantic_facturas_archivos.id_principal
				from
					tc_mantic_ventas
				inner join 
					tc_mantic_clientes on tc_mantic_ventas.id_cliente= tc_mantic_clientes.id_cliente
				inner join 
					tc_mantic_facturas_archivos on tc_mantic_facturas_archivos.id_factura= tc_mantic_ventas.id_factura
				where
					tc_mantic_ventas.ticket= '{folio}'
					and tc_mantic_clientes.rfc= '{rfc}'
					and tc_mantic_facturas_archivos.id_tipo_archivo= {idTipoArchivo}
					and tc_mantic_facturas_archivos.id_principal= 1				
				order by
				  tc_mantic_facturas_archivos.registro desc
			</select>
			<select id="lazy">
        select
					tc_mantic_ventas.id_venta as id_key,
					tc_mantic_ventas.id_empresa,
				  tc_mantic_empresas.clave as empresa,
				  tc_mantic_empresas.nombre as nombre_empresa,
					tc_mantic_ventas.consecutivo,
					tc_mantic_ventas.ticket,
					tc_mantic_ventas.total,
					tc_mantic_ventas.sub_total,
					tc_mantic_ventas.impuestos as iva,
					tc_mantic_ventas.total as precio_total,
				  tc_mantic_ventas_estatus.nombre as estatus,
					tc_mantic_ventas.id_venta_estatus,
					tc_mantic_ventas.registro,
					tc_mantic_ventas_estatus.estatus_asociados, 					
					tc_mantic_personas.cuenta,
					concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) as nombre,
					tc_mantic_facturas.id_factura,
					tc_mantic_facturas.id_facturama,
					tc_mantic_facturas.sello_sat,
					tc_mantic_facturas.timbrado,
					tc_mantic_facturas.cancelada,
					tc_mantic_facturas.folio,
					tc_mantic_clientes.razon_social cliente,
					tc_mantic_clientes.id_cliente
				from 
					tc_mantic_ventas						
				left join 
					tc_mantic_ventas_detalles on tc_mantic_ventas.id_venta = tc_mantic_ventas_detalles.id_venta
				inner join 
					tc_mantic_empresas on tc_mantic_ventas.id_empresa= tc_mantic_empresas.id_empresa
				inner join 
					tc_mantic_ventas_estatus on tc_mantic_ventas.id_venta_estatus=tc_mantic_ventas_estatus.id_venta_estatus
				inner join 
				  tc_janal_usuarios on tc_mantic_ventas.id_usuario = tc_janal_usuarios.id_usuario
				inner join				
					tc_mantic_personas on tc_mantic_personas.id_persona = tc_janal_usuarios.id_persona			
				inner join 
					tc_mantic_facturas on tc_mantic_ventas.id_factura = tc_mantic_facturas.id_factura
				inner join 
					tc_mantic_clientes on tc_mantic_ventas.id_cliente= tc_mantic_clientes.id_cliente
				where
					tc_mantic_ventas.id_empresa in ({idEmpresa})
				  and tc_mantic_ventas.id_tipo_documento= 1
					and {condicion}
				group by 
					tc_mantic_ventas.id_venta,
					tc_mantic_ventas.id_empresa,  
				  tc_mantic_empresas.clave ,  
				  tc_mantic_empresas.nombre,  
					tc_mantic_ventas.consecutivo,  													
					tc_mantic_ventas.total,	
					tc_mantic_ventas.sub_total,
					tc_mantic_ventas.impuestos,				
				  tc_mantic_ventas_estatus.nombre,
					tc_mantic_ventas.id_venta_estatus,
					tc_mantic_ventas.registro,
					tc_mantic_ventas_estatus.estatus_asociados, 					
					tc_mantic_personas.cuenta,
					concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno),
					tc_mantic_facturas.timbrado,
					tc_mantic_facturas.folio,
					tc_mantic_clientes.razon_social,
					tc_mantic_clientes.id_cliente 
				{sortOrder}
			</select>
			<select id="detalle">
				select
					tc_mantic_ventas_detalles.id_venta_detalle as id_key,
					tc_mantic_ventas_detalles.id_venta_detalle as id_comodin,
          tc_mantic_ventas_detalles.*,
          tc_mantic_ventas_detalles.cantidad as cuantos,
          tc_mantic_ventas_detalles.cantidad as inicial,
					(select tc_mantic_articulos_codigos.codigo from tc_mantic_articulos_codigos where tc_mantic_articulos_codigos.id_articulo= tc_mantic_articulos.id_articulo and tc_mantic_articulos_codigos.id_principal= 1 limit 0, 1) as propio,
				  true as costo_libre
				from 
					tc_mantic_ventas_detalles 
				inner join
					tc_mantic_articulos on tc_mantic_ventas_detalles.id_articulo = tc_mantic_articulos.id_articulo
				where  
					id_venta = {idVenta}
				order by
					tc_mantic_ventas_detalles.registro
			</select>
			<select id="ficticia">				
        select      
				  tc_mantic_ventas.id_venta as id_key,
					tc_mantic_ventas.id_venta as id_ficticia, 
				  tc_mantic_ventas.*
        from      
          tc_mantic_ventas				
        where 
          tc_mantic_ventas.id_venta = {idFicticia} 
			</select>
		</unit>		
    <unit id="VistaApartadosDto">
      <select id="porCodigo">
        select      
					distinct(tc_mantic_clientes.id_cliente) as id_key,
          tc_mantic_clientes.*
          tc_mantic_apartados
        from      
          tc_mantic_apartados
        inner join
          tc_mantic_ventas on tc_mantic_apartados.id_venta= tc_mantic_ventas.id_venta
        inner join
          tc_mantic_clientes on tc_mantic_ventas.id_cliente= tc_mantic_clientes.id_cliente
        where 
          tc_mantic_clientes.id_empresa in ({sucursales})
          and 
            (upper(tc_mantic_clientes.clave) regexp '.*{codigo}.*'
             or
             upper(concat(tc_mantic_apartados.nombre, ' ', tc_mantic_apartados.paterno, ' ', tc_mantic_apartados.materno)) regexp '.*{codigo}.*')
				order by
				  tc_mantic_clientes.clave
      </select>
      <select id="porNombre">
        select      
					distinct(tc_mantic_clientes.id_cliente) as id_key,
          tc_mantic_clientes.*
        from      
          tc_mantic_apartados
        inner join
          tc_mantic_ventas on tc_mantic_apartados.id_venta= tc_mantic_ventas.id_venta
        inner join
          tc_mantic_clientes on tc_mantic_ventas.id_cliente= tc_mantic_clientes.id_cliente
        where 
          tc_mantic_clientes.id_empresa in ({sucursales})
          and (
				    upper(tc_mantic_clientes.razon_social) regexp '.*{codigo}.*'
				    or
				    upper(tc_mantic_clientes.rfc) regexp '.*{codigo}.*'
            or 
            upper(concat(tc_mantic_apartados.nombre, ' ', tc_mantic_apartados.paterno, ' ', tc_mantic_apartados.materno)) regexp '.*{codigo}.*'
				  )
				order by
				  tc_mantic_clientes.clave
      </select>      
      <select id="apartados">
        select 
					apartados.*,
					concat(nombre, ' ', paterno, ' ', materno) as cliente
				from(
          select
            tc_mantic_apartados.id_apartado as id_key,
            tc_mantic_apartados.consecutivo,
				    tc_mantic_empresas.clave as empresa,  
				    tc_mantic_empresas.nombre as nombre_empresa,  
				    tc_mantic_apartados.importe,
            tc_mantic_apartados.saldo,
            tc_mantic_ventas.id_empresa,
            tc_mantic_ventas.id_cliente,
            tc_mantic_apartados.vencimiento,
						if(tc_mantic_apartados.nombre is null, ' ' , tc_mantic_apartados.nombre) nombre,
						if(tc_mantic_apartados.paterno is null, ' ' , tc_mantic_apartados.paterno) paterno,
						if(tc_mantic_apartados.materno is null, ' ' , tc_mantic_apartados.materno) materno,	
        		ifnull(tc_mantic_apartados.telefono, ' ') as telefono,		
            ifnull(tc_mantic_apartados.celular, ' ') as celular,		
            ifnull(tc_mantic_apartados.domicilio, ' ') as domicilio,		
            concat(ifnull(tc_mantic_apartados.observaciones, ' '), ' ', tc_mantic_ventas.observaciones) as observaciones,		
            tc_mantic_clientes.rfc,
            tc_mantic_clientes.razon_social,
            concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) as persona,
            tc_mantic_apartados.abonado,
            tc_mantic_apartados.registro,
            datediff(now(),tc_mantic_apartados.registro) as dias,
            tc_mantic_apartados.id_apartado_estatus,
            tc_mantic_ventas.id_venta,
            tc_mantic_ventas.id_venta_estatus,
            tc_mantic_apartados_estatus.nombre estatus,
            tc_mantic_ventas.total,
            tc_mantic_ventas.ticket,
            tc_mantic_ventas.cticket
          from
            tc_mantic_apartados
          inner join
            tc_mantic_apartados_estatus on tc_mantic_apartados.id_apartado_estatus = tc_mantic_apartados_estatus.id_apartado_estatus
          inner join
            tc_mantic_ventas on tc_mantic_apartados.id_venta= tc_mantic_ventas.id_venta
          inner join
            tc_mantic_clientes on tc_mantic_ventas.id_cliente= tc_mantic_clientes.id_cliente
          inner join
            tc_janal_usuarios on tc_mantic_apartados.id_usuario= tc_janal_usuarios.id_usuario
          inner join
				    tc_mantic_empresas on tc_mantic_ventas.id_empresa= tc_mantic_empresas.id_empresa
          inner join
            tc_mantic_personas on tc_janal_usuarios.id_persona= tc_mantic_personas.id_persona) apartados
				where
				  id_empresa in ({idEmpresa})
					and {condicion}				
				{sortOrder}  
      </select>  
      <select id="apartado">
        select * from (select
					tc_mantic_apartados.id_apartado as id_key,
					tc_mantic_ventas.id_cliente,
					tc_mantic_ventas.ticket as consecutivo,
					tc_mantic_apartados.importe,
					tc_mantic_apartados.saldo,
          tc_mantic_apartados.vencimiento,
					concat(tc_mantic_apartados.nombre, ' ', ifnull(tc_mantic_apartados.paterno, ''), ' ', ifnull(tc_mantic_apartados.materno, '')) as cliente,
					concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) as persona,
					tc_mantic_apartados.abonado,
					tc_mantic_apartados.registro,
					datediff(now(),tc_mantic_apartados.registro) as dias,
					tc_mantic_apartados.id_apartado_estatus,
					tc_mantic_ventas.id_venta,
          tc_mantic_ventas.id_venta_estatus,
        tc_mantic_apartados_estatus.nombre estatus
        from
          tc_mantic_apartados
        inner join
          tc_mantic_apartados_estatus on tc_mantic_apartados.id_apartado_estatus = tc_mantic_apartados_estatus.id_apartado_estatus
				inner join
					tc_mantic_ventas on tc_mantic_apartados.id_venta= tc_mantic_ventas.id_venta
				inner join
					tc_janal_usuarios on tc_mantic_apartados.id_usuario= tc_janal_usuarios.id_usuario
				inner join
					tc_mantic_personas on tc_janal_usuarios.id_persona= tc_mantic_personas.id_persona
				where 
          tc_mantic_apartados.id_apartado = {idApartado} ) apartados 
				{sortOrder}
      </select>   
      <select id="pagosApartado">
        select
					tc_mantic_apartados_pagos.id_apartado_pago as id_key,
					tc_mantic_ventas.consecutivo,
					tc_mantic_ventas.id_cliente,
					tc_mantic_apartados.importe,
					tc_mantic_apartados.saldo,
          tc_mantic_apartados.abonado total_final,
          tc_mantic_apartados.registro registro_apartado,
					tc_mantic_apartados.abonado,
          tc_mantic_apartados.vencimiento,
					tc_mantic_apartados_pagos.pago,
					concat(tc_mantic_apartados.nombre, ' ', tc_mantic_apartados.paterno, ' ', tc_mantic_apartados.materno) as cliente,
					concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) as persona,
					tc_mantic_apartados_pagos.registro,
					tc_mantic_apartados_pagos.observaciones,
					tc_mantic_tipos_medios_pagos.nombre as tipo_pago,
          tc_mantic_apartados.observaciones as apartado_obs
				from
					tc_mantic_apartados_pagos
				inner join
					tc_mantic_apartados on tc_mantic_apartados_pagos.id_apartado= tc_mantic_apartados.id_apartado
				inner join
					tc_mantic_ventas on tc_mantic_apartados.id_venta= tc_mantic_ventas.id_venta
				inner join
					tc_janal_usuarios on tc_mantic_apartados_pagos.id_usuario= tc_janal_usuarios.id_usuario
				inner join
					tc_mantic_personas on tc_janal_usuarios.id_persona= tc_mantic_personas.id_persona
				inner join 
					tc_mantic_tipos_medios_pagos on tc_mantic_apartados_pagos.id_tipo_medio_pago = tc_mantic_tipos_medios_pagos.id_tipo_medio_pago
				where
					tc_mantic_apartados.id_apartado= {idApartado}									
				order by
					tc_mantic_ventas.consecutivo, 
					tc_mantic_apartados.registro desc
      </select> 
      <select id="abonos"> 
        select
					tc_mantic_apartados_pagos.id_apartado_pago as id_key,
          tc_mantic_apartados.abonado total_abonado,
					tc_mantic_apartados.abonado,
					tc_mantic_apartados_pagos.pago as importe,
					concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) as persona,
					tc_mantic_apartados_pagos.registro,
					tc_mantic_tipos_medios_pagos.nombre as medio,
          ifnull(tc_mantic_apartados_pagos.referencia, ' ') as referencia,
					tc_mantic_apartados_pagos.id_tipo_medio_pago
				from
					tc_mantic_apartados_pagos
				inner join
					tc_mantic_apartados on tc_mantic_apartados_pagos.id_apartado= tc_mantic_apartados.id_apartado
				inner join
					tc_mantic_ventas on tc_mantic_apartados.id_venta= tc_mantic_ventas.id_venta
				inner join
					tc_janal_usuarios on tc_mantic_apartados_pagos.id_usuario= tc_janal_usuarios.id_usuario
				inner join
					tc_mantic_personas on tc_janal_usuarios.id_persona= tc_mantic_personas.id_persona
				inner join 
					tc_mantic_tipos_medios_pagos on tc_mantic_apartados_pagos.id_tipo_medio_pago = tc_mantic_tipos_medios_pagos.id_tipo_medio_pago
				where
					tc_mantic_apartados.id_venta= {idVenta}
				order by
					tc_mantic_apartados_pagos.registro desc        
      </select> 
    </unit>
		<unit id="VistaGarantiasDto">
			<select id="lazy">
        select
					tc_mantic_garantias.id_garantia as id_key,
					tc_mantic_ventas.id_venta,
					tc_mantic_ventas.id_empresa,  
				  tc_mantic_empresas.clave as empresa,  
				  tc_mantic_empresas.nombre as nombre_empresa,  
					tc_mantic_garantias.consecutivo,  
					tc_mantic_clientes.id_cliente,  
					tc_mantic_clientes.razon_social as cliente,
					tc_mantic_clientes.limite_credito,
					tc_mantic_almacenes.clave,
					tc_mantic_almacenes.nombre as almacen,
					tc_mantic_garantias.total,
					tc_mantic_garantias.total as precio_total,
				  tc_mantic_garantias_estatus.nombre as estatus,
					tc_mantic_garantias.id_garantia_estatus,
					tc_mantic_garantias.registro,
					tc_mantic_garantias_estatus.estatus_asociados, 					
					tc_mantic_personas.cuenta,
					concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) as nombre,
					tc_mantic_clientes.id_credito          
				from 
					tc_mantic_garantias
				inner join 
					tc_mantic_ventas on tc_mantic_garantias.id_venta = tc_mantic_ventas.id_venta
				inner join 
					tc_mantic_clientes on tc_mantic_ventas.id_cliente= tc_mantic_clientes.id_cliente
				inner join 
					tc_mantic_almacenes on tc_mantic_ventas.id_almacen= tc_mantic_almacenes.id_almacen
				inner join 
					tc_mantic_empresas on tc_mantic_ventas.id_empresa= tc_mantic_empresas.id_empresa
				inner join 
					tc_mantic_garantias_estatus on tc_mantic_garantias.id_garantia_estatus= tc_mantic_garantias_estatus.id_garantia_estatus
				inner join 
				  tc_janal_usuarios on tc_mantic_ventas.id_usuario = tc_janal_usuarios.id_usuario
				inner join				
					tc_mantic_personas on tc_mantic_personas.id_persona = tc_janal_usuarios.id_persona				
				where
					tc_mantic_ventas.id_empresa in ({idEmpresa})
					and {condicion}
				{sortOrder}
			</select>			
		</unit>
		<unit id="VistaEstructuraOrdenesCompraDto">
			<select id="orden">
        select
          tc_mantic_ordenes_compras.id_orden_compra as id,
          tc_mantic_empresas.clave as clave_empresa,
          tc_mantic_empresas.nombre as nombre_empresa,
          tc_mantic_empresas.titulo as titulo_empresa,
          tc_mantic_ordenes_compras.consecutivo consecutivo,  
          tc_mantic_proveedores.razon_social as proveedor,
          tc_mantic_ordenes_compras.total importe,
          tc_mantic_ordenes_estatus.nombre estatus,
          tc_mantic_ordenes_compras.registro,
					concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) as persona,
          tc_mantic_almacenes.nombre as almacen
        from 
          tc_mantic_ordenes_compras
        inner join 
          tr_mantic_proveedor_pago on tc_mantic_ordenes_compras.id_proveedor_pago= tr_mantic_proveedor_pago.id_proveedor_pago
        inner join 
          tc_mantic_proveedores on tr_mantic_proveedor_pago.id_proveedor= tc_mantic_proveedores.id_proveedor
        inner join 
          tc_mantic_empresas on tc_mantic_ordenes_compras.id_empresa= tc_mantic_empresas.id_empresa
        inner join 
          tc_mantic_ordenes_estatus on tc_mantic_ordenes_compras.id_orden_estatus=tc_mantic_ordenes_estatus.id_orden_estatus        
				inner join
					tc_janal_usuarios on tc_mantic_ordenes_compras.id_usuario= tc_janal_usuarios.id_usuario
				inner join
					tc_mantic_personas on tc_janal_usuarios.id_persona= tc_mantic_personas.id_persona
				inner join 
					tc_mantic_almacenes on tc_mantic_ordenes_compras.id_almacen= tc_mantic_almacenes.id_almacen
        where 
          tc_mantic_ordenes_compras.id_orden_compra= {idOrdenCompra}	        
      </select>
			<select id="entrada">
        select          
          tc_mantic_notas_entradas.id_nota_entrada as id,
          tc_mantic_notas_entradas.id_nota_entrada,
          tc_mantic_empresas.nombre as nombre_empresa,
          tc_mantic_notas_entradas.consecutivo consecutivo,
          tc_mantic_notas_entradas.registro registro,
          tc_mantic_notas_entradas.total importe,
          tc_mantic_notas_estatus.nombre estatus,
				  tc_mantic_notas_entradas.factura,
				  tc_mantic_notas_entradas.fecha_factura,
				  tc_mantic_notas_entradas.fecha_recepcion,
          tc_mantic_proveedores.razon_social as proveedor,
					concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) as persona
        from 
          tc_mantic_ordenes_compras                
        inner join 
          tc_mantic_notas_entradas on tc_mantic_ordenes_compras.id_orden_compra= tc_mantic_notas_entradas.id_orden_compra
        inner join 
          tc_mantic_empresas on tc_mantic_notas_entradas.id_empresa= tc_mantic_empresas.id_empresa
        inner join 
          tc_mantic_notas_estatus on tc_mantic_notas_entradas.id_nota_estatus=tc_mantic_notas_estatus.id_nota_estatus        
        inner join 
          tc_mantic_proveedores on tc_mantic_notas_entradas.id_proveedor= tc_mantic_proveedores.id_proveedor
				inner join
					tc_janal_usuarios on tc_mantic_notas_entradas.id_usuario= tc_janal_usuarios.id_usuario
				inner join
					tc_mantic_personas on tc_janal_usuarios.id_persona= tc_mantic_personas.id_persona
        where 
          tc_mantic_ordenes_compras.id_orden_compra= {idOrdenCompra}	        
      </select>
			<select id="entradaArchivos">
				select
				  tc_mantic_notas_archivos.id_nota_archivo as id_key,
				  tc_mantic_notas_archivos.alias
        from 
          tc_mantic_notas_entradas                
        left join
          tc_mantic_notas_archivos on tc_mantic_notas_archivos.id_nota_entrada= tc_mantic_notas_entradas.id_nota_entrada				
				where
  				tc_mantic_notas_entradas.id_nota_entrada= {idNotaEntrada}
				  and tc_mantic_notas_archivos.id_principal= 1
			</select>	
			<select id="devolucion">
        select          
          tc_mantic_devoluciones.id_devolucion as id,
          tc_mantic_notas_entradas.id_nota_entrada,
          tc_mantic_empresas.nombre as nombre_empresa,
          tc_mantic_devoluciones.consecutivo consecutivo,
          tc_mantic_devoluciones.registro registro,
          tc_mantic_devoluciones.total importe,
          tc_mantic_devoluciones_estatus.nombre estatus,
				  tc_mantic_devoluciones_bitacora.registro as fecha_entrega
        from           
          tc_mantic_notas_entradas        
        inner join
          tc_mantic_devoluciones on tc_mantic_notas_entradas.id_nota_entrada= tc_mantic_devoluciones.id_nota_entrada
        inner join 
          tc_mantic_empresas on tc_mantic_devoluciones.id_empresa= tc_mantic_empresas.id_empresa
        inner join 
          tc_mantic_devoluciones_estatus on tc_mantic_devoluciones.id_devolucion_estatus=tc_mantic_devoluciones_estatus.id_devolucion_estatus        
				left join
				  tc_mantic_devoluciones_bitacora on tc_mantic_devoluciones.id_devolucion= tc_mantic_devoluciones_bitacora.id_devolucion and tc_mantic_devoluciones_bitacora.id_devolucion_estatus= 3 
        where 
          tc_mantic_notas_entradas.id_nota_entrada= {idNotaEntrada}	        
      </select>
			<select id="credito">
        select          
          tc_mantic_creditos_notas.id_credito_nota as id,
          tc_mantic_creditos_notas.consecutivo consecutivo,
				  tc_mantic_creditos_notas.folio,
				  tc_mantic_creditos_notas.fecha as fecha_documento,
          tc_mantic_creditos_notas.registro registro,
          tc_mantic_creditos_notas.importe importe,
          tc_mantic_creditos_estatus.nombre estatus
        from           
          tc_mantic_devoluciones        
        inner join
          tc_mantic_creditos_notas on tc_mantic_devoluciones.id_devolucion = tc_mantic_creditos_notas.id_devolucion 
        inner join 
          tc_mantic_creditos_estatus on tc_mantic_creditos_notas.id_credito_estatus=tc_mantic_creditos_estatus.id_credito_estatus
        where 
          tc_mantic_devoluciones.id_devolucion= {idDevolucion}	        
      </select>
			<select id="creditoArchivos">
				select
				  tc_mantic_creditos_archivos.id_credito_archivo as id_key,
				  tc_mantic_creditos_archivos.alias
        from 
          tc_mantic_creditos_notas                
        left join
          tc_mantic_creditos_archivos on tc_mantic_creditos_archivos.id_credito_nota= tc_mantic_creditos_notas.id_credito_nota
				where
  				tc_mantic_creditos_notas.id_credito_nota= {idCreditoNota}
				  and tc_mantic_creditos_archivos.id_principal= 1
			</select>	
		</unit>		
		<unit id="VistaIndicadoresTableroDto">
			<select id="cobrar">
        select
          tc_mantic_clientes_deudas.id_cliente as id_key,
          tc_mantic_clientes_deudas.id_cliente,
          tc_mantic_clientes.razon_social,
          count(*) as cuentas,
          sum(tc_mantic_clientes_deudas.saldo) as saldo,
          max(datediff(tc_mantic_clientes_deudas.limite, now())* -1) as dias,
          group_concat(tc_mantic_ventas.ticket separator '| ') as tickets
        from  
          tc_mantic_clientes_deudas  
        inner join
          tc_mantic_clientes on tc_mantic_clientes_deudas.id_cliente= tc_mantic_clientes.id_cliente
        inner join
          tc_mantic_ventas on tc_mantic_clientes_deudas.id_venta= tc_mantic_ventas.id_venta
        where 
          tc_mantic_clientes_deudas.id_cliente_estatus in (1, 2)
          and tc_mantic_clientes.id_credito= 1
        group by
          tc_mantic_clientes_deudas.id_cliente
        {sortOrder}
      </select>  
			<select id="pagar">
        select
          tc_mantic_empresas_deudas.id_empresa_deuda as id_key,
          tc_mantic_notas_entradas.consecutivo,
          tc_mantic_proveedores.razon_social,
          tc_mantic_notas_entradas.factura,
          tc_mantic_empresas_deudas.saldo as total,
          tc_mantic_empresas_deudas.limite as registro,
          (datediff(tc_mantic_empresas_deudas.limite, now())* -1) as dias
        from
          tc_mantic_empresas_deudas
        inner join
          tc_mantic_notas_entradas on tc_mantic_empresas_deudas.id_nota_entrada= tc_mantic_notas_entradas.id_nota_entrada
        inner join
          tc_mantic_proveedores on tc_mantic_notas_entradas.id_proveedor= tc_mantic_proveedores.id_proveedor
        where 
          tc_mantic_empresas_deudas.id_empresa_estatus in (1, 2, 3)
          and tc_mantic_empresas_deudas.id_revisado in (1, 2)
        {sortOrder}
      </select>  
			<select id="agendar">
        select
          tc_mantic_empresas_deudas.id_empresa_deuda as id_key,
          tc_mantic_notas_entradas.consecutivo,
          tc_mantic_proveedores.razon_social,
          tc_mantic_notas_entradas.factura,
          tc_mantic_notas_entradas.total,
          tc_mantic_empresas_deudas.registro
        from
          tc_mantic_empresas_deudas
        inner join
          tc_mantic_notas_entradas on tc_mantic_empresas_deudas.id_nota_entrada= tc_mantic_notas_entradas.id_nota_entrada
        inner join
          tc_mantic_proveedores on tc_mantic_notas_entradas.id_proveedor= tc_mantic_proveedores.id_proveedor
        where 
          tc_mantic_empresas_deudas.id_empresa_estatus in (1, 2)
          and tc_mantic_empresas_deudas.id_revisado= 2 
        {sortOrder}       
      </select>  
			<select id="utilidadSucursales">
				select 
					tc_mantic_empresas.id_empresa as id_key, 
					tc_mantic_empresas.clave as sucursal,
					sum(if(tc_mantic_ventas.utilidad is null, 0, tc_mantic_ventas.utilidad)) total
				from 
					tc_mantic_empresas
				left join 
					tc_mantic_ventas on tc_mantic_ventas.id_empresa = tc_mantic_empresas.id_empresa and tc_mantic_ventas.id_venta_estatus in ({estatusVentas})
				where
					{condicionGeneral}
				group by 
					tc_mantic_empresas.id_empresa, 
					tc_mantic_empresas.clave
				order by 
					tc_mantic_empresas.id_empresa
			</select>			
			<select id="utilidadCaja">
				select 
					id_key, caja, sum(utilidad_caja) utilidad_caja
				from(
				select 
					tc_mantic_cajas.id_caja as id_key,
					concat(tc_mantic_cajas.clave, ' ' , tc_mantic_empresas.clave) caja,
					if(tc_mantic_ventas.utilidad is null, 0, tc_mantic_ventas.utilidad) utilidad_caja
				from 
					tc_mantic_cajas
				inner join 
					tc_mantic_empresas on tc_mantic_cajas.id_empresa = tc_mantic_empresas.id_empresa
				left join 
					tc_mantic_cierres_cajas on tc_mantic_cierres_cajas.id_caja = tc_mantic_cajas.id_caja
				left join 
					tc_mantic_cierres on tc_mantic_cierres_cajas.id_cierre = tc_mantic_cierres.id_cierre
				left join 
					tr_mantic_venta_medio_pago on tc_mantic_cierres.id_cierre = tr_mantic_venta_medio_pago.id_cierre
				left join 
					tc_mantic_ventas on tr_mantic_venta_medio_pago.id_venta = tc_mantic_ventas.id_venta and tc_mantic_ventas.id_venta_estatus in ({estatusVentas})
				where
					{condicionGeneral}
				group by 
					tc_mantic_cajas.id_caja,
					concat(tc_mantic_cajas.clave, ' ' , tc_mantic_empresas.clave),
					tc_mantic_ventas.utilidad 
				order by 
					tc_mantic_empresas.id_empresa, tc_mantic_cajas.id_caja) principal
				group by 
					id_key, caja
			</select>			
			<select id="cuentasCobrar">
				select
					tc_mantic_clientes_deudas.id_cliente_deuda as id_key,
					tc_mantic_clientes.razon_social as cliente,
					tc_mantic_clientes_deudas.importe,
					tc_mantic_clientes_deudas.saldo
				from 
					tc_mantic_clientes_deudas				
				inner join 
					tc_mantic_clientes on tc_mantic_clientes_deudas.id_cliente = tc_mantic_clientes.id_cliente
				where
					{condicionGeneral}
				order by 
					tc_mantic_clientes_deudas.importe desc
			</select>
			<select id="cuentasPagar">
				select 
					tc_mantic_empresas_deudas.id_empresa_deuda as id_key,
					tc_mantic_proveedores.razon_social as proveedor,
					tc_mantic_empresas_deudas.importe,
					(tc_mantic_empresas_deudas.saldo * -1) saldo
				from 
					tc_mantic_empresas_deudas				
				inner join 
					tc_mantic_notas_entradas on tc_mantic_empresas_deudas.id_nota_entrada = tc_mantic_notas_entradas.id_nota_entrada
				inner join 
					tc_mantic_proveedores on tc_mantic_notas_entradas.id_proveedor = tc_mantic_proveedores.id_proveedor
				where
					{condicionGeneral}
				order by 
					tc_mantic_empresas_deudas.saldo desc
			</select>
			<select id="ventasSucursal">
				select 
					tc_mantic_empresas.id_empresa as id_key, 
					tc_mantic_empresas.clave as sucursal,
					count(*) total
				from 
					tc_mantic_empresas
				left join 
					tc_mantic_ventas on tc_mantic_ventas.id_empresa = tc_mantic_empresas.id_empresa and tc_mantic_ventas.id_venta_estatus in ({estatusVentas})
				where
					{condicionGeneral}
				group by 
					tc_mantic_empresas.id_empresa, 
					tc_mantic_empresas.clave
				order by 
					tc_mantic_empresas.id_empresa
			</select>
			<select id="articulosMasVentas">
				select
					id_key, 
					articulo, 
					total, 
					((total * 100)/(select sum(cantidad) from tc_mantic_ventas inner join tc_mantic_ventas_detalles on tc_mantic_ventas.id_venta = tc_mantic_ventas_detalles.id_venta and tc_mantic_ventas.id_venta_estatus in ({estatusVentas}) where tc_mantic_ventas.id_venta_estatus in ({estatusVentas}) and {condicionGeneral})) porcentaje
				from(
				select
					id_key, articulo, sum(cantidad) total
				from(            
					select 
						tc_mantic_articulos.id_articulo as id_key,
						tc_mantic_articulos.nombre articulo,
						tc_mantic_ventas_detalles.cantidad
					from 
						tc_mantic_ventas
					inner join 
						tc_mantic_ventas_detalles on tc_mantic_ventas.id_venta = tc_mantic_ventas_detalles.id_venta and tc_mantic_ventas.id_venta_estatus in ({estatusVentas})
					inner join 
						tc_mantic_articulos on tc_mantic_ventas_detalles.id_articulo = tc_mantic_articulos.id_articulo
					where
						{condicionGeneral}) principal
				group by 
					id_key, articulo
				order by 
					total desc) general
				group by 
					id_key, articulo, total
				order by
					total desc
			</select>
			<select id="articulosMasUtilidad">
				select
					id_key, 
					articulo, 
					total, 
					((total * 100)/(select sum(utilidad) from tc_mantic_ventas where tc_mantic_ventas.id_tipo_documento= 2 and tc_mantic_ventas.id_venta_estatus in ({estatusVentas}) and {condicionGeneral})) porcentaje
				from(
				select
					id_key, articulo, sum(utilidad) total
				from(            
					select 
						tc_mantic_articulos.id_articulo as id_key,
						tc_mantic_articulos.nombre articulo,
						tc_mantic_ventas_detalles.utilidad
					from 
						tc_mantic_ventas
					inner join 
						tc_mantic_ventas_detalles on tc_mantic_ventas.id_venta = tc_mantic_ventas_detalles.id_venta and tc_mantic_ventas.id_venta_estatus in ({estatusVentas})
					inner join 
						tc_mantic_articulos on tc_mantic_ventas_detalles.id_articulo = tc_mantic_articulos.id_articulo
					where
				    tc_mantic_ventas.id_tipo_documento= 2 and 
						{condicionGeneral}
				) principal
				group by 
					id_key, articulo
				order by 
					total desc ) general
				group by 
					id_key, articulo, total
				order by
					total desc
			</select>
			<select id="ventasPorEmpleado">
				select
					id_key, nombre, total,
					((total * 100)/(select count(*) total from tc_mantic_ventas where tc_mantic_ventas.id_venta_estatus in ({estatusVentas}) and {condicionGeneral})) porcentaje
				from (
				select 
					tc_mantic_personas.id_persona as id_key,
					concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) nombre,
					count(*) total
				from 
					tc_mantic_ventas
				inner join 
					tc_janal_usuarios on tc_mantic_ventas.id_usuario = tc_janal_usuarios.id_usuario
				inner join 
					tc_mantic_personas on tc_janal_usuarios.id_persona = tc_mantic_personas.id_persona
				where 
					{condicionGeneral}
				and 
					tc_mantic_ventas.id_venta_estatus in ({estatusVentas})
				group by   
					tc_mantic_personas.id_persona,
					concat(tc_mantic_personas.nombres, tc_mantic_personas.paterno, tc_mantic_personas.materno)) principal
				group by 
					id_key, nombre, total
			</select>
		</unit>
    <unit id="VistaFaltantesDto">
      <select id="igual">
        select      
				  tc_mantic_faltantes.id_faltante as id_key,
          tc_mantic_faltantes.*,
					(select tc_mantic_articulos_codigos.codigo from tc_mantic_articulos_codigos where tc_mantic_articulos_codigos.id_articulo= tc_mantic_articulos.id_articulo and tc_mantic_articulos_codigos.id_principal= 1 limit 0, 1) as codigo,
				  tc_mantic_articulos.nombre
        from      
          tc_mantic_faltantes
				inner join 
				  tc_mantic_articulos on tc_mantic_faltantes.id_articulo= tc_mantic_articulos.id_articulo
        where      
          id_faltante = {idFaltante}
      </select>
			<select id="lazy">
				select      
          tc_mantic_faltantes.id_faltante as id_key,
          tc_mantic_faltantes.id_empresa,
          tc_mantic_empresas.clave as empresa,  
          tc_mantic_empresas.nombre as nombre_empresa,  
          tc_mantic_articulos_codigos.codigo,
          tc_mantic_articulos_codigos.codigo as propio,
          tc_mantic_articulos.id_articulo,
          tc_mantic_articulos.nombre,
          tc_mantic_articulos.precio,
          tc_mantic_articulos.iva,
          tc_mantic_faltantes.cantidad,
          concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) as usuario,
          tc_mantic_faltantes.registro
        from      
          tc_mantic_faltantes
        inner join 
          tc_mantic_empresas on tc_mantic_faltantes.id_empresa = tc_mantic_empresas.id_empresa
        inner join
          tc_mantic_articulos on tc_mantic_faltantes.id_articulo= tc_mantic_articulos.id_articulo
        inner join
          tc_janal_usuarios on tc_mantic_faltantes.id_usuario= tc_janal_usuarios.id_usuario          
        inner join
          tc_mantic_personas on tc_janal_usuarios.id_persona= tc_mantic_personas.id_persona
        left join
          tc_mantic_articulos_codigos on tc_mantic_faltantes.id_articulo= tc_mantic_articulos_codigos.id_articulo and tc_mantic_articulos_codigos.id_principal= 1
        where 
          tc_mantic_faltantes.id_vigente= 1
				  and tc_mantic_articulos.id_descontinuado= 2
          and tc_mantic_faltantes.id_empresa in ({idEmpresa})
          and {condicion}
          {sortOrder}
			</select>
			<select id="usuariosFaltantes">
				select distinct    
          tc_mantic_faltantes.id_usuario as id_key,
          tc_mantic_faltantes.id_usuario,
          concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) as nombre_usuario
        from      
          tc_mantic_faltantes
        inner join
          tc_janal_usuarios on tc_mantic_faltantes.id_usuario= tc_janal_usuarios.id_usuario          
        inner join
          tc_mantic_personas on tc_janal_usuarios.id_persona= tc_mantic_personas.id_persona
			</select>
		</unit>
		<unit id="VistaEgresosDto">
      <select id="exportar">
        select
          tt_keet_documentos.*
        from (         
          select
            tc_mantic_notas_archivos.id_nota_archivo as id_key,
            concat('N-', tc_mantic_notas_entradas.consecutivo) as consecutivo,
            tc_mantic_tipos_archivos.nombre as documento,
  					tt_mantic_tipos_archivos.nombre as tipo,
            tc_mantic_notas_archivos.id_tipo_documento,
            tc_mantic_notas_archivos.id_tipo_archivo,
            tc_mantic_notas_archivos.nombre,
            tc_mantic_notas_archivos.ruta,
            tc_mantic_notas_archivos.alias,
            tc_mantic_notas_archivos.id_eliminado,
            tc_mantic_notas_archivos.registro,
            tc_mantic_notas_archivos.observaciones,
            concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) as usuario,
            'facturas/' as repositorio
          from
            tc_mantic_egresos_notas         
          inner join
            tc_mantic_egresos on tc_mantic_egresos_notas.id_egreso= tc_mantic_egresos.id_egreso         
          inner join
            tc_mantic_notas_entradas on tc_mantic_egresos_notas.id_nota_entrada= tc_mantic_notas_entradas.id_nota_entrada         
          inner join
            tc_mantic_notas_archivos on tc_mantic_egresos_notas.id_nota_entrada= tc_mantic_notas_archivos.id_nota_entrada         
          inner join
            tc_mantic_tipos_archivos on tc_mantic_notas_archivos.id_tipo_documento= tc_mantic_tipos_archivos.id_tipo_archivo
  				inner join
	  				tc_mantic_tipos_archivos as tt_mantic_tipos_archivos on tc_mantic_notas_archivos.id_tipo_archivo= tt_mantic_tipos_archivos.id_tipo_archivo
          inner join
            tc_janal_usuarios on tc_mantic_notas_archivos.id_usuario = tc_janal_usuarios.id_usuario
          inner join
            tc_mantic_personas on tc_janal_usuarios.id_persona = tc_mantic_personas.id_persona
          where
            tc_mantic_egresos_notas.id_egreso= {idEgreso}
            and tc_mantic_notas_archivos.id_eliminado= 2
          union all
          select
            (50000+ tc_mantic_egresos_archivos.id_egreso_archivo) as id_key,
            concat('E-', tc_mantic_egresos.consecutivo) as consecutivo,
            tc_mantic_tipos_archivos.nombre as documento,
  					tt_mantic_tipos_archivos.nombre as tipo,
            tc_mantic_egresos_archivos.id_tipo_documento,
            tc_mantic_egresos_archivos.id_tipo_archivo,
            tc_mantic_egresos_archivos.nombre,
            tc_mantic_egresos_archivos.ruta,
            tc_mantic_egresos_archivos.alias,
            tc_mantic_egresos_archivos.id_eliminado,
            tc_mantic_egresos_archivos.registro,
            tc_mantic_egresos_archivos.observaciones,
            concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) as usuario,
            'egresos/' as repositorio
          from
            tc_mantic_egresos
          inner join
            tc_mantic_egresos_archivos on tc_mantic_egresos.id_egreso= tc_mantic_egresos_archivos.id_egreso
          inner join
            tc_mantic_tipos_archivos on tc_mantic_egresos_archivos.id_tipo_documento= tc_mantic_tipos_archivos.id_tipo_archivo
  				inner join
	  				tc_mantic_tipos_archivos as tt_mantic_tipos_archivos on tc_mantic_egresos_archivos.id_tipo_archivo= tt_mantic_tipos_archivos.id_tipo_archivo
          inner join
            tc_janal_usuarios on tc_mantic_egresos_archivos.id_usuario = tc_janal_usuarios.id_usuario
          inner join
            tc_mantic_personas on tc_janal_usuarios.id_persona = tc_mantic_personas.id_persona
          where
            tc_mantic_egresos.id_egreso= {idEgreso}
            and tc_mantic_egresos_archivos.id_eliminado= 2
       ) as tt_keet_documentos   
       order by          
          tt_keet_documentos.consecutivo,
          tt_keet_documentos.id_tipo_documento,
          tt_keet_documentos.id_tipo_archivo,
          tt_keet_documentos.registro desc   
      </select>
			<select id="lazy">
				select 
					tc_mantic_egresos.id_egreso as id_key,
					tc_mantic_egresos.*,
					tc_mantic_egresos_estatus.nombre,
					tc_mantic_egresos_estatus.estatus_asociados,
          sum(if(tc_mantic_egresos_notas.id_egreso is null, 0, 1)) as cuentas,
          (select count(*) from tc_mantic_egresos_archivos where tc_mantic_egresos_archivos.id_egreso= tc_mantic_egresos.id_egreso and tc_mantic_egresos_archivos.id_eliminado= 2) as documentos				
        from 
					tc_mantic_egresos
				inner join 
					tc_mantic_egresos_estatus on tc_mantic_egresos.id_egreso_estatus = tc_mantic_egresos_estatus.id_egreso_estatus
        left join
          tc_mantic_egresos_notas on tc_mantic_egresos.id_egreso= tc_mantic_egresos_notas.id_egreso
				left join
					tc_mantic_notas_entradas on tc_mantic_egresos_notas.id_nota_entrada= tc_mantic_notas_entradas.id_nota_entrada         
        where 
					{condicion}
				group by
				  tc_mantic_egresos.id_egreso
				{sortOrder}
			</select>		
      <select id="revisar">
        select      
          tc_mantic_egresos_notas.id_egreso_nota as id_key,
          tc_mantic_empresas_deudas.id_completo
        from      
          tc_mantic_egresos_notas
        inner join
          tc_mantic_empresas_deudas on tc_mantic_empresas_deudas.id_nota_entrada= tc_mantic_egresos_notas.id_nota_entrada
        where 
          tc_mantic_egresos_notas.id_egreso= {idEgreso}       
      </select>  
      <select id="documentos">
        select      
          tc_mantic_egresos_notas.id_egreso_nota as id_key,
          count(*) as total,
          sum(if(tc_mantic_empresas_deudas.id_completo= 3, 1, 0)) as completos
        from      
          tc_mantic_egresos_notas
        inner join 
          tc_mantic_empresas_deudas on tc_mantic_egresos_notas.id_nota_entrada= tc_mantic_empresas_deudas.id_nota_entrada
        where 
          tc_mantic_egresos_notas.id_egreso= {idEgreso}
      </select>  
      <select id="notas">
        select      
          tc_mantic_egresos_notas.id_egreso_nota as id_key,
          tc_mantic_egresos_notas.id_egreso as id_pivote,
					tc_mantic_egresos.consecutivo,
          tc_mantic_egresos.fecha,
          tc_mantic_egresos.descripcion,
          tc_mantic_egresos.importe,
          tc_mantic_notas_entradas.consecutivo as nota_entrada,
          tc_mantic_notas_entradas.factura,
          tc_mantic_notas_entradas.fecha_factura,
          tc_mantic_notas_entradas.total,
          tc_mantic_egresos_notas.*
        from      
          tc_mantic_egresos_notas
        inner join
          tc_mantic_egresos on tc_mantic_egresos_notas.id_egreso= tc_mantic_egresos.id_egreso
        inner join
          tc_mantic_notas_entradas on tc_mantic_egresos_notas.id_nota_entrada= tc_mantic_notas_entradas.id_nota_entrada
        where 
          tc_mantic_egresos_notas.id_nota_entrada= {idNotaEntrada}
        {sortOrder}
      </select>
      <select id="egresos">
        select      
          tc_mantic_egresos_notas.id_egreso_nota as id_key,
          tc_mantic_egresos_notas.id_nota_entrada as id_pivote,
          tc_mantic_empresas_deudas.id_empresa_deuda,
          tc_mantic_empresas.nombre as sucursal,
          tc_mantic_notas_entradas.consecutivo,
          tc_mantic_notas_entradas.factura,
          tc_mantic_notas_entradas.fecha_factura,
          tc_mantic_notas_entradas.total,
          tc_mantic_proveedores.razon_social as proveedor,
          tc_mantic_empresas_deudas.id_completo,
          tc_mantic_egresos_notas.*
        from      
          tc_mantic_egresos_notas
        inner join
          tc_mantic_egresos on tc_mantic_egresos_notas.id_egreso= tc_mantic_egresos.id_egreso
        inner join
          tc_mantic_notas_entradas on tc_mantic_egresos_notas.id_nota_entrada= tc_mantic_notas_entradas.id_nota_entrada
        inner join
          tc_mantic_empresas on tc_mantic_empresas.id_empresa= tc_mantic_notas_entradas.id_empresa
        inner join
          tc_mantic_empresas_deudas on tc_mantic_notas_entradas.id_nota_entrada= tc_mantic_empresas_deudas.id_nota_entrada
        left join
          tc_mantic_proveedores on tc_mantic_notas_entradas.id_proveedor= tc_mantic_proveedores.id_proveedor
        where 
          tc_mantic_egresos_notas.id_egreso= {idEgreso}
        group by
          tc_mantic_egresos_notas.id_nota_entrada
        {sortOrder}
      </select>
			<select id="notasEntradas">
        select
					tc_mantic_notas_entradas.id_nota_entrada as id_key,
					tc_mantic_notas_entradas.id_nota_entrada,
					tc_mantic_ordenes_compras.id_orden_compra,
          tc_mantic_notas_entradas.id_almacen,
          tc_mantic_notas_entradas.id_empresa,
          tc_mantic_proveedores.id_proveedor,
					tc_mantic_ordenes_compras.consecutivo as orden_compra,
					tc_mantic_notas_entradas.consecutivo,
					tc_mantic_empresas.nombre as empresa,
					tc_mantic_notas_tipos.nombre as directa,
					tc_mantic_notas_entradas.id_nota_tipo,
					tc_mantic_proveedores.razon_social,
					tc_mantic_notas_entradas.total,
					tc_mantic_notas_estatus.id_nota_estatus,
					tc_mantic_notas_estatus.nombre as estatus,
					tc_mantic_notas_estatus.estatus_asociados,
					tc_mantic_notas_entradas.registro,
					tc_mantic_empresas_pagos.id_empresa_pago,
					tc_mantic_notas_archivos.id_tipo_archivo,
					tc_mantic_notas_archivos.id_principal,
					tc_mantic_notas_archivos.alias,
					tc_mantic_notas_archivos.nombre,
					tc_mantic_notas_archivos.archivo
        from
          tc_mantic_notas_entradas  
				inner join 
					tc_mantic_empresas_pagos on tc_mantic_notas_entradas.id_nota_entrada = tc_mantic_empresas_pagos.id_nota_entrada
        inner join
          tc_mantic_notas_tipos on tc_mantic_notas_entradas.id_nota_tipo= tc_mantic_notas_tipos.id_nota_tipo
        inner join
          tc_mantic_empresas on tc_mantic_notas_entradas.id_empresa= tc_mantic_empresas.id_empresa         
        inner join
          tc_mantic_proveedores on tc_mantic_notas_entradas.id_proveedor= tc_mantic_proveedores.id_proveedor         
        inner join
          tc_mantic_notas_estatus on tc_mantic_notas_entradas.id_nota_estatus= tc_mantic_notas_estatus.id_nota_estatus      
        left join
          tc_mantic_ordenes_compras on tc_mantic_notas_entradas.id_orden_compra= tc_mantic_ordenes_compras.id_orden_compra 
				left join
					tc_mantic_notas_archivos on tc_mantic_notas_entradas.id_nota_entrada = tc_mantic_notas_archivos.id_nota_entrada
        where
					tc_mantic_empresas_pagos.id_egreso= {idEgreso}					
			</select>	
			<select id="creditosNotas">
        select
					tc_mantic_creditos_notas.id_credito_nota as id_key,
					tc_mantic_creditos_notas.id_credito_nota,
					tc_mantic_creditos_notas.id_devolucion,
					tc_mantic_devoluciones.consecutivo as devolucion,
				  tc_mantic_notas_entradas.id_nota_entrada,
					tc_mantic_notas_entradas.consecutivo as nota_entrada,
          tc_mantic_notas_entradas.id_almacen,
          tc_mantic_notas_entradas.id_empresa,
				  tc_mantic_proveedores.id_proveedor,
					tc_mantic_proveedores.razon_social as proveedor,
					tc_mantic_creditos_notas.consecutivo,
					tc_mantic_empresas.clave as empresa,
				  tc_mantic_empresas.nombre as nombre_empresa,
					tc_mantic_creditos_notas.folio,
					tc_mantic_creditos_notas.importe,
		  		tc_mantic_creditos_estatus.nombre as estatus,
					tc_mantic_creditos_estatus.id_credito_estatus,
				  tc_mantic_creditos_estatus.estatus_asociados,
				  tc_mantic_tipos_creditos_notas.id_tipo_credito_nota,
				  tc_mantic_tipos_creditos_notas.nombre nombre_nota,
					tc_mantic_creditos_notas.registro,
					tc_mantic_empresas_pagos.id_empresa_pago,
					tc_mantic_creditos_archivos.id_tipo_archivo,
					tc_mantic_creditos_archivos.id_principal,
					tc_mantic_creditos_archivos.alias,
					tc_mantic_creditos_archivos.nombre,
					tc_mantic_creditos_archivos.archivo
        from
          tc_mantic_creditos_notas         
				inner join 
					tc_mantic_empresas_pagos on tc_mantic_creditos_notas.id_credito_nota = tc_mantic_empresas_pagos.id_credito_nota
        inner join
          tc_mantic_tipos_creditos_notas on tc_mantic_creditos_notas.id_tipo_credito_nota=tc_mantic_tipos_creditos_notas.id_tipo_credito_nota      
        inner join
          tc_mantic_creditos_estatus on tc_mantic_creditos_notas.id_credito_estatus=tc_mantic_creditos_estatus.id_credito_estatus      
        inner join
          tc_mantic_empresas on tc_mantic_creditos_notas.id_empresa= tc_mantic_empresas.id_empresa         
        left join
          tc_mantic_devoluciones on tc_mantic_creditos_notas.id_devolucion= tc_mantic_devoluciones.id_devolucion
        left join
          tc_mantic_notas_entradas on tc_mantic_creditos_notas.id_nota_entrada= tc_mantic_notas_entradas.id_nota_entrada
        left join
          tc_mantic_proveedores on tc_mantic_creditos_notas.id_proveedor= tc_mantic_proveedores.id_proveedor
				left join 
					tc_mantic_creditos_archivos on tc_mantic_creditos_notas.id_credito_nota = tc_mantic_creditos_archivos.id_credito_nota
        where
					tc_mantic_empresas_pagos.id_egreso ={idEgreso}					
			</select> 
			<select id="empresasPagos">
				select
					tc_mantic_empresas_pagos.id_empresa_pago as id_key,
					tc_mantic_notas_entradas.consecutivo,
					tc_mantic_empresas_deudas.importe,
					tc_mantic_empresas_deudas.saldo,
					tc_mantic_empresas_pagos.pago,
					concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) as persona,
					tc_mantic_empresas_pagos.registro,
					tc_mantic_empresas_pagos.observaciones,
					tc_mantic_tipos_medios_pagos.clave,
					tc_mantic_tipos_medios_pagos.nombre nombre_pago,
					tc_mantic_empresas_archivos.id_tipo_archivo,
					tc_mantic_empresas_archivos.id_principal,
					tc_mantic_empresas_archivos.alias,
					tc_mantic_empresas_archivos.nombre,
					tc_mantic_empresas_archivos.archivo
				from
					tc_mantic_empresas_pagos
				inner join
					tc_mantic_empresas_deudas on tc_mantic_empresas_pagos.id_empresa_deuda= tc_mantic_empresas_deudas.id_empresa_deuda
				inner join
					tc_mantic_notas_entradas on tc_mantic_empresas_deudas.id_nota_entrada= tc_mantic_notas_entradas.id_nota_entrada
				inner join
					tc_janal_usuarios on tc_mantic_empresas_pagos.id_usuario= tc_janal_usuarios.id_usuario
				inner join
					tc_mantic_personas on tc_janal_usuarios.id_persona= tc_mantic_personas.id_persona
				inner join 
					tc_mantic_tipos_medios_pagos on tc_mantic_empresas_pagos.id_tipo_medio_pago = tc_mantic_tipos_medios_pagos.id_tipo_medio_pago
				left join 
					tc_mantic_empresas_archivos on tc_mantic_empresas_pagos.id_empresa_pago = tc_mantic_empresas_archivos.id_empresa_pago
				where
					tc_mantic_empresas_pagos.id_egreso= {idEgreso} and tc_mantic_empresas_pagos.id_credito_nota is null and tc_mantic_empresas_pagos.id_nota_entrada is null
				order by
					tc_mantic_notas_entradas.consecutivo, 
					tc_mantic_empresas_deudas.registro desc				
			</select>
			<select id="observaciones">
				select 
					tc_mantic_egresos_notas.id_egreso_nota as id_key,
					tc_mantic_egresos_notas.*,
					concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) as persona
				from 
					tc_mantic_egresos_notas
				inner join
					tc_janal_usuarios on tc_mantic_egresos_notas.id_usuario= tc_janal_usuarios.id_usuario          
				inner join
					tc_mantic_personas on tc_janal_usuarios.id_persona= tc_mantic_personas.id_persona
				where 
					tc_mantic_egresos_notas.id_egreso= {idEgreso}
			</select>	
			<select id="importados">
				select
					tc_mantic_egresos_archivos.id_egreso_archivo AS id_key,
					tc_mantic_egresos_archivos.id_egreso,
					tc_mantic_egresos_archivos.id_tipo_archivo,
					tc_mantic_tipos_archivos.nombre as tipo,
					tc_mantic_egresos_archivos.nombre,
					tc_mantic_egresos_archivos.alias,
					tc_mantic_egresos_archivos.ruta,
					tc_mantic_egresos_archivos.id_principal,
					concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) as usuario,
					tc_mantic_egresos_archivos.observaciones,
					tc_mantic_egresos_archivos.registro,
          tt_mantic_tipos_archivos.nombre as documento,
 					tc_mantic_egresos_archivos.id_eliminado
				from
					tc_mantic_egresos_archivos
				inner join
					tc_mantic_tipos_archivos on tc_mantic_egresos_archivos.id_tipo_archivo= tc_mantic_tipos_archivos.id_tipo_archivo				
				inner join
					tc_mantic_tipos_archivos as tt_mantic_tipos_archivos on tc_mantic_egresos_archivos.id_tipo_documento= tt_mantic_tipos_archivos.id_tipo_archivo
				inner join
					tc_janal_usuarios on tc_mantic_egresos_archivos.id_usuario = tc_janal_usuarios.id_usuario
				inner join
					tc_mantic_personas on tc_janal_usuarios.id_persona = tc_mantic_personas.id_persona
				where
					tc_mantic_egresos_archivos.id_egreso= {idEgreso}
          and (tc_mantic_egresos_archivos.id_tipo_documento= {idTipoDocumento} or {idTipoDocumento}= -1)
				order by
					tc_mantic_egresos_archivos.id_tipo_documento, 
          tc_mantic_egresos_archivos.id_tipo_archivo, 
          tc_mantic_egresos_archivos.registro desc				
			</select>
			<select id="exists">
        select      
          tc_mantic_egresos_archivos.*
        from      
          tc_mantic_egresos_archivos				
        where      
          tc_mantic_egresos_archivos.id_tipo_archivo = {idTipoArchivo} and tc_mantic_egresos_archivos.id_egreso = {idEgreso}
				order by
				  tc_mantic_egresos_archivos.registro desc
      </select>
			<select id="filesEgresos">
        select      
          tc_mantic_egresos_archivos.*
        from      
          tc_mantic_egresos_archivos				
        where      
          tc_mantic_egresos_archivos.id_egreso = {idEgreso} and tc_mantic_egresos_archivos.id_principal=1
				order by
				  tc_mantic_egresos_archivos.registro desc
      </select>
			<select id="filesEgresosNotasEntradas">
        select
					tc_mantic_notas_archivos.*
        from
          tc_mantic_notas_entradas  
				inner join 
					tc_mantic_empresas_pagos on tc_mantic_notas_entradas.id_nota_entrada = tc_mantic_empresas_pagos.id_nota_entrada
				inner join 
					tc_mantic_notas_archivos on tc_mantic_notas_entradas.id_nota_entrada = tc_mantic_notas_archivos.id_nota_entrada								        
        where
					tc_mantic_empresas_pagos.id_egreso= {idEgreso} and tc_mantic_notas_archivos.id_principal=1
      </select>
			<select id="filesEgresosCreditosNotas">
        select
					tc_mantic_creditos_archivos.*    
        from
          tc_mantic_creditos_notas         
				inner join 
					tc_mantic_empresas_pagos on tc_mantic_creditos_notas.id_credito_nota = tc_mantic_empresas_pagos.id_credito_nota
        inner join 
					tc_mantic_creditos_archivos on tc_mantic_creditos_notas.id_credito_nota = tc_mantic_creditos_archivos.id_credito_nota								
        where
					tc_mantic_empresas_pagos.id_egreso ={idEgreso} and tc_mantic_creditos_archivos.id_principal=1
      </select>
			<select id="filesEgresosEmpresasPagos">
        select
					tc_mantic_empresas_archivos.*
				from
					tc_mantic_empresas_pagos
				inner join 
					tc_mantic_empresas_archivos on tc_mantic_empresas_pagos.id_empresa_pago = tc_mantic_empresas_archivos.id_empresa_pago				
				where
					tc_mantic_empresas_pagos.id_egreso= {idEgreso} and tc_mantic_empresas_pagos.id_credito_nota is null and tc_mantic_empresas_pagos.id_nota_entrada is null and tc_mantic_empresas_archivos.id_principal=1				
      </select>
      <select id="porComodin">
        select      
          tc_mantic_notas_entradas.id_nota_entrada as id_key,
          tc_mantic_notas_entradas.id_nota_entrada as id_pivote,
          tc_mantic_empresas.nombre as sucursal,
          tc_mantic_notas_entradas.id_nota_entrada,
          tc_mantic_notas_entradas.consecutivo,
          tc_mantic_notas_entradas.factura,
          tc_mantic_notas_entradas.fecha_factura as dia,
          tc_mantic_notas_entradas.fecha_factura,
          tc_mantic_notas_entradas.total as cantidad,
          tc_mantic_notas_entradas.total,
          tc_mantic_proveedores.razon_social as proveedor
        from      
          tc_mantic_notas_entradas
        inner join
          tc_mantic_empresas_deudas on tc_mantic_notas_entradas.id_nota_entrada= tc_mantic_empresas_deudas.id_nota_entrada
        inner join
          tc_mantic_empresas on tc_mantic_empresas.id_empresa= tc_mantic_notas_entradas.id_empresa
        left join
          tc_mantic_proveedores on tc_mantic_notas_entradas.id_proveedor= tc_mantic_proveedores.id_proveedor
        where 
          tc_mantic_empresas_deudas.id_empresa_estatus= 4
          and {condicion}
        {sortOrder}        
      </select>
		</unit>
		<unit id="VistaAlmacenesUbicacionesDto">
			<select id="lazy">
				select 
				  principal.*,
					(select count(*) from tc_mantic_almacenes_articulos where id_almacen_ubicacion= principal.id_almacen_ubicacion) as total_articulos
				from (
				select 
					tc_mantic_almacenes_ubicaciones.id_almacen_ubicacion as id_key, 
					tc_mantic_almacenes.id_almacen,
					tc_mantic_almacenes.id_empresa, 
					tc_mantic_almacenes.clave,
					tc_mantic_almacenes.nombre,
					tc_mantic_almacenes.descripcion,
					tc_mantic_almacenes.id_principal,
					tc_mantic_almacenes_ubicaciones.id_almacen_ubicacion, 
					tc_mantic_almacenes_ubicaciones.piso,
					tc_mantic_almacenes_ubicaciones.cuarto, 
					tc_mantic_almacenes_ubicaciones.anaquel,
					tc_mantic_almacenes_ubicaciones.charola,
					tc_mantic_almacenes_ubicaciones.descripcion descripcion_ubicacion
				from 
					tc_mantic_almacenes
				inner join 
					tc_mantic_almacenes_ubicaciones on tc_mantic_almacenes.id_almacen = tc_mantic_almacenes_ubicaciones.id_almacen
				where
					tc_mantic_almacenes.id_empresa in ({sucursales})
				and
					{condicion}
					{sortOrder}) principal
			</select>
			<select id="lazyArticulo">
				select 
					tc_mantic_articulos.id_articulo as id_key,
					tc_mantic_almacenes.id_almacen,
					tc_mantic_almacenes.id_empresa, 
					tc_mantic_almacenes.clave,
					if(tc_mantic_almacenes.nombre is null, ' ', tc_mantic_almacenes.nombre) nombre,
					tc_mantic_almacenes.descripcion,
					tc_mantic_almacenes.id_principal,
					tc_mantic_almacenes_ubicaciones.id_almacen_ubicacion, 
					if(tc_mantic_almacenes_ubicaciones.piso is null, ' ', tc_mantic_almacenes_ubicaciones.piso) piso,
					if(tc_mantic_almacenes_ubicaciones.cuarto is null, ' ', tc_mantic_almacenes_ubicaciones.cuarto) cuarto, 
					if(tc_mantic_almacenes_ubicaciones.anaquel is null, ' ', tc_mantic_almacenes_ubicaciones.anaquel) anaquel,
					if(tc_mantic_almacenes_ubicaciones.charola is null, ' ', tc_mantic_almacenes_ubicaciones.charola) charola,
					tc_mantic_almacenes_ubicaciones.descripcion descripcion_ubicacion,
					tc_mantic_articulos.nombre nombre_articulo,
					tc_mantic_articulos_codigos.codigo,				  
					tc_mantic_articulos.descripcion descripcion_articulo,
					tc_mantic_articulos.id_articulo,
					tc_mantic_almacenes_articulos.id_almacen_articulo,
					ifnull(tc_mantic_inventarios.stock, 0) as stock
				from 					
					tc_mantic_articulos 
				inner join  
					tc_mantic_articulos_codigos on tc_mantic_articulos_codigos.id_articulo= tc_mantic_articulos.id_articulo and tc_mantic_articulos_codigos.id_principal= 1
				left join 
					tc_mantic_almacenes_articulos on tc_mantic_articulos.id_articulo = tc_mantic_almacenes_articulos.id_articulo
        left join
            tc_mantic_inventarios on tc_mantic_almacenes_articulos.id_almacen= tc_mantic_inventarios.id_almacen and tc_mantic_almacenes_articulos.id_articulo= tc_mantic_inventarios.id_articulo and tc_mantic_inventarios.id_automatico= 2     
        left join
            (select
                max(tc_mantic_inventarios.id_inventario) as id_inventario
              from
                tc_mantic_inventarios         
              group by
                id_almacen, id_articulo  
            ) as tc_mantic_maximos on tc_mantic_inventarios.id_inventario= tc_mantic_maximos.id_inventario        
				left join 
					tc_mantic_almacenes on tc_mantic_almacenes_articulos.id_almacen = tc_mantic_almacenes.id_almacen
				left join 
					tc_mantic_almacenes_ubicaciones on tc_mantic_almacenes_articulos.id_almacen_ubicacion = tc_mantic_almacenes_ubicaciones.id_almacen_ubicacion
				where
					tc_mantic_articulos.id_empresa in ({sucursales})
				and
					{condicion}
					{sortOrder}
			</select>
		</unit>
		<unit id="VistaUbicacionesDto">
			<select id="ubicacionEmpresa">
				select 
					principal.*,
					(select count(*) articulos from tc_mantic_almacenes_articulos where id_almacen in (select id_almacen from tc_mantic_almacenes where id_empresa= principal.id_empresa)) articulos
				from(
				select 
					tc_mantic_empresas.id_empresa id_key,
					tc_mantic_empresas.id_empresa,
					tc_mantic_empresas.nombre empresa,
					tc_mantic_empresas.registro
				from 
					tc_mantic_almacenes
				inner join 
					tc_mantic_empresas on tc_mantic_almacenes.id_empresa = tc_mantic_empresas.id_empresa
				where 
					tc_mantic_empresas.id_empresa in ({idEmpresa})
				group by 
					tc_mantic_empresas.id_empresa,
					tc_mantic_empresas.nombre,
					tc_mantic_empresas.registro) principal
			</select>			
			<select id="ubicacionAlmacen">
				select 
					principal.*,
					(select count(*) articulos from tc_mantic_almacenes_articulos where id_almacen= principal.id_key) articulos
				from(
				select   
					tc_mantic_almacenes.id_almacen id_key,
					tc_mantic_empresas.id_empresa,  
					tc_mantic_empresas.nombre empresa,
					tc_mantic_almacenes.id_almacen,
					tc_mantic_almacenes.nombre almacen,
					tc_mantic_almacenes.registro
				from 
					tc_mantic_almacenes
				inner join 
					tc_mantic_empresas on tc_mantic_almacenes.id_empresa = tc_mantic_empresas.id_empresa				
				where 
					tc_mantic_empresas.id_empresa in ({idEmpresa})) principal
			</select>
			<select id="ubicacionPiso">
				select 
					principal.*,
					(select count(*) articulos from tc_mantic_almacenes_articulos where id_almacen_ubicacion= principal.id_almacen_ubicacion) articulos
				from(
				select   
					tc_mantic_almacenes.id_almacen id_key,
					tc_mantic_empresas.id_empresa,  
					tc_mantic_empresas.nombre empresa,
					tc_mantic_almacenes_ubicaciones.id_almacen_ubicacion,
					tc_mantic_almacenes.id_almacen,
					tc_mantic_almacenes.nombre almacen,
					tc_mantic_almacenes_ubicaciones.descripcion,
					tc_mantic_almacenes_ubicaciones.piso,					
					tc_mantic_almacenes.registro
				from 
					tc_mantic_almacenes
				inner join 
					tc_mantic_empresas on tc_mantic_almacenes.id_empresa = tc_mantic_empresas.id_empresa
				inner join 
					tc_mantic_almacenes_ubicaciones on tc_mantic_almacenes.id_almacen = tc_mantic_almacenes_ubicaciones.id_almacen
				where 
					tc_mantic_empresas.id_empresa in ({idEmpresa})
				and 
					tc_mantic_almacenes.id_almacen= {idAlmacen} and tc_mantic_almacenes.id_almacen is not null and tc_mantic_almacenes.id_almacen!= ''
				and 
					tc_mantic_almacenes_ubicaciones.piso is not null and tc_mantic_almacenes_ubicaciones.piso!= ''
				and 
					tc_mantic_almacenes_ubicaciones.nivel=1
				group by   
					tc_mantic_empresas.id_empresa,
					tc_mantic_empresas.nombre,
					tc_mantic_almacenes_ubicaciones.id_almacen_ubicacion,
					tc_mantic_almacenes_ubicaciones.descripcion,
					tc_mantic_almacenes_ubicaciones.piso,					
					tc_mantic_empresas.registro
				order by 
					tc_mantic_almacenes_ubicaciones.piso) principal
			</select>
			<select id="ubicacionCuarto">
				select 
					principal.*,
					(select count(*) articulos from tc_mantic_almacenes_articulos where id_almacen_ubicacion= principal.id_almacen_ubicacion) articulos
				from(
				select   
					tc_mantic_almacenes.id_almacen id_key,
					tc_mantic_empresas.id_empresa,  
					tc_mantic_empresas.nombre empresa,
					tc_mantic_almacenes_ubicaciones.id_almacen_ubicacion,
					tc_mantic_almacenes.id_almacen,
					tc_mantic_almacenes.nombre almacen,
					tc_mantic_almacenes_ubicaciones.descripcion,
					tc_mantic_almacenes_ubicaciones.piso,
					tc_mantic_almacenes_ubicaciones.cuarto,					
					tc_mantic_almacenes.registro
				from 
					tc_mantic_almacenes
				inner join 
					tc_mantic_empresas on tc_mantic_almacenes.id_empresa = tc_mantic_empresas.id_empresa
				inner join 
					tc_mantic_almacenes_ubicaciones on tc_mantic_almacenes.id_almacen = tc_mantic_almacenes_ubicaciones.id_almacen
				where 
					tc_mantic_empresas.id_empresa in ({idEmpresa})
				and 
					tc_mantic_almacenes.id_almacen= {idAlmacen} and tc_mantic_almacenes.id_almacen is not null and tc_mantic_almacenes.id_almacen!= ''
				and 
					tc_mantic_almacenes_ubicaciones.piso= '{piso}' and tc_mantic_almacenes_ubicaciones.piso is not null and tc_mantic_almacenes_ubicaciones.piso != ''
				and 
					tc_mantic_almacenes_ubicaciones.cuarto is not null and tc_mantic_almacenes_ubicaciones.cuarto != ''				
				and 
					tc_mantic_almacenes_ubicaciones.nivel=2
				group by   
					tc_mantic_empresas.id_empresa,
					tc_mantic_empresas.nombre,
					tc_mantic_almacenes_ubicaciones.id_almacen_ubicacion,
					tc_mantic_almacenes_ubicaciones.descripcion,
					tc_mantic_almacenes_ubicaciones.piso,
					tc_mantic_almacenes_ubicaciones.cuarto,					
					tc_mantic_empresas.registro
				order by
					tc_mantic_almacenes_ubicaciones.piso,
					tc_mantic_almacenes_ubicaciones.cuarto) principal
			</select>
			<select id="ubicacionAnaquel">
				select 
					principal.*,
					(select count(*) articulos from tc_mantic_almacenes_articulos where id_almacen_ubicacion= principal.id_almacen_ubicacion) articulos
				from(
				select   
					tc_mantic_almacenes.id_almacen id_key,
					tc_mantic_empresas.id_empresa,  
					tc_mantic_empresas.nombre empresa,
					tc_mantic_almacenes.id_almacen,
					tc_mantic_almacenes.nombre almacen,
					tc_mantic_almacenes_ubicaciones.id_almacen_ubicacion,
					tc_mantic_almacenes_ubicaciones.descripcion,
					tc_mantic_almacenes_ubicaciones.piso,
					tc_mantic_almacenes_ubicaciones.cuarto,
					tc_mantic_almacenes_ubicaciones.anaquel,					
					tc_mantic_almacenes.registro
				from 
					tc_mantic_almacenes
				inner join 
					tc_mantic_empresas on tc_mantic_almacenes.id_empresa = tc_mantic_empresas.id_empresa
				inner join 
					tc_mantic_almacenes_ubicaciones on tc_mantic_almacenes.id_almacen = tc_mantic_almacenes_ubicaciones.id_almacen
				where 
					tc_mantic_empresas.id_empresa in ({idEmpresa})
				and 
					tc_mantic_almacenes.id_almacen= {idAlmacen} and tc_mantic_almacenes.id_almacen is not null and tc_mantic_almacenes.id_almacen!= ''
				and 
					tc_mantic_almacenes_ubicaciones.piso= '{piso}' and tc_mantic_almacenes_ubicaciones.piso is not null and tc_mantic_almacenes_ubicaciones.piso != ''
				and 
					tc_mantic_almacenes_ubicaciones.cuarto= '{cuarto}' and tc_mantic_almacenes_ubicaciones.cuarto is not null and tc_mantic_almacenes_ubicaciones.cuarto != ''
				and 
					tc_mantic_almacenes_ubicaciones.anaquel is not null and tc_mantic_almacenes_ubicaciones.anaquel != ''				
				and 
					tc_mantic_almacenes_ubicaciones.nivel=3
				group by   
					tc_mantic_empresas.id_empresa,
					tc_mantic_empresas.nombre,
					tc_mantic_almacenes_ubicaciones.id_almacen_ubicacion,
					tc_mantic_almacenes_ubicaciones.descripcion,
					tc_mantic_almacenes_ubicaciones.piso,
					tc_mantic_almacenes_ubicaciones.cuarto,
					tc_mantic_almacenes_ubicaciones.anaquel,					
					tc_mantic_empresas.registro
				order by
					tc_mantic_almacenes_ubicaciones.piso,
					tc_mantic_almacenes_ubicaciones.cuarto,
					tc_mantic_almacenes_ubicaciones.anaquel) principal
			</select>
			<select id="ubicacionCharola">
				select 
					principal.*,
					(select count(*) articulos from tc_mantic_almacenes_articulos where id_almacen_ubicacion= principal.id_almacen_ubicacion) articulos
				from(
				select   
					tc_mantic_almacenes.id_almacen id_key,
					tc_mantic_empresas.id_empresa,  
					tc_mantic_empresas.nombre empresa,
					tc_mantic_almacenes.id_almacen,
					tc_mantic_almacenes.nombre almacen,
					tc_mantic_almacenes_ubicaciones.id_almacen_ubicacion,
					tc_mantic_almacenes_ubicaciones.descripcion,
					tc_mantic_almacenes_ubicaciones.piso,
					tc_mantic_almacenes_ubicaciones.cuarto,
					tc_mantic_almacenes_ubicaciones.anaquel,
					tc_mantic_almacenes_ubicaciones.charola,					
					tc_mantic_almacenes.registro					
				from 
					tc_mantic_almacenes
				inner join 
					tc_mantic_empresas on tc_mantic_almacenes.id_empresa = tc_mantic_empresas.id_empresa
				inner join 
					tc_mantic_almacenes_ubicaciones on tc_mantic_almacenes.id_almacen = tc_mantic_almacenes_ubicaciones.id_almacen
				where 
					tc_mantic_empresas.id_empresa in ({idEmpresa})
				and 
					tc_mantic_almacenes.id_almacen= {idAlmacen} and tc_mantic_almacenes.id_almacen is not null and tc_mantic_almacenes.id_almacen!= ''
				and 
					tc_mantic_almacenes_ubicaciones.piso= '{piso}' and tc_mantic_almacenes_ubicaciones.piso is not null and tc_mantic_almacenes_ubicaciones.piso != ''
				and 
					tc_mantic_almacenes_ubicaciones.cuarto= '{cuarto}' and tc_mantic_almacenes_ubicaciones.cuarto is not null and tc_mantic_almacenes_ubicaciones.cuarto != ''
				and 
					tc_mantic_almacenes_ubicaciones.anaquel= '{anaquel}' and tc_mantic_almacenes_ubicaciones.anaquel is not null and tc_mantic_almacenes_ubicaciones.anaquel != ''
				and 
					tc_mantic_almacenes_ubicaciones.charola is not null and tc_mantic_almacenes_ubicaciones.charola != ''
				and 
					tc_mantic_almacenes_ubicaciones.nivel=4
				group by   
					tc_mantic_empresas.id_empresa,
					tc_mantic_empresas.nombre,
					tc_mantic_almacenes_ubicaciones.id_almacen_ubicacion,
					tc_mantic_almacenes_ubicaciones.descripcion,
					tc_mantic_almacenes_ubicaciones.piso,
					tc_mantic_almacenes_ubicaciones.cuarto,
					tc_mantic_almacenes_ubicaciones.anaquel,
					tc_mantic_almacenes_ubicaciones.charola,					
					tc_mantic_empresas.registro
				order by 
					tc_mantic_almacenes_ubicaciones.piso,
					tc_mantic_almacenes_ubicaciones.cuarto,
					tc_mantic_almacenes_ubicaciones.anaquel,
					tc_mantic_almacenes_ubicaciones.charola) principal
			</select>
			<select id="ubicacionesNivel">				
				select   
					tc_mantic_almacenes_ubicaciones.id_almacen_ubicacion id_key,
					tc_mantic_almacenes.id_almacen ,
					tc_mantic_empresas.id_empresa,  
					tc_mantic_empresas.nombre empresa,					
					tc_mantic_almacenes.nombre almacen,					
					tc_mantic_almacenes_ubicaciones.descripcion,
					if(tc_mantic_almacenes_ubicaciones.piso is null, '', tc_mantic_almacenes_ubicaciones.piso) piso,
					if(tc_mantic_almacenes_ubicaciones.cuarto is null, '', tc_mantic_almacenes_ubicaciones.cuarto) cuarto,
					if(tc_mantic_almacenes_ubicaciones.anaquel is null, '', tc_mantic_almacenes_ubicaciones.anaquel) anaquel,
					if(tc_mantic_almacenes_ubicaciones.charola is null, '', tc_mantic_almacenes_ubicaciones.charola) charola,					
					tc_mantic_almacenes.registro					
				from 
					tc_mantic_almacenes
				inner join 
					tc_mantic_empresas on tc_mantic_almacenes.id_empresa = tc_mantic_empresas.id_empresa
				inner join 
					tc_mantic_almacenes_ubicaciones on tc_mantic_almacenes.id_almacen = tc_mantic_almacenes_ubicaciones.id_almacen
				where 					
					tc_mantic_almacenes.id_empresa in ({sucursales})
				and 
					tc_mantic_almacenes_ubicaciones.nivel= {nivel}				
				and 
					tc_mantic_almacenes.id_almacen= {idAlmacen}				
				order by 
					tc_mantic_almacenes_ubicaciones.piso,
					tc_mantic_almacenes_ubicaciones.cuarto,
					tc_mantic_almacenes_ubicaciones.anaquel,
					tc_mantic_almacenes_ubicaciones.charola
			</select>
		</unit>
    <unit id="VistaCorteCierreCajaDto">
      <select id="resumenCorte">
        select distinct
          tc_mantic_cierres.id_cierre,
          tc_mantic_cierres.consecutivo,
          tc_mantic_cierres.termino,
          tc_mantic_cierres.registro,
          tc_mantic_empresas.id_empresa,
          tc_mantic_empresas.clave as empresa,
          tc_mantic_empresas.nombre as nombre_empresa,  
          tc_mantic_cajas.clave as caja,
          tc_mantic_cajas.id_caja,
          concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) as nombre_completo_cajero,
          tc_mantic_cajas.limite, ifnull(min(tc_mantic_ventas.cticket),0) as ticket_inicial,  
          ifnull(max(tc_mantic_ventas.cticket),0) as ticket_final, 
          ifnull(devoluciones_garantias.garantia_inicial,0) as garantia_inicial, 
          ifnull(devoluciones_garantias.garantia_final,0) as garantia_final, 
          ifnull(devoluciones_garantias.total_garantias,0) as total_garantias,
          ifnull(devoluciones_garantias.sub_total_garantias,0) as sub_total_garantias,
          ifnull(devoluciones_garantias.impuetos_garantias,0) as impuetos_garantias,
          ifnull(pagos_ventas.resumen_efectivo,0) as resumen_efectivo,
          ifnull(pagos_ventas.resumen_cheque,0) as resumen_cheque,
          ifnull(pagos_ventas.resumen_transferencia,0) as resumen_transferencia,
          ifnull((pagos_ventas.resumen_credito+pagos_ventas.resumen_debito),0) as resumen_tarjetas,
          ifnull(pagos_ventas.resumen_credito,0) as resumen_credito,
          ifnull(pagos_ventas.resumen_vales,0) as resumen_vales,
          ifnull(pagos_ventas.resumen_debito,0) as resumen_debito, 
          ifnull(pagos_ventas.resumen_total,0) as resumen_total, 
          (ifnull(pagos_ventas.resumen_total,0)- ifnull(devoluciones_garantias.total_garantias,0)) as total_sin_devoluciones,
          ifnull(pagos_ventas.resumen_efectivo_credito,0) as resumen_efectivo_credito,
          ifnull(pagos_ventas.resumen_cheque_credito,0) as resumen_cheque_credito,
          ifnull(pagos_ventas.resumen_transferencia_credito,0) as resumen_transferencia_credito,
          ifnull(pagos_ventas.resumen_credito_credito,0) as resumen_credito_credito,
          ifnull(pagos_ventas.resumen_vales_credito,0) as resumen_vales_credito,
          ifnull(pagos_ventas.resumen_debito_credito,0) as resumen_debito_credito, 
          ifnull(pagos_ventas.resumen_total_credito,0) as resumen_total_credito, 	
          ifnull(abonos.resumen_abonos,0) as resumen_abonos,
          ifnull(abonos.abono_inicial,0) as abono_inicial, 
          ifnull(abonos.abono_final,0) as abono_final, 
          ifnull(retiros.resumen_retiros,0) as resumen_retiros,
          ifnull(retiros.retiro_inicial,0) as retiro_inicial, 
          ifnull(retiros.retiro_final,0) as retiro_final, 
          ifnull(cierres_monedas.fondo_inicial,0) as fondo_inicial,
          ifnull(cierres_monedas.fondo_efectivo_final,0) as fondo_efectivo_final
        from
          tc_mantic_cierres
        inner join
          tc_mantic_cierres_cajas on tc_mantic_cierres.id_cierre= tc_mantic_cierres_cajas.id_cierre	
        left join 
          (select distinct
            tr_mantic_venta_medio_pago.id_cierre, 
            sum(case when tr_mantic_venta_medio_pago.id_tipo_medio_pago = 1 then tr_mantic_venta_medio_pago.total else 0 end) resumen_efectivo,
            sum(case when tr_mantic_venta_medio_pago.id_tipo_medio_pago = 2 then tr_mantic_venta_medio_pago.total else 0 end) resumen_cheque,
            sum(case when tr_mantic_venta_medio_pago.id_tipo_medio_pago = 3 then tr_mantic_venta_medio_pago.total else 0 end) resumen_transferencia,
            sum(case when tr_mantic_venta_medio_pago.id_tipo_medio_pago = 4 then tr_mantic_venta_medio_pago.total else 0 end) resumen_credito,
            sum(case when tr_mantic_venta_medio_pago.id_tipo_medio_pago = 7 then tr_mantic_venta_medio_pago.total else 0 end) resumen_vales,
            sum(case when tr_mantic_venta_medio_pago.id_tipo_medio_pago = 18 then tr_mantic_venta_medio_pago.total else 0 end) resumen_debito,
            sum(case when tr_mantic_venta_medio_pago.id_tipo_medio_pago in (1,2,3,4,7,18) then tr_mantic_venta_medio_pago.total else 0 end) resumen_total,
            sum(case when tr_mantic_venta_medio_pago.id_tipo_medio_pago = 1 and tc_mantic_ventas.id_credito = 1  then tr_mantic_venta_medio_pago.total else 0 end) resumen_efectivo_credito,
            sum(case when tr_mantic_venta_medio_pago.id_tipo_medio_pago = 2 and tc_mantic_ventas.id_credito = 1 then tr_mantic_venta_medio_pago.total else 0 end) resumen_cheque_credito,
            sum(case when tr_mantic_venta_medio_pago.id_tipo_medio_pago = 3 and tc_mantic_ventas.id_credito = 1 then tr_mantic_venta_medio_pago.total else 0 end) resumen_transferencia_credito,
            sum(case when tr_mantic_venta_medio_pago.id_tipo_medio_pago = 4 and tc_mantic_ventas.id_credito = 1 then tr_mantic_venta_medio_pago.total else 0 end) resumen_credito_credito,
            sum(case when tr_mantic_venta_medio_pago.id_tipo_medio_pago = 7 and tc_mantic_ventas.id_credito = 1 then tr_mantic_venta_medio_pago.total else 0 end) resumen_vales_credito,
            sum(case when tr_mantic_venta_medio_pago.id_tipo_medio_pago = 18 and tc_mantic_ventas.id_credito = 1 then tr_mantic_venta_medio_pago.total else 0 end) resumen_debito_credito,
            sum(case when tr_mantic_venta_medio_pago.id_tipo_medio_pago in (1,2,3,4,7,18) and tc_mantic_ventas.id_credito = 1  then tr_mantic_venta_medio_pago.total else 0 end) resumen_total_credito
          from 
            tr_mantic_venta_medio_pago
          inner join 
            tc_mantic_ventas on tr_mantic_venta_medio_pago.id_venta =  tc_mantic_ventas.id_venta where tr_mantic_venta_medio_pago.id_cierre={idCierre}) pagos_ventas on tc_mantic_cierres.id_cierre = pagos_ventas.id_cierre
        inner join
          tc_mantic_cajas on tc_mantic_cierres_cajas.id_caja= tc_mantic_cajas.id_caja
        inner join
          tc_mantic_personas on tc_mantic_cajas.id_usuario = tc_mantic_personas.id_persona 
        left join 
          tr_mantic_venta_medio_pago on tc_mantic_cierres_cajas.id_cierre= tr_mantic_venta_medio_pago.id_cierre
        left join 
          tc_mantic_ventas on tr_mantic_venta_medio_pago.id_venta = tc_mantic_ventas.id_venta and tc_mantic_ventas.id_venta_estatus in (3,6)
        inner join
          tc_mantic_empresas on tc_mantic_cajas.id_empresa= tc_mantic_empresas.id_empresa
        left join 
          (select 
				    id_cierre, min(garantias.consecutivo) garantia_inicial, max(garantias.consecutivo) as garantia_final, 
            sum(case when garantias.total &gt; 0 and garantias.id_garantia_estatus = 6  then garantias.total else 0 end) as total_garantias,
            sum(case when garantias.sub_total &gt; 0 and garantias.id_garantia_estatus = 6  then garantias.sub_total else 0 end) as sub_total_garantias,
            sum(case when garantias.impuestos &gt; 0 and garantias.id_garantia_estatus = 6 then garantias.impuestos else 0 end) as impuetos_garantias
			    from (
           select 
            distinct tc_mantic_garantias.*, 
            pagos_venta.id_cierre
       	  from 
					  tc_mantic_garantias
				  inner join 
				    tc_mantic_garantias_detalles on tc_mantic_garantias.id_garantia= tc_mantic_garantias_detalles.id_garantia
				  inner join 
				    tc_mantic_ventas_detalles on tc_mantic_garantias_detalles.id_venta_detalle= tc_mantic_ventas_detalles.id_venta_detalle
				  inner join 
	          tc_mantic_ventas ventas_garantias on tc_mantic_garantias.id_venta = ventas_garantias.id_venta
	        inner join 
	          tr_mantic_venta_medio_pago pagos_venta on ventas_garantias.id_venta = pagos_venta.id_venta
	      	inner join
					tc_mantic_cierres on tc_mantic_cierres.id_cierre= pagos_venta.id_cierre
				where 
					pagos_venta.id_cierre = {idCierre} and tc_mantic_garantias.id_garantia_estatus = 6
					and tc_mantic_garantias_detalles.cantidad &gt; 0	
					and (tc_mantic_ventas_detalles.registro between tc_mantic_cierres.registro and tc_mantic_cierres.termino)
			  order by
				  tc_mantic_garantias.consecutivo, tc_mantic_ventas_detalles.codigo) garantias) devoluciones_garantias on tc_mantic_cierres.id_cierre = devoluciones_garantias.id_cierre
        left join (
          select 
            tc_mantic_cierres_monedas.id_cierre,
            sum(case when tc_mantic_cierres_monedas.id_efectivo = 2 then tc_mantic_cierres_monedas.importe else 0 end) as fondo_inicial,
            sum(case when tc_mantic_cierres_monedas.id_efectivo = 1 then tc_mantic_cierres_monedas.importe else 0 end) as fondo_efectivo_final
          from 
            tc_mantic_cierres_monedas) as cierres_monedas on tc_mantic_cierres.id_cierre = cierres_monedas.id_cierre
        left join (
          select 
            distinct tc_mantic_cierres_cajas.id_cierre,min(tc_mantic_cierres_retiros.consecutivo) abono_inicial, max(tc_mantic_cierres_retiros.consecutivo) as abono_final, 
            sum(case when tc_mantic_cierres_retiros.id_abono= 1  then tc_mantic_cierres_retiros.importe else 0 end) as resumen_abonos
          from
            tc_mantic_cierres_cajas 
          inner join
            tc_mantic_cierres_retiros on tc_mantic_cierres_cajas.id_cierre_caja= tc_mantic_cierres_retiros.id_cierre_caja where tc_mantic_cierres_retiros.id_abono= 1 and tc_mantic_cierres_cajas.id_cierre={idCierre}) abonos on tc_mantic_cierres.id_cierre = abonos.id_cierre
        left join (
          select 
            distinct tc_mantic_cierres_cajas.id_cierre,min(tc_mantic_cierres_retiros.consecutivo) retiro_inicial, max(tc_mantic_cierres_retiros.consecutivo) retiro_final, 
            sum(case when tc_mantic_cierres_retiros.id_abono= 2  then tc_mantic_cierres_retiros.importe else 0 end) resumen_retiros
          from
            tc_mantic_cierres_cajas 
          inner join
            tc_mantic_cierres_retiros on tc_mantic_cierres_cajas.id_cierre_caja= tc_mantic_cierres_retiros.id_cierre_caja where tc_mantic_cierres_retiros.id_abono= 2 and tc_mantic_cierres_cajas.id_cierre={idCierre}) retiros on tc_mantic_cierres.id_cierre = retiros.id_cierre
        where
          tc_mantic_cierres.id_cierre = {idCierre}
  		</select>
      <select id="garantias">
        select distinct
         	tc_mantic_garantias.*, pagos_venta.id_cierre
       	from 
					tc_mantic_garantias
				inner join 
				  tc_mantic_garantias_detalles on tc_mantic_garantias.id_garantia= tc_mantic_garantias_detalles.id_garantia
				inner join 
				  tc_mantic_ventas_detalles on tc_mantic_garantias_detalles.id_venta_detalle= tc_mantic_ventas_detalles.id_venta_detalle
				inner join 
	          tc_mantic_ventas ventas_garantias on tc_mantic_garantias.id_venta = ventas_garantias.id_venta
	        inner join 
	          tr_mantic_venta_medio_pago pagos_venta  on ventas_garantias.id_venta = pagos_venta.id_venta
	      	inner join
					tc_mantic_cierres on tc_mantic_cierres.id_cierre= pagos_venta.id_cierre
				where 
					pagos_venta.id_cierre = {idCierre} and tc_mantic_garantias.id_garantia_estatus = 6
					and tc_mantic_garantias_detalles.cantidad> 0	and tc_mantic_garantias.id_efectivo = 2
					and 
					(tc_mantic_ventas_detalles.registro between tc_mantic_cierres.registro and tc_mantic_cierres.termino)
					order by
				  tc_mantic_garantias.consecutivo, tc_mantic_ventas_detalles.codigo
      </select>
      <select id="abonosCaja">
        select distinct
					tc_mantic_cierres_retiros.id_cierre_retiro as id_key,
					tc_mantic_cierres.id_cierre,
					tc_mantic_cajas.clave as caja,
					tc_mantic_cierres_retiros.consecutivo,
					tc_mantic_cierres_retiros.id_abono,
					concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) as usuario,
          tc_mantic_personas.cuenta,
					tc_mantic_tipos_medios_pagos.nombre as medio,
				  tc_mantic_cierres_retiros.concepto,
					tc_mantic_cierres_retiros.importe,
					tc_mantic_cierres_retiros.observaciones,
					tc_mantic_tipos_medios_pagos.id_tipo_medio_pago,
					tc_mantic_tipos_medios_pagos.nombre as moneda
				from
					tc_mantic_cierres
				inner join
					tc_mantic_cierres_cajas on tc_mantic_cierres.id_cierre= tc_mantic_cierres_cajas.id_cierre
				inner join
					tc_mantic_cajas on tc_mantic_cierres_cajas.id_caja= tc_mantic_cajas.id_caja
				inner join
					tc_mantic_empresas on tc_mantic_cajas.id_empresa= tc_mantic_empresas.id_empresa
				inner join
					tc_mantic_cierres_retiros on tc_mantic_cierres_cajas.id_cierre_caja= tc_mantic_cierres_retiros.id_cierre_caja
				inner join
					tc_mantic_tipos_medios_pagos on tc_mantic_cierres_retiros.id_tipo_medio_pago= tc_mantic_tipos_medios_pagos.id_tipo_medio_pago
				inner join
					tc_janal_usuarios on tc_mantic_cierres_retiros.id_usuario= tc_janal_usuarios.id_usuario
				inner join
					tc_mantic_personas on tc_janal_usuarios.id_persona= tc_mantic_personas.id_persona
				where
				  tc_mantic_cierres.id_cierre= {idCierre} and tc_mantic_cierres_retiros.id_abono= 1
      </select>
      <select id="retirosCaja">
        select distinct
					tc_mantic_cierres_retiros.id_cierre_retiro as id_key,
					tc_mantic_cierres.id_cierre,
					tc_mantic_cajas.clave as caja,
					tc_mantic_cierres_retiros.consecutivo,
					tc_mantic_cierres_retiros.id_abono,
					concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) as usuario,
          tc_mantic_personas.cuenta,
					tc_mantic_tipos_medios_pagos.nombre as medio,
				  tc_mantic_cierres_retiros.concepto,
					tc_mantic_cierres_retiros.importe,
					tc_mantic_cierres_retiros.observaciones,
					tc_mantic_tipos_medios_pagos.id_tipo_medio_pago,
					tc_mantic_tipos_medios_pagos.nombre as moneda
				from
					tc_mantic_cierres
				inner join
					tc_mantic_cierres_cajas on tc_mantic_cierres.id_cierre= tc_mantic_cierres_cajas.id_cierre
				inner join
					tc_mantic_cajas on tc_mantic_cierres_cajas.id_caja= tc_mantic_cajas.id_caja
				inner join
					tc_mantic_empresas on tc_mantic_cajas.id_empresa= tc_mantic_empresas.id_empresa
				inner join
					tc_mantic_cierres_retiros on tc_mantic_cierres_cajas.id_cierre_caja= tc_mantic_cierres_retiros.id_cierre_caja
				inner join
					tc_mantic_tipos_medios_pagos on tc_mantic_cierres_retiros.id_tipo_medio_pago= tc_mantic_tipos_medios_pagos.id_tipo_medio_pago
				inner join
					tc_janal_usuarios on tc_mantic_cierres_retiros.id_usuario= tc_janal_usuarios.id_usuario
				inner join
					tc_mantic_personas on tc_janal_usuarios.id_persona= tc_mantic_personas.id_persona
				where
				  tc_mantic_cierres.id_cierre= {idCierre} and tc_mantic_cierres_retiros.id_abono= 2
      </select>
      <select id="efectivoFinal">
        select distinct
				  tc_mantic_monedas.nombre, 
				  tc_mantic_monedas.denominacion, tc_mantic_cierres_monedas.cantidad, tc_mantic_cierres_monedas.importe, tc_mantic_cierres_monedas.id_efectivo
  			from 
				  tc_mantic_cierres_monedas 
				inner join 
				  tc_mantic_monedas on tc_mantic_cierres_monedas.id_moneda= tc_mantic_monedas.id_moneda 
				where 
				  tc_mantic_cierres_monedas.id_cierre= {idCierre} and id_efectivo = 1
				order by 
				  tc_mantic_monedas.orden
      </select>
      <select id="fondoInicial">
        select distinct
				  tc_mantic_monedas.nombre, 
				  tc_mantic_monedas.denominacion, tc_mantic_cierres_monedas.cantidad, tc_mantic_cierres_monedas.importe, tc_mantic_cierres_monedas.id_efectivo
  			from 
				  tc_mantic_cierres_monedas 
				inner join 
				  tc_mantic_monedas on tc_mantic_cierres_monedas.id_moneda= tc_mantic_monedas.id_moneda 
				where 
				  tc_mantic_cierres_monedas.id_cierre= {idCierre} and id_efectivo = 2
				order by 
				  tc_mantic_monedas.orden
      </select>
      <select id="aperturaCaja">
        select distinct
				  tc_mantic_monedas.nombre, 
				  tc_mantic_monedas.denominacion, tc_mantic_cierres_monedas.cantidad, tc_mantic_cierres_monedas.importe, tc_mantic_cierres_monedas.id_efectivo
  			from 
				  tc_mantic_cierres_monedas 
				inner join 
				  tc_mantic_monedas on tc_mantic_cierres_monedas.id_moneda= tc_mantic_monedas.id_moneda 
				where 
				  tc_mantic_cierres_monedas.id_cierre= {idCierreNuevo} and id_efectivo = 2
				order by 
				  tc_mantic_monedas.orden
      </select>
      <select id="cajerosCierre">
        select distinct
          concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) as nombre_completo_cajero
        from 
          tc_mantic_ventas  
        inner join 
          tr_mantic_venta_medio_pago on tc_mantic_ventas.id_venta = tr_mantic_venta_medio_pago.id_venta
        inner join
          tc_janal_usuarios on tr_mantic_venta_medio_pago.id_usuario = tc_janal_usuarios.id_usuario      
        inner join
          tc_mantic_personas on tc_janal_usuarios.id_persona = tc_mantic_personas.id_persona
        where 
          tr_mantic_venta_medio_pago.id_cierre = {idCierre} 
          and tc_mantic_ventas.id_venta_estatus= 3
        group by
          tr_mantic_venta_medio_pago.id_usuario  
        order by
          concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno)
      </select>
      <select id="diferenciaVsCapturado">
        select distinct 
          tc_mantic_cierres_cajas.*, 
          tc_mantic_tipos_medios_pagos.clave,
          tc_mantic_tipos_medios_pagos.nombre,
          ifnull(tc_mantic_cierres_cajas.saldo - tc_mantic_cierres_cajas.importe, 0) diferencia_capturado
        from 
          tc_mantic_cierres_cajas
        inner join
          tc_mantic_tipos_medios_pagos on tc_mantic_cierres_cajas.id_tipo_medio_pago = tc_mantic_tipos_medios_pagos.id_tipo_medio_pago 
        where id_cierre = {idCierre}
      </select>
		</unit>
		<unit id="VistaTcManticClientesPagosDto">
			<select id="siguiente">
        select
					max(tc_mantic_clientes_pagos.orden)+ 1 as siguiente
				from 
					tc_mantic_clientes_pagos
				inner join 
					tc_mantic_clientes_deudas on tc_mantic_clientes_pagos.id_cliente_deuda = tc_mantic_clientes_deudas.id_cliente_deuda
				inner join 
					tc_mantic_clientes on tc_mantic_clientes_deudas.id_cliente = tc_mantic_clientes.id_cliente
				where
				  tc_mantic_clientes.id_empresa= {idEmpresa}
				  and tc_mantic_clientes_pagos.ejercicio= {ejercicio} 
			    and tc_mantic_clientes_pagos.orden{operador} 900000
			</select>		
		</unit>
		<unit id="VistaTcManticEmpresasPagosDto">
			<select id="siguiente">
        select
					max(tc_mantic_empresas_pagos.orden)+ 1 as siguiente
				from 
					tc_mantic_empresas_pagos
				inner join 
					tc_mantic_empresas_deudas on tc_mantic_empresas_pagos.id_empresa_deuda = tc_mantic_empresas_deudas.id_empresa_deuda				
				where
				  tc_mantic_empresas_deudas.id_empresa= {idEmpresa}
				  and tc_mantic_empresas_pagos.ejercicio= {ejercicio} 
          and tc_mantic_empresas_pagos.orden{operador} 900000
			</select>		
		</unit>
		<unit id="VistaEmpaquesUnidadesDto">
			<select id="row">
				select 
					tr_mantic_empaque_unidad_medida.id_empaque_unidad_medida as id_key,
					tr_mantic_empaque_unidad_medida.id_empaque,
					tr_mantic_empaque_unidad_medida.id_unidad_medida, 
					tr_mantic_empaque_unidad_medida.observaciones,
					tr_mantic_empaque_unidad_medida.id_usuario,
					tr_mantic_empaque_unidad_medida.registro,
					tc_mantic_empaques.clave as clave_empaque,
					tc_mantic_empaques.nombre as empaque,
					tc_mantic_empaques.descripcion as descripcion_empaque,
					tc_mantic_unidades_medidas.clave as clave_unidad,
					tc_mantic_unidades_medidas.nombre as unidad,
					tc_mantic_unidades_medidas.descripcion as clave_descripcion,
					tc_mantic_unidades_medidas.proporcion
				from 
					tr_mantic_empaque_unidad_medida
				inner join 
					tc_mantic_empaques on tr_mantic_empaque_unidad_medida.id_empaque = tc_mantic_empaques.id_empaque
				inner join
					tc_mantic_unidades_medidas on tr_mantic_empaque_unidad_medida.id_unidad_medida= tc_mantic_unidades_medidas.id_unidad_medida
				where 
					{condicion}
				order by 
					tc_mantic_empaques.nombre, tc_mantic_unidades_medidas.proporcion
			</select>
		</unit>
		<unit id="VistaEchartsDemostracionDto">
			<select id="multiple">
				select
					tc_mantic_empresas.nombre as category,
					dayname(tc_mantic_ventas.registro) as serie,
					sum(tc_mantic_ventas.total) as value
				from
					tc_mantic_ventas
				inner join 
					tc_mantic_empresas on tc_mantic_ventas.id_empresa= tc_mantic_empresas.id_empresa
				group by
					tc_mantic_empresas.nombre,
					dayname(tc_mantic_ventas.registro)			
			</select>
			<select id="simple">
				select
					dayname(tc_mantic_ventas.registro) as serie,
					sum(tc_mantic_ventas.total) as value
				from
					tc_mantic_ventas
				inner join 
					tc_mantic_empresas on tc_mantic_ventas.id_empresa= tc_mantic_empresas.id_empresa
				group by
					dayname(tc_mantic_ventas.registro) 				
			</select>
			<select id="clean">
				select
					tc_mantic_articulos_codigos.id_articulo_codigo as id_key,			
					tc_mantic_articulos_codigos.*
				from
					tc_mantic_articulos_codigos
				where
					tc_mantic_articulos_codigos.id_articulo= {idArticulo}
					and tc_mantic_articulos_codigos.codigo= '{codigo}'
					and tc_mantic_articulos_codigos.id_proveedor is null
				order by
					tc_mantic_articulos_codigos.id_principal				
			</select>
		</unit>
		<unit id="VistaIncidentesDto">
			<select id="principal">
				select 
					tc_mantic_incidentes.id_incidente as id_key,
					tc_mantic_incidentes.consecutivo,
					tc_mantic_incidentes.id_persona, 
					tc_mantic_incidentes.id_tipo_incidente, 
					tc_mantic_incidentes.vigencia_inicio,
					tc_mantic_incidentes.vigencia_fin,
					tc_mantic_incidentes.ejercicio,
					tc_mantic_incidentes.orden,
					tc_mantic_incidentes.id_incidente_estatus,
					tc_mantic_incidentes.observaciones,
					tc_mantic_incidentes.id_usuario,
					tc_mantic_incidentes.registro,	
					concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) nombre,
					concat(persona_usuario.nombres, ' ', persona_usuario.paterno, ' ', persona_usuario.materno) nombre_usuario,
					tc_mantic_tipos_incidentes.nombre tipo_incidente,
					tc_mantic_incidentes_estatus.nombre estatus,
					tc_mantic_incidentes_estatus.estatus_asociados,
					tc_mantic_puestos.nombre puesto
				from 
					tc_mantic_incidentes
				inner join 
					tc_mantic_personas on tc_mantic_incidentes.id_persona = tc_mantic_personas.id_persona
				inner join
					tr_mantic_empresa_personal on tc_mantic_personas.id_persona = tr_mantic_empresa_personal.id_persona
				inner join 
					tc_mantic_puestos on tr_mantic_empresa_personal.id_puesto = tc_mantic_puestos.id_puesto
				inner join 
					tc_mantic_tipos_incidentes on tc_mantic_incidentes.id_tipo_incidente = tc_mantic_tipos_incidentes.id_tipo_incidente
				inner join 
					tc_mantic_incidentes_estatus on tc_mantic_incidentes_estatus.id_incidente_estatus = tc_mantic_incidentes.id_incidente_estatus
				inner join 
					tc_janal_usuarios on tc_mantic_incidentes.id_usuario = tc_janal_usuarios.id_usuario
				inner join 
					tc_mantic_personas persona_usuario on tc_janal_usuarios.id_persona = persona_usuario.id_persona
				where 
					{condicion}
				  and tr_mantic_empresa_personal.id_empresa in ({idEmpresa})
          and tr_mantic_empresa_personal.id_activo= 1
				{sortOrder}
			</select>
			<select id="ordenes">
				select 
					tc_mantic_incidentes.id_incidente as id_key,					
					tc_mantic_incidentes.orden
				from 
					tc_mantic_incidentes
				inner join 
					tc_mantic_personas on tc_mantic_incidentes.id_persona = tc_mantic_personas.id_persona
				inner join
					tr_mantic_empresa_personal on tc_mantic_personas.id_persona = tr_mantic_empresa_personal.id_persona
				inner join 
					tc_mantic_puestos on tr_mantic_empresa_personal.id_puesto = tc_mantic_puestos.id_puesto
				inner join 
					tc_mantic_tipos_incidentes on tc_mantic_incidentes.id_tipo_incidente = tc_mantic_tipos_incidentes.id_tipo_incidente
				inner join 
					tc_mantic_incidentes_estatus on tc_mantic_incidentes_estatus.id_incidente_estatus = tc_mantic_incidentes.id_incidente_estatus
				inner join 
					tc_janal_usuarios on tc_mantic_incidentes.id_usuario = tc_janal_usuarios.id_usuario
				inner join 
					tc_mantic_personas persona_usuario on tc_janal_usuarios.id_persona = persona_usuario.id_persona
				where 
					tc_mantic_incidentes.orden like '{orden}%'
				  and tr_mantic_empresa_personal.id_empresa in ({idEmpresa})
			</select>
		</unit>
		<unit id="VistaBusquedaArticulosVentasDto">				
			<select id="porNombre">
select 
  tc_mantic_articulos.id_articulo as id_key,
  tc_mantic_articulos.id_articulo,
  (select tc_mantic_articulos_codigos.codigo from tc_mantic_articulos_codigos where tc_mantic_articulos_codigos.id_articulo= tc_mantic_articulos.id_articulo and tc_mantic_articulos_codigos.id_principal= 1 and (upper(tc_mantic_articulos.nombre) regexp '.*{codigo}.*' or tc_mantic_articulos.id_articulo= {idArticulo}) limit 0, 1) as propio,
  (select tc_mantic_articulos_codigos.codigo from tc_mantic_articulos_codigos where tc_mantic_articulos_codigos.id_articulo= tc_mantic_articulos.id_articulo and tc_mantic_articulos_codigos.id_proveedor= {idProveedor} and (upper(tc_mantic_articulos.nombre) regexp '.*{codigo}.*' or tc_mantic_articulos.id_articulo= {idArticulo}) limit 0, 1) as codigo,
  tc_mantic_articulos.fabricante,
  tc_mantic_articulos.nombre,
  '   ' as origen,
  tc_mantic_articulos.descripcion,
  tc_mantic_articulos.precio,
  tc_mantic_articulos.precio as original,
  tc_mantic_articulos.menudeo,
  tc_mantic_articulos.medio_mayoreo,
  tc_mantic_articulos.mayoreo,
  tc_mantic_articulos.{precioCliente} as precio_cliente,
  tc_mantic_articulos.sat,
  tc_mantic_articulos.limite_medio_mayoreo,
  tc_mantic_articulos.limite_mayoreo,
  tc_mantic_articulos.iva,
  tc_mantic_articulos.id_redondear,
  tc_mantic_unidades_medidas.nombre unidad_medida,
  ifnull(tc_mantic_articulos.extra, '0') as morado,
  concat(ifnull(tc_mantic_articulos.descuento, '0'), ',', ifnull(tc_mantic_articulos.extra, '0')) as porcentajes,
  concat(tc_mantic_articulos.id_empresa, '/', ifnull(tc_mantic_imagenes.archivo, 'sin-foto.png')) as archivo,
  if(sum(tc_mantic_almacenes_articulos.stock) is null, 0, sum(tc_mantic_almacenes_articulos.stock)) as stock
from 
  tc_mantic_articulos
inner join 
  tc_mantic_empresas on tc_mantic_articulos.id_empresa = tc_mantic_empresas.id_empresa
inner join
  tr_mantic_empaque_unidad_medida on tc_mantic_articulos.id_empaque_unidad_medida = tr_mantic_empaque_unidad_medida.id_empaque_unidad_medida
inner join 
  tc_mantic_empaques on tr_mantic_empaque_unidad_medida.id_empaque = tc_mantic_empaques.id_empaque
inner join 
  tc_mantic_unidades_medidas on tr_mantic_empaque_unidad_medida.id_unidad_medida = tc_mantic_unidades_medidas.id_unidad_medida
left join
  tc_mantic_imagenes on tc_mantic_articulos.id_imagen= tc_mantic_imagenes.id_imagen
left join
  tc_mantic_almacenes_articulos on tc_mantic_almacenes_articulos.id_articulo= tc_mantic_articulos.id_articulo and tc_mantic_almacenes_articulos.id_almacen= {idAlmacen}
where 
  tc_mantic_empresas.id_empresa in ({sucursales})
  and tc_mantic_articulos.id_articulo_tipo= 1
  and tc_mantic_articulos.id_vigente= 1
  and 
  (upper(tc_mantic_articulos.nombre) regexp '.*{codigo}.*' or tc_mantic_articulos.id_articulo= {idArticulo})
group by
  tc_mantic_articulos.id_articulo
order by   
  tc_mantic_articulos.nombre
			</select>			
			<select id="porCodigo">
select 
  tc_mantic_articulos_codigos.id_articulo_codigo as id_key,
  tc_mantic_articulos.id_articulo,
  (select tc_mantic_articulos_codigos.codigo from tc_mantic_articulos_codigos where tc_mantic_articulos_codigos.id_articulo= tc_mantic_articulos.id_articulo and tc_mantic_articulos_codigos.id_principal= 1 limit 0, 1) as propio,
  (select tc_mantic_articulos_codigos.codigo from tc_mantic_articulos_codigos where tc_mantic_articulos_codigos.id_articulo= tc_mantic_articulos.id_articulo and (tc_mantic_articulos_codigos.id_proveedor= {idProveedor} and tc_mantic_articulos_codigos.id_principal> 1) and ((upper(tc_mantic_articulos_codigos.codigo) like '{codigo}%' and (tc_mantic_articulos_codigos.id_proveedor = {idProveedor} and tc_mantic_articulos_codigos.id_principal> 1)) or tc_mantic_articulos.id_articulo= {idArticulo}) limit 0, 1) as codigo,
  tc_mantic_articulos.fabricante,
  tc_mantic_articulos.nombre,
  ' ' as origen,
  tc_mantic_articulos.descripcion,
  tc_mantic_articulos.precio,
  tc_mantic_articulos.precio as original,
  tc_mantic_articulos.menudeo,
  tc_mantic_articulos.medio_mayoreo,
  tc_mantic_articulos.mayoreo,
  tc_mantic_articulos.{precioCliente} as precio_cliente,
  tc_mantic_articulos.sat,
  tc_mantic_articulos.limite_medio_mayoreo,
  tc_mantic_articulos.limite_mayoreo,
  tc_mantic_articulos.iva,
  tc_mantic_articulos.id_redondear,
  tc_mantic_unidades_medidas.nombre unidad_medida,
  ifnull(tc_mantic_articulos.extra, '0') as morado,
  concat(ifnull(tc_mantic_articulos.descuento, '0'), ',', ifnull(tc_mantic_articulos.extra, '0')) as porcentajes,
  concat(tc_mantic_articulos.id_empresa, '/', ifnull(tc_mantic_imagenes.archivo, 'sin-foto.png')) as archivo,
  if(sum(tc_mantic_almacenes_articulos.stock) is null, 0, sum(tc_mantic_almacenes_articulos.stock)) as stock
from 
  tc_mantic_articulos
inner join
  tc_mantic_articulos_codigos on tc_mantic_articulos.id_articulo = tc_mantic_articulos_codigos.id_articulo
inner join 
  tc_mantic_empresas on tc_mantic_articulos.id_empresa = tc_mantic_empresas.id_empresa								
inner join
  tr_mantic_empaque_unidad_medida on tc_mantic_articulos.id_empaque_unidad_medida = tr_mantic_empaque_unidad_medida.id_empaque_unidad_medida
inner join 
  tc_mantic_empaques on tr_mantic_empaque_unidad_medida.id_empaque = tc_mantic_empaques.id_empaque
inner join 
  tc_mantic_unidades_medidas on tr_mantic_empaque_unidad_medida.id_unidad_medida = tc_mantic_unidades_medidas.id_unidad_medida
left join
  tc_mantic_imagenes on tc_mantic_articulos.id_imagen= tc_mantic_imagenes.id_imagen
left join
  tc_mantic_almacenes_articulos on tc_mantic_almacenes_articulos.id_articulo= tc_mantic_articulos.id_articulo and tc_mantic_almacenes_articulos.id_almacen= {idAlmacen}
where 
  tc_mantic_empresas.id_empresa in ({sucursales})
  and tc_mantic_articulos.id_articulo_tipo= 1
  and tc_mantic_articulos.id_vigente= 1
  and (
      (upper(tc_mantic_articulos_codigos.codigo) like '{codigo}%' and tc_mantic_articulos_codigos.id_proveedor is null)
    or
      (upper(tc_mantic_articulos_codigos.codigo) like '{codigo}%' and tc_mantic_articulos_codigos.id_proveedor = {idProveedor})
    or	
      tc_mantic_articulos.id_articulo= {idArticulo}
  )
group by
  tc_mantic_articulos.id_articulo
order by   
  tc_mantic_articulos_codigos.codigo
			</select>
			<select id="porCodigoIgual">
select 
  tc_mantic_articulos_codigos.id_articulo_codigo as id_key,
  tc_mantic_articulos.id_articulo,
  (select tc_mantic_articulos_codigos.codigo from tc_mantic_articulos_codigos where tc_mantic_articulos_codigos.id_articulo= tc_mantic_articulos.id_articulo and tc_mantic_articulos_codigos.id_principal= 1 limit 0, 1) as propio,
  (select tc_mantic_articulos_codigos.codigo from tc_mantic_articulos_codigos where tc_mantic_articulos_codigos.id_articulo= tc_mantic_articulos.id_articulo and (tc_mantic_articulos_codigos.id_proveedor= {idProveedor} and tc_mantic_articulos_codigos.id_principal> 1) and ((upper(tc_mantic_articulos_codigos.codigo) like '{codigo}%' and (tc_mantic_articulos_codigos.id_proveedor = {idProveedor} and tc_mantic_articulos_codigos.id_principal> 1)) or tc_mantic_articulos.id_articulo= {idArticulo}) limit 0, 1) as codigo,
  tc_mantic_articulos.fabricante,
  tc_mantic_articulos.nombre,
  ' ' as origen,
  tc_mantic_articulos.descripcion,
  tc_mantic_articulos.precio,
  tc_mantic_articulos.precio as original,
  tc_mantic_articulos.menudeo,
  tc_mantic_articulos.medio_mayoreo,					
  tc_mantic_articulos.mayoreo,
  tc_mantic_articulos.{precioCliente} as precio_cliente,
  tc_mantic_articulos.sat,
  tc_mantic_articulos.limite_medio_mayoreo,
  tc_mantic_articulos.limite_mayoreo,
  tc_mantic_articulos.iva,
  tc_mantic_articulos.id_redondear,
  tc_mantic_unidades_medidas.nombre unidad_medida,
  ifnull(tc_mantic_articulos.extra, '0') as morado,
  concat(ifnull(tc_mantic_articulos.descuento, '0'), ',', ifnull(tc_mantic_articulos.extra, '0')) as porcentajes,
  concat(tc_mantic_articulos.id_empresa, '/', ifnull(tc_mantic_imagenes.archivo, 'sin-foto.png')) as archivo,
  if(sum(tc_mantic_almacenes_articulos.stock) is null, 0, sum(tc_mantic_almacenes_articulos.stock)) as stock
from 
  tc_mantic_articulos
inner join
  tc_mantic_articulos_codigos on tc_mantic_articulos.id_articulo = tc_mantic_articulos_codigos.id_articulo
inner join 
  tc_mantic_empresas on tc_mantic_articulos.id_empresa = tc_mantic_empresas.id_empresa								
inner join
  tr_mantic_empaque_unidad_medida on tc_mantic_articulos.id_empaque_unidad_medida = tr_mantic_empaque_unidad_medida.id_empaque_unidad_medida
inner join 
  tc_mantic_empaques on tr_mantic_empaque_unidad_medida.id_empaque = tc_mantic_empaques.id_empaque
inner join 
  tc_mantic_unidades_medidas on tr_mantic_empaque_unidad_medida.id_unidad_medida = tc_mantic_unidades_medidas.id_unidad_medida
left join
  tc_mantic_imagenes on tc_mantic_articulos.id_imagen= tc_mantic_imagenes.id_imagen
left join
  tc_mantic_almacenes_articulos on tc_mantic_almacenes_articulos.id_articulo= tc_mantic_articulos.id_articulo and tc_mantic_almacenes_articulos.id_almacen= {idAlmacen}
where 
  tc_mantic_empresas.id_empresa in ({sucursales})
  and tc_mantic_articulos.id_articulo_tipo= 1
  and tc_mantic_articulos.id_vigente= 1
  and (
      (upper(tc_mantic_articulos_codigos.codigo)= '{codigo}' and tc_mantic_articulos_codigos.id_proveedor is null)
    or
     (upper(tc_mantic_articulos_codigos.codigo)= '{codigo}' and tc_mantic_articulos_codigos.id_proveedor = {idProveedor})
    or	
     tc_mantic_articulos.id_articulo= {idArticulo}
  )
group by
  tc_mantic_articulos.id_articulo
order by   
  tc_mantic_articulos_codigos.codigo
			</select>		
		</unit>
		<unit id="VistaCortesCajasDto">
			<select id="lazy">
				select
				  tr_mantic_venta_medio_pago.id_venta_medio_pago as id_key,
					tc_mantic_empresas.id_empresa,
					tc_mantic_empresas.clave as empresa,
					tc_mantic_empresas.nombre as nombre_empresa,
					tr_mantic_venta_medio_pago.id_cierre, 
					tr_mantic_venta_medio_pago.id_venta, 
					concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) as vendedor,
					tc_mantic_ventas.ticket,
					tc_mantic_ventas.id_venta_estatus,
					tc_mantic_ventas_estatus.nombre as estatus,
					tr_mantic_venta_medio_pago.id_tipo_medio_pago, 
					tc_mantic_tipos_medios_pagos.nombre as medio_pago,
					tr_mantic_venta_medio_pago.total, 
					tr_mantic_venta_medio_pago.total as importe, 
					tr_mantic_venta_medio_pago.registro    
				from
					tr_mantic_venta_medio_pago     
				inner join
					tc_mantic_ventas on tr_mantic_venta_medio_pago.id_venta= tc_mantic_ventas.id_venta
				inner join 
					tc_mantic_ventas_estatus on tc_mantic_ventas.id_venta_estatus= tc_mantic_ventas_estatus.id_venta_estatus
				inner join
					tc_mantic_tipos_medios_pagos on tc_mantic_tipos_medios_pagos.id_tipo_medio_pago =tr_mantic_venta_medio_pago.id_tipo_medio_pago
				inner join 
					tc_janal_usuarios on tc_mantic_ventas.id_usuario = tc_janal_usuarios.id_usuario
				inner join				
					tc_mantic_personas on tc_mantic_personas.id_persona = tc_janal_usuarios.id_persona				
				inner join
					tc_mantic_empresas on tc_mantic_ventas.id_empresa= tc_mantic_empresas.id_empresa     
				where
					 tr_mantic_venta_medio_pago.id_cierre= {idCierre} 
				order by
					tr_mantic_venta_medio_pago.id_tipo_medio_pago, tr_mantic_venta_medio_pago.registro 
			</select>	
			<select id="ventas">
				select
					sum(tr_mantic_venta_medio_pago.total) as total
				from
					tr_mantic_venta_medio_pago     
				inner join
					tc_mantic_ventas on tr_mantic_venta_medio_pago.id_venta= tc_mantic_ventas.id_venta
				inner join 
					tc_mantic_ventas_estatus on tc_mantic_ventas.id_venta_estatus= tc_mantic_ventas_estatus.id_venta_estatus
				inner join
					tc_mantic_tipos_medios_pagos on tc_mantic_tipos_medios_pagos.id_tipo_medio_pago =tr_mantic_venta_medio_pago.id_tipo_medio_pago
				inner join 
					tc_janal_usuarios on tc_mantic_ventas.id_usuario = tc_janal_usuarios.id_usuario
				inner join				
					tc_mantic_personas on tc_mantic_personas.id_persona = tc_janal_usuarios.id_persona				
				inner join
					tc_mantic_empresas on tc_mantic_ventas.id_empresa= tc_mantic_empresas.id_empresa     
				where
					 tr_mantic_venta_medio_pago.id_cierre= {idCierre} 
				order by
					tr_mantic_venta_medio_pago.id_tipo_medio_pago, tr_mantic_venta_medio_pago.registro 
			</select>	
			<select id="retiros">
				select 
					tc_mantic_cierres_retiros.id_cierre_retiro as id_key,
					tc_mantic_empresas.id_empresa,
					tc_mantic_empresas.clave as empresa,
					tc_mantic_empresas.nombre as nombre_empresa,
					tc_mantic_cierres_cajas.id_caja,
					tc_mantic_cajas.clave as caja,
					tc_mantic_cierres_retiros.consecutivo,
					concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) as nombre,
					tc_mantic_cierres_retiros.importe,
					tc_mantic_cierres_retiros.importe as total,
					tc_mantic_cierres_retiros.concepto,
					tc_mantic_cierres_retiros.id_abono,
					if(tc_mantic_cierres_retiros.id_abono= 1, 'ABONO', 'RETIRO') as tipo,
					tc_mantic_cierres_retiros.id_usuario,
					tc_mantic_cierres_retiros.registro
				from 
					tc_mantic_cierres_cajas
				inner join 
					tc_mantic_cierres_retiros on tc_mantic_cierres_retiros.id_cierre_caja= tc_mantic_cierres_cajas.id_cierre_caja
				inner join 
					tc_janal_usuarios on tc_mantic_cierres_retiros.id_usuario = tc_janal_usuarios.id_usuario
				inner join				
					tc_mantic_personas on tc_mantic_personas.id_persona = tc_janal_usuarios.id_persona				
				inner join
					tc_mantic_cajas on tc_mantic_cierres_cajas.id_caja = tc_mantic_cajas.id_caja     
				inner join
					tc_mantic_empresas on tc_mantic_cajas.id_empresa= tc_mantic_empresas.id_empresa     
				where
					tc_mantic_cierres_cajas.id_cierre= {idCierre} 
			</select>
			<select id="abonos">
				select 
					sum(tc_mantic_cierres_retiros.importe) as total
				from 
					tc_mantic_cierres_cajas
				inner join 
					tc_mantic_cierres_retiros on tc_mantic_cierres_retiros.id_cierre_caja= tc_mantic_cierres_cajas.id_cierre_caja
				inner join 
					tc_janal_usuarios on tc_mantic_cierres_retiros.id_usuario = tc_janal_usuarios.id_usuario
				inner join				
					tc_mantic_personas on tc_mantic_personas.id_persona = tc_janal_usuarios.id_persona				
				inner join
					tc_mantic_cajas on tc_mantic_cierres_cajas.id_caja = tc_mantic_cajas.id_caja     
				inner join
					tc_mantic_empresas on tc_mantic_cajas.id_empresa= tc_mantic_empresas.id_empresa     
				where
					tc_mantic_cierres_cajas.id_cierre= {idCierre} 
			</select>
			<select id="devoluciones">
				select
					tc_mantic_garantias.id_garantia as id_key,
					tc_mantic_empresas.id_empresa,
					tc_mantic_empresas.clave as empresa,
					tc_mantic_empresas.nombre as nombre_empresa,
					tc_mantic_garantias.consecutivo,
					concat(tc_mantic_personas.nombres, ' ', tc_mantic_personas.paterno, ' ', tc_mantic_personas.materno) as nombre,
					tc_mantic_garantias.total as importe,
					tc_mantic_garantias.total,
					tc_mantic_garantias.id_garantia_estatus,
					tc_mantic_garantias_estatus.nombre as estatus,
					tc_mantic_garantias.id_usuario,
					tc_mantic_garantias.registro
				from
					tc_mantic_garantias
				inner join
					tc_mantic_ventas on tc_mantic_ventas.id_venta= tc_mantic_garantias.id_venta
				inner join
					tr_mantic_venta_medio_pago on tr_mantic_venta_medio_pago.id_venta= tc_mantic_ventas.id_venta
				inner join
					tc_mantic_garantias_estatus on tc_mantic_garantias_estatus.id_garantia_estatus= tc_mantic_garantias.id_garantia_estatus
				inner join 
					tc_janal_usuarios on tc_mantic_garantias.id_usuario= tc_janal_usuarios.id_usuario
				inner join				
					tc_mantic_personas on tc_mantic_personas.id_persona= tc_janal_usuarios.id_persona
				inner join
					tc_mantic_empresas on tc_mantic_ventas.id_empresa= tc_mantic_empresas.id_empresa 
				where 
					tc_mantic_empresas.id_empresa= {idEmpresa}
					and date_format(tc_mantic_garantias.registro, '%Y%m%d%H%i')&gt;= '{inicio}'
					and date_format(tc_mantic_garantias.registro, '%Y%m%d%H%i')&lt;= '{termino}'
				order by
					tc_mantic_garantias.registro desc
			</select>
			<select id="garantias">
				select
					sum(tc_mantic_garantias.total) as total
				from
					tc_mantic_garantias
				inner join
					tc_mantic_ventas on tc_mantic_ventas.id_venta= tc_mantic_garantias.id_venta
				inner join
					tr_mantic_venta_medio_pago on tr_mantic_venta_medio_pago.id_venta= tc_mantic_ventas.id_venta
				inner join
					tc_mantic_garantias_estatus on tc_mantic_garantias_estatus.id_garantia_estatus= tc_mantic_garantias.id_garantia_estatus
				inner join 
					tc_janal_usuarios on tc_mantic_garantias.id_usuario= tc_janal_usuarios.id_usuario
				inner join				
					tc_mantic_personas on tc_mantic_personas.id_persona= tc_janal_usuarios.id_persona
				inner join
					tc_mantic_empresas on tc_mantic_ventas.id_empresa= tc_mantic_empresas.id_empresa 
				where 
					tc_mantic_empresas.id_empresa= {idEmpresa}
					and date_format(tc_mantic_garantias.registro, '%Y%m%d%H%i')&gt;= '{inicio}'
					and date_format(tc_mantic_garantias.registro, '%Y%m%d%H%i')&lt;= '{termino}'
				order by
					tc_mantic_garantias.registro desc
			</select>
		</unit>
	</dml>    
</process>
