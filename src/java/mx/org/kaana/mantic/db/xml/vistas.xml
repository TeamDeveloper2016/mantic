<?xml version="1.0" encoding="ISO-8859-1"?>
<!--
		Relación de consultas para las vistas de MANTIC
-->
<process>
	<dml> 
		<unit id="VistaArticulosDto">
			<select id="row">
				select 
				  tc_mantic_articulos.id_articulo as id_key,
				  tc_mantic_articulos.nombre,          
				  tc_mantic_articulos.menudeo,          
				  tc_mantic_articulos.medio_mayoreo,          
				  tc_mantic_articulos.mayoreo,          
				  tc_mantic_articulos.stock,       
				  tc_mantic_articulos.iva,          
				  tc_mantic_articulos.desperdicio          
				from 
					tc_mantic_articulos
				inner join
					tc_mantic_articulos_codigos on tc_mantic_articulos.id_articulo = tc_mantic_articulos_codigos.id_articulo
				inner join 
					tc_mantic_empresas on tc_mantic_articulos.id_empresa = tc_mantic_empresas.id_empresa
				inner join
					tr_mantic_empaque_unidad_medida on tc_mantic_articulos.id_empaque_unidad_medida = tr_mantic_empaque_unidad_medida.id_unidad_medida
				inner join 
					tc_mantic_empaques on tr_mantic_empaque_unidad_medida.id_empaque = tc_mantic_empaques.id_empaque
				inner join 
					tc_mantic_unidades_medidas on tr_mantic_empaque_unidad_medida.id_unidad_medida = tc_mantic_unidades_medidas.id_unidad_medida
				where 
					tc_mantic_empresas.id_empresa = {idEmpresa}
				and 
					upper(tc_mantic_articulos_codigos.codigo) like upper('%{codigo}%')
				and 
					upper(tc_mantic_articulos.nombre) like upper('%{nombre}%')				
				group by 
				  tc_mantic_articulos.nombre,          
				  tc_mantic_articulos.menudeo,          
				  tc_mantic_articulos.medio_mayoreo,          
				  tc_mantic_articulos.mayoreo,          
				  tc_mantic_articulos.stock,          
				  tc_mantic_articulos.iva,          
				  tc_mantic_articulos.desperdicio          
				{sortOrder}
			</select>
		</unit>
		<unit id="VistaEmpaqueUnidadMedidaDto">
			<select id="empaqueUnidadMedida">
				select 
					tr_mantic_empaque_unidad_medida.id_empaque_unidad_medida as id_key,
					tc_mantic_unidades_medidas.nombre,
					tc_mantic_unidades_medidas.clave,
					tc_mantic_unidades_medidas.descripcion,
					tc_mantic_unidades_medidas.proporcion
				from
				  tr_mantic_empaque_unidad_medida
				inner join 
					tc_mantic_unidades_medidas on tr_mantic_empaque_unidad_medida.id_unidad_medida = tc_mantic_unidades_medidas.id_unidad_medida
				where 
					id_empaque= {idEmpaque}
			</select>
		</unit>
        <unit id="VistaProveedoresDto">
          <select id="row">
            select 
              tc_mantic_proveedores.id_proveedor as id_key,
              tc_mantic_proveedores.clave,
              tc_mantic_proveedores.rfc,
              tc_mantic_proveedores.razon_social,
              tc_mantic_tipos_proveedores.nombre as tipo_proveedor,
              tc_mantic_proveedores.dias_entrega,
              tc_mantic_tipos_dias.nombre as tipo_dia,
              tc_mantic_proveedores.descuento  
             from   
               tc_mantic_proveedores
             inner join
               tc_mantic_tipos_proveedores   on  tc_mantic_tipos_proveedores.id_tipo_proveedor= tc_mantic_proveedores.id_tipo_proveedor
             inner  join
               tc_mantic_tipos_dias  on tc_mantic_tipos_dias.id_tipo_dia=tc_mantic_proveedores.id_tipo_dia
             inner join 
               tr_mantic_proveedor_domicilio  on   tr_mantic_proveedor_domicilio.id_proveedor=tc_mantic_proveedores.id_proveedor
             where
               tc_mantic_proveedores.razon_social like '%{razonSocial}%'
              and
               (tc_mantic_proveedores.rfc like '%{rfc}%' or tc_mantic_proveedores.rfc is null)
              and
               tc_mantic_proveedores.clave like '%{clave}%'
              and 
                tc_mantic_proveedores.id_tipo_proveedor  in ({idTipoProveedor}) 
              and
                tc_mantic_proveedores.id_empresa={idEmpresa}            
              {sortOrder}
          </select>
          <select id="proveedorCondicionPago">
            select 
                tc_mantic_tipos_pagos.id_tipo_pago,
                tc_mantic_tipos_pagos.id_tipo_pago as id_key,            
                tc_mantic_tipos_pagos.nombre as nombre_pago,
                tc_mantic_tipos_formas_pagos.clave,
                tc_mantic_tipos_formas_pagos.nombre
            from 
              tc_mantic_tipos_pagos
            inner join 
              tc_mantic_tipos_formas_pagos on tc_mantic_tipos_formas_pagos.id_tipo_medio_pago=tc_mantic_tipos_pagos.id_tipo_medio_pago              
          </select>  
           <select id="direccionProveedor">
            select 
            tc_janal_entidades.id_entidad,tc_janal_municipios.id_municipio,tc_janal_localidades.id_localidad, tc_janal_entidades.id_entidad as id_key
          from 
            tc_janal_entidades 
          inner join
            tc_janal_municipios  on tc_janal_municipios.id_entidad=tc_janal_entidades.id_entidad
          inner join    
            tc_janal_localidades on tc_janal_localidades.id_municipio=tc_janal_municipios.id_municipio
           inner join
            tc_mantic_domicilios on tc_mantic_domicilios.id_localidad=tc_janal_localidades.id_localidad
           where 
            tc_mantic_domicilios.id_domicilio={idDomicilio}
          </select>            
        </unit> 
        <unit id="VistaClientesDto"> 
          <select id="row">
             select 
                tc_mantic_clientes.id_cliente as id_key,
                tc_mantic_clientes.clave,
                tc_mantic_clientes.rfc,
                tc_mantic_clientes.razon_social,
                tc_mantic_clientes.limite_credito,
                tc_mantic_clientes.plazo_dias,
                tc_mantic_domicilios.calle,
                tc_mantic_domicilios.numero_exterior,
                tc_mantic_domicilios.asentamiento,
                tc_mantic_domicilios.codigo_postal  
               from
                 tc_mantic_clientes 
                inner join
                  tr_mantic_cliente_domicilio  on tr_mantic_cliente_domicilio.id_cliente=tc_mantic_clientes.id_cliente
                inner join
                  tc_mantic_domicilios on tc_mantic_domicilios.id_domicilio = tr_mantic_cliente_domicilio.id_domicilio
                where   
                 tc_mantic_clientes.razon_social like '%{razonSocial}%'
                and
                  tc_mantic_clientes.rfc like '%{rfc}%'
                and
                  tc_mantic_clientes.clave like '%{clave}%' 
                 and
                  tc_mantic_clientes.id_empresa={idEmpresa} 
                 and 
                  tr_mantic_cliente_domicilio.id_principal={idPrincipal}            
               {sortOrder}            
          </select>
         
        </unit>
        <unit id="VistaAlmacenesDto">
          <select id="row">
            select 
             tc_mantic_almacenes.id_almacen as id_key,
             tc_mantic_almacenes.clave,
             tc_mantic_almacenes.nombre,
             tc_mantic_almacenes.descripcion,
             tc_mantic_personas.nombres,
             tc_mantic_personas.paterno,
             tc_mantic_personas.materno,
             tc_mantic_domicilios.calle,
             tc_mantic_domicilios.numero_exterior,
             tc_mantic_domicilios.asentamiento,
             tc_mantic_domicilios.codigo_postal,
             tc_janal_entidades.descripcion as entidad,
             tc_janal_municipios.descripcion as municipio,
             (select count(*) from tc_mantic_almacenes_pisos where id_almacen=tc_mantic_almacenes.id_almacen) pisos            
           from 
             tc_mantic_almacenes
           inner join
             tc_mantic_personas on tc_mantic_personas.id_persona=tc_mantic_almacenes.id_responsable
           inner join
             tr_mantic_almacen_domicilio on  tr_mantic_almacen_domicilio.id_almacen= tc_mantic_almacenes.id_almacen
           inner join
            tc_mantic_domicilios on tc_mantic_domicilios.id_domicilio = tr_mantic_almacen_domicilio.id_domicilio
           inner join
             tc_janal_localidades  on tc_mantic_domicilios.id_localidad=tc_janal_localidades.id_localidad
           inner join 
             tc_janal_municipios on tc_janal_municipios.id_municipio= tc_janal_localidades.id_municipio
            inner join
              tc_janal_entidades  on tc_janal_municipios.id_entidad=tc_janal_entidades.id_entidad
             where
              (tc_mantic_almacenes.clave like '%{clave}%' or tc_mantic_almacenes.clave is null)
             and
               tc_mantic_almacenes.nombre like '%{nombre}%'
              and 
                (tc_mantic_almacenes.descripcion  like '%{descripcion}%' or  tc_mantic_almacenes.descripcion is null)
              and
                tr_mantic_almacen_domicilio.id_principal={idPrincipal}  
              and
                  tc_mantic_almacenes.id_empresa={idEmpresa} 
             {sortOrder} 
          </select>  
        </unit>
		<unit id="VistaPersonasDto">
			<select id="row">
				select 
				  tc_mantic_personas.id_persona as id_key,
				  tc_mantic_personas.nombres,
				  tc_mantic_personas.paterno,
				  tc_mantic_personas.materno,
				  tc_mantic_personas.rfc,
				  tc_mantic_personas.curp,
				  tc_mantic_personas.fecha_nacimiento,
				  tc_mantic_tipos_personas.nombre as tipo_persona,
				  tc_janal_tipos_sexos.id_tipo_sexo,
		 		  tc_janal_tipos_sexos.nombre as sexo,
				  tc_janal_tipos_sexos.nombre,
				  tc_mantic_personas.cuenta 
				from 
					tc_mantic_personas
				inner join
					tc_mantic_personas_titulos on tc_mantic_personas_titulos.id_persona_titulo =tc_mantic_personas.id_persona_titulo
				inner join
					tc_mantic_tipos_personas  on tc_mantic_personas.id_tipo_persona=tc_mantic_tipos_personas.id_tipo_persona
				inner join
					tc_janal_tipos_sexos  on tc_janal_tipos_sexos.id_tipo_sexo = tc_mantic_personas.id_tipo_sexo
				where 
					(tc_mantic_personas.nombres like '%{nombres}%' 
				or
					tc_mantic_personas.paterno like '%{paterno}%'
				or
					tc_mantic_personas.materno  like '%{materno}%')
				and 
					tc_mantic_personas.rfc  like '%{rfc}%'
				and 
					tc_mantic_personas.curp like '%{curp}%'
				and 
					tc_mantic_personas.id_tipo_sexo in ({idTipoSexo})
				and
					tc_mantic_personas.id_tipo_persona  in ({idTipoPersona})
				{sortOrder}  
			</select>              
			<select id="tipoPersona">
				select 
					tc_mantic_personas.*,tc_mantic_personas.id_persona as id_key
				from
					tc_mantic_personas
				inner join
					tr_mantic_empresa_personal on tc_mantic_personas.id_persona = tr_mantic_empresa_personal.id_persona
				where 
					tc_mantic_personas.id_tipo_persona= {idTipoPersona}
				and 
					tr_mantic_empresa_personal.id_empresa= {idEmpresa}
				order by
					paterno,materno,nombres
			</select>
    </unit>                       
	</dml>    
</process>
